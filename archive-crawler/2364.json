{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":27093708,"authorName":"SÃ¸ren Vejrup Carlsen","from":"=?iso-8859-1?q?S=F8ren_Vejrup_Carlsen?= &lt;svc@...&gt;","profile":"svc400","replyTo":"LIST","senderId":"HAkM8QFicy5LdYhK_rE-089JykdP76CKrrs6LsVPag1_e5eix70EHA8jlh_3eK5NGlgfOoWNGbYcG5Pc67bQZEUf-RFTD_0mSPysB7kN5uWOGdisj26LcIhj","spamInfo":{"isSpam":false,"reason":"12"},"subject":"How to create arcfiles with ARC-entries based on files?","postDate":"1132080550","msgId":2364,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGRsZGFqNitrbm84QGVHcm91cHMuY29tPg=="},"prevInTopic":0,"nextInTopic":2365,"prevInTime":2363,"nextInTime":2365,"topicId":2364,"numMessagesInTopic":2,"msgSnippet":"Dear all. We want to embed the heritrix-logs into ARC-files. And the only way seems to convert the files to ByteArrayOutputStreams. The following code maybe","rawEmail":"Return-Path: &lt;svc@...&gt;\r\nX-Sender: svc@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 32338 invoked from network); 15 Nov 2005 18:50:05 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m30.grp.scd.yahoo.com with QMQP; 15 Nov 2005 18:50:05 -0000\r\nReceived: from unknown (HELO n25.bulk.scd.yahoo.com) (66.94.237.54)\n  by mta1.grp.scd.yahoo.com with SMTP; 15 Nov 2005 18:50:04 -0000\r\nComment: DomainKeys? See http://antispam.yahoo.com/domainkeys\r\nReceived: from [66.218.69.4] by n25.bulk.scd.yahoo.com with NNFMP; 15 Nov 2005 18:49:13 -0000\r\nReceived: from [66.218.66.79] by mailer4.bulk.scd.yahoo.com with NNFMP; 15 Nov 2005 18:49:10 -0000\r\nDate: Tue, 15 Nov 2005 18:49:10 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;dldaj6+kno8@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:12:0:0\r\nFrom: =?iso-8859-1?q?S=F8ren_Vejrup_Carlsen?= &lt;svc@...&gt;\r\nSubject: How to create arcfiles with ARC-entries based on files?\r\nX-Yahoo-Group-Post: member; u=27093708; y=E6rTBm3kFh7RNs6MVHHU2ipAKjft41rRpwMuDsbjSChx\r\nX-Yahoo-Profile: svc400\r\n\r\nDear all.\nWe want to embed the heritrix-logs into ARC-files.\nAnd the only w=\r\nay seems to convert the files to ByteArrayOutputStreams.\nThe following code=\r\n maybe does the trick, but it seems very akward\nthis way. Any help would be=\r\n appreciated:\n\n################# Code begins ######################\n\nARCWri=\r\nter aw =3D new ARCWriter(arcsDirs, prefix, suffix, compress,\n              =\r\n  maxSize, metadata);\nIterator filesToIncludeIterator =3D filesToInclude.it=\r\nerator();\n\nwhile (filesToIncludeIterator.hasNext()) {\ntry {\n     String con=\r\ntentType =3D &quot;text/plain&quot;;\n     String hostIP =3D InetAddress.getLocalHost(=\r\n).getHostAddress();\n     long fetchBeginTimeStamp =3D System.currentTimeMil=\r\nlis();\n     ByteArrayOutputStream baos;\n     int recordLength;\n\n     String=\r\n fileName =3D (String) filesToIncludeIterator.next();\n     System.out.print=\r\nln(&quot;filename:&quot; + fileName);\n     if (fileName =3D=3D null) {\n             c=\r\nontinue;\n     }\n     File theFile =3D new File(crawldir, fileName);\n     St=\r\nring uri =3D new String(RECORD_PREFIX + jobId + &quot;/&quot; + fileName);\n\n     baos=\r\n =3D createBaosFromFile(theFile);\n\n     // We have to read the whole file t=\r\no know the length of the\n     // file, or do we take this information\n     =\r\n// from theFile.length()\n     recordLength =3D baos.toByteArray().length;\n =\r\n    \n      /**\n        * @see ARCWriter#write(java.lang.String, java.lang.S=\r\ntring,\n        *      java.lang.String, long, int,\n        *      java.io.B=\r\nyteArrayOutputStream)\n        */\n      aw.write(uri, contentType, hostIP, f=\r\netchBeginTimeStamp,\n                        recordLength, baos);\n\n     } ca=\r\ntch (IOException e) {\n                throw new IOFailure(&quot;IOexception was =\r\ncaught: &quot;, e);\n     }\n   } // end while\n\n   /**\n     * @param theFile\n     =\r\n* @return a ByteArrayOutputStream from a file\n     * @throws IOException\n  =\r\n   */\n    public static ByteArrayOutputStream createBaosFromFile(File \ntheF=\r\nile)\n            throws IOException {\n        // TODO: Need to write a head=\r\ner as well to the baos??\n\n        InputStream stream =3D new FileInputStrea=\r\nm(theFile); // throws\n        // IOException (or\n        // rather\n        =\r\n// FileNotFoundException)\n        ByteArrayOutputStream baos =3D new ByteAr=\r\nrayOutputStream();\n        byte[] buffer =3D new byte[8192];\n        int by=\r\ntesRead =3D 0;\n\n        final String HTTP =3D &quot;HTTP/1.0 200 Ok&quot;;\n        fi=\r\nnal String date =3D &quot;Date: &quot; + new Date();\n        final String contentType=\r\n =3D &quot;Content-type: &quot; + &quot;text/plain&quot;;\n        final String contentLength =\r\n=3D &quot;Content-length: &quot; + \ntheFile.length();\n        StringBuffer http_heade=\r\nr =3D new StringBuffer();\n\n        http_header.append(HTTP + &quot;&#92;n&quot;);\n       =\r\n http_header.append(date + &quot;&#92;n&quot;);\n        http_header.append(contentType + =\r\n&quot;&#92;n&quot;);\n        http_header.append(contentLength + &quot;&#92;n&#92;n&quot;);\n        System.o=\r\nut.println(&quot;header: &quot; + http_header.toString());\n        baos.write(http_he=\r\nader.toString().getBytes());\n        while ((bytesRead =3D stream.read(buff=\r\ner, 0, 8192)) !=3D -1) { // \nthrows\n            // IOException\n            =\r\nbaos.write(buffer, 0, bytesRead);\n        }\n        return baos;\n    }\n####=\r\n########### Code ends #########################\n\n\n\n\n"}}