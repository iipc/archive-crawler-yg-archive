{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"gfj1JmtK2r8rwp3yvl73o7HpS5LYJLfHM5Cyb1ZFU952eEN5AifldLvmeP5RHaEBODETBcbRy36oBrZuBXEQ11XyhMlvo6s","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] H3: Changing queue budgets in sheet overlays during a crawl","postDate":"1281485235","msgId":6667,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRDNjFFOUIzLjIwNTAwMDhAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGkzcm8ycitvYTU0QGVHcm91cHMuY29tPg==","referencesHeader":"PGkzcm8ycitvYTU0QGVHcm91cHMuY29tPg=="},"prevInTopic":6660,"nextInTopic":6668,"prevInTime":6666,"nextInTime":6668,"topicId":6660,"numMessagesInTopic":3,"msgSnippet":"... There are some issues with the liveness of mid-crawl budget/retirement-status changes; the current approach doesn t necessarily compare values at the","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 75483 invoked from network); 11 Aug 2010 00:07:16 -0000\r\nX-Received: from unknown (98.137.34.45)\n  by m8.grp.sp2.yahoo.com with QMQP; 11 Aug 2010 00:07:16 -0000\r\nX-Received: from unknown (HELO relay03.pair.com) (209.68.5.17)\n  by mta2.grp.sp2.yahoo.com with SMTP; 11 Aug 2010 00:07:16 -0000\r\nX-Received: (qmail 99953 invoked from network); 11 Aug 2010 00:07:14 -0000\r\nX-Received: from 208.70.27.190 (HELO silverbook.local) (208.70.27.190)\n  by relay03.pair.com with SMTP; 11 Aug 2010 00:07:14 -0000\r\nX-pair-Authenticated: 208.70.27.190\r\nMessage-ID: &lt;4C61E9B3.2050008@...&gt;\r\nDate: Tue, 10 Aug 2010 17:07:15 -0700\r\nUser-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.1.11) Gecko/20100711 Thunderbird/3.0.6\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: kristsi25 &lt;kris@...&gt;\r\nReferences: &lt;i3ro2r+oa54@...&gt;\r\nIn-Reply-To: &lt;i3ro2r+oa54@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] H3: Changing queue budgets in sheet overlays\n during a crawl\r\nX-Yahoo-Group-Post: member; u=137285340; y=d5tPXm9F8DHsfcPYNFXg2rInY4wogEkP5p6JHEIaGIOY\r\nX-Yahoo-Profile: gojomo\r\n\r\nOn 8/10/10 7:35 AM, kristsi25 wrote:\n&gt; Running a crawl under Heritrix 3.0.0 I associated a new SURT to a sheet that affects the frontier.queueTotalBudget and frontier.balanceReplenishAmount. I then invoked the frontier&#39;s reconsiderRetiredQueues() method expecting the queues that had been retired to pick up the new (more generous) values and go back into rotation.\n&gt;\n&gt; However, while the queues were un-retired, they did not seem to pick up on this change.\n&gt;\n&gt; No errors cropped up and inspecting the sheetOverlayManager reveals that the association is as expected.\n&gt;\n&gt; Beanshell code used:\n&gt; appCtx.getBean(&quot;sheetOverlaysManager&quot;).addSurtAssociation(&quot;[SURT]&quot;, &quot;[The sheets bean name]&quot;)\n&gt; appCtx.getBean(&quot;frontier&quot;).reconsiderRetiredQueues();\n\nThere are some issues with the &#39;liveness&#39; of mid-crawl \nbudget/retirement-status changes; the current approach doesn&#39;t \nnecessarily compare values at the right times. Not yet sure of the best \nfix, but the issue is on my radar. Some related JIRA issues are:\n\nhttps://webarchive.jira.com/browse/HER-1768\nhttps://webarchive.jira.com/browse/HER-747\n\n&gt; The reason this needed to be done was because some urls with the &quot;protocol&quot; prefix &#39;p://&#39; got erroneously added to the crawl.\n&gt;\n&gt; The baseline queue budget is very limited but a sheet overlay is used to remove limits for http://(is, and https://(is, along with a few select others. When the p:// urls came up they lowered the budget again as they did not match the association. (Perhaps the SurtAuthorityQueueAssignmentPolicy should hang on to the protocol part in the queue name?)\n&gt;\n&gt; This issue has also got me wondering if it would be possible to have such associations that applied to all protocols? Indeed, it would seem more logical to me for that to be the norm.\n\nThe fact that groupings-into-queues and qroupings-for-overlay-settings \nare not identical can lead to problems in a number of places -- most \nacutely here -- because the whole queue is treated according to the \noverlay settings of the most recent URI used for settings-context, and \n(due to the above issue) the queue-comparisons may linger beyond when \nthey should.\n\nAddressing the above &#39;liveness&#39; issue might help a bit; the budget would \nself-correct as soon as the next &#39;real&#39; URI&#39;s settings are considered.\n\nAlso, ensuring different (especially unknown) protocol URIs don&#39;t land \nin the same http(s) queue would reduce the triggering situations for \nsettings divergence.\n\nA protocol-agnostic overlay, as you suggest, is worth considering but \nI&#39;ll have to think more about the implementation details. Another \npossibility might be overlays that are addressed at queue-groupings, \nrather than just SURT prefixes, for precision with regard to \nqueue/frontier values.\n\nCan you file an issue highlighting this &quot;p://&quot; issue and how it \nessentially clobbered the desired queue settings for real URIs?\n\n- Gordon @ IA\n\n\n&gt; - Kris\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}