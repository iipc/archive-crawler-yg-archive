{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":191387937,"authorName":"pandae667","from":"&quot;pandae667&quot; &lt;aaron667@...&gt;","profile":"pandae667","replyTo":"LIST","senderId":"h6s8Z5w0VnC9qsg-cfkH0N22_q_tRyF8pQjC9IlZoyLryNe0UEvkpRvAgU8nwPP8wIgq-1FSA-1bQWME0T7oJY_WDzDB","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: Heritrix &quot;hangs&quot; and doesn&#39;t finish its job","postDate":"1151662130","msgId":2994,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGU4MnQ3aStnY3J1QGVHcm91cHMuY29tPg==","inReplyToHeader":"PDQ0QTQ0MjI2LjkwMTAxMDhAYXJjaGl2ZS5vcmc+"},"prevInTopic":2991,"nextInTopic":2996,"prevInTime":2993,"nextInTime":2995,"topicId":2822,"numMessagesInTopic":9,"msgSnippet":"Hi Gordon, first of all, here is the full frontier report I get: Job being crawled: hangup ... Discovered:    237 Queued:        4 Finished:      24 ","rawEmail":"Return-Path: &lt;aaron667@...&gt;\r\nX-Sender: aaron667@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 39847 invoked from network); 30 Jun 2006 10:08:56 -0000\r\nReceived: from unknown (66.218.67.36)\n  by m40.grp.scd.yahoo.com with QMQP; 30 Jun 2006 10:08:56 -0000\r\nReceived: from unknown (HELO n4c.bullet.sc5.yahoo.com) (66.163.187.195)\n  by mta10.grp.scd.yahoo.com with SMTP; 30 Jun 2006 10:08:56 -0000\r\nReceived: from [66.163.187.123] by n4.bullet.sc5.yahoo.com with NNFMP; 30 Jun 2006 10:08:51 -0000\r\nReceived: from [66.218.69.2] by t4.bullet.sc5.yahoo.com with NNFMP; 30 Jun 2006 10:08:50 -0000\r\nReceived: from [66.218.66.68] by t2.bullet.scd.yahoo.com with NNFMP; 30 Jun 2006 10:08:50 -0000\r\nDate: Fri, 30 Jun 2006 10:08:50 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;e82t7i+gcru@...&gt;\r\nIn-Reply-To: &lt;44A44226.9010108@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:6:0:0\r\nFrom: &quot;pandae667&quot; &lt;aaron667@...&gt;\r\nSubject: Re: Heritrix &quot;hangs&quot; and doesn&#39;t finish its job\r\nX-Yahoo-Group-Post: member; u=191387937; y=0ZS9bc1LLrBfV92KeQHFyuqfI2zKAO2vITa8VP2iXDTCba0e\r\nX-Yahoo-Profile: pandae667\r\n\r\nHi Gordon,\n\nfirst of all, here is the full frontier report I get:\n\n Job bei=\r\nng crawled: hangup\n\n -----=3D=3D=3D=3D=3D STATS =3D=3D=3D=3D=3D-----\n Disco=\r\nvered:    237\n Queued:        4\n Finished:      24\n  Successfully: 24\n  Fai=\r\nled:       0\n  Disregarded:  0\n\n -----=3D=3D=3D=3D=3D QUEUES =3D=3D=3D=3D=\r\n=3D-----\n Already included size:     237\n               pending:     0\n\n Al=\r\nl class queues map size: 4\n             Active queues: 0\n                  =\r\n  In-process: 0\n                         Ready: 0\n                       Sn=\r\noozed: 0\n           Inactive queues: 0\n            Retired queues: 4\n      =\r\n    Exhausted queues: 0\n\n -----=3D=3D=3D=3D=3D IN-PROCESS QUEUES =3D=3D=3D=\r\n=3D=3D-----\n\n -----=3D=3D=3D=3D=3D READY QUEUES =3D=3D=3D=3D=3D-----\n\n ----=\r\n-=3D=3D=3D=3D=3D SNOOZED QUEUES =3D=3D=3D=3D=3D-----\n\n -----=3D=3D=3D=3D=3D=\r\n LONGEST QUEUE =3D=3D=3D=3D=3D-----\nQueue www.chip.de\n  169 items\n    last =\r\nenqueued:\nhttp://www.chip.de/news/http%3A%2F%2Fwww.chip.de%2Fnews%2Fc1_news=\r\n_20547236.html%3Ftid1%3D9226%26tid2%3D0\n      last peeked:\nhttp://www.chip.=\r\nde/news/c1_news_20546431.html?tid1=3D9226&tid2=3D0\n   total expended: 6 (to=\r\ntal budget: 5)\n   active balance: 5\n   last(avg) cost: 1(1.0)\n\n\n -----=3D=\r\n=3D=3D=3D=3D INACTIVE QUEUES =3D=3D=3D=3D=3D-----\n\n -----=3D=3D=3D=3D=3D RE=\r\nTIRED QUEUES =3D=3D=3D=3D=3D-----\nQueue r.chip.de\n  5 items\n    last enqueu=\r\ned:\nhttp://r.chip.de/images/pic.gif?m=3Dc1&uid=3D0&c=3D20547236&b=3D2711826=\r\n&l=3D3071&tc=3D019001003&tid=3D9240&tp=3D9223,9226&random=3D%22+Math.random=\r\n()+%22&json=3D1&con=3D%22+con+%22&tit=3DNews%20-%20MP3-Player%20inklusive%2=\r\n0H%26ouml%3Brb%26uuml%3Bchern&r=3D%22+escape(document.referrer)+%22&sz=3D%2=\r\n2+r2sz+%22&tn=3DM%E4rkte%20%26%20Unternehmen&url=3Dhttp%3A%2F%2Fwww.chip.de=\r\n%2Fnews%2Fc1_news_20547236.html%3Ftid1%3D9240%26amp%3Btid2%3D0&cs=3D1\n     =\r\n last peeked:\nhttp://r.chip.de/images/pic.gif?m=3Dc1&uid=3D&c=3D17215088&b=\r\n=3D1868041&l=3D3661&tc=3D019039&tid=3D&tp=3D&tit=3DHomepage&r=3Dhttp%3A%2F%=\r\n2Fwww.chip.de%2Fc1_navseite_12648189.html&random=3D716829837&tn=3D&url=3Dht=\r\ntp%3A%2F%2Farchiv.chip.de%2Findex.html%3Ftid1%3D%26amp%3Btid2%3D&cs=3D1\n   =\r\ntotal expended: 6 (total budget: 5)\n   active balance: 5\n   last(avg) cost:=\r\n 1(1.0)\n\nQueue ad.chip.de\n  3 items\n    last enqueued:\nhttp://ad.chip.de/wb=\r\n/adjs.php?what=3Dwebtipp&n=3D439136166&exclude=3D1&p=3Dchip.de&nbpp=3D9223,=\r\n9226,9226&pbpp=3D1&uri=3D%2Fnews%2Fc1_news_20547236.html&pos=3Dwebtipp&ress=\r\nort=3D9226&rubrik=3D9226&tid2=3D0\n      last peeked:\nhttp://ad.chip.de/wb/a=\r\ndjs.php?what=3Dfooter&n=3D905642610&exclude=3D1&p=3Dchip.de&nbpp=3D9223,922=\r\n6,9226&pbpp=3D1&uri=3D%2Fnews%2Fc1_news_20562075.html&pos=3Dfooter&ressort=\r\n=3D9226&rubrik=3D9226&tid2=3D0\n   total expended: 6 (total budget: 5)\n   ac=\r\ntive balance: 5\n   last(avg) cost: 1(1.0)\n\nQueue archiv.chip.de\n  36 items\n=\r\n    last enqueued: http://archiv.chip.de/http%3A%2F%2Farchiv.chip.de%2F\n   =\r\n   last peeked: http://archiv.chip.de/http%3A%2F%2Farchiv.chip.de%2F\n   tot=\r\nal expended: 6 (total budget: 5)\n   active balance: 5\n   last(avg) cost: 1(=\r\n1.0)\n\nQueue www.chip.de\n  169 items\n    last enqueued:\nhttp://www.chip.de/n=\r\news/http%3A%2F%2Fwww.chip.de%2Fnews%2Fc1_news_20547236.html%3Ftid1%3D9226%2=\r\n6tid2%3D0\n      last peeked:\nhttp://www.chip.de/news/c1_news_20546431.html?=\r\ntid1=3D9226&tid2=3D0\n   total expended: 6 (total budget: 5)\n   active balan=\r\nce: 5\n   last(avg) cost: 1(1.0)\n\n\nThe JVm I am using is a 32bit Sun JDK 1.5=\r\n.0.06 on one system and a AMD\n64bit Sun JDK 1.5.0.07 on another one.\n\nAbout=\r\n you suspecting the cause in IPQueueAssignement - it also happens\nto me whe=\r\nn using a HostnameQueueAssignementPolicy,\nBucketQueueAssignementPolicy or S=\r\nortAuthorityQueueAssignementPolicy.\n\nHope those details help you in trackin=\r\ng down this really annoying problem.\n\nThanks in advance\n  Olaf Freyer\n\n--- =\r\nIn archive-crawler@yahoogroups.com, Gordon Mohr &lt;gojomo@...&gt; wrote:\n&gt;\n&gt; Ola=\r\nf -\n&gt; \n&gt; I can see a potential cause of your problem -- an interaction betw=\r\neen \n&gt; the IP-based queueing and retired queues -- but I can&#39;t reproduce it=\r\n.\n&gt; \n&gt; Specifically, with the IP-based queueing, URIs first go onto a \n&gt; do=\r\nmain-name queue (before IP is known), then get moved to an IP-based \n&gt; queu=\r\ne. It appears possible that this handoff between queues might not \n&gt; mainta=\r\nin the proper queued count in all situations. (Also, that the\n&gt; \n&gt; However,=\r\n my attempts to reproduce with the URI you provided and similar \n&gt; settings=\r\n have not yet succeeded. Indeed, I even ran into another\nproblem \n&gt; with IP=\r\nQueueAssignmentPolicy not working at all, given the difference \n&gt; between i=\r\nts getClassKey() signature and the superclass signature.\n&gt; \n&gt; What JVM are =\r\nyou using?\n&gt; \n&gt; Can you forward the contents of the full frontier report fo=\r\nr your\nlatest \n&gt; mini-reproduction run?\n&gt; \n&gt; - Gordon @ IA\n&gt; \n&gt; pandae667 w=\r\nrote:\n&gt; &gt; Hi everyone,\n&gt; &gt; \n&gt; &gt; I tried to find the cause of the problem fo=\r\nr a while by now, but I&#39;m\n&gt; &gt; still stuck. \n&gt; &gt; I added some debug output t=\r\no heritrix so each time the queuedUriCount\n&gt; &gt; gets increased I get an info=\r\n in the log, same when it is increased.\n&gt; &gt; \n&gt; &gt; Using the previous example=\r\n of mine I see the following in my logs:\n&gt; &gt; \n&gt; &gt; queued count increased by=\r\n 1:  231\n&gt; &gt; queued count decreased by 1:   24 (it have been 4 queues, max =\r\ntotal\n&gt; &gt; cost of 5 - thus 5 plus DNS query for each?)\n&gt; &gt; \n&gt; &gt; and in the =\r\nend, 4 queues are retired, reducing the queued count by: 1,\n&gt; &gt; 2, 36, 164\n=\r\n&gt; &gt; \n&gt; &gt; So a total of 231 objects were queued, but only 227 were dequeued,=\r\n\n&gt; &gt; resulting in 4 remaining &quot;queued&quot; URIs in no queue that feels\nresponsi=\r\nble.\n&gt; &gt; \n&gt; &gt; As the number of single decreases seems sane, the single incr=\r\neases\n&gt; &gt; seem correct, too (no URI seems to have been enqueued twice) I su=\r\nspect\n&gt; &gt; the problem must be with the WorkQueues. Is there any chance that=\r\n the\n&gt; &gt; getCount() method might return the wrong value?\n&gt; &gt; \n&gt; &gt; I&#39;d be th=\r\nankful for any help as I&#39;m desperated by now..\n&gt; &gt; \n&gt; &gt; Thanks in advance\n&gt;=\r\n &gt;   Olaf Freyer\n&gt; &gt; \n&gt; &gt; --- In archive-crawler@yahoogroups.com, &quot;pandae66=\r\n7&quot; &lt;aaron667@&gt; wrote:\n&gt; &gt;&gt; Hi everyone,\n&gt; &gt;&gt;\n&gt; &gt;&gt; its me again. I have mana=\r\nged to reproduce this problem with just one\n&gt; &gt;&gt; seed.\n&gt; &gt;&gt; The seed in que=\r\nstion is: \nhttp://www.chip.de/c1_navseite_12648189.html\n&gt; &gt;&gt; The order.xml =\r\nto trigger the problem can be found at:\n&gt; &gt;&gt; http://user.cs.tu-berlin.de/~a=\r\naron/order.xml\n&gt; &gt;&gt;\n&gt; &gt;&gt; With this order.xml it takes about 5 seconds to tr=\r\nigger the\nproblem for\n&gt; &gt;&gt; me (100% reproducable).\n&gt; &gt;&gt; I&#39;m using an out-of=\r\n-the-box heritrix-1.8.0 release without any\nspecial\n&gt; &gt;&gt; tweaks or changes.=\r\n\n&gt; &gt;&gt;\n&gt; &gt;&gt; Here is the queue report I get:\n&gt; &gt;&gt; -----=3D=3D=3D=3D=3D STATS =\r\n=3D=3D=3D=3D=3D-----\n&gt; &gt;&gt; Discovered:    492\n&gt; &gt;&gt; Queued:        134\n&gt; &gt;&gt; F=\r\ninished:      30\n&gt; &gt;&gt; Successfully: 30\n&gt; &gt;&gt; Failed:       0\n&gt; &gt;&gt; Disregarde=\r\nd:  0\n&gt; &gt;&gt;\n&gt; &gt;&gt; -----=3D=3D=3D=3D=3D QUEUES =3D=3D=3D=3D=3D-----\n&gt; &gt;&gt; Alrea=\r\ndy included size:     492\n&gt; &gt;&gt; pending:     0\n&gt; &gt;&gt;\n&gt; &gt;&gt; All class queues ma=\r\np size: 5\n&gt; &gt;&gt; Active queues: 0\n&gt; &gt;&gt; In-process: 0\n&gt; &gt;&gt; Ready: 0\n&gt; &gt;&gt; Snooz=\r\ned: 0\n&gt; &gt;&gt; Inactive queues: 0\n&gt; &gt;&gt; Retired queues: 5\n&gt; &gt;&gt; Exhausted queues:=\r\n 0\n&gt; &gt;&gt;\n&gt; &gt;&gt; -----=3D=3D=3D=3D=3D IN-PROCESS QUEUES =3D=3D=3D=3D=3D-----\n&gt; =\r\n&gt;&gt; heritrix_out.log shows once again no sign of an exception.\n&gt; &gt;&gt;\n&gt; &gt;&gt; Thx=\r\n for any further help in resolving this problem\n&gt; &gt;&gt;    Olaf Freyer\n&gt; &gt;&gt;\n&gt; =\r\n&gt;&gt;\n&gt; &gt;&gt; --- In archive-crawler@yahoogroups.com, &quot;pandae667&quot; &lt;aaron667@&gt;\n&gt; &gt;=\r\n&gt; wrote:\n&gt; &gt;&gt;&gt; Hi everyone,\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; I&#39;v dug some more through the Herit=\r\nrix sources to track down the\n&gt; &gt;&gt;&gt; problem but haven&#39;t found a solution ye=\r\nt. This problem starts to get\n&gt; &gt;&gt;&gt; really annoying as it happens on almost=\r\n every big crawl I&#39;m running\n&gt; &gt;&gt;&gt; (500+ seeds) but rarly on small ones wit=\r\nh less seeds.\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; I haven&#39;t found a cause yet but have some theorie=\r\ns what might\ncause it\n&gt; &gt;&gt;&gt; (even though I might be totally wrong).\n&gt; &gt;&gt;&gt;\n&gt;=\r\n &gt;&gt;&gt; The most propable theory so far is the following:\n&gt; &gt;&gt;&gt; Two ToeThreads=\r\n working on different URIs from different queues come\n&gt; &gt;&gt;&gt; accross the sam=\r\ne (so far unseen) URI at more or less &quot;the exact same\n&gt; &gt;&gt;&gt; moment&quot;. Both t=\r\nhreads come to the conclusion that their URI is\nnew and\n&gt; &gt;&gt;&gt; try to enqueu=\r\ne it in the currect queue. While doing this both of\nthem\n&gt; &gt;&gt;&gt; increment to=\r\n queuedUriCount by 1 but the queue itself being smart\n&gt; &gt;&gt;&gt; enough only con=\r\ntains one of them.\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; I&#39;ll increase logging to see if my theory mi=\r\nght be true and report\n&gt; &gt;&gt;&gt; back later.\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; If anyone has an=\r\ny other idea in the meantime I&#39;ll be happy to hear\n&gt; &gt;&gt;&gt; about it.\n&gt; &gt;&gt;&gt;\n&gt; =\r\n&gt;&gt;&gt; Thanks alot\n&gt; &gt;&gt;&gt;   Olaf Freyer\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; --- In archive-crawle=\r\nr@yahoogroups.com, &quot;pandae667&quot; aaron667@ wrote:\n&gt; &gt;&gt;&gt;&gt; Hi everyone here at =\r\narchive-crawler,\n&gt; &gt;&gt;&gt;&gt;\n&gt; &gt;&gt;&gt;&gt; I&#39;m experiencing a strange problem with my c=\r\nrawler (heritrix cvs +\n&gt; &gt;&gt;&gt;&gt; AddRedirectFromRootServerToScope fix from Gor=\r\ndon). It happened\nto me\n&gt; &gt;&gt;&gt;&gt; twice so far.\n&gt; &gt;&gt;&gt;&gt;\n&gt; &gt;&gt;&gt;&gt; After about 1 ho=\r\nur it has fetched (allmost?) all the documents\nit is\n&gt; &gt;&gt;&gt;&gt; supposed to (ab=\r\nout 9000 seeds and a limit of 100 documents per\nhost)\n&gt; &gt;&gt;&gt;&gt; and then just =\r\n&quot;hangs&quot;.\n&gt; &gt;&gt;&gt;&gt;\n&gt; &gt;&gt;&gt;&gt; The Frontier Report tells me:\n&gt; &gt;&gt;&gt;&gt;\n&gt; &gt;&gt;&gt;&gt;  -----=\r\n=3D=3D=3D=3D=3D STATS =3D=3D=3D=3D=3D-----\n&gt; &gt;&gt;&gt;&gt;  Discovered:    1008968\n&gt;=\r\n &gt;&gt;&gt;&gt;  Queued:        24\n&gt; &gt;&gt;&gt;&gt;  Finished:      432424\n&gt; &gt;&gt;&gt;&gt;   Successfull=\r\ny: 426289\n&gt; &gt;&gt;&gt;&gt;   Failed:       1565\n&gt; &gt;&gt;&gt;&gt;   Disregarded:  4570\n&gt; &gt;&gt;&gt;&gt;\n&gt; =\r\n&gt;&gt;&gt;&gt;  -----=3D=3D=3D=3D=3D QUEUES =3D=3D=3D=3D=3D-----\n&gt; &gt;&gt;&gt;&gt;  Already incl=\r\nuded size:     1008968\n&gt; &gt;&gt;&gt;&gt;                pending:     0\n&gt; &gt;&gt;&gt;&gt;\n&gt; &gt;&gt;&gt;&gt;  =\r\nAll class queues map size: 12872\n&gt; &gt;&gt;&gt;&gt;              Active queues: 0\n&gt; &gt;&gt;&gt;=\r\n&gt;                     In-process: 0\n&gt; &gt;&gt;&gt;&gt;                          Ready: =\r\n0\n&gt; &gt;&gt;&gt;&gt;                        Snoozed: 0\n&gt; &gt;&gt;&gt;&gt;            Inactive queue=\r\ns: 0\n&gt; &gt;&gt;&gt;&gt;             Retired queues: 2226\n&gt; &gt;&gt;&gt;&gt;           Exhausted que=\r\nues: 10646\n&gt; &gt;&gt;&gt;&gt;\n&gt; &gt;&gt;&gt;&gt;  -----=3D=3D=3D=3D=3D IN-PROCESS QUEUES =3D=3D=3D=\r\n=3D=3D-----\n&gt; &gt;&gt;&gt;&gt;\n&gt; &gt;&gt;&gt;&gt; So there are still 24 queued URIs - but no active=\r\n queue left (last\n&gt; &gt;&gt;&gt;&gt; time a queue did anything was about 12 hours ago).=\r\n\n&gt; &gt;&gt;&gt;&gt;\n&gt; &gt;&gt;&gt;&gt; Thanks in advance for any ideas\n&gt; &gt;&gt;&gt;&gt;   Olaf Freyer\n&gt; &gt;&gt;&gt;&gt;\n=\r\n&gt; &gt; \n&gt; &gt; \n&gt; &gt; \n&gt; &gt; \n&gt; &gt; \n&gt; &gt; \n&gt; &gt; \n&gt; &gt;  \n&gt; &gt; Yahoo! Groups Links\n&gt; &gt; \n&gt; &gt; \n=\r\n&gt; &gt; \n&gt; &gt;  \n&gt; &gt; \n&gt; &gt;\n&gt;\n\n\n\n\n\n\n"}}