{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"dEGXIIsihEjdAWIFTdRQetWqWDeXOx_1Hn9poCA6ADaNmjSgN-dxS4ILwkRdlQWk2VilhRYOGgm2Sv3Av6q_x5fewnspXrM","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Dealing with Thread Contention","postDate":"1312498638","msgId":7251,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRFM0IyM0NFLjQwNkBhcmNoaXZlLm9yZz4=","inReplyToHeader":"PGoxZjR0NStnaW85QGVHcm91cHMuY29tPg==","referencesHeader":"PGoxZjR0NStnaW85QGVHcm91cHMuY29tPg=="},"prevInTopic":7250,"nextInTopic":7257,"prevInTime":7250,"nextInTime":7252,"topicId":7250,"numMessagesInTopic":4,"msgSnippet":"If you see many threads in this same state, then one other thread has the monitor , and likely it is blocked (or otherwise taking longer than ideal) because","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 7275 invoked from network); 4 Aug 2011 22:57:20 -0000\r\nX-Received: from unknown (66.196.94.107)\n  by m12.grp.re1.yahoo.com with QMQP; 4 Aug 2011 22:57:20 -0000\r\nX-Received: from unknown (HELO relay02.pair.com) (209.68.5.16)\n  by mta3.grp.re1.yahoo.com with SMTP; 4 Aug 2011 22:57:20 -0000\r\nX-Received: (qmail 35776 invoked by uid 0); 4 Aug 2011 22:57:18 -0000\r\nX-Received: from 76.218.213.38 (HELO silverbook.local) (76.218.213.38)\n  by relay02.pair.com with SMTP; 4 Aug 2011 22:57:18 -0000\r\nX-pair-Authenticated: 76.218.213.38\r\nMessage-ID: &lt;4E3B23CE.406@...&gt;\r\nDate: Thu, 04 Aug 2011 15:57:18 -0700\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:5.0) Gecko/20110624 Thunderbird/5.0\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: helloitsmaxine &lt;itsmaxine@...&gt;\r\nReferences: &lt;j1f4t5+gio9@...&gt;\r\nIn-Reply-To: &lt;j1f4t5+gio9@...&gt;\r\nContent-Type: text/plain; charset=windows-1252; format=flowed\r\nContent-Transfer-Encoding: 8bit\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] Dealing with Thread Contention\r\nX-Yahoo-Group-Post: member; u=137285340; y=0We_CmiYwflI9r6CjywgtdefBtAF04dL-R0AVDSn_LxH\r\nX-Yahoo-Profile: gojomo\r\n\r\nIf you see many threads in this same state, then one other thread &#39;has \nthe monitor&#39;, and likely it is blocked (or otherwise taking longer than \nideal) because of necessary queue-maintenance disk IO (inside the BDB-JE \ncode, in either the thread directly holding the lock, or some other \nbackground BDB-JE thread).\n\nThere&#39;s no setting quick-fix ï¿½ or else it would be the default!\n\nMore/faster hard-disks should help: especially specifying the &#39;state&#39; \ndirectory to be on a different disk than all other IO, or a faster disk \n(SSD) or disk-array.\n\nMore RAM usually helps some too, by either allowing a larger heap (for \nBDB-JE&#39;s own caching) or more OS disk-caching outside the JVM (assuming \nMacOS works like Linux in this regard).\n\nH3 also has a number of changes to reduce thread contention in places \nlike this, but the overall benefit (if any) hasn&#39;t been quantified.\n\n- Gordon\n\nOn 8/4/11 3:02 PM, helloitsmaxine wrote:\n&gt; I&#39;ve been asking a lot about this same problem I&#39;ve been having so sorry for all the questions!\n&gt;\n&gt; The general overview is that my crawl starts out fast and slows down to an extremely slow rate after a few hours. At the slow-down time, the max heap is being used, congestion ratio high, and all threads active.\n&gt;\n&gt; Recently after trying to monitor crawl progress using jvisualvm I the heap usage is generally steady rising and falling near the max heap. The thread activity shows most of the threads stopped at &quot;Monitor.&quot; A thread dump shows messages like:\n&gt; &quot;ToeThread #159: http://xqueso.tumblr.com/ask&quot; prio=4 tid=196954800 nid=0x1a50db000 waiting for monitor entry [1a50da000]\n&gt;     java.lang.Thread.State: BLOCKED (on object monitor)\n&gt; \tat org.archive.crawler.postprocessor.FrontierScheduler.innerProcess(FrontierScheduler.java:76)\n&gt; \t- waiting to lock&lt;111c81320&gt;  (a org.archive.crawler.postprocessor.FrontierScheduler)\n&gt; \tat org.archive.crawler.framework.Processor.process(Processor.java:109)\n&gt; \tat org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:306)\n&gt; \tat org.archive.crawler.framework.ToeThread.run(ToeThread.java:154)\n&gt;\n&gt;     Locked ownable synchronizers:\n&gt; \t- None\n&gt;\n&gt; It looks like the reason for the slow-down is that most of the threads are blocked, with only some of them actually running.\n&gt;\n&gt; Does anyone have strategies for how to reduce this sort of thread contention by changing settings?\n&gt;\n&gt; Lately I&#39;ve been trying to see if changing the # of threads will help reduce it-I was originally using 160 as max-threads, and now I&#39;m testing 80, but it doesn&#39;t seem to be making a significant difference, except in the latter case the maximum heap gets used up immediately within a few minutes, while in the former it takes about an hour to reach max heap usage.\n&gt;\n&gt; Anyway, the point is I&#39;m a little stuck and any insights or suggestions would be really appreciated!\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}