{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":39397245,"authorName":"Eric","from":"Eric &lt;ej@...&gt;","replyTo":"LIST","senderId":"9lUckLuI-67h-zdM5_YGiQ_-5ikx5NBJyRy8ZITfmxJqKxBWHJqrj04D4QJOWA63GGMyOdcZBJcak_s","spamInfo":{"isSpam":false,"reason":"0"},"subject":"unnecessary bottleneck in FrontierScheduler?","postDate":"1170269525","msgId":3767,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDIwMDcwMTMxMTg1MjA0LkdBMjUyMjRAZHV2ZWwuaXIuaWl0LmVkdT4="},"prevInTopic":0,"nextInTopic":3769,"prevInTime":3766,"nextInTime":3768,"topicId":3767,"numMessagesInTopic":2,"msgSnippet":"When running heritrix with about 50 ToeThreads I m running into a bottleneck in FrontierScheduler that seems unnecessary, or at least misplaced.  On line 76 as","rawEmail":"Return-Path: &lt;ej@...&gt;\r\nX-Sender: ej@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 21817 invoked from network); 31 Jan 2007 18:53:07 -0000\r\nReceived: from unknown (66.218.67.33)\n  by m42.grp.scd.yahoo.com with QMQP; 31 Jan 2007 18:53:07 -0000\r\nReceived: from unknown (HELO duvel.ir.iit.edu) (216.47.134.15)\n  by mta7.grp.scd.yahoo.com with SMTP; 31 Jan 2007 18:53:07 -0000\r\nReceived: from ej by duvel.ir.iit.edu with local (Exim 4.54)\n\tid 1HCKYv-0006uW-2f\n\tfor archive-crawler@yahoogroups.com; Wed, 31 Jan 2007 12:52:05 -0600\r\nDate: Wed, 31 Jan 2007 12:52:05 -0600\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;20070131185204.GA25224@...&gt;\r\nMime-Version: 1.0\r\nContent-Type: text/plain; charset=us-ascii\r\nContent-Disposition: inline\r\nX-PGP-Key: http://ir.iit.edu/~ej/ericjensen.asc\r\nUser-Agent: Mutt/1.5.11\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nFrom: Eric &lt;ej@...&gt;\r\nSubject: unnecessary bottleneck in FrontierScheduler?\r\nX-Yahoo-Group-Post: member; u=39397245; y=WxoOv93jxC7yd3roPdCl0voiKE88PTYDhXxsf-9RNABfjGN-hg\r\n\r\nWhen running heritrix with about 50 ToeThreads I&#39;m running into a\nbottleneck in FrontierScheduler that seems unnecessary, or at least\nmisplaced.  On line 76 as the final step of innerProcess it does\nsynchronized(this) while it loops through all the\ncuri.getOutCandidates() and calls Frontier.schedule() on each of them.\nFirst, there should at least be a check to see if there are any\ncandidates before requiring the lock.  Second, I don&#39;t think this is\nthe right place to be synchronizing.  Looking at\nWorkQueueFrontier.schedule() which handles this in most configs, it&#39;s\npassing these candidates along to the UriUniqFilter (of which at least\nthe Bdb one is thread-safe).  We know that the UriUniqFilter can\nbecome a bottleneck in large crawls, so we definitely shouldn&#39;t make\nall the threads wait while we access it, especially if it is\nthread-safe anyways...we should let Bdb itself do any necessary\nsynchronization.  \n\nOf course, this would mean making sure other things down the line are\nthread-safe.  UriUniqFilter in turn calls WorkQueueFrontier.receive()\nif they&#39;re unique, which most significantly calls\nWorkQueueFrontier.sendToQueue() which I think for the Bdb one should\nbe thread-safe, but even if we made that synchronized, that would be\nbetter than synchronizing before we even access the UriUniqFilter\nsince that can be slow.\n\nThanks,\neric\n\n-- \nhttp://ir.iit.edu/~ej\n\n"}}