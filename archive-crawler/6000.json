{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"dP5iA4xou2ZtTSqOcBcgUi6VhsBVme2_Lc1QBbAD6iIcJCvh3SGb0bL6rbO-3zaDbrpKJO1mE_FKkXi4njz6a4J8x-YvI14","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: [archive-crawler] H3 - Possible memory leak?","postDate":"1251141268","msgId":6000,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRBOTJFNjk0LjIwMjA2MDdAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDRBOTJEMThFLjMwODAzMDBAYXJjaGl2ZS5vcmc+","referencesHeader":"PGg2dTQwMytmaGJnQGVHcm91cHMuY29tPiA8NEE5MkQxOEUuMzA4MDMwMEBhcmNoaXZlLm9yZz4="},"prevInTopic":5999,"nextInTopic":6001,"prevInTime":5999,"nextInTime":6001,"topicId":5998,"numMessagesInTopic":7,"msgSnippet":"The thought that UTF-8 was a more appropriate modern default (matching browser behavior) was the motivation, but further analysis of the choice is a top","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 36833 invoked from network); 24 Aug 2009 19:15:30 -0000\r\nX-Received: from unknown (69.147.108.202)\n  by m4.grp.sp2.yahoo.com with QMQP; 24 Aug 2009 19:15:30 -0000\r\nX-Received: from unknown (HELO relay01.pair.com) (209.68.5.15)\n  by mta3.grp.re1.yahoo.com with SMTP; 24 Aug 2009 19:15:30 -0000\r\nX-Received: (qmail 36211 invoked from network); 24 Aug 2009 19:14:30 -0000\r\nX-Received: from 67.188.14.54 (HELO ?192.168.1.105?) (67.188.14.54)\n  by relay01.pair.com with SMTP; 24 Aug 2009 19:14:30 -0000\r\nX-pair-Authenticated: 67.188.14.54\r\nMessage-ID: &lt;4A92E694.2020607@...&gt;\r\nDate: Mon, 24 Aug 2009 12:14:28 -0700\r\nUser-Agent: Thunderbird 2.0.0.23 (Windows/20090812)\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;h6u403+fhbg@...&gt; &lt;4A92D18E.3080300@...&gt;\r\nIn-Reply-To: &lt;4A92D18E.3080300@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] H3 - Possible memory leak?\r\nX-Yahoo-Group-Post: member; u=137285340; y=0W5PGcmEw2Ggb0kCntPgnctDaElNcJJ7k8Ox9W96O0jV\r\nX-Yahoo-Profile: gojomo\r\n\r\nThe thought that UTF-8 was a more appropriate modern default (matching \nbrowser behavior) was the motivation, but further analysis of the choice \nis a top priority issue before the final H3 release.\n\nIkrom, thanks for the data -- but I think it&#39;s reflective of a lot of \nnew allocation, rather than a memory/reference leak that fails to be \nfreed. Otherwise, a large crawl would OOME fairly quickly.\n\nStill, the performance hit is a concern. For the core crawler, our chief \ngoal is to ensure all outlink URIs are found... though some applications \nmay be more interested in accurate non-URI content extraction. More \nresearch into tradeoffs is needed, probably involving some big \ncomparative crawls to discover cases where the different defaults yield \ndifferent crawler behavior.\n\n- Gordon @ IA\n\nNoah Levitt wrote:\n&gt; Thanks Ikrom for the report. More than likely, much of the slowness you \n&gt; see happens when the GenericReplayCharSequence is created, since the \n&gt; entire file is decoded and written to disk in UTF-16.\n&gt; \n&gt; Do you have any example urls that trigger the slowness?\n&gt; \n&gt; Gordon, I see the change you made falls back to utf-8 when the web page \n&gt; specifies a bogus encoding. Is that because you found cases where utf-8 \n&gt; was the correct encoding, or did you choose utf-8 just as a standard \n&gt; default? If the latter, it might be better to fall back on on \n&gt; single-byte encoding like latin1. Then GenericReplayCharSequence will \n&gt; not need to create a second UTF-16 temp file.\n&gt; \n&gt; Noah\n&gt; \n&gt; \n&gt; progre55 wrote:\n&gt;&gt; Hi people!\n&gt;&gt;\n&gt;&gt; I&#39;ve been using heritrix3 now, and as I have written before, after Gordon has changed default character encding to utf-8 and the ReplayCharSequence().toString() method, there has been some significant drop in the crawl performance. Here is a snapshot from a profiler that shows that there might even be a memory-leak in some of those methods http://dl.getdropbox.com/u/1571029/yourkitprofiler.jpg\n&gt;&gt;\n&gt;&gt; Gordon, could you please have a look at that and possibly try to fix it?\n&gt;&gt;\n&gt;&gt; Thanks in advance.\n&gt;&gt;\n&gt;&gt; cheers,\n&gt;&gt; Ikrom (@...)\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; ------------------------------------\n&gt;&gt;\n&gt;&gt; Yahoo! Groups Links\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;   \n&gt; \n&gt; \n&gt; ------------------------------------\n&gt; \n&gt; Yahoo! Groups Links\n&gt; \n&gt; \n&gt; \n\n"}}