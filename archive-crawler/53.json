{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":95697582,"authorName":"G.B.Reddy","from":"&quot;G.B.Reddy&quot; &lt;reddy@...&gt;","profile":"gbreddysoft","replyTo":"LIST","senderId":"d9W0kuTgOBWbW6_2tnTuH5Vm-mgN6xT66wjnHiu1vNMeQvfM6I99c6mgAQoN-sAv_MJQJ6-A6eVycZFiU-fDu0CbMO_vBgU_Or3th7Q","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Re: Memory Pool manager update !!","postDate":"1051658458","msgId":53,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDMyNTQwMWMzMGVhNSRmZTJlYWI5MCRkNTAwYThjMEB0aWRlbHBhcmsuaXNvZnR0ZWNoaW5kaWEuY29tPg==","referencesHeader":"PDIyYWYwMWMzMDk1NCRkNzE4Yjc5MCRkNTAwYThjMEB0aWRlbHBhcmsuaXNvZnR0ZWNoaW5kaWEuY29tPiA8MDBmOTAxYzMwOWUwJDMyZmFiMDAwJDQ4ZjBlZGQxQFdPUktTVEFUSU9OMjE+IDwyNGY3MDFjMzBhODQkMDg3MmZiZTAkZDUwMGE4YzBAdGlkZWxwYXJrLmlzb2Z0dGVjaGluZGlhLmNvbT4="},"prevInTopic":0,"nextInTopic":54,"prevInTime":52,"nextInTime":54,"topicId":53,"numMessagesInTopic":6,"msgSnippet":"Gordon, The MemPoolManager updates are checked into the CVS in the ArchiveOpenCrawler module ( in the same org.archive.crawler.io package ). Some of the","rawEmail":"Return-Path: &lt;reddy@...&gt;\r\nX-Sender: reddy@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (EGP: mail-8_2_6_6); 29 Apr 2003 23:25:38 -0000\r\nReceived: (qmail 26085 invoked from network); 29 Apr 2003 23:25:37 -0000\r\nReceived: from unknown (66.218.66.217)\n  by m5.grp.scd.yahoo.com with QMQP; 29 Apr 2003 23:25:37 -0000\r\nReceived: from unknown (HELO pub.isofttechindia.com) (203.199.202.17)\n  by mta2.grp.scd.yahoo.com with SMTP; 29 Apr 2003 23:25:36 -0000\r\nReceived: from ReddyGB (ReddyGB.isofttechindia.com [192.168.0.213])\n\tby pub.isofttechindia.com (8.11.0/8.11.0) with SMTP id h3TMxdP08440\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed, 30 Apr 2003 04:29:39 +0530\r\nMessage-ID: &lt;325401c30ea5$fe2eab90$d500a8c0@...&gt;\r\nTo: &lt;archive-crawler@yahoogroups.com&gt;\r\nReferences: &lt;22af01c30954$d718b790$d500a8c0@...&gt; &lt;00f901c309e0$32fab000$48f0edd1@WORKSTATION21&gt; &lt;24f701c30a84$0872fbe0$d500a8c0@...&gt;\r\nSubject: Re: [archive-crawler] Re: Memory Pool manager update !!\r\nDate: Wed, 30 Apr 2003 04:50:58 +0530\r\nOrganization: ISoftTech\r\nMIME-Version: 1.0\r\nContent-Type: multipart/alternative;\n\tboundary=&quot;----=_NextPart_000_3251_01C30ED4.177A6A20&quot;\r\nX-Priority: 3\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook Express 5.50.4920.2300\r\nX-MimeOLE: Produced By Microsoft MimeOLE V5.50.4920.2300\r\nX-eGroups-From: &quot;G.B.Reddy&quot; &lt;reddy@...&gt;\r\nFrom: &quot;G.B.Reddy&quot; &lt;reddy@...&gt;\r\nReply-To: &quot;G.B.Reddy&quot; &lt;reddy@...&gt;\r\nX-Yahoo-Group-Post: member; u=95697582\r\nX-Yahoo-Profile: gbreddysoft\r\n\r\n\r\n------=_NextPart_000_3251_01C30ED4.177A6A20\r\nContent-Type: text/plain;\n\tcharset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nGordon,\n\nThe MemPoolManager updates are checked into the CVS in the Archive=\r\nOpenCrawler module ( in the same org.archive.crawler.io package ).\n\nSome of=\r\n the outstanding issues are\n\n-- I assume that virtual buffer read will happ=\r\nen only after write completes. Meaning, the InputStreams should be asked fo=\r\nr only after the output stream is flushed and closed. Is this right or will=\r\n other processes keep reading it as and when it is being downloaded.\n\n-- Su=\r\nbclassing the VirtualBuffers : You had said that a subclasses such as HTTPR=\r\nesponseBuffer could be written with functionalities to rewind to the header=\r\n, rewind to the content-body, etc. How would this be done ? Would we want t=\r\no take the approach of allowing the internal output stream to be subclassed=\r\n and overriden so that the parsing could happen during the download itself =\r\nand we would find the indices at which the header starts, the body starts, =\r\netc during the parsing.\n\n-- Using a RandomAccessFile for i/o on the spilled=\r\n file so as to provide seek capability : Operations on this RandomAccessFil=\r\ne needs to be a buffered i/o. Not sure what would be the optimal size of th=\r\nis buffer. Taking a 4K block from the pool for the sake of this buffer may =\r\nbe too big. We may have to think of having some RAMOnlyBuffers allocated fr=\r\nom the pool for such purposes. These may be of 1K or 2K size.\n\n-- In the im=\r\nplementation that is checked in, the streams have a close knowledge of the =\r\nDiskedVirtualBuffer. May have to find another way of doing it.\n\n-- The clar=\r\nification needed on contiguous 8K allocations - Raymie to clarify on my pre=\r\nvious mail.\n\nIf possible, I would have a quick chat with Raymie sometime la=\r\nte evening today on yahoo messenger to discuss these.\n\nIn the mean time, so=\r\nme of the other activities done were.\n\n-- The complete directory structure =\r\ncreated for the ArchiveOpenCrawler module.\n-- A Do&#39;s and Don&#39;ts Readme is w=\r\nritten and checked into the docs directory of the ArchiveOpenCrawler module=\r\n. This talks about the notions to be adhered while using this module.\n-- Ma=\r\nde the JAnt build.xml file more flexible and configurable so as to make it =\r\nsuitable for running unit tests.\n-- As of now, the JAnt build script would =\r\nrun the nightly unit testing only if the previous day&#39;s nightly build passe=\r\ns. Will have to make it do unit test on the existing latest nightly build.\n=\r\n-- Archives last one week unit test results.\n-- An Unit test summary report=\r\n would be given in the nightly build mail with a link to the detailed repor=\r\nt. Some problems still exist in getting this work.\n\nWe may have to start pl=\r\nanning on setting up the &quot;Synthetic crawl environment: ~4 in house machines=\r\n running web servers&quot;, and the other internet/intranet crawl setups as disc=\r\nussed earlier. \n\nI would be on leave on 1st of May being our Labour Day.\n\nT=\r\nhanks,\nReddy\n\n  ----- Original Message ----- \n  From: G.B.Reddy \n  To: arch=\r\nive-crawler@yahoogroups.com \n  Sent: Thursday, April 24, 2003 10:37 PM\n  Su=\r\nbject: Re: [archive-crawler] Re: Memory Pool manager attached !!\n\n\n  Raymie=\r\n,\n\n  On the first day we discussed about the memory pool manager, we decide=\r\nd that the 8MB big chunk of memory will be broken into pieces of 4K each. A=\r\nnd the writer would incrementally get 4K blocks one after the other until h=\r\ne reaches the max 32K. These 4K blocks need not be contiguous. After the 32=\r\nK max is reached, the whole of it would be written into a tmp file and we w=\r\nould procure a contiguous 8K block from the pool. This 8K block as we discu=\r\nssed will hold the first 8KB data of the fetched page. Knowing that Linux u=\r\nses only a 4KB default page size, we are not very clear why you suggested t=\r\nhat we use a contiguous 8K in this case. Can&#39;t it be a non contiguous 4K + =\r\n4K, so that we can hold the first 4K data in it and use the other 4K for bu=\r\nffered i/o on the tmp file. If there is any reason behind it being a contig=\r\nuous 8K, we will additionally need another 4K to use as a buffer for the i/=\r\no. If there isn&#39;t any reason, then should the pool manager necessarily supp=\r\nort contiguous 8K allocations ?\n\n  Thanks,\n  Reddy\n\n    ----- Original Mess=\r\nage ----- \n    From: Gordon Mohr \n    To: G.B.Reddy ; archive-crawler@yahoo=\r\ngroups.com \n    Sent: Thursday, April 24, 2003 3:05 AM\n    Subject: [archiv=\r\ne-crawler] Re: Memory Pool manager attached !!\n\n\n    Thanks! \n\n    Some tho=\r\nughts:\n\n    I&#39;d like to approach this part of the system -- buffers/streams=\r\n for \n    multi-Kb entities across one processing cycle -- at three separat=\r\ne \n    levels, in order:\n\n    (1) The basic interface offered to other craw=\r\nler components,\n        hiding implementation details.\n\n    (2) The trick o=\r\nf using disk space for large files, because\n        it is impractical to ke=\r\nep so many large files in RAM\n        through all processing stages.\n\n    (=\r\n3) The optimization of using recycled internal objects, to \n        minimiz=\r\ne garbage collection overhead.\n\n    Part (1) needs to be right and relative=\r\nly constant early; parts (2) \n    and (3) can be tweaked down the road -- a=\r\nnd I&#39;m reluctant to evaluate\n    approaches to (3) just yet, because it is =\r\nonly after seeing the latest \n    Java allocators/garbage-collectors do poo=\r\nrly on a naive implementation\n    that we&#39;ll be able to make sensible pool-=\r\nmanagement choices.\n\n    For part (1), please take a look at the abstract c=\r\nlasses I&#39;ve placed\n    in the ArchiveOpenCrawler module, src/org/archive/cr=\r\nawler/io [*]:\n\n       VirtualBuffer\n       SeekableInputStream\n       Seeka=\r\nbleInputSubstream\n\n    I think the &#39;VirtualBuffer&#39; object is useful to tie =\r\ntogether the \n    construction of the data stream and its later use, rather=\r\n than \n    using a [Something]OutputStream first and then only at the end a=\r\nsking\n    it for one [Something]InputStream on the results. Also, it better=\r\n\n    supports the idea there could be multiple independent InputStreams\n   =\r\n (or CharSequences) on the same read-only buffer. \n\n    Fleshing out the po=\r\ntential connections between the abstract classes\n    above and the concrete=\r\n classes you&#39;ve proposed:\n\n      class RewindableSpreadInputStream extends =\r\nSeekableInputStream\n\n      class DiskedVirtualBuffer extends VirtualBuffer =\r\n{\n        // naive implementation of VirtualBuffer with associated Streams/=\r\nCharSequence classes\n        // that is, &quot;level (2)&quot; above\n        // likel=\r\ny uses a RandomAccessFile to augment any in-memory buffer(s)\n        // ...=\r\n //\n      }\n      \n      class EconomizingDiskedVirtualBuffer extends Diske=\r\ndVirtualBuffer {\n        // recycling/optimizable implementation of Virtual=\r\nBuffer\n        // that is, &quot;level (3)&quot; above\n        // somehow utilizes on=\r\ne or more managed MemoryArea instances\n\n        public SpreadOutputStream g=\r\netOutputStream() { /* ... */ }\n        public RewindableSpreadInputStream g=\r\netInputStream() { /* ... */ }\n      }\n\n    Does this make sense to everyone=\r\n? \n\n    - Gordon\n\n    [*] http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/ar=\r\nchive-crawler/ArchiveOpenCrawler/src/org/archive/crawler/io/\n\n    ----- Ori=\r\nginal Message ----- \n    From: G.B.Reddy \n    To: Gordon Mohr \n    Sent: Tu=\r\nesday, April 22, 2003 9:57 PM\n    Subject: Memory Pool manager attached !!\n=\r\n\n\n    Gordon,\n\n    As requested, I am attaching the javadoc/code which we d=\r\nid when Raymie was here in India. Some changes which are to be done are\n\n  =\r\n  - Support for Multiple MemPoolManager instances. (don&#39;t make it static)\n =\r\n   - Use a free list instead of a bitmap to track the allocated/free areas.=\r\n\n\n    Thanks,\n    Reddy\n\n\n    To unsubscribe from this group, send an email=\r\n to:\n    archive-crawler-unsubscribe@yahoogroups.com\n\n\n\n    Your use of Yah=\r\noo! Groups is subject to the Yahoo! Terms of Service. \n\n\r\n------=_NextPart_000_3251_01C30ED4.177A6A20\r\nContent-Type: text/html;\n\tcharset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;\n&lt;HTML&gt;&lt;HEAD&gt;=\r\n\n&lt;META http-equiv=3DContent-Type content=3D&quot;text/html; charset=3Diso-8859-1=\r\n&quot;&gt;\n&lt;META content=3D&quot;MSHTML 5.50.4134.600&quot; name=3DGENERATOR&gt;\n&lt;STYLE&gt;&lt;/STYLE&gt;=\r\n\n&lt;/HEAD&gt;\n&lt;BODY bgColor=3D#ffffff&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Gordon,&lt;=\r\n/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FON=\r\nT face=3DArial size=3D2&gt;The MemPoolManager updates are checked into the CVS=\r\n \nin the ArchiveOpenCrawler module ( in the same org.archive.crawler.io pac=\r\nkage \n).&lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n=\r\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Some of the outstanding issues are&lt;/FONT&gt;&lt;=\r\n/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=\r\n=3DArial size=3D2&gt;-- I assume that virtual buffer read will happen \nonly af=\r\nter write completes. Meaning, the InputStreams should be asked \nfor&nbsp;on=\r\nly after the output stream is flushed and closed. Is this right or \nwill ot=\r\nher processes keep reading it as and when it is being \ndownloaded.&lt;/FONT&gt;&lt;/=\r\nDIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=\r\n=3DArial size=3D2&gt;-- Subclassing the VirtualBuffers :&nbsp;You had \nsaid th=\r\nat a subclasses such as HTTPResponseBuffer&nbsp;could be written with \nfunc=\r\ntionalities to rewind to the header, rewind to the content-body, etc. How \n=\r\nwould this be done ? Would we want to take the approach of allowing the int=\r\nernal \noutput stream to be subclassed and overriden so that the parsing cou=\r\nld happen \nduring the download itself&nbsp;and we would&nbsp;find the indic=\r\nes at which the \nheader starts, the body starts, etc during the parsing.&lt;/F=\r\nONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT =\r\nface=3DArial size=3D2&gt;-- Using a RandomAccessFile for i/o on the spilled \nf=\r\nile so as to provide seek capability : Operations on this RandomAccessFile =\r\n\nneeds to be a buffered i/o.&nbsp;Not sure what would be the optimal size o=\r\nf this \nbuffer. Taking a 4K block from the pool for the sake of this buffer=\r\n may be too \nbig. We may have to think of having some RAMOnlyBuffers alloca=\r\nted from the pool \nfor such purposes. These may be of 1K or 2K size.&lt;/FONT&gt;=\r\n&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=\r\n=3DArial size=3D2&gt;-- In the implementation that is checked in, the \nstreams=\r\n have a close knowledge of the&nbsp;DiskedVirtualBuffer. May have to find \n=\r\nanother way of doing it.&lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FO=\r\nNT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;-- The clarification neede=\r\nd on&nbsp;contiguous 8K \nallocations - Raymie to clarify&nbsp;on my previou=\r\ns mail.&lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;=\r\nDIV&gt;&lt;FONT face=3DArial size=3D2&gt;If possible, I would have a quick chat with=\r\n \nRaymie&lt;/FONT&gt;&lt;FONT face=3DArial size=3D2&gt; sometime late evening today on =\r\nyahoo \nmessenger to discuss these.&lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial siz=\r\ne=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;In the mean time=\r\n, some of the other activities done \nwere.&lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DA=\r\nrial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;-- The c=\r\nomplete directory structure created for the \nArchiveOpenCrawler module.&lt;/FO=\r\nNT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;-- A Do&#39;s and Don&#39;ts Readme is w=\r\nritten and checked \ninto the&nbsp;docs directory of the&nbsp;&lt;/FONT&gt;&lt;FONT f=\r\nace=3DArial \nsize=3D2&gt;ArchiveOpenCrawler module. This talks about the notio=\r\nns to be adhered \nwhile using this module.&lt;BR&gt;-- Made the JAnt build.xml&nb=\r\nsp;file more flexible \nand configurable so as to make it suitable for runni=\r\nng unit tests.&lt;BR&gt;-- As of \nnow, the JAnt build script would run the nightl=\r\ny unit testing&nbsp;only if the \nprevious day&#39;s nightly build&nbsp;passes. =\r\nWill have to make it do unit test on \nthe existing latest nightly build.&lt;/F=\r\nONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;-- Archives last one week unit =\r\ntest results.&lt;BR&gt;-- \nAn Unit test summary report would be given in the nigh=\r\ntly build mail with a link \nto the detailed report.&nbsp;Some problems&nbsp=\r\n;still exist in getting this \nwork.&lt;BR&gt;&lt;/DIV&gt;&lt;/FONT&gt;\n&lt;DIV&gt;&lt;FONT face=3DAria=\r\nl size=3D2&gt;We may have to start planning on setting up the \n&quot;Synthetic craw=\r\nl environment: ~4 in house machines running web servers&quot;, and the \nother in=\r\nternet/intranet crawl setups as discussed earlier. &lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT=\r\n face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2=\r\n&gt;\n&lt;DIV&gt;&lt;/FONT&gt;&lt;FONT face=3DArial size=3D2&gt;I would be on leave on 1st of May=\r\n being our \nLabour Day.&lt;/FONT&gt;&lt;/DIV&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2=\r\n&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Thanks,&lt;/FONT&gt;&lt;/DIV&gt;\n=\r\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Reddy&lt;/FONT&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&lt;FONT face=3DArial=\r\n size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n&lt;BLOCKQUOTE \nstyle=3D&quot;PADDING-RIGHT: 0px; PAD=\r\nDING-LEFT: 5px; MARGIN-LEFT: 5px; BORDER-LEFT: #000000 2px solid; MARGIN-RI=\r\nGHT: 0px&quot;&gt;\n  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;----- Original Message ----- &lt;=\r\n/DIV&gt;\n  &lt;DIV \n  style=3D&quot;BACKGROUND: #e4e4e4; FONT: 10pt arial; font-color:=\r\n black&quot;&gt;&lt;B&gt;From:&lt;/B&gt; \n  &lt;A title=3Dreddy@... href=3D&quot;mailto:reddy=\r\n@...&quot;&gt;G.B.Reddy&lt;/A&gt; \n  &lt;/DIV&gt;\n  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;=\r\nB&gt;To:&lt;/B&gt; &lt;A \n  title=3Darchive-crawler@yahoogroups.com \n  href=3D&quot;mailto:a=\r\nrchive-crawler@yahoogroups.com&quot;&gt;archive-crawler@yahoogroups.com&lt;/A&gt; \n  &lt;/DI=\r\nV&gt;\n  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;Sent:&lt;/B&gt; Thursday, April 24, 2003 =\r\n10:37 \n  PM&lt;/DIV&gt;\n  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;Subject:&lt;/B&gt; Re: [ar=\r\nchive-crawler] Re: Memory \n  Pool manager attached !!&lt;/DIV&gt;\n  &lt;DIV&gt;&lt;FONT fa=\r\nce=3DArial size=3D2&gt;&lt;/FONT&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;\n  =\r\n&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Raymie,&lt;/FONT&gt;&lt;/DIV&gt;\n  &lt;DIV&gt;&lt;FONT face=3DA=\r\nrial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;On the=\r\n first day we discussed about the memory \n  pool manager, we decided that t=\r\nhe 8MB big chunk of memory will be broken into \n  pieces of 4K each. And th=\r\ne writer would incrementally get 4K blocks one after \n  the other until he =\r\nreaches the max 32K. These 4K blocks need not be \n  contiguous. &lt;/FONT&gt;&lt;FON=\r\nT face=3DArial size=3D2&gt;After the 32K max is \n  reached,&nbsp;the whole of =\r\nit would be written into a tmp file and we would \n  procure a contiguous 8K=\r\n block from the pool. This 8K block as we discussed \n  will hold the first =\r\n8KB data of the fetched page. &lt;/FONT&gt;&lt;FONT face=3DArial \n  size=3D2&gt;Knowing=\r\n that Linux uses only a 4KB default page size, we are not very \n  clear why=\r\n you suggested&nbsp;that we use a contiguous 8K&nbsp;in this case. \n  Can&#39;t=\r\n it be a non contiguous 4K + 4K,&nbsp;so that we can hold the first 4K \n  d=\r\nata in it and use the other 4K for buffered i/o on the tmp file. If there i=\r\ns \n  any reason behind it being a contiguous 8K, we will additionally need =\r\nanother \n  4K to use as a buffer for the i/o. If there isn&#39;t any reason, th=\r\nen should the \n  pool manager necessarily support contiguous 8K allocations=\r\n ?&lt;/FONT&gt;&lt;/DIV&gt;\n  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;\n  &lt;D=\r\nIV&gt;&lt;FONT face=3DArial size=3D2&gt;Thanks,&lt;/FONT&gt;&lt;/DIV&gt;\n  &lt;DIV&gt;&lt;FONT face=3DAri=\r\nal size=3D2&gt;Reddy&lt;/FONT&gt;&lt;/DIV&gt;\n  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&n=\r\nbsp;&lt;/DIV&gt;\n  &lt;BLOCKQUOTE \n  style=3D&quot;PADDING-RIGHT: 0px; PADDING-LEFT: 5px;=\r\n MARGIN-LEFT: 5px; BORDER-LEFT: #000000 2px solid; MARGIN-RIGHT: 0px&quot;&gt;\n    =\r\n&lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;----- Original Message ----- &lt;/DIV&gt;\n    &lt;DI=\r\nV \n    style=3D&quot;BACKGROUND: #e4e4e4; FONT: 10pt arial; font-color: black&quot;&gt;&lt;=\r\nB&gt;From:&lt;/B&gt; \n    &lt;A title=3Dgojomo@... href=3D&quot;mailto:gojomo@archiv=\r\ne.org&quot;&gt;Gordon Mohr&lt;/A&gt; \n    &lt;/DIV&gt;\n    &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;T=\r\no:&lt;/B&gt; &lt;A title=3Dreddy@... \n    href=3D&quot;mailto:reddy@isofttech.c=\r\nom&quot;&gt;G.B.Reddy&lt;/A&gt; ; &lt;A \n    title=3Darchive-crawler@yahoogroups.com \n    hr=\r\nef=3D&quot;mailto:archive-crawler@yahoogroups.com&quot;&gt;archive-crawler@yahoogroups.c=\r\nom&lt;/A&gt; \n    &lt;/DIV&gt;\n    &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;Sent:&lt;/B&gt; Thursda=\r\ny, April 24, 2003 3:05 \n    AM&lt;/DIV&gt;\n    &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B=\r\n&gt;Subject:&lt;/B&gt; [archive-crawler] Re: Memory \n    Pool manager attached !!&lt;/D=\r\nIV&gt;\n    &lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;&lt;TT&gt;Thanks! &lt;BR&gt;&lt;BR&gt;Some thoughts:&lt;BR&gt;&lt;BR&gt;I&#39;d like t=\r\no \n    approach this part of the system -- buffers/streams for &lt;BR&gt;multi-Kb=\r\n \n    entities across one processing cycle -- at three separate &lt;BR&gt;levels,=\r\n in \n    order:&lt;BR&gt;&lt;BR&gt;(1) The basic interface offered to other crawler \n  =\r\n  components,&lt;BR&gt;&nbsp;&nbsp;&nbsp; hiding implementation details.&lt;BR&gt;&lt;BR&gt;(=\r\n2) \n    The trick of using disk space for large files, because&lt;BR&gt;&nbsp;&nb=\r\nsp;&nbsp; \n    it is impractical to keep so many large files in RAM&lt;BR&gt;&nbs=\r\np;&nbsp;&nbsp; \n    through all processing stages.&lt;BR&gt;&lt;BR&gt;(3) The optimizat=\r\nion of using recycled \n    internal objects, to &lt;BR&gt;&nbsp;&nbsp;&nbsp; mini=\r\nmize garbage collection \n    overhead.&lt;BR&gt;&lt;BR&gt;Part (1) needs to be right an=\r\nd relatively constant early; \n    parts (2) &lt;BR&gt;and (3) can be tweaked down=\r\n the road -- and I&#39;m reluctant to \n    evaluate&lt;BR&gt;approaches to (3) just y=\r\net, because it is only after seeing the \n    latest &lt;BR&gt;Java allocators/gar=\r\nbage-collectors do poorly on a naive \n    implementation&lt;BR&gt;that we&#39;ll be a=\r\nble to make sensible pool-management \n    choices.&lt;BR&gt;&lt;BR&gt;For part (1), ple=\r\nase take a look at the abstract classes \n    I&#39;ve placed&lt;BR&gt;in the ArchiveO=\r\npenCrawler module, src/org/archive/crawler/io \n    [*]:&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;=\r\n VirtualBuffer&lt;BR&gt;&nbsp;&nbsp; \n    SeekableInputStream&lt;BR&gt;&nbsp;&nbsp; See=\r\nkableInputSubstream&lt;BR&gt;&lt;BR&gt;I think \n    the &#39;VirtualBuffer&#39; object is usefu=\r\nl to tie together the &lt;BR&gt;construction of \n    the data stream and its late=\r\nr use, rather than &lt;BR&gt;using a \n    [Something]OutputStream first and then =\r\nonly at the end asking&lt;BR&gt;it for one \n    [Something]InputStream on the res=\r\nults. Also, it better&lt;BR&gt;supports the idea \n    there could be multiple ind=\r\nependent InputStreams&lt;BR&gt;(or CharSequences) on \n    the same read-only buff=\r\ner. &lt;BR&gt;&lt;BR&gt;Fleshing out the potential connections \n    between the abstrac=\r\nt classes&lt;BR&gt;above and the concrete classes you&#39;ve \n    proposed:&lt;BR&gt;&lt;BR&gt;&n=\r\nbsp; class RewindableSpreadInputStream extends \n    SeekableInputStream&lt;BR&gt;=\r\n&lt;BR&gt;&nbsp; class DiskedVirtualBuffer extends \n    VirtualBuffer {&lt;BR&gt;&nbsp;=\r\n&nbsp;&nbsp; // naive implementation of \n    VirtualBuffer with associated =\r\nStreams/CharSequence \n    classes&lt;BR&gt;&nbsp;&nbsp;&nbsp; // that is, &quot;level =\r\n(2)&quot; \n    above&lt;BR&gt;&nbsp;&nbsp;&nbsp; // likely uses a RandomAccessFile to =\r\naugment any \n    in-memory buffer(s)&lt;BR&gt;&nbsp;&nbsp;&nbsp; // ... //&lt;BR&gt;&nb=\r\nsp; }&lt;BR&gt;&nbsp; \n    &lt;BR&gt;&nbsp; class EconomizingDiskedVirtualBuffer extend=\r\ns DiskedVirtualBuffer \n    {&lt;BR&gt;&nbsp;&nbsp;&nbsp; // recycling/optimizable=\r\n implementation of \n    VirtualBuffer&lt;BR&gt;&nbsp;&nbsp;&nbsp; // that is, &quot;le=\r\nvel (3)&quot; \n    above&lt;BR&gt;&nbsp;&nbsp;&nbsp; // somehow utilizes one or more m=\r\nanaged \n    MemoryArea instances&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp; public SpreadOut=\r\nputStream \n    getOutputStream() { /* ... */ }&lt;BR&gt;&nbsp;&nbsp;&nbsp; public=\r\n \n    RewindableSpreadInputStream getInputStream() { /* ... */ }&lt;BR&gt;&nbsp; =\r\n\n    }&lt;BR&gt;&lt;BR&gt;Does this make sense to everyone? &lt;BR&gt;&lt;BR&gt;- Gordon&lt;BR&gt;&lt;BR&gt;[*]=\r\n &lt;A \n    href=3D&quot;http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/archive-cra=\r\nwler/ArchiveOpenCrawler/src/org/archive/crawler/io/&quot;&gt;http://cvs.sourceforge=\r\n.net/cgi-bin/viewcvs.cgi/archive-crawler/ArchiveOpenCrawler/src/org/archive=\r\n/crawler/io/&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;----- \n    Original Message ----- &lt;BR&gt;From: G.B.Red=\r\ndy &lt;BR&gt;To: Gordon Mohr &lt;BR&gt;Sent: \n    Tuesday, April 22, 2003 9:57 PM&lt;BR&gt;Su=\r\nbject: Memory Pool manager attached \n    !!&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;Gordon,&lt;BR&gt;&lt;BR&gt;As re=\r\nquested, I am attaching the javadoc/code \n    which we did when Raymie was =\r\nhere in India. Some changes which are to be \n    done are&lt;BR&gt;&lt;BR&gt;- Support =\r\nfor Multiple MemPoolManager instances. (don&#39;t make \n    it static)&lt;BR&gt;- Use=\r\n a free list instead of a bitmap to track the \n    allocated/free areas.&lt;BR=\r\n&gt;&lt;BR&gt;Thanks,&lt;BR&gt;Reddy&lt;BR&gt;&lt;/TT&gt;&lt;BR&gt;&lt;BR&gt;&lt;TT&gt;To \n    unsubscribe from this gro=\r\nup, send an email \n    to:&lt;BR&gt;archive-crawler-unsubscribe@yahoogroups.com&lt;B=\r\nR&gt;&lt;BR&gt;&lt;/TT&gt;&lt;BR&gt;&lt;BR&gt;&lt;TT&gt;Your \n    use of Yahoo! Groups is subject to the &lt;A =\r\n\n    href=3D&quot;http://docs.yahoo.com/info/terms/&quot;&gt;Yahoo! Terms of Service&lt;/A&gt;=\r\n.&lt;/TT&gt; \n    &lt;BR&gt;&lt;/BLOCKQUOTE&gt;&lt;/BLOCKQUOTE&gt;&lt;/BODY&gt;&lt;/HTML&gt;\n\r\n------=_NextPart_000_3251_01C30ED4.177A6A20--\r\n\n"}}