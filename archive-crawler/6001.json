{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":325624130,"authorName":"Noah Levitt","from":"Noah Levitt &lt;nlevitt@...&gt;","profile":"nlevitt0","replyTo":"LIST","senderId":"XWcC_cCReyw17U1LGwuVI7ldvSXBwnMaTOw1UQYCPZ2CPmYaTXSFVFqzlEXffC9fHtPLDwiyRA7zCYHNpjU5qI50WoS-bwwk","spamInfo":{"isSpam":false,"reason":"3"},"subject":"Re: [archive-crawler] H3 - Possible memory leak?","postDate":"1251144175","msgId":6001,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRBOTJGMUVGLjYwOTA4MDRAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDRBOTJFNjk0LjIwMjA2MDdAYXJjaGl2ZS5vcmc+","referencesHeader":"PGg2dTQwMytmaGJnQGVHcm91cHMuY29tPiA8NEE5MkQxOEUuMzA4MDMwMEBhcmNoaXZlLm9yZz4gPDRBOTJFNjk0LjIwMjA2MDdAYXJjaGl2ZS5vcmc+"},"prevInTopic":6000,"nextInTopic":6002,"prevInTime":6000,"nextInTime":6002,"topicId":5998,"numMessagesInTopic":7,"msgSnippet":"... Actually I think latin1 is still the default fallback encoding in US browsers. At least, it is in my browser (firefox 3.0). Edit/Preferences/Content/Fonts","rawEmail":"Return-Path: &lt;nlevitt@...&gt;\r\nX-Sender: nlevitt@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 64581 invoked from network); 24 Aug 2009 20:03:00 -0000\r\nX-Received: from unknown (69.147.108.201)\n  by m3.grp.re1.yahoo.com with QMQP; 24 Aug 2009 20:03:00 -0000\r\nX-Received: from unknown (HELO mail.archive.org) (207.241.231.239)\n  by mta2.grp.re1.yahoo.com with SMTP; 24 Aug 2009 20:02:59 -0000\r\nX-Received: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 4FB212B74B6\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Mon, 24 Aug 2009 13:02:59 -0700 (PDT)\r\nX-Received: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id qPKa8wmH7LVO for &lt;archive-crawler@yahoogroups.com&gt;;\n\tMon, 24 Aug 2009 13:02:58 -0700 (PDT)\r\nX-Received: from [192.168.1.204] (c-67-188-14-54.hsd1.ca.comcast.net [67.188.14.54])\n\tby mail.archive.org (Postfix) with ESMTPSA id 192532B6ABB\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Mon, 24 Aug 2009 13:02:56 -0700 (PDT)\r\nMessage-ID: &lt;4A92F1EF.6090804@...&gt;\r\nDate: Mon, 24 Aug 2009 13:02:55 -0700\r\nUser-Agent: Thunderbird 2.0.0.22 (X11/20090608)\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;h6u403+fhbg@...&gt; &lt;4A92D18E.3080300@...&gt; &lt;4A92E694.2020607@...&gt;\r\nIn-Reply-To: &lt;4A92E694.2020607@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 2:3:4:0:0\r\nFrom: Noah Levitt &lt;nlevitt@...&gt;\r\nSubject: Re: [archive-crawler] H3 - Possible memory leak?\r\nX-Yahoo-Group-Post: member; u=325624130; y=t56ZwW6oL4Yb-2dZSxs1fRXCPv1m-ZhNsOaNtM0y7Ij6c2o\r\nX-Yahoo-Profile: nlevitt0\r\n\r\n\nGordon Mohr wrote:\n&gt; The thought that UTF-8 was a more appropriate modern default (matching \n&gt; browser behavior) was the motivation, but further analysis of the choice \n&gt; is a top priority issue before the final H3 release.\n\nActually I think latin1 is still the default fallback encoding in US browsers. At least, it is in my browser (firefox 3.0). Edit/Preferences/Content/Fonts & Colors -&gt; Advanced...\n\nNoah\n\n\n&gt; \n&gt; Ikrom, thanks for the data -- but I think it&#39;s reflective of a lot of \n&gt; new allocation, rather than a memory/reference leak that fails to be \n&gt; freed. Otherwise, a large crawl would OOME fairly quickly.\n&gt; \n&gt; Still, the performance hit is a concern. For the core crawler, our chief \n&gt; goal is to ensure all outlink URIs are found... though some applications \n&gt; may be more interested in accurate non-URI content extraction. More \n&gt; research into tradeoffs is needed, probably involving some big \n&gt; comparative crawls to discover cases where the different defaults yield \n&gt; different crawler behavior.\n&gt; \n&gt; - Gordon @ IA\n&gt; \n&gt; Noah Levitt wrote:\n&gt;&gt; Thanks Ikrom for the report. More than likely, much of the slowness you \n&gt;&gt; see happens when the GenericReplayCharSequence is created, since the \n&gt;&gt; entire file is decoded and written to disk in UTF-16.\n&gt;&gt;\n&gt;&gt; Do you have any example urls that trigger the slowness?\n&gt;&gt;\n&gt;&gt; Gordon, I see the change you made falls back to utf-8 when the web page \n&gt;&gt; specifies a bogus encoding. Is that because you found cases where utf-8 \n&gt;&gt; was the correct encoding, or did you choose utf-8 just as a standard \n&gt;&gt; default? If the latter, it might be better to fall back on on \n&gt;&gt; single-byte encoding like latin1. Then GenericReplayCharSequence will \n&gt;&gt; not need to create a second UTF-16 temp file.\n&gt;&gt;\n&gt;&gt; Noah\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; progre55 wrote:\n&gt;&gt;&gt; Hi people!\n&gt;&gt;&gt;\n&gt;&gt;&gt; I&#39;ve been using heritrix3 now, and as I have written before, after Gordon has changed default character encding to utf-8 and the ReplayCharSequence().toString() method, there has been some significant drop in the crawl performance. Here is a snapshot from a profiler that shows that there might even be a memory-leak in some of those methods http://dl.getdropbox.com/u/1571029/yourkitprofiler.jpg\n&gt;&gt;&gt;\n&gt;&gt;&gt; Gordon, could you please have a look at that and possibly try to fix it?\n&gt;&gt;&gt;\n&gt;&gt;&gt; Thanks in advance.\n&gt;&gt;&gt;\n&gt;&gt;&gt; cheers,\n&gt;&gt;&gt; Ikrom (@...)\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; ------------------------------------\n&gt;&gt;&gt;\n&gt;&gt;&gt; Yahoo! Groups Links\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;   \n&gt;&gt;\n&gt;&gt; ------------------------------------\n&gt;&gt;\n&gt;&gt; Yahoo! Groups Links\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt; \n&gt; \n&gt; ------------------------------------\n&gt; \n&gt; Yahoo! Groups Links\n&gt; \n&gt; \n&gt; \n\n\n"}}