{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":325624130,"authorName":"Noah Levitt","from":"Noah Levitt &lt;nlevitt@...&gt;","profile":"nlevitt","replyTo":"LIST","senderId":"oXFkr47wqwuNdl6nJ20CzM7b7Gk3a8trOtD-MHh8mzaDrE6Oy6B8A-y72BcG3QLVUr7fjop5ae00OA4AvnPg203HyPde1_xC","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] ToeThreads","postDate":"1322007111","msgId":7408,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRFQ0MzQTQ3LjYwMTAzQGFyY2hpdmUub3JnPg==","inReplyToHeader":"PDRFQzE5OUI1LjgwMDA4MDlAY3MuY211LmVkdT4=","referencesHeader":"PGo4bXRkcisybnI1QGVHcm91cHMuY29tPiA8NEVCODEyRjQuNDA3MDYwOEBhcmNoaXZlLm9yZz4gPDRFQjgyQ0E3LjYwMDA3MDRAY3MuY211LmVkdT4gPDRFQjgzNTA5LjUwMzAyMDlAYXJjaGl2ZS5vcmc+IDw0RUI4NDM4Ri4zMDQwNjA2QGNzLmNtdS5lZHU+IDw0RUI4OTk5My44MDQwMjA4QGFyY2hpdmUub3JnPiA8NEVCOTgyODMuOTA3MDYwOEBjcy5jbXUuZWR1PiA8NEVCOTg0OUIuNjAyMDYwMUBhcmNoaXZlLm9yZz4gPDRFQzE5OUI1LjgwMDA4MDlAY3MuY211LmVkdT4="},"prevInTopic":7401,"nextInTopic":7410,"prevInTime":7407,"nextInTime":7409,"topicId":7379,"numMessagesInTopic":23,"msgSnippet":"Hello David, What happened to the 600+ toe threads that disappeared? heritrix_out.log should have that information. This is also relevant","rawEmail":"Return-Path: &lt;nlevitt@...&gt;\r\nX-Sender: nlevitt@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 21469 invoked from network); 23 Nov 2011 00:11:59 -0000\r\nX-Received: from unknown (98.137.35.160)\n  by m13.grp.sp2.yahoo.com with QMQP; 23 Nov 2011 00:11:59 -0000\r\nX-Received: from unknown (HELO mail.archive.org) (207.241.224.6)\n  by mta4.grp.sp2.yahoo.com with SMTP; 23 Nov 2011 00:11:59 -0000\r\nX-Received: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 5A2856840153;\n\tTue, 22 Nov 2011 16:11:54 -0800 (PST)\r\nX-Received: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id 7Pwq-H6qCZ06; Tue, 22 Nov 2011 16:11:52 -0800 (PST)\r\nX-Received: from Noah-Levitts-MacBook-Pro.local (cpe-76-175-73-84.socal.res.rr.com [76.175.73.84])\n\tby mail.archive.org (Postfix) with ESMTPSA id 918306840152;\n\tTue, 22 Nov 2011 16:11:52 -0800 (PST)\r\nMessage-ID: &lt;4ECC3A47.60103@...&gt;\r\nDate: Tue, 22 Nov 2011 16:11:51 -0800\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:6.0) Gecko/20110812 Thunderbird/6.0\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: David Pane &lt;dpane@...&gt;\r\nReferences: &lt;j8mtdr+2nr5@...&gt; &lt;4EB812F4.4070608@...&gt; &lt;4EB82CA7.6000704@...&gt; &lt;4EB83509.5030209@...&gt; &lt;4EB8438F.3040606@...&gt; &lt;4EB89993.8040208@...&gt; &lt;4EB98283.9070608@...&gt; &lt;4EB9849B.6020601@...&gt; &lt;4EC199B5.8000809@...&gt;\r\nIn-Reply-To: &lt;4EC199B5.8000809@...&gt;\r\nContent-Type: text/plain; charset=windows-1252; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Noah Levitt &lt;nlevitt@...&gt;\r\nSubject: Re: [archive-crawler] ToeThreads\r\nX-Yahoo-Group-Post: member; u=325624130; y=nGIJ5f_mUkiSYcCxxJ6uLWEDaPNQbja14gAbhLG09sa0jw\r\nX-Yahoo-Profile: nlevitt\r\n\r\nHello David,\n\nWhat happened to the 600+ toe threads that disappeared? heritrix_out.log should have that information.\n\nThis is also relevant tohttps://webarchive.jira.com/browse/HER-1967 - there are 693 in-process queues. That is at least one thing preventing the crawl from finishing (thanks Kenji for pointing this out). So the question is, what happened to those toe threads. Only serious errors like OOME should kill toe threads (see ToeThread.run()), and in that case the crawl should pause which I imagine you would have mentioned. So... what&#39;s in heritrix_out.log?\n\nNoah\n\nOn 2011-11-14 14:44 , David Pane wrote:\n&gt; A naive user would think that if one configures the crawler to use 1200\n&gt; toe threads, the crawler would use all 1200 threads for the duration of\n&gt; the crawl.\n&gt;\n&gt; I have found that this is not always true.  A recent test crawl showed\n&gt; only ~512 of the threads (512 threads: 512 ...) for the duration of a\n&gt; crawl 3 day crawl with as many as 8 million uri queues.\n&gt;\n&gt; Other crawls show multiple (maybe ~800) warcWriter threads and maybe\n&gt; less than a dozen fetch threads.\n&gt;\n&gt; I have been playing with the balanceReplenishAmount (now at 1500),\n&gt; maxRetries (now at 5)  and recently changed the configuration to use the\n&gt; wagCostAssignmentPolicy.\n&gt;\n&gt; Finally, I have been using the maxTimeSeconds to segments of a crawl.\n&gt; The last few segments were set at 3 1/2 days.  When the crawler goes to\n&gt; active stopping, about 20 minutes later the load goes to zero (e.g. 0\n&gt; active of 507 threads; 4,891.94 congestion ratio; 11262085 deepest\n&gt; queue; 37 average depth ) but it take multiple hours to actually\n&gt; complete the stopping.\n&gt;\n&gt; The theads show (507 threads: 507 ABOUT_TO_GET_URI; 507 noActiveProcessor )\n&gt;\n&gt; The Toe thread report looks something like:\n&gt; Toe threads report - 201111142240\n&gt;    Job being crawled: jobname\n&gt;    Number of toe threads in pool: 507 (0 active)\n&gt;\n&gt; [ToeThread #21:\n&gt;    -no CrawlURI-\n&gt;       WAITING for 1h30m21s121ms\n&gt;       step: ABOUT_TO_GET_URI for 1h30m21s121ms\n&gt; Java Thread State: WAITING\n&gt; Blocked/Waiting On: NONE\n&gt;       sun.misc.Unsafe.park(Native Method)\n&gt;       java.util.concurrent.locks.LockSupport.park(LockSupport.java:156)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:811)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:969)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1281)\n&gt;\n&gt; java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.lockInterruptibly(ReentrantReadWriteLock.java:639)\n&gt;\n&gt; org.archive.crawler.frontier.AbstractFrontier.next(AbstractFrontier.java:450)\n&gt;       org.archive.crawler.framework.ToeThread.run(ToeThread.java:133)\n&gt; ]\n&gt; [ToeThread #30:\n&gt;    -no CrawlURI-\n&gt;       WAITING for 1h30m20s411ms\n&gt;       step: ABOUT_TO_GET_URI for 1h30m20s411ms\n&gt; Java Thread State: WAITING\n&gt; Blocked/Waiting On: NONE\n&gt;       sun.misc.Unsafe.park(Native Method)\n&gt;       java.util.concurrent.locks.LockSupport.park(LockSupport.java:156)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:811)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:969)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1281)\n&gt;\n&gt; java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.lockInterruptibly(ReentrantReadWriteLock.java:639)\n&gt;\n&gt; org.archive.crawler.frontier.AbstractFrontier.next(AbstractFrontier.java:450)\n&gt;       org.archive.crawler.framework.ToeThread.run(ToeThread.java:133)\n&gt; ]\n&gt; [ToeThread #31:\n&gt;    -no CrawlURI-\n&gt;       WAITING for 1h22m8s292ms\n&gt;       step: ABOUT_TO_GET_URI for 1h22m8s292ms\n&gt; Java Thread State: WAITING\n&gt; Blocked/Waiting On: NONE\n&gt;       sun.misc.Unsafe.park(Native Method)\n&gt;       java.util.concurrent.locks.LockSupport.park(LockSupport.java:156)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:811)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:969)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1281)\n&gt;\n&gt; java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.lockInterruptibly(ReentrantReadWriteLock.java:639)\n&gt;\n&gt; org.archive.crawler.frontier.AbstractFrontier.next(AbstractFrontier.java:450)\n&gt;       org.archive.crawler.framework.ToeThread.run(ToeThread.java:133)\n&gt; ]\n&gt; [ToeThread #133:\n&gt;    -no CrawlURI-\n&gt;       WAITING for 1h19m48s302ms\n&gt;       step: ABOUT_TO_GET_URI for 1h19m48s302ms\n&gt; Java Thread State: WAITING\n&gt; Blocked/Waiting On: NONE\n&gt;       sun.misc.Unsafe.park(Native Method)\n&gt;       java.util.concurrent.locks.LockSupport.park(LockSupport.java:156)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:811)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:969)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1281)\n&gt;\n&gt; java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.lockInterruptibly(ReentrantReadWriteLock.java:639)\n&gt;\n&gt; org.archive.crawler.frontier.AbstractFrontier.next(AbstractFrontier.java:450)\n&gt;       org.archive.crawler.framework.ToeThread.run(ToeThread.java:133)\n&gt; ]\n&gt; .\n&gt; .\n&gt; .\n&gt;\n&gt; ToeThread #1198:\n&gt;    -no CrawlURI-\n&gt;       WAITING for 1h30m20s625ms\n&gt;       step: ABOUT_TO_GET_URI for 1h30m20s625ms\n&gt; Java Thread State: WAITING\n&gt; Blocked/Waiting On: NONE\n&gt;       sun.misc.Unsafe.park(Native Method)\n&gt;       java.util.concurrent.locks.LockSupport.park(LockSupport.java:156)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:811)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:969)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1281)\n&gt;\n&gt; java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.lockInterruptibly(ReentrantReadWriteLock.java:639)\n&gt;\n&gt; org.archive.crawler.frontier.AbstractFrontier.next(AbstractFrontier.java:450)\n&gt;       org.archive.crawler.framework.ToeThread.run(ToeThread.java:133)\n&gt; ]\n&gt; [ToeThread #1199:\n&gt;    -no CrawlURI-\n&gt;       WAITING for 1h30m25s395ms\n&gt;       step: ABOUT_TO_GET_URI for 1h30m25s395ms\n&gt; Java Thread State: WAITING\n&gt; Blocked/Waiting On: NONE\n&gt;       sun.misc.Unsafe.park(Native Method)\n&gt;       java.util.concurrent.locks.LockSupport.park(LockSupport.java:156)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:811)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:969)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1281)\n&gt;\n&gt; java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.lockInterruptibly(ReentrantReadWriteLock.java:639)\n&gt;\n&gt; org.archive.crawler.frontier.AbstractFrontier.next(AbstractFrontier.java:450)\n&gt;       org.archive.crawler.framework.ToeThread.run(ToeThread.java:133)\n&gt; ]\n&gt; [ToeThread #1200:\n&gt;    -no CrawlURI-\n&gt;       WAITING for 1h30m26s398ms\n&gt;       step: ABOUT_TO_GET_URI for 1h30m26s398ms\n&gt; Java Thread State: WAITING\n&gt; Blocked/Waiting On: NONE\n&gt;       sun.misc.Unsafe.park(Native Method)\n&gt;       java.util.concurrent.locks.LockSupport.park(LockSupport.java:156)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:811)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:969)\n&gt;\n&gt; java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1281)\n&gt;\n&gt; java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.lockInterruptibly(ReentrantReadWriteLock.java:639)\n&gt;\n&gt; org.archive.crawler.frontier.AbstractFrontier.next(AbstractFrontier.java:450)\n&gt;       org.archive.crawler.framework.ToeThread.run(ToeThread.java:133)\n&gt; ]\n&gt;\n&gt;\n&gt; Any clarification and explanation of these would greatly be appreciated.\n&gt;\n&gt; --David\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}