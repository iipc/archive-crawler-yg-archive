{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":191387937,"authorName":"pandae667","from":"&quot;pandae667&quot; &lt;aaron667@...&gt;","profile":"pandae667","replyTo":"LIST","senderId":"CoIUZZOvsQ8a88IxD-JDM1i0mdpITpWoIFra7tqqS5w2QgCM_shYvlMrexqaCTfEd2TCrJzwqVG0_QQLunKKwr8AB0Pj","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: questions about heritrix memory consumption","postDate":"1176279350","msgId":4085,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGV2aTVmbStydW1pQGVHcm91cHMuY29tPg==","inReplyToHeader":"PGV2aHVzZCtycmo5QGVHcm91cHMuY29tPg=="},"prevInTopic":4084,"nextInTopic":4087,"prevInTime":4084,"nextInTime":4086,"topicId":4079,"numMessagesInTopic":8,"msgSnippet":"Hi Gordon, its once again me. I were able to trigger a GC via a JMX call and now the reports of jmap -histo seem to be more consistent with the report of the","rawEmail":"Return-Path: &lt;aaron667@...&gt;\r\nX-Sender: aaron667@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 34356 invoked from network); 11 Apr 2007 08:16:04 -0000\r\nReceived: from unknown (66.218.66.70)\n  by m48.grp.scd.yahoo.com with QMQP; 11 Apr 2007 08:16:04 -0000\r\nReceived: from unknown (HELO n31.bullet.scd.yahoo.com) (66.94.237.25)\n  by mta12.grp.scd.yahoo.com with SMTP; 11 Apr 2007 08:16:00 -0000\r\nReceived: from [209.73.164.86] by n31.bullet.scd.yahoo.com with NNFMP; 11 Apr 2007 08:15:50 -0000\r\nReceived: from [66.218.66.90] by t8.bullet.scd.yahoo.com with NNFMP; 11 Apr 2007 08:15:50 -0000\r\nDate: Wed, 11 Apr 2007 08:15:50 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;evi5fm+rumi@...&gt;\r\nIn-Reply-To: &lt;evhusd+rrj9@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:6:0:0\r\nFrom: &quot;pandae667&quot; &lt;aaron667@...&gt;\r\nSubject: Re: questions about heritrix memory consumption\r\nX-Yahoo-Group-Post: member; u=191387937; y=44himBDS_K3rdTnOYYMCvjiwtp02Gyj19yhCU_X8SrZyoMqS\r\nX-Yahoo-Profile: pandae667\r\n\r\nHi Gordon,\n\nits once again me. \nI were able to trigger a GC via a JMX call =\r\nand now the reports of\n&#39;jmap -histo&#39; seem to be more consistent with the re=\r\nport of the webUI.\n(or maybe I just copied&pasted the wrong report last tim=\r\ne)\n\nnum   #instances    #bytes  class name\n--------------------------------=\r\n------\n  1:    674736   292760720  [B\n  2:    451626    18065040  com.sleep=\r\nycat.je.tree.LN\n  3:      7239     7580688  [[B\n  4:      7233     7580184 =\r\n [Lcom.sleepycat.je.tree.Node;\n  5:     39884     5859680  &lt;constMethodKlas=\r\ns&gt;\n  6:     39884     4794544  &lt;methodKlass&gt;\n  7:     28497     4725848  [L=\r\njava.util.HashMap$Entry;\n  8:      3704     4580736  &lt;constantPoolKlass&gt;\n  =\r\n9:     47991     4553240  [Ljava.lang.Object;\n 10:     79118     3797664  j=\r\nava.util.HashMap$Entry\n\n(summing up all the #bytes only differs by a few % =\r\nto what the webUI\nreports)\n\nBut still... What I&#39;m seeing is about half the =\r\nmemory consumption\nbeing caused by JBDB data structures - whilest heritrix =\r\nsays:\n\nJobs\nNone available\n0 pending, 53 completed\n\nThis doesn&#39;t seem all t=\r\noo reasonable to me (or maybe I still just\ncan&#39;t stand garbage collectors?)=\r\n.\n\nI&#39;ll try to get a heap dump to retrieve some more informations about\nwha=\r\nt is going on.\n\nRegards\n  Olaf Freyer\n\n--- In archive-crawler@yahoogroups.c=\r\nom, &quot;pandae667&quot; &lt;aaron667@...&gt; wrote:\n&gt;\n&gt; Hi Gordon,\n&gt; \n&gt; thanks for your q=\r\nuick reply.\n&gt; (1) I think it might be true, that &#39;jmap -histo&#39; doesn&#39;t forc=\r\ne a GC.\n&gt; I&#39;ll look into this and try if things change after a forced GC.\n&gt;=\r\n (2) The last 50 jobs all are in the &quot;Finished&quot; state, so I&#39;d presume\n&gt; eve=\r\nrything finished just fine. (This machine only does &quot;small&quot; jobs)\n&gt; \n&gt; The =\r\nmain reason why I&#39;m mentioning all this is that my machines\n&gt; running the b=\r\nig crawls tend to &quot;die&quot; after about a week.\n&gt; Or to be more correct, they r=\r\nun fine for one week. Then their task is\n&gt; either finished - or I finish it=\r\n via JMX. Now I enqueue the next job\n&gt; which runs OOME within 1 or 2 days.\n=\r\n&gt; \n&gt; After the first job has finished heritrix remains in a state of 4.5GB\n=\r\n&gt; of 5GB heap used -  so I think it seems reasonable to believe that\n&gt; some=\r\nthing from the previous job still remains in-memory.\n&gt; \n&gt; I&#39;m not sure why =\r\nthis happens - if this is either a real memory leak\n&gt; or just the GC going =\r\nnuts.\n&gt; \n&gt; I have to admit that I still don&#39;t understand all of heritrix\n&gt; =\r\ninternals, but I found this blog entry\n&gt; (http://blogs.oracle.com/charlesla=\r\nmb/2007/02/22) interesting\n&gt; concerning java BDB and OOME issues. Not sure =\r\nif it applies to\n&gt; heritrix as I&#39;, not sure if we have one or multiple envi=\r\nronments.\n&gt; \n&gt; Regards\n&gt;   Olaf Freyer\n&gt; \n&gt; --- In archive-crawler@yahoogro=\r\nups.com, Gordon Mohr &lt;gojomo@&gt; wrote:\n&gt; &gt;\n&gt; &gt; Two possibilities come to min=\r\nd:\n&gt; &gt; \n&gt; &gt; (1) I don&#39;t think &#39;jmap -histo&#39; forces a GC first. And, its out=\r\nput\n&gt; seems \n&gt; &gt; peculiar given the webUI figures: it&#39;s showing over 1GB of=\r\n byte\narrays \n&gt; &gt; (&quot;[B&quot;), though the webUi reports only ~400MB heap in use.=\r\n So I think\n&gt; the \n&gt; &gt; &#39;jmap -histo&#39; figures contain dead objects. Maybe a =\r\nforced GC would\n&gt; give \n&gt; &gt; more sensible figures.\n&gt; &gt; \n&gt; &gt; (2) The crawl d=\r\nidn&#39;t finish completely or cleanly. It&#39;s not \n&gt; &gt; paused-at-finish waiting =\r\nfor a possible resume with more URIs, is it?\n&gt; &gt; \n&gt; &gt; - Gordon @ IA\n&gt; &gt; \n&gt; =\r\n&gt; pandae667 wrote:\n&gt; &gt; &gt; Dear IA-Team,\n&gt; &gt; &gt; \n&gt; &gt; &gt; whilest analysing the r=\r\nesults of a previous crawl I decided to also\n&gt; &gt; &gt; take a closer look at he=\r\nritrix. To be more specific a closer look at\n&gt; &gt; &gt; the state heritrix was i=\r\nn after finishing the job.\n&gt; &gt; &gt; (basically heritrix-1.12 with some minor p=\r\natches running under\n&gt; java 1.6)\n&gt; &gt; &gt; \n&gt; &gt; &gt; The webUI showed me the follo=\r\nwing stats:\n&gt; &gt; &gt; \n&gt; &gt; &gt; Memory\n&gt; &gt; &gt; 402591 KB used\n&gt; &gt; &gt; 950456 KB curren=\r\nt heap\n&gt; &gt; &gt; 3063488 KB max heap\n&gt; &gt; &gt; \n&gt; &gt; &gt; Now this is quite a lot memor=\r\ny being used while sitting there idle.\n&gt; &gt; &gt; So I wondered what is eating u=\r\np all my precious memory and this is\n&gt; &gt; &gt; what jmap -histo &lt;pid&gt; was able =\r\nto tell me:\n&gt; &gt; &gt; \n&gt; &gt; &gt; num   #instances    #bytes  class name\n&gt; &gt; &gt; -----=\r\n---------------------------------\n&gt; &gt; &gt;   1:   7716610   1352335640  [B\n&gt; &gt;=\r\n &gt;   2:   5202265   208090600  com.sleepycat.je.tree.LN\n&gt; &gt; &gt;   3:     7815=\r\n5    81900656  [[B\n&gt; &gt; &gt;   4:     78149    81900152  [Lcom.sleepycat.je.tre=\r\ne.Node;\n&gt; &gt; &gt;   5:    469864    72832376  [C\n&gt; &gt; &gt;   6:     24169    250503=\r\n92  [J\n&gt; &gt; &gt;   7:    421191    20217168  java.util.Hashtable$Entry\n&gt; &gt; &gt;   =\r\n8:    467772    18710880  java.lang.String\n&gt; &gt; &gt;   9:     75246    12641328=\r\n  com.sleepycat.je.tree.BIN\n&gt; &gt; &gt;  10:    259687    12464976  org.archive.c=\r\nrawler.admin.SeedRecord\n&gt; &gt; &gt;  ...\n&gt; &gt; &gt;  ...\n&gt; &gt; &gt;  ...\n&gt; &gt; &gt; \n&gt; &gt; &gt; So wh=\r\nat I&#39;m asking myself is: why do I still see about 5 million\n&gt; &gt; &gt; instances=\r\n of com.sleepycat.je.tree.LN in memory whilest sitting\nthere\n&gt; &gt; &gt; idle and=\r\n the last job having finished about 3 days ago ?\n&gt; &gt; &gt; \n&gt; &gt; &gt; Anyone able t=\r\no share some insights with me?\n&gt; &gt; &gt; \n&gt; &gt; &gt; Regards\n&gt; &gt; &gt;   Olaf Freyer\n&gt; &gt;=\r\n &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt;  \n&gt; &gt; &gt; Yahoo! Groups Links\n&gt; &gt; &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt;\n&gt; &gt;=\r\n\n&gt;\n\n\n\n"}}