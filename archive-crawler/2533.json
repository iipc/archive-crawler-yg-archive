{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":241416423,"authorName":"Andrea Goethals","from":"Andrea Goethals &lt;andrea_goethals@...&gt;","replyTo":"LIST","senderId":"evKhzVbs3YM5WY2K1uBIJl86xSy9BMtgho3OTM_3nJRMBfVkUTFiLQATSJ_QWz-B2GglylWpaa0fhQSbhZqiF1ZLYgpMggTPvZFUfmceYZ7MkMqw","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] NullPointerException when writing to ARC  file","postDate":"1137002753","msgId":2533,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDUuMi4xLjEuMi4yMDA2MDExMTEyNDMyNC4wMjVlN2ViOEBodWxtYWlsLmhhcnZhcmQuZWR1Pg==","inReplyToHeader":"PDQzQzQ3NzcyLjgwMDAxMDVAYXJjaGl2ZS5vcmc+","referencesHeader":"PDUuMi4xLjEuMi4yMDA2MDExMDEyMjU1Ni4wMjRhOTdlOEBodWxtYWlsLmhhcnZhcmQuZWR1PiA8NS4yLjEuMS4yLjIwMDYwMTEwMTIyNTU2LjAyNGE5N2U4QGh1bG1haWwuaGFydmFyZC5lZHU+"},"prevInTopic":2530,"nextInTopic":2539,"prevInTime":2532,"nextInTime":2534,"topicId":2527,"numMessagesInTopic":6,"msgSnippet":"... Thanks St.Ack for the quick fix. This helped a lot. ... Now here s a better exception trace (all the exceptions are the same but for different URIs): ","rawEmail":"Return-Path: &lt;andrea_goethals@...&gt;\r\nX-Sender: andrea_goethals@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 62010 invoked from network); 11 Jan 2006 18:06:01 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m1.grp.scd.yahoo.com with QMQP; 11 Jan 2006 18:06:01 -0000\r\nReceived: from unknown (HELO rockhop.harvard.edu) (128.103.60.229)\n  by mta4.grp.scd.yahoo.com with SMTP; 11 Jan 2006 18:06:00 -0000\r\nReceived: from kcml6fy.harvard.edu (hulpres61.harvard.edu [128.103.151.61])\n\tby rockhop.harvard.edu (8.11.6/8.11.6) with ESMTP id k0BI5og15327\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed, 11 Jan 2006 13:05:55 -0500\r\nMessage-Id: &lt;5.2.1.1.2.20060111124324.025e7eb8@...&gt;\r\nX-Sender: andreag@...\r\nX-Mailer: QUALCOMM Windows Eudora Version 5.2.1\r\nDate: Wed, 11 Jan 2006 13:05:53 -0500\r\nTo: archive-crawler@yahoogroups.com\r\nIn-Reply-To: &lt;43C47772.8000105@...&gt;\r\nReferences: &lt;5.2.1.1.2.20060110122556.024a97e8@...&gt;\n &lt;5.2.1.1.2.20060110122556.024a97e8@...&gt;\r\nMime-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;us-ascii&quot;; format=flowed\r\nX-eGroups-Msg-Info: 1:12:0:0\r\nFrom: Andrea Goethals &lt;andrea_goethals@...&gt;\r\nSubject: Re: [archive-crawler] NullPointerException when writing to ARC\n  file\r\nX-Yahoo-Group-Post: member; u=241416423\r\n\r\nAt 07:11 PM 1/10/2006 -0800, you wrote:\n&gt;Thanks Andrea.  The &#39;writer.getPosition&#39; throwing an NPE is especially\n&gt;silly considering next line in ARCWriterProcessor is a check for a null\n&gt;writer (I just fixed it -- build 884 on our continuous build server --\n&gt;see\n&gt;http://crawltools.archive.org:8080/cruisecontrol/buildresults/HEAD-heritrix\n&gt;-- should have the amendment).\n\nThanks St.Ack for the quick fix. This helped a lot.\n\n\n&gt;As to why the IOException is being thrown in the first place, can the\n&gt;Heritrix process for sure write to wherever you&#39;re directing ARC files\n&gt;be written (It is not full and its writeable by the Heritrix process?)\n&gt;Maybe trying with build 884 will give a better clue as to whats going on\n&gt;now I imagine it&#39;ll let out the IOException.\n\nNow here&#39;s a better exception trace (all the exceptions are the same but \nfor different URIs):\nMessage:\n\nFailed write of ARC Record: http://www.aandw.net/images/walden2.png(in \nprocessor Archiver)\n\nException:\n\njava.io.IOException: Metadata line doesn&#39;t match expected pattern: \nhttp://www.aandw.net/images/walden2.png 128.197.34.86 20060111174224 \nimage/png 2160\n\nStacktrace: java.io.IOException: Metadata line doesn&#39;t match expected \npattern: http://www.aandw.net/images/walden2.png 128.197.34.86 \n20060111174224 image/png 2160\n\n         at org.archive.io.arc.ARCWriter.validateMetaLine(ARCWriter.java:793)\n         at org.archive.io.arc.ARCWriter.getMetaLine(ARCWriter.java:764)\n         at org.archive.io.arc.ARCWriter.write(ARCWriter.java:687)\n         at \norg.archive.crawler.writer.ARCWriterProcessor.write(ARCWriterProcessor.java:475)\n         at \norg.archive.crawler.writer.ARCWriterProcessor.writeHttp(ARCWriterProcessor.java:417)\n         at \norg.archive.crawler.writer.ARCWriterProcessor.innerProcess(ARCWriterProcessor.java:394)\n         at org.archive.crawler.framework.Processor.process(Processor.java:103)\n         at \norg.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:306)\n         at org.archive.crawler.framework.ToeThread.run(ToeThread.java:153)\n\nSomehow the ARCWriter.METADATA_LINE_PATTERN isn&#39;t matching exactly with the \nmetadata line.\n\nWhat ends up happening is that it writes the very first part of an ARC file \n(like below) gets the IOException, renames the file to *invalid, opens a \nnew file and starts the process again. So it continues to write *invalid \nfiles with just the first part of the ARC file until you see all the alerts \nand stop it.\n\nThe only part that gets written to each ARC file:\n[andreag@chaz unzipped]$ more IAH-20060110181306-00028-chaz.hul.harvard.edu.arc\nfiledesc://IAH-20060110181306-00028-chaz.hul.harvard.edu.arc 0.0.0.0 \n20060110181306 text/plain 1214\n1 1 InternetArchive\nURL IP-address Archive-date Content-type Archive-length\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;\n&lt;arcmetadata xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; \nxmlns:dcterms=&quot;http://purl.org/dc/terms/&quot; \nxmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; \nxmlns:arc=&quot;http://archive.org/arc/1.0/&quot; xmlns=&quot;http://archive.org/arc/1.0/&quot; \nxsi:schemaLocation=&quot;http://archive.org/arc/1.0/ \nhttp://www.archive.org/arc/1.0/arc.xsd&quot;&gt;\n&lt;arc:software&gt;Heritrix 1.6.0 http://crawler.archive.org&lt;/arc:software&gt;\n&lt;arc:hostname&gt;chaz.hul.harvard.edu&lt;/arc:hostname&gt;\n&lt;arc:ip&gt;128.103.151.249&lt;/arc:ip&gt;\n&lt;dcterms:isPartOf&gt;test2&lt;/dcterms:isPartOf&gt;\n&lt;dc:description&gt;Default Profile&lt;/dc:description&gt;\n&lt;arc:operator&gt;Admin&lt;/arc:operator&gt;\n&lt;dc:date xsi:type=&quot;dcterms:W3CDTF&quot;&gt;2006-01-10T18:11:55+00:00&lt;/dc:date&gt;\n&lt;arc:http-header-user-agent&gt;Mozilla/5.0 (compatible; heritrix/1.6.0 \n+http://hul.harvard.edu/ois/)&lt;/arc:http-header-user-agent&gt;\n&lt;arc:http-header-from&gt;andrea_goethals@...&lt;/arc:http-header-from&gt;\n&lt;arc:robots&gt;classic&lt;/arc:robots&gt;\n&lt;dc:format&gt;ARC file version 1.1&lt;/dc:format&gt;\n&lt;dcterms:conformsTo \nxsi:type=&quot;dcterms:URI&quot;&gt;http://www.archive.org/web/researcher/ArcFileFormat.php&lt;/dcterms:conformsTo&gt;\n&lt;/arcmetadata&gt;\n\n\n\nAndrea\n\n\n&gt;St.Ack\n&gt;\n&gt;\n&gt;Andrea Goethals wrote:\n&gt; &gt; Hello,\n&gt; &gt;\n&gt; &gt; I recently changed the machine I am doing crawls on. Now every time I try\n&gt; &gt; to run a crawl I get a NullPointerException - even doing the Charset\n&gt; &gt; self-test. These are the kind of entries I&#39;m getting in my console &\n&gt; &gt; heritrix_out.log:\n&gt; &gt;\n&gt; &gt; Message:\n&gt; &gt;\n&gt; &gt; Problem java.lang.NullPointerException occured when trying to process\n&gt; &gt; &#39;http://127.0.0.1:8181/robots.txt&#39;\n&gt; &gt; &lt;http://127.0.0.1:8181/robots.txt%27&gt; at step ABOUT_TO_BEGIN_PROCESSOR\n&gt; &gt; in Archiver\n&gt; &gt; (in processor Archiver)\n&gt; &gt;\n&gt; &gt; java.lang.NullPointerException\n&gt; &gt; Stacktrace: java.lang.NullPointerException\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.write(ARCWriterProcessor.java:492)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.writeHttp(ARCWriterProcessor.java:417)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.innerProcess(ARCWriterProcessor.java:394)\n&gt; &gt;       at\n&gt; &gt; org.archive.crawler.framework.Processor.process(Processor.java:103)\n&gt; &gt;       at\n&gt; &gt; org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:306)\n&gt; &gt;       at org.archive.crawler.framework.ToeThread.run(ToeThread.java:153)\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; I can kind of see from the source why the NullPointerException might be\n&gt; &gt; thrown. In the ArcWriterProcessor when an IOException is thrown, on line\n&gt; &gt; 489 the writer is being set to null. Then in the finally clause on\n&gt; &gt; line 492\n&gt; &gt; it tries to call getPosition() on the null writer.\n&gt; &gt;\n&gt; &gt; The arc files are being written with the invalid suffix. I don&#39;t know why\n&gt; &gt; the IOException occurs if that is what&#39;s happening. I was able to do\n&gt; &gt; crawls\n&gt; &gt; on a different machine (both linux, both heritrix 1.6). Any help is\n&gt; &gt; appreciated.\n&gt; &gt;\n&gt; &gt; thanks,\n&gt; &gt; Andrea\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n\n\n\n"}}