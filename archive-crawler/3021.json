{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":168599281,"authorName":"Michael Stack","from":"Michael Stack &lt;stack@...&gt;","profile":"stackarchiveorg","replyTo":"LIST","senderId":"a2NvXsRObjWWBN2lUV8lFmLGbPM2QeJOKzBj1zJ4Qb-Fvrgnz40N1Css4YcVU60yctLIJOrvXZsLkVEIqPpNdSbmTdA5NQje","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Writing source (seed) in arc file","postDate":"1152293292","msgId":3021,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQ0QUU5OUFDLjUwMDAwMDBAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGU4am90bitxNG1tQGVHcm91cHMuY29tPg==","referencesHeader":"PGU4am90bitxNG1tQGVHcm91cHMuY29tPg=="},"prevInTopic":3011,"nextInTopic":3022,"prevInTime":3020,"nextInTime":3022,"topicId":3011,"numMessagesInTopic":4,"msgSnippet":"... This class does not make for easy reading. ... Looking at code, this looks hard. The content that gets written to ARCs is recorded by wrapping the apache","rawEmail":"Return-Path: &lt;stack@...&gt;\r\nX-Sender: stack@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 60091 invoked from network); 7 Jul 2006 17:40:03 -0000\r\nReceived: from unknown (66.218.67.33)\n  by m32.grp.scd.yahoo.com with QMQP; 7 Jul 2006 17:40:03 -0000\r\nReceived: from unknown (HELO dns.duboce.net) (63.203.238.114)\n  by mta7.grp.scd.yahoo.com with SMTP; 7 Jul 2006 17:40:02 -0000\r\nReceived: from [192.168.1.105] ([192.168.1.105])\n\tby dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id k67GB6F09611;\n\tFri, 7 Jul 2006 09:11:06 -0700\r\nMessage-ID: &lt;44AE99AC.5000000@...&gt;\r\nDate: Fri, 07 Jul 2006 10:28:12 -0700\r\nUser-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X Mach-O; en-US; rv:1.8.0.4) Gecko/20060516 SeaMonkey/1.0.2\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;e8jotn+q4mm@...&gt;\r\nIn-Reply-To: &lt;e8jotn+q4mm@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nFrom: Michael Stack &lt;stack@...&gt;\r\nSubject: Re: [archive-crawler] Writing source (seed) in arc file\r\nX-Yahoo-Group-Post: member; u=168599281; y=yLa-L_WNSJh-MRwinTXdoHgJ30_nZ9psbpBJHG9sdpUQvRnKcYFS3ZW7\r\nX-Yahoo-Profile: stackarchiveorg\r\n\r\nbarabasy69 wrote:\n&gt;\n&gt; Hi,\n&gt;\n&gt; I need a way to track from which seed (source) a URI came from. This\n&gt; information is written down in the crawl.log if I set the\n&gt; attribute &#39;source-tag-seeds&#39; in the frontier. But it will be more\n&gt; intersting to if the seed is marked as an HTTP header and survives all\n&gt; the way down to the arc record. After reading the code, I thought that\n&gt; the HTTP fetcher is a good place to inject some HTTP headers into the\n&gt; HTTP response but I cannot see where in code I can do that.\n&gt;\n\n\n\n\n\n\n\n\n\n\n\n\nThis class does not make for easy reading.\n&gt;\n&gt; Anybody can give me some advice in how I can add more headers to the\n&gt; HTTP response so that I can recover them in the arc file?\n&gt;\n\n\n\n\n\nLooking at code, this looks hard.\n\nThe content that gets written to ARCs is &#39;recorded&#39; by wrapping the \napache commons HttpClient Socket Input/Output Streams.  This is done \nwith a little hack. We&#39;ve copied local into Heritrix the commons \nHttpClient HttpConnection class and added our wraps directly since the \nAPI doesn&#39;t have support for wrapping streams.  See under \n$HERITRIX_HOME/src/java/org/apache.....  Our changes are wrapped by \ncomments with mention of &#39;Heritrix&#39; (Because of these overlays, so our \nhacked versions of these classes are used, the Heritrix jar must come \nfirst on the CLASSPATH).\n\nSo, you&#39;ll need get in on this low-level act if you want to inject HTTP \nHeaders and have them show up in ARCs.   When you&#39;re down low at the \nstreams level, you don&#39;t have easy access to current CrawlURI so you can \nget at the source seed.  Also, figuring the end-of-headers and \nstart-of-body so you know where to inject your header won&#39;t be easy.\n\nYou might try looking at HTTPRecorderGetMethod (See \nhttp://crawler.archive.org/xref/org/archive/httpclient/HttpRecorderGetMethod.html), \nthe subclass of commons HttpClient GetMethod we use in FetchHTTP, where \nwe get notification from commons HttpClient of transition from header to \nbody but I&#39;m guessing the notification comes too late.  When this method \nis called, the double new-line separating header from body has probably \nalready been written.  If not -- I haven&#39;t checked -- this might be the \nplace for you to add code.  Make a version of HttpRecorderGetMethod that \ntakes a CrawlURI in its constructor so  you can get at the source seed \ninstead of a uri String, and add in your header in this method: \nhttp://crawler.archive.org/xref/org/archive/httpclient/HttpRecorderGetMethod.html#95 \n(You might have to pass in HttpRecorder too so you can get at streams).\n\nGood luck.  Let us know if there is anything we can do to make this \neasier on you.\nSt.Ack\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"}}