{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":340369307,"authorName":"Pratyush Banerjee","from":"Pratyush Banerjee &lt;Pratyushbanerjee@...&gt;","replyTo":"LIST","senderId":"SN4qTBuIcEnNIUze_TwuVDiIgQFFMUx_dpCWWJqFx4vrNHhQJ8ZOKZ2APsgNk6XhR6hEkSmHOUEGiIciNbskJl0vu5fDJ1jwqYNXdbhkUXxwDSU","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] Exception in usage of BucketQueueAssignmentPolicy in Heritrix-2.0.0","postDate":"1210226444","msgId":5187,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDhDQTdFRTdGQzBGODRFMy00OTAtMjU4NEB3ZWJtYWlsLW5mMTYuc2ltLmFvbC5jb20+","inReplyToHeader":"PDQ4MjI1OTU4LjkwNDA0MDhAYXJjaGl2ZS5vcmc+","referencesHeader":"PDhDQTdDRTFEOTNBMDIwRC1GRTgtMzczOEB3ZWJtYWlsLWRkMTQuc3lzb3BzLmFvbC5jb20+IDw0ODFGQjM5MS4zMDMwMDA2QGFyY2hpdmUub3JnPiA8OENBN0Q2NTdGQzZEREUzLTEyNTAtNzk2NUB3ZWJtYWlsLW5mMTYuc2ltLmFvbC5jb20+IDw0ODIwQzcyMC4zMDkwNDA2QGFyY2hpdmUub3JnPiA8OENBN0UyMDE2ODRGODhDLTFGMjQtMzRFM0B3ZWJtYWlsLW5iMTEuc3lzb3BzLmFvbC5jb20+IDw0ODIxNjA4Ny43MDkwNDA2QGFyY2hpdmUub3JnPiA8OENBN0U1QkIzNTg3QzU3LTU2Qy1GMTdAd2VibWFpbC1uYzEzLnN5c29wcy5hb2wuY29tPiA8NDgyMjU5NTguOTA0MDQwOEBhcmNoaXZlLm9yZz4="},"prevInTopic":5186,"nextInTopic":0,"prevInTime":5186,"nextInTime":5188,"topicId":5174,"numMessagesInTopic":10,"msgSnippet":"Thanks Gordon, for so much of your time. Meanwhile i would have a look at the SVN 2 heritrix trunk. Thanking you Pratyush ... From: Gordon Mohr","rawEmail":"Return-Path: &lt;Pratyushbanerjee@...&gt;\r\nX-Sender: Pratyushbanerjee@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 11642 invoked from network); 8 May 2008 06:01:11 -0000\r\nX-Received: from unknown (66.218.67.96)\n  by m54.grp.scd.yahoo.com with QMQP; 8 May 2008 06:01:11 -0000\r\nX-Received: from unknown (HELO imo-m23.mx.aol.com) (64.12.137.4)\n  by mta17.grp.scd.yahoo.com with SMTP; 8 May 2008 06:01:11 -0000\r\nX-Received: from Pratyushbanerjee@...\n\tby imo-m23.mx.aol.com (mail_out_v38_r9.4.) id r.bda.29479654 (37541)\n\t for &lt;archive-crawler@yahoogroups.com&gt;; Thu, 8 May 2008 02:00:45 -0400 (EDT)\r\nX-Received: from webmail-nf16 (webmail-nf16.sim.aol.com [207.200.67.80]) by cia-mb02.mx.aol.com (v121.5) with ESMTP id MAILCIAMB022-92a54822970c238; Thu, 08 May 2008 02:00:44 -0400\r\nReferences: &lt;8CA7CE1D93A020D-FE8-3738@...&gt; &lt;481FB391.3030006@...&gt; &lt;8CA7D657FC6DDE3-1250-7965@...&gt; &lt;4820C720.3090406@...&gt; &lt;8CA7E201684F88C-1F24-34E3@...&gt; &lt;48216087.7090406@...&gt; &lt;8CA7E5BB3587C57-56C-F17@...&gt; &lt;48225958.9040408@...&gt;\r\nTo: archive-crawler@yahoogroups.com\r\nDate: Thu, 08 May 2008 02:00:44 -0400\r\nX-AOL-IP: 10.146.163.253\r\nIn-Reply-To: &lt;48225958.9040408@...&gt;\r\nX-MB-Message-Source: WebUI\r\nMIME-Version: 1.0\r\nX-MB-Message-Type: User\r\nContent-Type: multipart/alternative; \n boundary=&quot;--------MB_8CA7EE7FD300443_490_4AAD_webmail-nf16.sim.aol.com&quot;\r\nX-Mailer: AOL Webmail 36240-STANDARD\r\nX-Received: from 10.146.163.253 by webmail-nf16.sim.aol.com (207.200.67.80) with HTTP (WebMailUI); Thu, 08 May 2008 02:00:44 -0400\r\nMessage-Id: &lt;8CA7EE7FC0F84E3-490-2584@...&gt;\r\nX-Spam-Flag: NO\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Pratyush Banerjee &lt;Pratyushbanerjee@...&gt;\r\nSubject: Re: [archive-crawler] Exception in usage of BucketQueueAssignmentPolicy in\n Heritrix-2.0.0\r\nX-Yahoo-Group-Post: member; u=340369307\r\n\r\n\r\n----------MB_8CA7EE7FD300443_490_4AAD_webmail-nf16.sim.aol.com\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/plain; charset=&quot;us-ascii&quot;\r\n\r\n\n Thanks Gordon, for so much of your time. \nMeanwhile i would have a look at the SVN 2 heritrix trunk. \n\nThanking you\n\nPratyush\n\n\n \n\n\n \n\n-----Original Message-----\nFrom: Gordon Mohr &lt;gojomo@...&gt;\nTo: archive-crawler@yahoogroups.com\nSent: Thu, 8 May 2008 7:07 am\nSubject: Re: [archive-crawler] Exception in usage of BucketQueueAssignmentPolicy in Heritrix-2.0.0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    \n\n            \nI discovered why I could not reproduce your error. Although I had \n\nchanged the root:queue-assignment-policy to be a \n\nBucketQueueAssignmentPolicy, the frontier (root:controller:frontier:) \n\nwas still using the previous policy. Further -- and this is a separate \n\nbug -- the UI did not allow me to change \n\nroot:controller:frontier:queue-assignment-policy to be either a \n\nbackreference to root:queue-assignment-policy or a new instance.\n\n\n\nHowever, when I deleted the root:queue-assignment-policy, then I could \n\nset root:controller:frontier:queue-assignment-policy to be \n\nBucketQueueAssignmentPolicy, and saw the NullPointerExceptions you \n\nreported.\n\n\n\nI&#39;ve looked at your change. I agree that prior to the change, when the \n\ntest against MAX_QUEUES_TO_HOLD_ALLQUEUES_IN_MEMORY is true, the \n\nfrontier is incompletely initialized. Your change looks like it is safe \n\nand addresses the problem.\n\n\n\nIt does appear to cause the allQueues field to be assigned twice: once \n\nin the default manner with the early call to the no-argument \n\ninitAllQueues(), then again inside the conditional (causing the first \n\nmap to be dereferenced). I don&#39;t know for sure any problems that will \n\ncause, but it seems less than ideal.\n\n\n\nSo, I&#39;ve just committed on the heritrix2 codebase a slightly different \n\napproach, which includes renaming the relevant methods for clarity, and \n\nshould also ensure the right initialization occurs even when a \n\nBucketQueueAssignmentPolicy is in use. If you can work from the \n\nheritrix2 SVN trunk, you may want to try it.\n\n\n\nThanks for the bug reports and suggested fix! I&#39;ve made an issue for the \n\nvarious bugs you encountered trying to use BucketQueueAssignmentPolicy:\n\n\n\nhttp://webteam.archive.org/jira/browse/HER-1494\n\n\n\n- Gordon @ IA\n\n\n\nPratyush Banerjee wrote:\n\n&gt; \n\n&gt; Gordon,\n\n&gt; \n\n&gt; After quite some agonizing hours i think i found out what was causing \n\n&gt; such a horrible crash in the system.\n\n&gt; \n\n&gt; While debugging the Heritrix-2.0.0 code  i was looking at the  files \n\n&gt; WorkQueueFrontier.java and BdbFrontier.java and found out that all the \n\n&gt; queues\n\n&gt; used within  WorkQueueFrontier.java were null. Hence somehow they \n\n&gt; weren&#39;t being initialized properly.\n\n&gt; \n\n&gt; I also found out that in BdbFrontier.java there was a function called \n\n&gt; InitAllQueues() which actually initiates all the queues. The \n\n&gt; initAllQueues(boolean) function in WorkQueueFrontier.java was calling \n\n&gt; the above conditionally. I made a slight modification in the code in \n\n&gt; order to call the same unconditionally and the code seems to work fine now.\n\n&gt; \n\n&gt; I even undid the change you suggested about  initializing server-cache \n\n&gt; prior to QueueAssignmentPolicy and the code still works.\n\n&gt; \n\n&gt; to be specific here is what i changed in the code...\n\n&gt; \n\n&gt; Initially the code was\n\n&gt; \n\n&gt;     protected void initAllQueues(boolean recycle)\n\n&gt;     throws IOException, DatabaseException {\n\n&gt;         this.initAllQueues(); //Added by Pratyush to ensure Queues \n\n&gt; aren&#39;t NULL\n\n&gt;         if (workQueueDataOnDisk()\n\n&gt;                 && get(QUEUE_ASSIGNMENT_POLICY).maximumNumberOfKeys() &gt;= 0\n\n&gt;                 && get(QUEUE_ASSIGNMENT_POLICY).maximumNumberOfKeys() &lt;=\n\n&gt;                     MAX_QUEUES_TO_HOLD_ALLQUEUES_IN_MEMORY) {\n\n&gt;             this.allQueues = Collections.synchronizedMap(\n\n&gt;                     new HashMap&lt;String,WorkQueue&gt;());\n\n&gt;         }/* else {  // commented out by Pratyush to allow normal flow.\n\n&gt;             this.initAllQueues();\n\n&gt;         }*/\n\n&gt;         initQueue(recycle);\n\n&gt;        \n\n&gt;     }\n\n&gt; \n\n&gt; Please do let me know if this looks okkay to you or not.\n\n&gt; \n\n&gt; ~regards\n\n&gt; \n\n&gt; Pratyush\n\n&gt; -----Original Message-----\n\n&gt; From: Gordon Mohr &lt;gojomo@...&gt;\n\n&gt; To: archive-crawler@yahoogroups.com\n\n&gt; Sent: Wed, 7 May 2008 1:25 pm\n\n&gt; Subject: Re: [archive-crawler] Exception in usage of \n\n&gt; BucketQueueAssignmentPolicy in Heritrix-2.0.0\n\n&gt; \n\n&gt; I was able to reproduce the problem starting from a working,\n\n&gt; nearly-default configuration and substituting\n\n&gt; BucketQueueAssignme ntPolicy via the web UI&#39;s &#39;details&#39; option for the\n\n&gt; &#39;root: .\n\n&gt; \n\n&gt; The problem appears to be that the definition of certain shared modules\n\n&gt; by name inside the root map -- specifically &#39;queue-assignment- policy&#39;\n\n&gt; and then &#39;server-cache&#39; -- is in a problematic order once a\n\n&gt; BucketQueueAssignme ntPolicy is introduced.\n\n&gt; \n\n&gt; The &#39;queue-assignment- policy&#39; comes first and unlike other policies,\n\n&gt; BucketQueueAssignme ntPolicy needs a reference to a ServerCache. There\n\n&gt; should only be one ServerCache, so an instance is created there, and all\n\n&gt; later ServerCache references should refer back to it. However, the\n\n&gt; immediately following &#39;server-cache&#39; definition inside the &#39;root&#39; map\n\n&gt; can&#39;t be filled by autowire references, as the exception indicates.\n\n&gt; \n\n&gt; I&#39;m not certain if that&#39;s a truly necessary restriction, but a\n\n&gt; workaround that removed the problem for me was to ensure that the\n\n&gt; &#39;root:server- cache&#39; definition comes right before, rather than right\n\n&gt; after, &#39;root:queue- assignment- policy&#39;.\n\n&gt; \n\n&gt; This can&#39;t be done via the web UI; I did it in the on-disk global.sheet\n\n&gt; before attempting to swap in BucketQueueAssignme ntPolicy.\n\n&gt; \n\n&gt; A small test crawl with BucketQueueAssignme ntPolicy then launched and\n\n&gt; completed.\n\n&gt; \n\n&gt; Hope this helps,\n\n&gt; \n\n&gt; - Gordon @ IA\n\n&gt; \n\n&gt; Pratyush Banerjee wrote:\n\n&gt;  &gt;\n\n&gt;  &gt; Hi Gordon,\n\n&gt;  &gt;\n\n&gt;  &gt; Initially my application crashed due to selection of the\n\n&gt;  &gt; BucketQueueAssignme ntPolicy. Obviously i had changed other default\n\n&gt;  &gt; options like the\n\n&gt;  &gt; Archiver, and the politeness settings including max-retry and\n\n&gt;  &gt; retry-del;ay and fetch-http-timeout.\n\n&gt;  &gt;\n\n&gt;  &gt; However after the application crashed i tried changing the\n\n&gt;  &gt; queueAssignmentPoli cy in a frtesh installation of heritrix-2.0 and i\n\n&gt;  &gt; chose the profile basic-seed-sites crawl. But still the app crashed with\n\n&gt;  &gt; the same errors.\n\n&gt;  &gt;\n\n&gt;  &gt; I also tried selecting optionally a BdbServerCache or a\n\n&gt;  &gt; DefaultServerCache along with the BucketQueueAssignme ntPolicy but to no\n\n&gt;  &gt; avail.\n\n&gt;  &gt;\n\n&gt;  &gt; Pratyush\n\n&gt;  &gt;\n\n&gt;  &gt;\n\n&gt;  &gt; -----Original Message-----\n\n&gt;  &gt; From: Gordon Mohr &lt;gojomo@archive. org &lt;mailto:gojomo%40archive.org&gt;&gt;\n\n&gt;  &gt; To: archive-crawler@ yahoogroups. com \n\n&gt; &lt;mailto:archive-crawler%40yahoogroups.com&gt;\n\n&gt;  &gt; Sent: Wed, 7 May 2008 2:31 am\n\n&gt;  &gt; Subject: Re: [archive-crawler] Exception in usage of\n\n&gt;  &gt; BucketQueueAssignme ntPolicy in Heritrix-2.0. 0\n\n&gt;  &gt;\n\n&gt;  &gt; I suspect this is a different issue entirely. Have you made other\n\n&gt;  &gt; changes to the default configuration, besides specifying a\n\n&gt;  &gt; BucketQueueAssignme ntPolicy?\n\n&gt;  &gt;\n\n&gt;  &gt; Or is starting with a default configuration and only changing to\n\n&gt;  &gt; BucketQueueAssignme ntPolicy enough to trigger this error on launch?\n\n&gt;  &gt;\n\n&gt;  &gt; - Gordon @ IA\n\n&gt;  &gt;\n\n&gt;  &gt; Pratyush Banerjee wrote:\n\n&gt;  &gt; &gt; Thanks Gordon for your prompt reply.\n\n&gt;  &gt; &gt;\n\n&gt;  &gt; &gt; I already tried the changes you suggested.? But that does not however\n\n&gt;  &gt; solve the problem. I tried making the Key public and getting a\n\n&gt;  &gt; KeyManager to add keys in a static block within the class.? The previous\n\n&gt;  &gt; error was gone? obviously.\n\n&gt;  &gt; &gt;\n\n&gt;  &gt; &gt; But when i ran that code it again crashed giving me the following \n\n&gt; error.\n\n&gt;  &gt; &gt;\n\n&gt;  &gt; &gt; java.lang.RuntimeEx ception: org.archive. settings. path.PathChangeE\n\n&gt;  &gt; xception: Can&#39;t autowire map elements.\n\n&gt;  &gt; &gt; ??? at org.archive. crawler.framewor k.EngineImpl. launchJob(\n\n&gt;  &gt; EngineImpl. java:378)\n\n&gt;  &gt; &gt; ??? at sun.reflect. NativeMethodAcce ssorImpl. invoke0(Native Method)\n\n&gt;  &gt; &gt; ??? at sun.reflect. NativeMethodAcce ssorImpl. invoke(NativeMet\n\n&gt;  &gt; hodAccessorImpl. java:39)\n\n&gt; Plan your next roadtrip with MapQuest.com \n\n&gt; &lt;http://www.mapquest.com/?ncid=mpqmap00030000000004&gt;: America&#39;s #1 \n\n&gt; Mapping Site.\n\n&gt; \n\n\n\n    \n  \n\n    \n    \n    \n    \n\n\n\n\n    \n    \n \n\n\r\n----------MB_8CA7EE7FD300443_490_4AAD_webmail-nf16.sim.aol.com\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/html; charset=&quot;us-ascii&quot;\r\n\r\n\n&lt;div&gt; Thanks Gordon, for so much of your time. &lt;br&gt;\nMeanwhile i would have a look at the SVN 2 heritrix trunk. &lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;&lt;br&gt;\n&lt;br&gt;\nThanking you&lt;br&gt;\n&lt;br&gt;\nPratyush&lt;br&gt;\n&lt;/font&gt;&lt;/div&gt;\n\n&lt;div&gt; &lt;br&gt;\n&lt;/div&gt;\n\n&lt;div&gt; &lt;br&gt;\n&lt;/div&gt;\n-----Original Message-----&lt;br&gt;\nFrom: Gordon Mohr &lt;gojomo@...&gt;&lt;br&gt;\nTo: archive-crawler@yahoogroups.com&lt;br&gt;\nSent: Thu, 8 May 2008 7:07 am&lt;br&gt;\nSubject: Re: [archive-crawler] Exception in usage of BucketQueueAssignmentPolicy in Heritrix-2.0.0&lt;br&gt;\n&lt;br&gt;\n\n\n\n\n\n\n&lt;div id=&quot;AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0&quot;&gt;\n\n\n\n\n\n\n\n\n\n&lt;div id=&quot;ygrp-mlmsg&quot; style=&quot;width: 655px; position: relative;&quot;&gt;\n\n&lt;div id=&quot;ygrp-msg&quot; style=&quot;margin: 0pt; padding: 0pt 25px 0pt 0pt; width: 470px; float: left; z-index: 1;&quot;&gt;\n\n\n    \n&lt;div id=&quot;ygrp-text&quot;&gt;\n            \n&lt;div&gt;I discovered why I could not reproduce your error. Although I had &lt;br&gt;\n\nchanged the root:queue-assignme&lt;wbr&gt;nt-policy to be a &lt;br&gt;\n\nBucketQueueAssignme&lt;wbr&gt;ntPolicy, the frontier (root:controller:&lt;wbr&gt;frontier:&lt;wbr&gt;) &lt;br&gt;\n\nwas still using the previous policy. Further -- and this is a separate &lt;br&gt;\n\nbug -- the UI did not allow me to change &lt;br&gt;\n\nroot:controller:&lt;wbr&gt;frontier:&lt;wbr&gt;queue-assignment&lt;wbr&gt;-policy to be either a &lt;br&gt;\n\nbackreference to root:queue-assignme&lt;wbr&gt;nt-policy or a new instance.&lt;br&gt;\n\n&lt;br&gt;\n\nHowever, when I deleted the root:queue-assignme&lt;wbr&gt;nt-policy, then I could &lt;br&gt;\n\nset root:controller:&lt;wbr&gt;frontier:&lt;wbr&gt;queue-assignment&lt;wbr&gt;-policy to be &lt;br&gt;\n\nBucketQueueAssignme&lt;wbr&gt;ntPolicy, and saw the NullPointerExceptio&lt;wbr&gt;ns you &lt;br&gt;\n\nreported.&lt;br&gt;\n\n&lt;br&gt;\n\nI&#39;ve looked at your change. I agree that prior to the change, when the &lt;br&gt;\n\ntest against MAX_QUEUES_TO_&lt;wbr&gt;HOLD_ALLQUEUES_&lt;wbr&gt;IN_MEMORY is true, the &lt;br&gt;\n\nfrontier is incompletely initialized. Your change looks like it is safe &lt;br&gt;\n\nand addresses the problem.&lt;br&gt;\n\n&lt;br&gt;\n\nIt does appear to cause the allQueues field to be assigned twice: once &lt;br&gt;\n\nin the default manner with the early call to the no-argument &lt;br&gt;\n\ninitAllQueues(&lt;wbr&gt;), then again inside the conditional (causing the first &lt;br&gt;\n\nmap to be dereferenced)&lt;wbr&gt;. I don&#39;t know for sure any problems that will &lt;br&gt;\n\ncause, but it seems less than ideal.&lt;br&gt;\n\n&lt;br&gt;\n\nSo, I&#39;ve just committed on the heritrix2 codebase a slightly different &lt;br&gt;\n\napproach, which includes renaming the relevant methods for clarity, and &lt;br&gt;\n\nshould a&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;lso ensure the right initialization occurs even when a &lt;/font&gt;&lt;br&gt;\n\nBucketQueueAssignme&lt;wbr&gt;ntPolicy is in use. I&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;f you can work from the &lt;/font&gt;&lt;br&gt;\n\nheritrix2 SVN trunk, you may want to try it.&lt;br&gt;\n\n&lt;br&gt;\n\nT&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;hanks for the bug reports and suggested fix! I&#39;ve made an issue for the &lt;br&gt;\n\nvarious bugs you encountered trying to use BucketQueueAssignme&lt;/font&gt;&lt;wbr&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;ntPolicy:&lt;/font&gt;&lt;br&gt;\n\n&lt;br&gt;\n\n&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://webteam.archive.org/jira/browse/HER-1494&quot;&gt;http://webteam.&lt;wbr&gt;archive.org/&lt;wbr&gt;jira/browse/&lt;wbr&gt;HER-1494&lt;/a&gt;&lt;/font&gt;&lt;br&gt;\n\n&lt;br&gt;\n\n- Gordon @ IA&lt;br&gt;\n\n&lt;br&gt;\n\nPratyush Banerjee wrote:&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; Gordon,&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; After quite some agonizing hours i think i found out what was causing &lt;br&gt;\n\n&gt; such a horrible crash in the system.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; While debugging the Heritrix-2.0.&lt;wbr&gt;0 code  i was looking at the  files &lt;br&gt;\n\n&gt; WorkQueueFrontier.&lt;wbr&gt;java and BdbFrontier.&lt;wbr&gt;java and found out that all the &lt;br&gt;\n\n&gt; queues&lt;br&gt;\n\n&gt; used within  WorkQueueFrontier.&lt;wbr&gt;java were null. Hence somehow they &lt;br&gt;\n\n&gt; weren&#39;t being initialized properly.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; I also found out that in BdbFrontier.&lt;wbr&gt;java there was a function called &lt;br&gt;\n\n&gt; InitAllQueues(&lt;wbr&gt;) which actually initiates all the queues. The &lt;br&gt;\n\n&gt; initAllQueues(&lt;wbr&gt;boolean) function in WorkQueueFrontier.&lt;wbr&gt;java was calling &lt;br&gt;\n\n&gt; the above conditionally. I made a slight modification in the code in &lt;br&gt;\n\n&gt; order to call the same unconditionally and the code seems to work fine now.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; I even undid the change you suggested about  initializing server-cache &lt;br&gt;\n\n&gt; prior to QueueAssignmentPoli&lt;wbr&gt;cy and the code still works.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; to be specific here is what i changed in the code...&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; Initially the code was&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt;     protected void initAllQueues(&lt;wbr&gt;boolean recycle)&lt;br&gt;\n\n&gt;     throws IOException, DatabaseException {&lt;br&gt;\n\n&gt;         this.initAllQueues(&lt;wbr&gt;); //Added by Pratyush to ensure Queues &lt;br&gt;\n\n&gt; aren&#39;t NULL&lt;br&gt;\n\n&gt;         if (workQueueDataOnDis&lt;wbr&gt;k()&lt;br&gt;\n\n&gt;                 &amp;&amp; get(QUEUE_ASSIGNMEN&lt;wbr&gt;T_POLICY)&lt;wbr&gt;.maximumNumberOf&lt;wbr&gt;Keys() &gt;= 0&lt;br&gt;\n\n&gt;                 &amp;&amp; get(QUEUE_ASSIGNMEN&lt;wbr&gt;T_POLICY)&lt;wbr&gt;.maximumNumberOf&lt;wbr&gt;Keys() &lt;=&lt;br&gt;\n\n&gt;                     MAX_QUEUES_TO_&lt;wbr&gt;HOLD_ALLQUEUES_&lt;wbr&gt;IN_MEMORY) {&lt;br&gt;\n\n&gt;             this.allQueues = Collections.&lt;wbr&gt;synchronizedMap(&lt;br&gt;\n\n&gt;                     new HashMap&lt;String,&lt;wbr&gt;WorkQueue&gt;&lt;wbr&gt;());&lt;br&gt;\n\n&gt;         }/* else {  // commented out by Pratyush to allow normal flow.&lt;br&gt;\n\n&gt;             this.initAllQueues(&lt;wbr&gt;);&lt;br&gt;\n\n&gt;         }*/&lt;br&gt;\n\n&gt;         initQueue(recycle)&lt;wbr&gt;;&lt;br&gt;\n\n&gt;        &lt;br&gt;\n\n&gt;     }&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; Please do let me know if this looks okkay to you or not.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; ~regards&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; Pratyush&lt;br&gt;\n\n&gt; -----Original Message-----&lt;br&gt;\n\n&gt; From: Gordon Mohr &lt;&lt;a href=&quot;mailto:gojomo%40archive.org&quot;&gt;gojomo@archive.&lt;wbr&gt;org&lt;/a&gt;&gt;&lt;br&gt;\n\n&gt; To: &lt;a href=&quot;mailto:archive-crawler%40yahoogroups.com&quot;&gt;archive-crawler@&lt;wbr&gt;yahoogroups.&lt;wbr&gt;com&lt;/a&gt;&lt;br&gt;\n\n&gt; Sent: Wed, 7 May 2008 1:25 pm&lt;br&gt;\n\n&gt; Subject: Re: [archive-crawler] Exception in usage of &lt;br&gt;\n\n&gt; BucketQueueAssignme&lt;wbr&gt;ntPolicy in Heritrix-2.0.&lt;wbr&gt;0&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; I was able to reproduce the problem starting from a working,&lt;br&gt;\n\n&gt; nearly-default configuration and substituting&lt;br&gt;\n\n&gt; BucketQueueAssignme ntPolicy via the web UI&#39;s &#39;details&#39; option for the&lt;br&gt;\n\n&gt; &#39;root: .&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; The problem appears to be that the definition of certain shared modules&lt;br&gt;\n\n&gt; by name inside the root map -- specifically &#39;queue-assignment- policy&#39;&lt;br&gt;\n\n&gt; and then &#39;server-cache&#39; -- is in a problematic order once a&lt;br&gt;\n\n&gt; BucketQueueAssignme ntPolicy is introduced.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; The &#39;queue-assignment- policy&#39; comes first and unlike other policies,&lt;br&gt;\n\n&gt; BucketQueueAssignme ntPolicy needs a reference to a ServerCache. There&lt;br&gt;\n\n&gt; should only be one ServerCache, so an instance is created there, and all&lt;br&gt;\n\n&gt; later ServerCache references should refer back to it. However, the&lt;br&gt;\n\n&gt; immediately following &#39;server-cache&#39; definition inside the &#39;root&#39; map&lt;br&gt;\n\n&gt; can&#39;t be filled by autowire references, as the exception indicates.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; I&#39;m not certain if that&#39;s a truly necessary restriction, but a&lt;br&gt;\n\n&gt; workaround that removed the problem for me was to ensure that the&lt;br&gt;\n\n&gt; &#39;root:server- cache&#39; definition comes right before, rather than right&lt;br&gt;\n\n&gt; after, &#39;root:queue- assignment- policy&#39;.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; This can&#39;t be done via the web UI; I did it in the on-disk global.sheet&lt;br&gt;\n\n&gt; before attempting to swap in BucketQueueAssignme ntPolicy.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; A small test crawl with BucketQueueAssignme ntPolicy then launched and&lt;br&gt;\n\n&gt; completed.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; Hope this helps,&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; - Gordon @ IA&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&gt; Pratyush Banerjee wrote:&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; Hi Gordon,&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; Initially my application crashed due to selection of the&lt;br&gt;\n\n&gt;  &gt; BucketQueueAssignme ntPolicy. Obviously i had changed other default&lt;br&gt;\n\n&gt;  &gt; options like the&lt;br&gt;\n\n&gt;  &gt; Archiver, and the politeness settings including max-retry and&lt;br&gt;\n\n&gt;  &gt; retry-del;ay and fetch-http-timeout.&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; However after the application crashed i tried changing the&lt;br&gt;\n\n&gt;  &gt; queueAssignmentPoli cy in a frtesh installation of heritrix-2.0 and i&lt;br&gt;\n\n&gt;  &gt; chose the profile basic-seed-sites crawl. But still the app crashed with&lt;br&gt;\n\n&gt;  &gt; the same errors.&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; I also tried selecting optionally a BdbServerCache or a&lt;br&gt;\n\n&gt;  &gt; DefaultServerCache along with the BucketQueueAssignme ntPolicy but to no&lt;br&gt;\n\n&gt;  &gt; avail.&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; Pratyush&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; -----Original Message-----&lt;br&gt;\n\n&gt;  &gt; From: Gordon Mohr &lt;gojomo@archive. org &lt;&lt;a href=&quot;mailto:gojomo%?&quot;&gt;mailto:gojomo%&lt;/a&gt;&lt;wbr&gt;40archive.&lt;wbr&gt;org&gt;&gt;&lt;br&gt;\n\n&gt;  &gt; To: archive-crawler@ yahoogroups. com &lt;br&gt;\n\n&gt; &lt;&lt;a href=&quot;mailto:archive-?&quot;&gt;mailto:archive-&lt;/a&gt;&lt;wbr&gt;crawler%40yahoog&lt;wbr&gt;roups.com&gt;&lt;br&gt;\n\n&gt;  &gt; Sent: Wed, 7 May 2008 2:31 am&lt;br&gt;\n\n&gt;  &gt; Subject: Re: [archive-crawler] Exception in usage of&lt;br&gt;\n\n&gt;  &gt; BucketQueueAssignme ntPolicy in Heritrix-2.0. 0&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; I suspect this is a different issue entirely. Have you made other&lt;br&gt;\n\n&gt;  &gt; changes to the default configuration, besides specifying a&lt;br&gt;\n\n&gt;  &gt; BucketQueueAssignme ntPolicy?&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; Or is starting with a default configuration and only changing to&lt;br&gt;\n\n&gt;  &gt; BucketQueueAssignme ntPolicy enough to trigger this error on launch?&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; - Gordon @ IA&lt;br&gt;\n\n&gt;  &gt;&lt;br&gt;\n\n&gt;  &gt; Pratyush Banerjee wrote:&lt;br&gt;\n\n&gt;  &gt; &gt; Thanks Gordon for your prompt reply.&lt;br&gt;\n\n&gt;  &gt; &gt;&lt;br&gt;\n\n&gt;  &gt; &gt; I already tried the changes you suggested.? But that does not however&lt;br&gt;\n\n&gt;  &gt; solve the problem. I tried making the Key public and getting a&lt;br&gt;\n\n&gt;  &gt; KeyManager to add keys in a static block within the class.? The previous&lt;br&gt;\n\n&gt;  &gt; error was gone? obviously.&lt;br&gt;\n\n&gt;  &gt; &gt;&lt;br&gt;\n\n&gt;  &gt; &gt; But when i ran that code it again crashed giving me the following &lt;br&gt;\n\n&gt; error.&lt;br&gt;\n\n&gt;  &gt; &gt;&lt;br&gt;\n\n&gt;  &gt; &gt; java.lang.RuntimeEx ception: org.archive. settings. path.PathChangeE&lt;br&gt;\n\n&gt;  &gt; xception: Can&#39;t autowire map elements.&lt;br&gt;\n\n&gt;  &gt; &gt; ??? at org.archive. crawler.framewor k.EngineImpl. launchJob(&lt;br&gt;\n\n&gt;  &gt; EngineImpl. java:378)&lt;br&gt;\n\n&gt;  &gt; &gt; ??? at sun.reflect. NativeMethodAcce ssorImpl. invoke0(Native Method)&lt;br&gt;\n\n&gt;  &gt; &gt; ??? at sun.reflect. NativeMethodAcce ssorImpl. invoke(NativeMet&lt;br&gt;\n\n&gt;  &gt; hodAccessorImpl. java:39)&lt;br&gt;\n\n&gt; Plan your next roadtrip with MapQuest.com &lt;br&gt;\n\n&gt; &lt;&lt;a target=&quot;_blank&quot; href=&quot;http://www.mapquest.com/?ncid=mpqmap00030000000004&quot;&gt;http://www.mapquest&lt;wbr&gt;.com/?ncid=&lt;wbr&gt;mpqmap0003000000&lt;wbr&gt;0004&lt;/a&gt;&gt;: America&#39;s #1 &lt;br&gt;\n\n&gt; Mapping Site.&lt;br&gt;\n\n&gt; &lt;br&gt;\n\n&lt;/div&gt;\n\n    &lt;/div&gt;\n  \n\n    \n    &lt;span width=&quot;1&quot; style=&quot;color: white;&quot;&gt;&lt;/span&gt;\n    \n    \n&lt;style type=&quot;text/css&quot;&gt;#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mkp{  border: 1px solid #d8d8d8;  font-family: Arial;  margin: 14px 0px;  padding: 0px 14px;}#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mkp hr{  border: 1px solid #d8d8d8;}#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mkp #hd{  color: #628c2a;  font-size: 85%;  font-weight: bold;  line-height: 122%;  margin: 10px 0px;}#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mkp #ads{  margin-bottom: 10px;}#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mkp .ad{  padding: 0 0;}#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mkp .ad a{  color: #0000ff;  text-decoration: none;}&lt;/style&gt;\n\n&lt;style type=&quot;text/css&quot;&gt;#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor #ygrp-lc{  font-family: Arial;}#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor #ygrp-lc #hd{  margin: 10px 0px;  font-weight: bold;  font-size: 78%;  line-height: 122%;}#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor #ygrp-lc .ad{  margin-bottom: 10px;  padding: 0 0;}&lt;/style&gt;\n\n    &lt;style type=&quot;text/css&quot;&gt;     #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mlmsg {font-size:13px; font-family: arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small;} #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mlmsg table {font-size:inherit;font:100%;} #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mlmsg select,#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0  input,#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0  textarea {font:99% arial,helvetica,clean,sans-serif;} #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mlmsg pre,#AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0  code {font:115% monospace;*font-size:100%;} #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mlmsg * {line-height:1.22em;} #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-text{     font-family: Georgia;  } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-text p{     margin: 0 0 1em 0; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-tpmsgs{     font-family: Arial;      clear: both; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vitnav{  padding-top: 10px;  font-family: Verdana;  font-size: 77%;  margin: 0; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vitnav a{  padding: 0 1px; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-actbar{  clear: both;  margin: 25px 0;  white-space:nowrap;  color: #666;  text-align: right; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-actbar .left{  float: left;  white-space:nowrap; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 .bld{font-weight:bold;} #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-grft{  font-family: Verdana;  font-size: 77%;  padding: 15px 0; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-ft{   font-family: verdana;   font-size: 77%;   border-top: 1px solid #666;    padding: 5px 0;  } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-mlmsg #logo{   padding-bottom: 10px; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-reco { margin-bottom: 20px; padding: 0px; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-reco #reco-head {  font-weight: bold;  color: #ff7900; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #reco-grpname{        font-weight: bold;        margin-top: 10px;   } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #reco-category{         font-size: 77%; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #reco-desc{         font-size: 77%; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vital{  background-color: #e0ecee;  margin-bottom: 20px;  padding: 2px 0 8px 8px; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vital #vithd{  font-size: 77%;  font-family: Verdana;  font-weight: bold;  color: #333;  text-transform: uppercase; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vital ul{  padding: 0;  margin: 2px 0; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vital ul li{   list-style-type: none;   clear: both;   border: 1px solid #e0ecee;   } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vital ul li .ct{   font-weight: bold;   color: #ff7900;   float: right;   width: 2em;   text-align:right;   padding-right: .5em; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vital ul li .cat{   font-weight: bold; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vital a{  text-decoration: none; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-vital a:hover{   text-decoration: underline; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor #hd{  color: #999;  font-size: 77%; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor #ov{  padding: 6px 13px;  background-color: #e0ecee;  margin-bottom: 20px; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor #ov ul{  padding: 0 0 0 8px;  margin: 0; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor #ov li{  list-style-type: square;  padding: 6px 0;  font-size: 77%; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor #ov li a{  text-decoration: none;  font-size: 130%; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor #nc{   background-color: #eee;   margin-bottom: 20px;   padding: 0 8px; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor .ad{  padding: 8px 0; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor .ad #hd1{  font-family: Arial;  font-weight: bold;  color: #628c2a;  font-size: 100%;  line-height: 122%; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor .ad a{  text-decoration: none; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor .ad a:hover{  text-decoration: underline; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-sponsor .ad p{  margin: 0; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 o{font-size: 0; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 .MsoNormal{    margin: 0 0 0 0; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 #ygrp-text tt{   font-size: 120%; } #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 blockquote{margin: 0 0 0 4px;} #AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 .replbq{margin:4}     &lt;/style&gt;\n    &lt;/div&gt;\n &lt;!-- end of AOLMsgPart_2_9432237d-ed36-4a2b-9f64-e805ccb950b0 --&gt;\n\n&lt;div id=&#39;u8CA7EE7FC0F84E3-490-2584&#39; class=&#39;aol_ad_footer&#39;&gt;&lt;FONT style=&quot;color: black; font: normal 10pt ARIAL, SAN-SERIF;&quot;&gt;&lt;HR style=&quot;MARGIN-TOP: 10px&quot;&gt;Plan your next roadtrip with &lt;A title=&quot;http://www.mapquest.com/?ncid=mpqmap00030000000004&quot; href=&quot;http://www.mapquest.com/?ncid=mpqmap00030000000004&quot; target=&quot;_blank&quot;&gt;MapQuest.com&lt;/A&gt;: America&#39;s #1 Mapping Site.&lt;/FONT&gt; &lt;/div&gt;\n\r\n----------MB_8CA7EE7FD300443_490_4AAD_webmail-nf16.sim.aol.com--\r\n\n"}}