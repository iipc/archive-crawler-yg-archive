{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":168599281,"authorName":"stack","from":"stack &lt;stack@...&gt;","profile":"stackarchiveorg","replyTo":"LIST","senderId":"o--VTKqMyGtW3NKzVUyxd8LGBTik6QP4WlNVJGxrnnZxMhUC7EIX-A1OggcPcAubiiZJ3nGJo2TKimHNbmyEpQ","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] Recovering a Job","postDate":"1134513210","msgId":2428,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQzOUY0QzNBLjcwNDA0MDdAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDAwMzAwMWM2MDAxYSQ1N2Q5MGQzMCQ3OTAxMTkwYUB4c2JpbnRlcm5hbC5jb20+","referencesHeader":"PDAwMzAwMWM2MDAxYSQ1N2Q5MGQzMCQ3OTAxMTkwYUB4c2JpbnRlcm5hbC5jb20+"},"prevInTopic":2427,"nextInTopic":2429,"prevInTime":2427,"nextInTime":2429,"topicId":2368,"numMessagesInTopic":19,"msgSnippet":"... This would probably be better done in your own CrawlJobHandler in the crawlEnded. This is how the selftest works It notices end of crawl then goes off to","rawEmail":"Return-Path: &lt;stack@...&gt;\r\nX-Sender: stack@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 258 invoked from network); 13 Dec 2005 21:44:32 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m26.grp.scd.yahoo.com with QMQP; 13 Dec 2005 21:44:32 -0000\r\nReceived: from unknown (HELO ia00524.archive.org) (207.241.224.171)\n  by mta4.grp.scd.yahoo.com with SMTP; 13 Dec 2005 21:44:32 -0000\r\nReceived: (qmail 4317 invoked by uid 100); 13 Dec 2005 21:38:00 -0000\r\nReceived: from adsl-71-130-102-78.dsl.pltn13.pacbell.net (HELO ?192.168.1.8?) (stack@...@71.130.102.78)\n  by mail-dev.archive.org with SMTP; 13 Dec 2005 21:38:00 -0000\r\nMessage-ID: &lt;439F4C3A.7040407@...&gt;\r\nDate: Tue, 13 Dec 2005 14:33:30 -0800\r\nUser-Agent: Debian Thunderbird 1.0.7 (X11/20051017)\r\nX-Accept-Language: en-us, en\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;003001c6001a$57d90d30$7901190a@...&gt;\r\nIn-Reply-To: &lt;003001c6001a$57d90d30$7901190a@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-Spam-DCC: : \r\nX-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on ia00524.archive.org\r\nX-Spam-Level: \r\nX-Spam-Status: No, hits=-96.1 required=7.0 tests=AWL,USER_IN_WHITELIST \n\tautolearn=no version=2.63\r\nX-eGroups-Msg-Info: 2:12:4:0\r\nFrom: stack &lt;stack@...&gt;\r\nSubject: Re: [archive-crawler] Recovering a Job\r\nX-Yahoo-Group-Post: member; u=168599281; y=uabYqEjuPE5Wl_fTwFC6o0DdeTkNfTnEyy6jr6YVVCd49J25CAGjwHSg\r\nX-Yahoo-Profile: stackarchiveorg\r\n\r\nAlex wrote:\n\n&gt; Hi Stack,\n&gt;\n&gt; One other thing, I will need to do some behavior at the end of the\n&gt; checkpointing.  I could do this in the event queue, but if you make it so\n&gt; that the CrawlController is easily overridable then this should suffice as\n&gt; well.\n\nThis would probably be better done in your own CrawlJobHandler in the \ncrawlEnded. This is how the selftest works It notices end of crawl then \ngoes off to do its examination of what was crawled. Or you could \nregister with CrawlController an implementation of the \nCrawlStatusListener (Or I could add notifications of checkpointing to \nJMX notifications).\n\nAdding a constructor to Heritrix that allows you add your own CJH would \nbe cleaner than the way it currently works where we have the \nsetJobHandler method (Would likely avoid the race condition you talked \nof in an earlier mail).  I could add this but you are using \nHeritrix#main to setup the crawler.  You are not using Heritrix \nconstructors directly. Thats why I was asking about why you were not \ndoing &#39;new Heritrix(...)&#39;.  Was it not working for you?\n\nRegistering a CrawlStatusListener should be easy enough.  You&#39;d probably \nmiss out on the first few crawlStarting messages but you probably don&#39;t \ncare.\n\nYours,\nSt.Ack\n\n\n&gt;\n&gt; Thanks,\n&gt; Alex\n&gt;\n&gt; &gt; -----Original Message-----\n&gt; &gt; From: archive-crawler@yahoogroups.com\n&gt; &gt; [mailto:archive-crawler@yahoogroups.com] On Behalf Of stack\n&gt; &gt; Sent: Tuesday, December 13, 2005 12:48 PM\n&gt; &gt; To: archive-crawler@yahoogroups.com\n&gt; &gt; Subject: Re: [archive-crawler] Recovering a Job\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; Alex wrote:\n&gt; &gt; &gt; Hi Stack,\n&gt; &gt; &gt;\n&gt; &gt; &gt; So are you suggesting using the CrawlController instead of a\n&gt; &gt; &gt; CrawlJobHandler in general?  I understand how it feels a\n&gt; &gt; little weird\n&gt; &gt; &gt; with the state being modified with the event queue.  If you\n&gt; &gt; could give\n&gt; &gt; &gt; me a little bit more insight on what you are suggesting.\n&gt; &gt; &gt;\n&gt; &gt; I was thinking there&#39;d be an &#39;atomic&#39; checkpoint that takes\n&gt; &gt; care of the\n&gt; &gt; pause, checkpoint, resume steps -- with handling for interruptions by\n&gt; &gt; operator, etc. It would live in CrawlController.  Let me try\n&gt; &gt; and work on\n&gt; &gt; this today.\n&gt; &gt;\n&gt; &gt; That would leave running a timer that on a period invokes this\n&gt; &gt; overarching checkpoint.  Could be started by the CrawlController if\n&gt; &gt; appropriate config. in heritrix.properties (The timer should probably\n&gt; &gt; live in CC too).\n&gt; &gt;\n&gt; &gt; What you think?\n&gt; &gt;\n&gt; &gt; St.Ack\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; &gt; I agree with the logging, quick and dirty, added recently, locally.\n&gt; &gt; &gt;\n&gt; &gt; &gt; Thanks,\n&gt; &gt; &gt; Alex\n&gt; &gt; &gt;\n&gt; &gt; &gt;  &gt; On your classes:\n&gt; &gt; &gt;  &gt;\n&gt; &gt; &gt;  &gt; Looks like you&#39;ve added to the crawlPaused method in your  &gt;\n&gt; &gt; &gt; CrawlJobHandler override a check to see if a request to  &gt;\n&gt; &gt; checkpoint\n&gt; &gt; &gt; has  &gt; been set and if so, you run checkpointing.\n&gt; &gt; Checkpointing runs,\n&gt; &gt; &gt;  &gt; crawlCheckpoint is called in your CJH override and you set\n&gt; &gt; &gt;  &gt; &#39;shouldResume&#39; to true so that when crawlPaused is\n&gt; &gt; called again after\n&gt; &gt; &gt;  &gt; checkpointing has completed, you&#39;re override invokes resume\n&gt; &gt; &gt;  &gt; (I like your\n&gt; &gt; &gt;  &gt; use of java.util.Timer).\n&gt; &gt; &gt;  &gt;\n&gt; &gt; &gt;  &gt; One suggestion I&#39;d make is that changing/managing crawler\n&gt; &gt; &gt;  &gt; state should\n&gt; &gt; &gt;  &gt; be done by the CrawlController rather than out of the\n&gt; &gt; state change\n&gt; &gt; &gt;  &gt; methods in CJH (CrawlController is overrideable. See\n&gt; &gt; &gt;  &gt; CrawlJob#setupForCrawlStart where we override CC so we can remove\n&gt; &gt; &gt;  &gt; registered MBeans).\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;  &gt; Would also suggest using a java.util logger in place of\n&gt; &gt; calls to  &gt;\n&gt; &gt; &gt; System.out.err.  &gt;\n&gt; &gt; &gt;  &gt; Calling Heritrix#main is working fine for you?  Any\n&gt; &gt; reason you don&#39;t\n&gt; &gt; &gt;  &gt; want to do &#39;new Heritrix()&#39; only?  Did you try it?\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; SPONSORED LINKS\n&gt; &gt; &gt; Computer internet security\n&gt; &gt; &gt;\n&gt; &gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+securit \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+securit&gt;\n&gt; &gt; y&w1=Computer+internet+security&w2=Computer+internet+business&\n&gt; &gt; w3=Computer+internet+access&w4=Computer+internet+help&c=4&s=12\n&gt; &gt; 2&.sig=fQlbV6UXiuarNtoxIqj5Ew&gt;\n&gt; &gt; &gt;       Computer internet business\n&gt; &gt; &gt;\n&gt; &gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+busines \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+busines&gt;\n&gt; &gt; s&w1=Computer+internet+security&w2=Computer+internet+business&\n&gt; &gt; w3=Computer+internet+access&w4=Computer+internet+help&c=4&s=12\n&gt; &gt; 2&.sig=TJtUvUPdqjaz8ZJRC_SQ2A&gt;\n&gt; &gt; &gt;       Computer internet access\n&gt; &gt; &gt;\n&gt; &gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+access& \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+access&&gt;\n&gt; &gt; w1=Computer+internet+security&w2=Computer+internet+business&w3\n&gt; &gt; =Computer+internet+access&w4=Computer+internet+help&c=4&s=122&\n&gt; ..sig=GtMYFi2Aij3DpAAcG75g1Q&gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; Computer internet help\n&gt; &gt; &gt;\n&gt; &gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+help&w1 \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+help&w1&gt;\n&gt; &gt; =Computer+internet+security&w2=Computer+internet+business&w3=C\n&gt; omputer+internet+access&w4&gt;\n&gt; =Computer+internet+help&c=4&s=122&.sig=AphsIa89Q01m6trU2VeGlA&gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; ----------------------------------------------------------------------\n&gt; &gt; &gt; --\n&gt; &gt; &gt; YAHOO! GROUPS LINKS\n&gt; &gt; &gt;\n&gt; &gt; &gt;     *  Visit your group &quot;archive-crawler\n&gt; &gt; &gt;       &lt;http://groups.yahoo.com/group/archive-crawler&gt;&quot; on the web.\n&gt; &gt; &gt;       \n&gt; &gt; &gt;     *  To unsubscribe from this group, send an email to:\n&gt; &gt; &gt;        archive-crawler-unsubscribe@yahoogroups.com\n&gt; &gt; &gt;      \n&gt; &gt; &gt;\n&gt; &gt; &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Un\n&gt; subscribe&gt;\n&gt; &gt;       \n&gt; &gt;     *  Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt; &gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; ----------------------------------------------------------------------\n&gt; &gt; --\n&gt; &gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------------------------------------------\n&gt; YAHOO! GROUPS LINKS\n&gt;\n&gt;     *  Visit your group &quot;archive-crawler\n&gt;       &lt;http://groups.yahoo.com/group/archive-crawler&gt;&quot; on the web.\n&gt;        \n&gt;     *  To unsubscribe from this group, send an email to:\n&gt;        archive-crawler-unsubscribe@yahoogroups.com\n&gt;       &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;\n&gt;        \n&gt;     *  Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt;\n&gt;\n&gt; ------------------------------------------------------------------------\n&gt;\n\n\n"}}