{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":354174125,"authorName":"matthewyau12","from":"&quot;matthewyau12&quot; &lt;matthewyau12@...&gt;","profile":"matthewyau12","replyTo":"LIST","senderId":"cEjcqWfbn1HWG8naQ2ItUgatYxBULYSo1xgnEt7sgFIwvmsJbSauyaoS4-MMthFvJtZqMHgrGq5R1ClHb4Y5BNfJcsS-J4AvVlzLb1c6qIAJ","spamInfo":{"isSpam":false,"reason":"6"},"subject":"inserting content information into a mysql database","postDate":"1268842680","msgId":6437,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGhucXZibytmbWE4QGVHcm91cHMuY29tPg=="},"prevInTopic":0,"nextInTopic":6439,"prevInTime":6436,"nextInTime":6438,"topicId":6437,"numMessagesInTopic":2,"msgSnippet":"hi, I am trying to do something similar with your work and inserting content information into a mysql database. I am able to see the JDBC setting in user","rawEmail":"Return-Path: &lt;matthewyau12@...&gt;\r\nX-Sender: matthewyau12@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 71693 invoked from network); 17 Mar 2010 16:18:06 -0000\r\nX-Received: from unknown (98.137.34.44)\n  by m12.grp.re1.yahoo.com with QMQP; 17 Mar 2010 16:18:06 -0000\r\nX-Received: from unknown (HELO n44d.bullet.mail.sp1.yahoo.com) (66.163.169.158)\n  by mta1.grp.sp2.yahoo.com with SMTP; 17 Mar 2010 16:18:06 -0000\r\nX-Received: from [69.147.65.149] by n44.bullet.mail.sp1.yahoo.com with NNFMP; 17 Mar 2010 16:18:02 -0000\r\nX-Received: from [98.137.35.12] by t9.bullet.mail.sp1.yahoo.com with NNFMP; 17 Mar 2010 16:18:02 -0000\r\nDate: Wed, 17 Mar 2010 16:18:00 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;hnqvbo+fma8@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: &quot;matthewyau12&quot; &lt;matthewyau12@...&gt;\r\nSubject: inserting content information into a mysql database\r\nX-Yahoo-Group-Post: member; u=354174125; y=uWYXpFkNCJvZztljFdiXhAnTc7heYeWyHuwqEqXAcfl9Cqb__fv2\r\nX-Yahoo-Profile: matthewyau12\r\n\r\nhi,\n\nI am trying to do something similar with your work and inserting conte=\r\nnt information into a mysql database. I am able to see the JDBC setting in =\r\nuser interface. However, I can not insert the content into database, and I =\r\nhave placed the mysql-connector-java-5.0.8-bin.jar to the library in &#92;herit=\r\nrix-1.14.3&#92;lib. I can not find any error message in the heritrix windows bu=\r\nt some warning message (org.arhive.rawler.settings.CrawlerSettingsSAXHandle=\r\nr$SimpleElementHandler endElement Unknown attribute &#39;com.mysql.jdbc.Driver&#39;=\r\n in file:../order.xml&#39; line: 234, column: 76\n\nAttached please find a java f=\r\nile.\n\nThx\nMat\n\npackage org.archive.crawler.writer;\n\nimport org.archive.craw=\r\nler.datamodel.CoreAttributeConstants;\nimport org.archive.crawler.datamodel.=\r\nCrawlURI;\nimport org.archive.crawler.framework.Processor;\nimport org.archiv=\r\ne.crawler.settings.SimpleType;\nimport org.archive.io.RecordingInputStream;\n=\r\nimport org.archive.io.ReplayInputStream;\nimport org.archive.net.UURI;\n\n\n\nim=\r\nport java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java=\r\n.sql.*;\nimport java.util.logging.Logger ;\nimport javax.management.Attribute=\r\nNotFoundException;\n\n/**\n* Processor module that writes the results of succe=\r\nssful fetches to\n* Database via JDBC.\n*/\npublic class JDBCWriterProcessor \n=\r\nextends Processor implements CoreAttributeConstants {\n\nprivate static final=\r\n long serialVersionUID =3D 111407556238389168L;\n\n/**\n* Key to use asking se=\r\nttings for JDBC driver.\n*/\npublic static final String ATTR_JDBC_DRIVER =3D =\r\n&quot;com.mysql.jdbc.Driver&quot;;\n\n/**\n* Key to use asking settings for JDBC URL.\n*/=\r\n\npublic static final String ATTR_JDBC_URL =3D &quot;jdbc:mysql://localhost/&quot;;\n\n/=\r\n/ Key to use asking database name\npublic static final String ATTR_JDBC_DBNA=\r\nME =3D &quot;northwind&quot;;\n\n// Key to use asking table name\npublic static final St=\r\nring ATTR_JDBC_TBNAME =3D &quot;testing&quot;;\n\n/**\n* Key to use asking settings for =\r\nusername.\n*/\npublic static final String ATTR_JDBC_USERNAME =3D &quot;root&quot;;\n\n/**=\r\n\n* Key to use asking settings for passwd.\n*/\npublic static final String ATT=\r\nR_JDBC_PASSWD =3D &quot;zxc&quot;;\n\n/**\n* Logger.\n*/\nprivate static final Logger logg=\r\ner =3D\nLogger.getLogger(JDBCWriterProcessor.class.getName());\n\n/**\n* @param=\r\n name Name of this processor.\n*/\npublic JDBCWriterProcessor(String name) {\n=\r\n//for adding attributes to heritrix processor, appears in WebUI&#92;\n//be sure =\r\nto define variables in the format up above first.\nsuper(name, &quot;JDBCWriter p=\r\nrocessor. &quot; +\n&quot;A writer that writes each URL to database via jdbc &quot;);\naddEl=\r\nementToDefinition(new SimpleType(ATTR_JDBC_DRIVER,\n&quot;jdbc driver name&quot;, &quot;com=\r\n.mysql.jdbc.Driver&quot;));\naddElementToDefinition(new SimpleType(ATTR_JDBC_URL,=\r\n\n&quot;jdbc url in this form:jdbc:databasetype://URL_to_db:port/&quot;, &quot;&quot;));\n//the l=\r\nast / is necessary after port b/c the full URL of a jdbc is\n//jdbc:database=\r\ntype://URL_to_db:port/db_name\naddElementToDefinition(new SimpleType(ATTR_JD=\r\nBC_DBNAME,\n&quot;database name&quot;, &quot;&quot;));\naddElementToDefinition(new SimpleType(ATT=\r\nR_JDBC_TBNAME,\n&quot;table name&quot;, &quot;&quot;));\naddElementToDefinition(new SimpleType(AT=\r\nTR_JDBC_USERNAME,\n&quot;username&quot;, &quot;&quot;));\naddElementToDefinition(new SimpleType(A=\r\nTTR_JDBC_PASSWD,\n&quot;password&quot;, &quot;&quot;));\n}\n\nprotected void innerProcess(CrawlURI =\r\ncuri) {\nif (!curi.isSuccess()) {\nreturn;\n}\nUURI uuri =3D curi.getUURI(); //=\r\n Current URI.\n\n// Only http and https schemes are supported.\nString scheme =\r\n=3D uuri.getScheme();\nif (!&quot;http&quot;.equalsIgnoreCase(scheme)\n&& !&quot;https&quot;.equa=\r\nlsIgnoreCase(scheme)) {\nreturn;\n}\n\n//Only xml file will store in database, =\r\nchange this expression to accept different content types\nString contenttype=\r\n =3D curi.getContentType();\nif (null =3D=3D contenttype ||\n!&quot;application/xm=\r\nl&quot;.equalsIgnoreCase(contenttype)) {\nreturn;\n}\n\nRecordingInputStream recis =\r\n=3D\ncuri.getHttpRecorder().getRecordedInput();\nif (0L =3D=3D recis.getRespo=\r\nnseContentLength()) {\nreturn;\n}\n\ntry {\nwriteToDatabase(curi); //calls the f=\r\nunction write to database\n} catch (IOException e) {\nlogger.warning(e.getLoc=\r\nalizedMessage());\n}\n}\n\n/**\n* write into database\n*\n* @param curi the curi t=\r\nhat recorded the contents\n* of the resource\n* @throws java.io.IOException w=\r\nhen something error;\n*/\nprivate void writeToDatabase(CrawlURI curi) throws =\r\nIOException {\nReplayInputStream replayis =3D\ncuri.getHttpRecorder().getReco=\r\nrdedInput().getContentReplayInputStream();\nByteArrayOutputStream sContent =\r\n=3D new ByteArrayOutputStream();\n\ntry {\nreplayis.readContentTo(sContent);\n}=\r\n finally {\nreplayis.close();\n}\n\nConnection conn =3D null;\nPreparedStatement=\r\n stmt =3D null;\n//calls a function getAttrValue to set each variable from w=\r\nebUI settings\nString driver =3D getAttrValue(ATTR_JDBC_DRIVER);\nString URL =\r\n=3D getAttrValue(ATTR_JDBC_URL);\nString db =3D getAttrValue(ATTR_JDBC_DBNAM=\r\nE);\nString table =3D getAttrValue(ATTR_JDBC_TBNAME);\nString user =3D getAtt=\r\nrValue(ATTR_JDBC_USERNAME);\nString pass =3D getAttrValue(ATTR_JDBC_PASSWD);=\r\n\n\nSystem.out.println(driver+&quot; &quot;+URL+&quot; &quot;+db+&quot; &quot;+table+&quot; &quot;+user+&quot; &quot;+pass);\ntr=\r\ny {// ERROR OCCURS HERE DUE TO INABILITY TO SEE THE DRIVER\nClass.forName(dr=\r\niver); //loads the JDBC driver.\n} catch (Exception e) {\n//handle error\nSyst=\r\nem.out.println(&quot;Failed to load JDBC Driver.&quot;);\nlogger.warning(e.getLocalize=\r\ndMessage());\n}\ntry {\nconn =3D DriverManager.getConnection(URL+db,user,pass)=\r\n;\n//insert into table section, change if column names are\n//different\n//Not=\r\ne this assumes you already made the table with these columns\n\nstmt =3D conn=\r\n.prepareStatement(&quot;INSERT INTO&quot;+table+&quot;(site,url,content,creation_date) VAL=\r\nUES(?,?,?,NOW())&quot;);\nstmt.setString(1, curi.getUURI().getHost()); //contains=\r\n host\n//address\nstmt.setString(2, curi.getUURI().getURI()); //contains\n//UR=\r\nL of content\nstmt.setString(3, sContent.toString()); //contains actual\n//co=\r\nntent of the page\nstmt.executeUpdate();\nstmt.close();\nconn.close();\n} catch=\r\n (SQLException ex) {\nlogger.warning(curi.getUURI().getURI() + &quot;--&gt;&quot; +\nex.ge=\r\ntLocalizedMessage());\nSystem.out.println(&quot;SQLException: &quot; + ex.getMessage()=\r\n);\nSystem.out.println(&quot;SQLState: &quot; + ex.getSQLState());\nSystem.out.println(=\r\n&quot;VendorError: &quot; + ex.getErrorCode());\n} finally {\n/*\n* close any jdbc insta=\r\nnces here that weren&#39;t\n* explicitly closed during normal code path, so\n* th=\r\nat we don&#39;t &#39;leak&#39; resources...\n*/\nif (stmt !=3D null) {\ntry {\nstmt.close()=\r\n;\n} catch (SQLException sqlex) {\n// ignore -- as we can&#39;t do anything about=\r\n it here\n}\nstmt =3D null;\n}\nif (conn !=3D null) {\ntry {\nconn.close();\n} cat=\r\nch (SQLException sqlex) {\n// ignore -- as we can&#39;t do anything about it her=\r\ne\n}\nconn =3D null;\n}\n}\n} //function writeToDB ends\n\npublic String getAttrVa=\r\nlue(String settingvalue) {\n//function gets and sets the attribute values en=\r\ntered in webUI,\n//other similar functions with different return types can b=\r\ne used\n//if needed.\nString varname =3D null;\ntry {\nvarname =3D ((String) ge=\r\ntAttribute(settingvalue));\n} catch (AttributeNotFoundException e) {\nlogger.=\r\nwarning(e.getLocalizedMessage());\n} finally { return varname; }\n}\n}// end o=\r\nf class\n\n\n\n"}}