{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":145406984,"authorName":"Alex","from":"&quot;Alex&quot; &lt;a.beggs.ml@...&gt;","profile":"SUNYAl","replyTo":"LIST","senderId":"0tlrYzW8xUfiFSn-c6NsJlfiXG9OJKsDi5rmc-gF9bjSUqCNQIcRHKgJ28Mwvu3LygR6NNxdxrX78lJRXD_C9VN2","spamInfo":{"isSpam":false,"reason":"12"},"subject":"RE: [archive-crawler] Recovering a Job","postDate":"1134413851","msgId":2413,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDAwMTYwMWM1ZmY0ZCRlYWMzYzNiMCQ3OTAxMTkwYUB4c2JpbnRlcm5hbC5jb20+","inReplyToHeader":"PDQzOTc0MzgzLjYwMzAzMDNAYXJjaGl2ZS5vcmc+"},"prevInTopic":2400,"nextInTopic":2417,"prevInTime":2412,"nextInTime":2414,"topicId":2368,"numMessagesInTopic":19,"msgSnippet":"Hi Stack, I wrote some code that automates the task of checkpointing at certain points of time during the crawl.  My method was a little more complicated than","rawEmail":"Return-Path: &lt;a.beggs.ml@...&gt;\r\nX-Sender: a.beggs.ml@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 29126 invoked from network); 12 Dec 2005 18:52:17 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m27.grp.scd.yahoo.com with QMQP; 12 Dec 2005 18:52:17 -0000\r\nReceived: from unknown (HELO mx1.portjeff.net) (216.168.142.133)\n  by mta4.grp.scd.yahoo.com with SMTP; 12 Dec 2005 18:52:17 -0000\r\nReceived: from localhost (localhost [127.0.0.1])\n\tby mx1.portjeff.net (Postfix) with ESMTP id 9D21971C59\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Mon, 12 Dec 2005 13:53:32 -0500 (EST)\r\nReceived: from mx1.portjeff.net ([127.0.0.1])\n by localhost (mx1.portjeff.net [127.0.0.1]) (amavisd-new, port 10024)\n with ESMTP id 27985-20 for &lt;archive-crawler@yahoogroups.com&gt;;\n Mon, 12 Dec 2005 13:53:29 -0500 (EST)\r\nReceived: from xsb.com (mail.portjeff.net [216.168.142.132])\n\tby mx1.portjeff.net (Postfix) with ESMTP id C259671BF0\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Mon, 12 Dec 2005 13:53:29 -0500 (EST)\r\nReceived: from xsbabeggs340 [129.49.16.170] by xsb.com with ESMTP\n  (SMTPD32-7.15) id A5FB13980092; Mon, 12 Dec 2005 13:48:27 -0500\r\nTo: &lt;archive-crawler@yahoogroups.com&gt;\r\nDate: Mon, 12 Dec 2005 13:57:31 -0500\r\nMessage-ID: &lt;001601c5ff4d$eac3c3b0$7901190a@...&gt;\r\nMIME-Version: 1.0\r\nContent-Type: multipart/mixed;\n\tboundary=&quot;----=_NextPart_000_0017_01C5FF24.01EDBBB0&quot;\r\nX-Priority: 3 (Normal)\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook, Build 10.0.6626\r\nIn-Reply-To: &lt;43974383.6030303@...&gt;\r\nImportance: Normal\r\nX-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2180\r\nX-Virus-Scanned: amavisd-new at portjeff.net\r\nX-eGroups-Msg-Info: 1:12:0:0\r\nFrom: &quot;Alex&quot; &lt;a.beggs.ml@...&gt;\r\nSubject: RE: [archive-crawler] Recovering a Job\r\nX-Yahoo-Group-Post: member; u=145406984; y=xmglmcBhD7R2e9W6lkskSpR12CBwM-m9pI9qVewzzSW9\r\nX-Yahoo-Profile: SUNYAl\r\n\r\n\r\n------=_NextPart_000_0017_01C5FF24.01EDBBB0\r\nContent-Type: text/plain;\n\tcharset=&quot;us-ascii&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nHi Stack,\n\nI wrote some code that automates the task of checkpointing at ce=\r\nrtain points\nof time during the crawl.  My method was a little more complic=\r\nated than the\none you suggested.  Some modifications to the code is require=\r\nd such as\nHeritrix.setJobHandler needs to be public.  I created a JobHandle=\r\nr that\ndeals with checkpointing the job at certain points during the run.  =\r\nI am\nattaching the first draft of my code, if you could let me know what yo=\r\nu\nthink.  \n\n1. I did find a &#39;bug&#39; with the base code, in the class \n\norg.ar=\r\nchive.crawler.framework.CrawlController\n\nThe method \n\nwriteCheckpoint()\n\nCa=\r\nlls \n\ncheckpointTo(Context)\n\nWhich at the end of the method calls completeP=\r\nause which invokes a Pause\nevent to be fired, which I am listening for, but=\r\n after this is called\nThe status is set to PAUSE back in the finally of \n\nw=\r\nriteCheckpoint()\n\n------------------- Current Implementation --------------=\r\n-----------\n  protected void writeCheckpoint() {\n        cpContext.begin();=\r\n\n        try {\n            this.checkpointTo(cpContext);  // calls complete=\r\nPause() (this\nshouldn&#39;t happen in this method)\n        } catch (Exception e=\r\n) {\n            cpContext.checkpointFailed(e);\n        } finally {\n        =\r\n    cpContext.end();\n            this.state =3D PAUSED;            \n       =\r\n }\n    }\n\n\n------------------- Should be -------------------------\n\n  prote=\r\ncted void writeCheckpoint() {\n        cpContext.begin();\n        try {\n    =\r\n        this.checkpointTo(cpContext); // should not call\ncompletePause!!!\n =\r\n       } catch (Exception e) {\n            cpContext.checkpointFailed(e);\n =\r\n       } finally {\n            cpContext.end();\n            // this.state =\r\n=3D PAUSED;\n            completePause();\n        }\n    }\n\n-----------------=\r\n-----------------------\n\nI use the event handling to determine the state, a=\r\nnd since it is in pause, I\ncall requestCrawlResume\nbut then it sets it back=\r\n to PAUSED without a notification, causing it to be\nin a weird state.\n\n\n2. =\r\nThe other problem I did run across was setting the JobHandler seemed to\nhav=\r\ne a race condition, on which was used, the original or the new one being\nse=\r\nt.  Not sure why.\n\nAlex\n\n\n\n\r\n------=_NextPart_000_0017_01C5FF24.01EDBBB0\r\nContent-Type: application/octet-stream;\n\tname=&quot;HeritrixRunner.java&quot;\r\nContent-Disposition: attachment;\n\tfilename=&quot;HeritrixRunner.java&quot;\r\n\r\n[ Attachment content not displayed ]\r\n------=_NextPart_000_0017_01C5FF24.01EDBBB0\r\nContent-Type: application/octet-stream;\n\tname=&quot;CheckpointCrawlJobHandler.java&quot;\r\nContent-Disposition: attachment;\n\tfilename=&quot;CheckpointCrawlJobHandler.java&quot;\r\n\r\n[ Attachment content not displayed ]\r\n------=_NextPart_000_0017_01C5FF24.01EDBBB0--\r\n\n"}}