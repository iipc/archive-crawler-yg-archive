{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":132996324,"authorName":"joehung302","from":"&quot;joehung302&quot; &lt;joe.hung@...&gt;","profile":"joehung302","replyTo":"LIST","senderId":"Bl6Y6GB9QkKS9RXV0ED0Qfd3tC_auJqmTpSCkBo4dsEqBquKtklRRXzHOh4C6DSc-I_GwENixd2M2sqH27gX4Ycmn-10I-619qfVYu6q","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: very busy IO when running 1.4","postDate":"1116569755","msgId":1855,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGQ2anZhcitvcmhyQGVHcm91cHMuY29tPg==","inReplyToHeader":"PGQ2ajdnMis4ZzZjQGVHcm91cHMuY29tPg=="},"prevInTopic":1853,"nextInTopic":1858,"prevInTime":1854,"nextInTime":1856,"topicId":1843,"numMessagesInTopic":11,"msgSnippet":"Some further analysis. I paused the crawler and did a few kill -3 on the supposed-doing-nothing crawler. The only thread that is always runnable is the je","rawEmail":"Return-Path: &lt;joe.hung@...&gt;\r\nX-Sender: joe.hung@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 98570 invoked from network); 20 May 2005 06:15:57 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m24.grp.scd.yahoo.com with QMQP; 20 May 2005 06:15:57 -0000\r\nReceived: from unknown (HELO n31.bulk.scd.yahoo.com) (66.94.237.60)\n  by mta1.grp.scd.yahoo.com with SMTP; 20 May 2005 06:15:57 -0000\r\nComment: DomainKeys? See http://antispam.yahoo.com/domainkeys\r\nReceived: from [66.218.66.59] by n31.bulk.scd.yahoo.com with NNFMP; 20 May 2005 06:15:56 -0000\r\nReceived: from [66.218.66.77] by mailer8.bulk.scd.yahoo.com with NNFMP; 20 May 2005 06:15:56 -0000\r\nDate: Fri, 20 May 2005 06:15:55 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;d6jvar+orhr@...&gt;\r\nIn-Reply-To: &lt;d6j7g2+8g6c@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Length: 6779\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:12:0\r\nFrom: &quot;joehung302&quot; &lt;joe.hung@...&gt;\r\nSubject: Re: very busy IO when running 1.4\r\nX-Yahoo-Group-Post: member; u=132996324\r\nX-Yahoo-Profile: joehung302\r\n\r\nSome further analysis. I paused the crawler and did a few kill -3 on \nthe supposed-doing-nothing crawler. The only thread that is always \nrunnable is the je &quot;cleaner&quot; thread:\n\n&quot;Cleaner&quot; daemon prio=1 tid=0x080babb8 nid=0x3746 runnable \n[6247e000..6247e87c]\n        at sun.nio.ch.FileDispatcher.pread0(Native Method)\n        at sun.nio.ch.FileDispatcher.pread(FileDispatcher.java:31)\n        at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:230)\n        at sun.nio.ch.IOUtil.read(IOUtil.java:206)\n        at sun.nio.ch.FileChannelImpl.read(FileChannelImpl.java:591)\n        at com.sleepycat.je.log.FileSource.getBytes\n(FileSource.java:49)\n        at com.sleepycat.je.log.LogManager.getLogEntryFromLogSource\n(LogManager.java:518)\n        at com.sleepycat.je.log.LogManager.getLogEntry\n(LogManager.java:486)\n        at com.sleepycat.je.log.LogManager.get(LogManager.java:610)\n        at com.sleepycat.je.tree.BINDelta.reconstituteBIN\n(BINDelta.java:102)\n        at com.sleepycat.je.log.entry.BINDeltaLogEntry.getIN\n(BINDeltaLogEntry.java:37)\n        at com.sleepycat.je.log.CleanerFileReader.getReconstructedIN\n(CleanerFileReader.java:199)\n        at com.sleepycat.je.cleaner.Cleaner.processDelta\n(Cleaner.java:922)\n        at com.sleepycat.je.cleaner.Cleaner.processFile\n(Cleaner.java:533)\n        at com.sleepycat.je.cleaner.Cleaner.doClean(Cleaner.java:288)\n        - locked &lt;0x6a0eca38&gt; (a com.sleepycat.je.cleaner.Cleaner)\n        at com.sleepycat.je.cleaner.Cleaner.onWakeup\n(Cleaner.java:200)\n        at com.sleepycat.je.utilint.DaemonThread.run\n(DaemonThread.java:178)\n        at java.lang.Thread.run(Thread.java:534)\n\n... another kill -3 shows the Cleanr is again busy ...\n\n&quot;Cleaner&quot; daemon prio=1 tid=0x080babb8 nid=0x3746 runnable \n[6247e000..6247e87c]\n        at com.sleepycat.je.log.LogUtils.readByteArray\n(LogUtils.java:163)\n        at com.sleepycat.je.tree.Key.readFromLog(Key.java:191)\n        at com.sleepycat.je.tree.IN.readFromLog(IN.java:2046)\n        at com.sleepycat.je.log.entry.INLogEntry.readEntry\n(INLogEntry.java:80)\n        at com.sleepycat.je.log.LogManager.getLogEntryFromLogSource\n(LogManager.java:565)\n        at com.sleepycat.je.log.LogManager.getLogEntry\n(LogManager.java:486)\n        at com.sleepycat.je.log.LogManager.get(LogManager.java:610)\n        at com.sleepycat.je.tree.BINDelta.reconstituteBIN\n(BINDelta.java:102)\n        at com.sleepycat.je.log.entry.BINDeltaLogEntry.getIN\n(BINDeltaLogEntry.java:37)\n        at com.sleepycat.je.log.CleanerFileReader.getReconstructedIN\n(CleanerFileReader.java:199)\n\nIs the bdb library doing something funny? \n\nThanks,\n\n-joe\n\n--- In archive-crawler@yahoogroups.com, &quot;joehung302&quot; &lt;joe.hung@c...&gt; \nwrote:\n&gt; Here is a snapshot of top:\n&gt;  16:22:13  up 56 days,  4:03,  1 user,  load average: 2.79, 2.64, \n&gt; 2.49\n&gt; 288 processes: 287 sleeping, 1 running, 0 zombie, 0 stopped\n&gt; CPU states:  cpu    user    nice  system    irq  softirq  \niowait    \n&gt; idle\n&gt;            total    0.0%   13.8%    1.0%   0.2%     0.1%   48.9%   \n&gt; 35.8%\n&gt;            cpu00    0.0%   11.8%    1.0%   0.2%     0.2%   25.6%   \n&gt; 61.1%\n&gt;            cpu01    0.0%   14.2%    1.2%   0.0%     0.0%   24.8%   \n&gt; 59.7%\n&gt;            cpu02    0.0%   12.6%    0.8%   0.2%     0.2%   74.1%   \n&gt; 12.0%\n&gt;            cpu03    0.2%   16.6%    1.0%   0.4%     0.0%   71.1%   \n&gt; 10.6%\n&gt; \n&gt; The machine has 2GB memory and I started heritrix with -Xmx1200m. \nI \n&gt; have another program (tomcat) which I started with -Xmx800m. But \n&gt; tomcat is mostly idle.\n&gt; \n&gt; Here is a few lines of vmstat 2:\n&gt; procs                      memory      swap          io     \n&gt; system         cpu\n&gt;  r  b   swpd   free   buff  cache   si   so    bi    bo   in    cs \n&gt; us sy wa id\n&gt;  1  2 2096600  17632  35160 662456    0    1     0     1    0     \n1  \n&gt; 2  0  1  1\n&gt;  2  2 2096856  17312  35088 664776    0 1286  3552  1286 2254  \n2258 \n&gt; 21  2 45 31\n&gt;  1  2 2096712  20756  34980 663256   34 1464  3866  5194 1720  \n1657 \n&gt; 42  2 39 17\n&gt;  3  2 2096636  17660  34916 667060   18  580  3824   580 1547  \n1740 \n&gt; 29  2 47 22\n&gt;  0  2 2096440  17704  34836 667772  484  940  3586  4286 1149  \n1220  \n&gt; 8  1 51 40\n&gt;  1  2 2096448  17396  34656 670040   80 1334  3996  1334 1653  \n1839 \n&gt; 25  2 51 23\n&gt;  0  1 2096456  17612  34772 670804   10 1166  4028  1166 1381  \n1367 \n&gt; 23  1 50 26\n&gt;  1  4 2096456  17828  34908 673088    4 1466  3850  2836 2326  \n2264 \n&gt; 15  2 57 26\n&gt;  0  2 2096456  17396  35020 675380  212 1466  3852  1466 2321  \n2351 \n&gt; 21  1 50 28\n&gt;  2  1 2096460  17504  35120 676540  402 1730  3912  4776 2384  \n2875 \n&gt; 17  2 54 27\n&gt;  2  2 2096460  17504  35228 677884  356 1462  2614  3296 1921  \n2748 \n&gt; 22  3 57 18\n&gt; \n&gt; \n&gt; Let me try the hold-queues parameter and see how it works.\n&gt; \n&gt; Thanks,\n&gt; \n&gt; -joe\n&gt; \n&gt; --- In archive-crawler@yahoogroups.com, &quot;Gordon Mohr (Internet \n&gt; Archive)&quot; &lt;gojomo@a...&gt; wrote:\n&gt; &gt; Memory use (and traffic to disk) is more a function of the\n&gt; &gt; number of hosts/queues that have been discovered or active,\n&gt; &gt; than of the total number of URLs discovered or crawled. So\n&gt; &gt; any &#39;broader&#39; crawls will strain resources more than\n&gt; &gt; &#39;narrower&#39; ones with a smaller or fixed number of hosts\n&gt; &gt; of interest.\n&gt; &gt; \n&gt; &gt; Your machine may be swapping heavily. Things to check:\n&gt; &gt; \n&gt; &gt;   - Does &#39;top&#39; show swap in use?\n&gt; &gt;   - How does your configured max heap and current heap size\n&gt; &gt;     compare with RAM? (Max heap should be 25% or more smaller\n&gt; &gt;   - Do the &#39;si&#39; and &#39;so&#39; columns in &#39;vmstat 2&#39;\n&gt; &gt;     (sample every 2 seconds) show activity?\n&gt; &gt; \n&gt; &gt; Separately from OS virtual memory, the new BDB/soft-reference\n&gt; &gt; mechanism for &#39;paging&#39; per-host/per-queue data out when not in\n&gt; &gt; immediate use could theoretically reach some excessive IO states\n&gt; &gt; in low-memory conditions. This would be more likely if you \nweren&#39;t\n&gt; &gt; using the &#39;hold-queues&#39; setting and were instead round-robinning\n&gt; &gt; among all queues in a big crawl.\n&gt; &gt; \n&gt; &gt; - Gordon @ IA\n&gt; &gt; \n&gt; &gt; joehung302 wrote:\n&gt; &gt; &gt; I started a crawl about a week ago (using 1.4 broad scope and \n&gt; the \n&gt; &gt; &gt; default BdbFrontier). So far I&#39;ve collected &gt;7 million docs \nbut \n&gt; IO is \n&gt; &gt; &gt; consistently at &gt;50% using top. Sometimes even higher at 90+%.\n&gt; &gt; &gt; \n&gt; &gt; &gt; Here is what&#39;s interesting...even if I pause the crawl, IO is \n&gt; still \n&gt; &gt; &gt; busy. The number never dropped.\n&gt; &gt; &gt; \n&gt; &gt; &gt; I&#39;m running on a dual Xeon with a direct attached SCSI array, \n&gt; using \n&gt; &gt; &gt; Sun&#39;s JDK 1.4.2. -Xmx1200.\n&gt; &gt; &gt; \n&gt; &gt; &gt; I&#39;ve done a 7 million docs crawl using 1.0.4 before on the \nsame \n&gt; &gt; &gt; hardware (using domainscope though). From what I remember the \n&gt; disk IO \n&gt; &gt; &gt; was at around 5%. \n&gt; &gt; &gt; \n&gt; &gt; &gt; Is it becuase of BdbFrontier? Any hints?\n&gt; &gt; &gt; \n&gt; &gt; &gt; Thanks,\n&gt; &gt; &gt; \n&gt; &gt; &gt; -joe\n&gt; &gt; &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt;  \n&gt; &gt; &gt; Yahoo! Groups Links\n&gt; &gt; &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt;  \n&gt; &gt; &gt; \n&gt; &gt; &gt;\n\n\n\n"}}