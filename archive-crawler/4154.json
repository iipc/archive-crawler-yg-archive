{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":296797862,"authorName":"Holger Lausen","from":"Holger Lausen &lt;holger.lausen@...&gt;","replyTo":"LIST","senderId":"ICZGcMfbxkGQoO3D3Scb3SLbjRfN_xkohaDUjBsUZ31vzdw4jFqGWz9w8uxYd9s_WLIZsCRYmrdjsdLcpV6VvMQwBPmt4Dy2DgpwgVU","spamInfo":{"isSpam":false,"reason":"2"},"subject":"Re: [archive-crawler] encoding issue with ARCWriterProcessor?","postDate":"1177078694","msgId":4154,"canDelete":false,"contentTrasformed":false,"systemMessage":true,"headers":{"messageIdInHeader":"PDQ2MjhDQkE2LjUwNzA1MDdAZGVyaS5vcmc+","inReplyToHeader":"PDQ2MEQ1NjQwLjEwNzAwMDlAYXJjaGl2ZS5vcmc+","referencesHeader":"PDQ2MEMwMjg4LjEwMzA3MDJAZGVyaS5vcmc+IDw0NjBDMDQ1NC44MDIwMjAzQGFyY2hpdmUub3JnPiA8NDYwQzExMjQuNDA3MDYwM0BkZXJpLm9yZz4gPDQ2MENBRTI4LjIwNzAyMDdAZGVyaS5vcmc+IDw0NjBENTY0MC4xMDcwMDA5QGFyY2hpdmUub3JnPg=="},"prevInTopic":3995,"nextInTopic":0,"prevInTime":4153,"nextInTime":4155,"topicId":3984,"numMessagesInTopic":6,"msgSnippet":"Gordon, Michael, you are right, I looked for the problem at the wrong place. The real problem was that when I was reading some arc file I was carelessly","rawEmail":"Return-Path: &lt;holger.lausen@...&gt;\r\nReceived: (qmail 94820 invoked from network); 20 Apr 2007 20:09:00 -0000\r\nReceived: from unknown (66.218.66.167)\n  by m47.grp.scd.yahoo.com with QMQP; 20 Apr 2007 20:09:00 -0000\r\nReceived: from unknown (HELO n7c.bullet.sp1.yahoo.com) (69.147.64.167)\n  by mta6.grp.scd.yahoo.com with SMTP; 20 Apr 2007 20:09:00 -0000\r\nReceived: from [216.252.122.217] by n7.bullet.sp1.yahoo.com with NNFMP; 20 Apr 2007 20:07:05 -0000\r\nReceived: from [66.218.69.3] by t2.bullet.sp1.yahoo.com with NNFMP; 20 Apr 2007 20:07:04 -0000\r\nReceived: from [66.218.66.74] by t3.bullet.scd.yahoo.com with NNFMP; 20 Apr 2007 20:07:04 -0000\r\nX-Sender: holger.lausen@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 89781 invoked from network); 20 Apr 2007 14:28:23 -0000\r\nReceived: from unknown (66.218.67.35)\n  by m48.grp.scd.yahoo.com with QMQP; 20 Apr 2007 14:28:23 -0000\r\nReceived: from unknown (HELO smtp.uibk.ac.at) (138.232.1.142)\n  by mta9.grp.scd.yahoo.com with SMTP; 20 Apr 2007 14:28:22 -0000\r\nReceived: from [192.168.2.100] (e181063045.adsl.alicedsl.de [85.181.63.45] holger.lausen@...)\n        (authenticated bits=0)\n        by smtp.uibk.ac.at (8.13.8/8.13.1/F1) with ESMTP id l3KEIKIM019785\n        (version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)\n        for &lt;archive-crawler@yahoogroups.com&gt;; Fri, 20 Apr 2007 16:18:21 +0200\r\nMessage-ID: &lt;4628CBA6.5070507@...&gt;\r\nDate: Fri, 20 Apr 2007 16:18:14 +0200\r\nUser-Agent: Thunderbird 1.5.0.10 (Windows/20070221)\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;460C0288.1030702@...&gt; &lt;460C0454.8020203@...&gt; &lt;460C1124.4070603@...&gt; &lt;460CAE28.2070207@...&gt; &lt;460D5640.1070009@...&gt;\r\nIn-Reply-To: &lt;460D5640.1070009@...&gt;\r\nX-Enigmail-Version: 0.94.1.2\r\nContent-Type: multipart/signed; micalg=pgp-sha1;\n protocol=&quot;application/pgp-signature&quot;;\n boundary=&quot;------------enigA95D5B805ECD98603910993F&quot;\r\nX-Spam-Score: () -7.4 ALL_TRUSTED,NORMAL_HTTP_TO_IP,RCV_SMTP_AUTH,RCV_SMTP_UIBK\r\nX-Scanned-By: MIMEDefang 2.58 at uibk.ac.at on 138.232.1.140\r\nX-eGroups-Msg-Info: 2:2:2:0\r\nFrom: Holger Lausen &lt;holger.lausen@...&gt;\r\nSubject: Re: [archive-crawler] encoding issue with ARCWriterProcessor?\r\nX-Yahoo-Group-Post: member; u=296797862\r\nX-Yahoo-Marked-Not-Spam: \r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Approved-By: gojomo &lt;gojomo@...&gt; via web; 20 Apr 2007 20:07:03 -0000\r\n\r\n\r\n--------------enigA95D5B805ECD98603910993F\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nGordon, Michael,\n\nyou are right, I looked for the problem at the wrong plac=\r\ne.\n\nThe real problem was that when I was reading some arc file I was\ncarele=\r\nssly converting the Inputstream to a String (not considering the\ncharset of=\r\n the bytestream).\n\n[1] and [2] had actually quite useful information and wi=\r\nth the\njuniversalchardet I was able to fix my problem.\n\nThat lets me remain=\r\n with one suggestion: Should the ArcReader/ArcHeader\ninterface not be exten=\r\nded, such that ArcHeader has a method like\ngetCharset() and ArcReader a met=\r\nhod like guessCharSet()? I think this\nalso would benefit other when handlin=\r\ng arc files.\n\nbest\n  Holger\n\n\n[1]http://webteam.archive.org/jira/browse/HER=\r\n-717\n[2]http://crawler.archive.org/cgi-bin/wiki.pl?CharsetsAndCrawling\n\nGor=\r\ndon Mohr wrote:\n&gt; \n&gt; \n&gt; Holger -\n&gt; \n&gt; Because of the way Heritrix &#39;records&#39;=\r\n HTTP responses -- at the socket\n&gt; level, before any encoding is considered=\r\n -- I am fairly confident that\n&gt; the ARC written by Heritrix is identical t=\r\no the bytes returned by the\n&gt; original target server.\n&gt; \n&gt; I suspect any ap=\r\nparent &#39;mangling&#39; you&#39;re seeing is a function of how\n&gt; you&#39;re viewing the A=\r\nRC -- most likely the final viewer step, but also\n&gt; possibly any other proc=\r\nessing steps before viewing. (Decompression\n&gt; should be safe, but any line-=\r\nby-line reading/excerpting could have\n&gt; caused a problem.)\n&gt; \n&gt; For example=\r\n, perhaps it is matter of your terminal program/window\n&gt; insisting on 8859-=\r\n1 encoding. Is that something you can adjust?\n&gt; \n&gt; (As Stack noted in his p=\r\nrevious reply, I can get exactly the &#39;mangling&#39;\n&gt; you report in Firefox by =\r\nforcing it to use ISO-8859-1 encoding (under\n&gt; View -&gt; Character Encoding).=\r\n\n&gt; \n&gt; (The change in Content-Length also suggests something affected the ra=\r\nw\n&gt; content between its download from the IIS server to its upload to your\n=\r\n&gt; Apache server, but I think that&#39;s a separate issue related to that\n&gt; proc=\r\ness and not the original problem.)\n&gt; \n&gt; Hope this helps,\n&gt; \n&gt; - Gordon @ IA=\r\n\n&gt; \n&gt; Holger Lausen wrote:\n&gt;&gt; Hi,\n&gt;&gt;\n&gt;&gt; I did some more tests. I figured ou=\r\nt using a browser I can obtain a\n&gt;&gt; correctly encoded document. I uploaded =\r\nthis to another server and ran\n&gt;&gt; heritrix against that one. In this way I =\r\nended up with a correct file.\n&gt;&gt;\n&gt;&gt; Here the headers of the Apache server I=\r\n uploaded the document:\n&gt;&gt; HTTP/1.1 200 OK\n&gt;&gt; Date: Fri, 30 Mar 2007 06:34:=\r\n39 GMT\n&gt;&gt; Server: Apache\n&gt;&gt; Last-Modified: Fri, 30 Mar 2007 06:32:33 GMT\n&gt;&gt;=\r\n ETag: &quot;183d4-1e28-9590240&quot;\n&gt;&gt; Accept-Ranges: bytes\n&gt;&gt; Content-Length: 7720=\r\n\n&gt;&gt; Keep-Alive: timeout=3D15, max=3D100\n&gt;&gt; Connection: Keep-Alive\n&gt;&gt; Conten=\r\nt-Type: text/html\n&gt;&gt;\n&gt;&gt; And here the original one from the IIS.\n&gt;&gt; HTTP/1.1=\r\n 200 OK\n&gt;&gt; Connection: keep-alive\n&gt;&gt; Date: Fri, 30 Mar 2007 06:21:37 GMT\n&gt;&gt;=\r\n Server: Microsoft-IIS/6.0\n&gt;&gt; X-Powered-By: ASP.NET\n&gt;&gt; X-AspNet-Version: 1.=\r\n1.4322\n&gt;&gt; Cache-Control: private, max-age=3D0\n&gt;&gt; Content-Type: text/html; c=\r\nharset=3Dutf-8\n&gt;&gt; Content-Length: 8025\n&gt;&gt;\n&gt;&gt; Interesting enough the documen=\r\nt size changed. I assume the IIS somehow\n&gt;&gt; does something to the charset w=\r\nhich got fixed when I used firefox to\n&gt;&gt; download the document, but not whe=\r\nn I ued heritrix. Any ideas?\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; thanks for any hints\n&gt;&gt; Holger\n&gt;&gt;\n&gt;&gt; =\r\nPS: Original doc URL: http://www.atcomp.cz/webservices/dokumenty.asmx\n&gt; &lt;ht=\r\ntp://www.atcomp.cz/webservices/dokumenty.asmx&gt;\n&gt;&gt; corrected one: http://138=\r\n.232.65.158/t.htm &lt;http://138.232.65.158/t.htm&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; Holger Lausen wrot=\r\ne:\n&gt;&gt;&gt; Wow, that is quick!\n&gt;&gt;&gt;\n&gt;&gt;&gt; I tried various stuff, e.g.\n&gt;&gt;&gt; cat IAH-=\r\n20070329193940-00000-res.arc | grep &#39;seznam&#39;\n&gt;&gt;&gt; or\n&gt;&gt;&gt; vi IAH-200703291939=\r\n40-00000-res.arc\n&gt;&gt;&gt; (vi tells me on &quot;set encoding&quot; that the file is UTF8)\n=\r\n&gt;&gt;&gt;\n&gt;&gt;&gt; I always get the mangling. I also tried\n&gt;&gt;&gt; wget http://www.atcomp.=\r\ncz/webservices/dokumenty.asmx\n&gt; &lt;http://www.atcomp.cz/webservices/dokumenty=\r\n.asmx&gt;\n&gt;&gt;&gt; I end up with a similar mess.\n&gt;&gt;&gt;\n&gt;&gt;&gt; However if I use my window=\r\ns machine to fetch the file and scp to\n&gt;&gt;&gt; transfer it to the debian machin=\r\ne, I can see all the chars correctly,\n&gt;&gt;&gt; this is why I suspect something i=\r\ns happening (or not happening) during\n&gt;&gt;&gt; the fetching or writing process..=\r\n. Can it be that the broswers (I used\n&gt;&gt;&gt; firefox) do some clever autofixin=\r\ng?\n&gt;&gt;&gt;\n&gt;&gt;&gt; BTW the locale installed on the debian machine is: &quot;de_DE.UTF-8 =\r\nUTF-8&quot;\n&gt;&gt;&gt; (/etc/locale.gen). I also tried to install all available locales=\r\n, but\n&gt;&gt;&gt; same result.\n&gt;&gt;&gt;\n&gt;&gt;&gt; thanks for the quick answer.\n&gt;&gt;&gt;\n&gt;&gt;&gt; /holger=\r\n\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; Michael Stack wrote:\n&gt;&gt;&gt;&gt; Tell us more.\n&gt;&gt;&gt;&gt;\n&gt;=\r\n&gt;&gt;&gt; Heritrix writes the raw captured bytes untampered.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; What are y=\r\nou using to view the ARCWriterProcessor captures? The page\n&gt;&gt;&gt;&gt; you point t=\r\no in the below does not explicitly state its encoding.\n&gt;&gt;&gt;&gt; Perhaps it need=\r\ns this hint to rendor the pages properly? For example,\n&gt;&gt;&gt;&gt; if I force my b=\r\nrowser to render the page using ISO-8859-1 rather than\n&gt;&gt;&gt;&gt; UTF-8, I see th=\r\ne mangling you reproduce below.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; St.Ack\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; Holger Lausen wr=\r\note:\n&gt;&gt;&gt;&gt;&gt; Hi all,\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; using heritrix 1.2:\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; When using t=\r\nhe org.archive.crawler.writer.ARCWriterProcessor in the\n&gt;&gt;&gt;&gt;&gt; default profi=\r\nle on e.g.\n&gt;&gt;&gt;&gt; http://www.atcomp.cz/webservices/dokumenty.asmx\n&gt; &lt;http://w=\r\nww.atcomp.cz/webservices/dokumenty.asmx&gt;\n&gt;&gt;&gt;&gt; &lt;http://www.atcomp.cz/webserv=\r\nices/dokumenty.asmx\n&gt; &lt;http://www.atcomp.cz/webservices/dokumenty.asmx&gt;&gt;\n&gt;&gt;=\r\n&gt;&gt;&gt; (UTF-8) I end up with an archive file containing instead of:\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;=\r\n&gt; Vrac=ED seznam koncov=FDch\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; Vrac=C3=AD seznam koncov=C3=BDch\n&gt;=\r\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; I am not sure where start looking at the issue, can someone give=\r\n me a\n&gt;&gt;&gt;&gt;&gt; pointer?\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; The servers char-set claim is correctly ut=\r\nf8, I am running a debian\n&gt;&gt;&gt;&gt;&gt; system....\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt; thanks\n&gt;&gt;&gt;&gt;&gt; Holger\n=\r\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;\n&gt; \n&gt; \n\n-- \nHolger Lausen\n\nDigital Enterprise Research =\r\nInstitute (DERI)\nhttp://www.deri.org/\n\nTel:   +43 512 5076464\nMail: holger.=\r\nlausen@...\nWWW: http://holgerlausen.net\n\n\r\n--------------enigA95D5B805ECD98603910993F\r\nContent-Type: application/pgp-signature; name=&quot;signature.asc&quot;\r\nContent-Description: OpenPGP digital signature\r\nContent-Disposition: attachment; filename=&quot;signature.asc&quot;\r\n\r\n[ Attachment content not displayed ]\r\n--------------enigA95D5B805ECD98603910993F--\r\n\n"}}