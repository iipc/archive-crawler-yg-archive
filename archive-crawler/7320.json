{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":55685036,"authorName":"cmiles74","from":"&quot;cmiles74&quot; &lt;twitch@...&gt;","profile":"cmiles74","replyTo":"LIST","senderId":"qxK7CGXg0Me0A-IHFgWbHoZkpf7kMEF0BH_h93pcEUPlcZbcITuc_gJSpKjhX97qogPaqrRBNGaFtzUkGPmhKTMrCysWRtDA_Mo","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Retrieving Non-Text Data from CrawlURI&#39;s ReplayInputStream","postDate":"1316384190","msgId":7320,"canDelete":false,"contentTrasformed":false,"systemMessage":true,"headers":{"messageIdInHeader":"PGo1NXFqdSsyb2oyQGVHcm91cHMuY29tPg=="},"prevInTopic":0,"nextInTopic":7321,"prevInTime":7319,"nextInTime":7321,"topicId":7320,"numMessagesInTopic":4,"msgSnippet":"Hello, I m trying to code-up my own writer that stores the crawled data in buckets in a Riak cluster instead of writing the data to a WARC file. This code is","rawEmail":"Return-Path: &lt;twitch@...&gt;\r\nReceived: (qmail 67003 invoked from network); 19 Sep 2011 03:43:14 -0000\r\nReceived: from unknown (98.137.35.162)\n  by m10.grp.sp2.yahoo.com with QMQP; 19 Sep 2011 03:43:14 -0000\r\nReceived: from unknown (HELO ng7-ip1.bullet.mail.ne1.yahoo.com) (98.138.215.162)\n  by mta6.grp.sp2.yahoo.com with SMTP; 19 Sep 2011 03:43:14 -0000\r\nDKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoogroups.com; s=lima; t=1316403793; bh=CVWluMXfdH3HJCiGaGvDXeEVXgeo5sLB2eO+LeTclxo=; h=Received:Received:Received:X-Sender:X-Apparently-To:X-Received:X-Received:X-Received:X-Received:X-Received:X-Received:Date:To:Message-ID:User-Agent:MIME-Version:Content-Type:X-Mailer:X-Yahoo-Newman-Property:X-Originating-IP:X-eGroups-Msg-Info:X-Yahoo-Post-IP:From:Subject:X-Yahoo-Group-Post:X-Yahoo-Profile:X-YGroups-SubInfo:Sender:X-eGroups-Approved-By:X-eGroups-Auth; b=eT4vIfMOBTdouiDKKn1qrzp/Dxl4VKMoJZORoS8gQLF0gy6GmNbf9EVo7r1JlZdNVs6nm0uhab+ce8tzGlwqSKDtwH7iYlW0nSq1aBvriys+SxJN74IF3smXASUVgfTc\r\nReceived: from [98.138.217.180] by ng7.bullet.mail.ne1.yahoo.com with NNFMP; 19 Sep 2011 03:43:13 -0000\r\nReceived: from [69.147.65.147] by tg5.bullet.mail.ne1.yahoo.com with NNFMP; 19 Sep 2011 03:43:13 -0000\r\nReceived: from [98.137.34.155] by t10.bullet.mail.sp1.yahoo.com with NNFMP; 19 Sep 2011 03:43:13 -0000\r\nX-Sender: twitch@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 30656 invoked from network); 18 Sep 2011 22:16:31 -0000\r\nX-Received: from unknown (98.137.35.160)\n  by m10.grp.sp2.yahoo.com with QMQP; 18 Sep 2011 22:16:31 -0000\r\nX-Received: from unknown (HELO ng9-ip1.bullet.mail.ne1.yahoo.com) (98.138.215.180)\n  by mta4.grp.sp2.yahoo.com with SMTP; 18 Sep 2011 22:16:31 -0000\r\nX-Received: from [98.138.217.182] by ng9.bullet.mail.ne1.yahoo.com with NNFMP; 18 Sep 2011 22:16:30 -0000\r\nX-Received: from [69.147.65.149] by tg7.bullet.mail.ne1.yahoo.com with NNFMP; 18 Sep 2011 22:16:30 -0000\r\nX-Received: from [98.137.34.51] by t9.bullet.mail.sp1.yahoo.com with NNFMP; 18 Sep 2011 22:16:30 -0000\r\nDate: Sun, 18 Sep 2011 22:16:30 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;j55qju+2oj2@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: multipart/alternative; boundary=&quot;3-6087774463-1723587205=:0&quot;\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: &quot;cmiles74&quot; &lt;twitch@...&gt;\r\nSubject: Retrieving Non-Text Data from CrawlURI&#39;s ReplayInputStream\r\nX-Yahoo-Group-Post: member; u=55685036; y=Ten3NR0Jee9U47eIYfdQ0HMYu2Yj0x89MBDVLQ64p6-GkaE\r\nX-Yahoo-Profile: cmiles74\r\nX-eGroups-Approved-By: nlevitt &lt;nlevitt@...&gt; via web; 19 Sep 2011 03:43:10 -0000\r\n\r\n\r\n--3-6087774463-1723587205=:0\r\nContent-Type: text/plain; charset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nHello,\n\nI&#39;m trying to code-up my own writer that stores the crawled data in=\r\n\nbuckets in a Riak cluster instead of writing the data to a WARC file.\nThis=\r\n code is mostly working in that HTML and plain-text content are\nbeing corre=\r\nctly stored. Binary content (specifically PDF files) are not\nworking so wel=\r\nl, they are being garbled along the way.\n\nI&#39;m using the following code to f=\r\netch this data from the CrawlURI\ninstance:\n\n             InputStreamReader =\r\nreader =3D\n                 new\nInputStreamReader(crawluri.getRecorder().ge=\r\ntContentReplayInputStream());\n             byte[] bytesResponse =3D IOUtils=\r\n.toByteArray(reader);\n             inputstreamResponse.close();\n\nI&#39;m then s=\r\ntoring this data in Riak as a ByteArray. When I pull the data\nback out, it&#39;=\r\ns clearly garbled. These are PDF files and while they open\nin a PDF reader,=\r\n all of the pages are blank. I&#39;m not sure where I might\nbe going wrong.\n\nDo=\r\nes this approach seem reasonable? Any help or feedback would be\ngreatly app=\r\nreciated.\n\nThank you\n--\nMiles\n\n\r\n--3-6087774463-1723587205=:0\r\nContent-Type: text/html; charset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nHello,&lt;br&gt;&lt;br&gt;I&#39;m trying to code-up my own writer that stores the crawled d=\r\nata in buckets in a Riak cluster instead of writing the data to a WARC file=\r\n. This code is mostly working in that HTML and plain-text content are being=\r\n correctly stored. Binary content (specifically PDF files) are not working =\r\nso well, they are being garbled along the way.&lt;br&gt;&lt;br&gt;I&#39;m using the followi=\r\nng code to fetch this data from the CrawlURI instance:&lt;br&gt;&lt;br&gt;&lt;font face=3D=\r\n&quot;courier new&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=\r\nnbsp; InputStreamReader reader =3D&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=\r\nnbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new InputStreamReader=\r\n(crawluri.getRecorder().getContentReplayInputStream());&lt;br&gt;&nbsp;&nbsp;&nbs=\r\np;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; byte[] bytesResponse =3D=\r\n IOUtils.toByteArray(reader);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=\r\n&nbsp;&nbsp;&nbsp;&nbsp; inputstreamResponse.close();&lt;/font&gt;&lt;br&gt;&lt;br&gt;I&#39;m the=\r\nn storing this data in Riak as a ByteArray. When I pull the data back out, =\r\nit&#39;s clearly garbled. These are PDF files and while they open in a PDF read=\r\ner, all of the pages are blank. I&#39;m not sure where I might be going wrong.&lt;=\r\nbr&gt;&lt;br&gt;Does this approach seem reasonable? Any help or feedback would be gr=\r\neatly appreciated.&lt;br&gt;&lt;br&gt;Thank you&lt;br&gt;--&lt;br&gt;Miles&lt;br&gt;\n\r\n--3-6087774463-1723587205=:0--\r\n\n"}}