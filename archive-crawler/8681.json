{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":325624130,"authorName":"Noah Levitt","from":"Noah Levitt &lt;nlevitt@...&gt;","profile":"nlevitt","replyTo":"LIST","senderId":"3DLgD1oi4mQFjEojPaOpGDRtoJrV82TuqCWA5uRG7DTqWj9Hcu5NHmg3UB6MeA57XhHR87blqB394v0BhvIlGBfivaVuiz7r","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Do we need the check for 0.0.0.0 in DefaultServerCache?","postDate":"1424827869","msgId":8681,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PENBQS16NzArRDZaMmlfSmVxQkI5LVpFbWdBYUU3dkJHaXlQUGp3ZW0ya1dBYUxHX2tWd0BtYWlsLmdtYWlsLmNvbT4=","inReplyToHeader":"PEU0ODZEOTNFMzcyRDhDNDI4MkU4REYwNzgzOTJGMTJERkQ2M0FDQGJsaWtpLmJva2hsYWRhLmxvY2FsPg==","referencesHeader":"PEU0ODZEOTNFMzcyRDhDNDI4MkU4REYwNzgzOTJGMTJERkQxQzJFQGJsaWtpLmJva2hsYWRhLmxvY2FsPgk8Q0FBLXo3MExDcXo2U3Q3UGZRXzVfRXc2UVB5PWZrM0hzcHordUxpWitSLW52QzFWN3dBQG1haWwuZ21haWwuY29tPgk8RTQ4NkQ5M0UzNzJEOEM0MjgyRThERjA3ODM5MkYxMkRGRDYzQUNAYmxpa2kuYm9raGxhZGEubG9jYWw+"},"prevInTopic":8680,"nextInTopic":0,"prevInTime":8680,"nextInTime":8682,"topicId":8678,"numMessagesInTopic":4,"msgSnippet":"Hey Kris, ... I see. Yeah the CrawlHost constructor sets its ip field if the hostname looks like an ipv4 address. ... I m seeing 0.0.0.0 from","rawEmail":"Return-Path: &lt;nlevitt@...&gt;\r\nX-Sender: nlevitt@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 3834 invoked by uid 102); 25 Feb 2015 01:31:11 -0000\r\nX-Received: from unknown (HELO mtaq3.grp.bf1.yahoo.com) (10.193.84.142)\n  by m11.grp.bf1.yahoo.com with SMTP; 25 Feb 2015 01:31:11 -0000\r\nX-Received: (qmail 24501 invoked from network); 25 Feb 2015 01:31:11 -0000\r\nX-Received: from unknown (HELO mail.archive.org) (98.138.100.121)\n  by mtaq3.grp.bf1.yahoo.com with SMTP; 25 Feb 2015 01:31:11 -0000\r\nX-Received: from mail.archive.org (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 709D5C141\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed, 25 Feb 2015 01:31:10 +0000 (UTC)\r\nX-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on mail.archive.org\r\nX-Spam-Level: \r\nX-Spam-Status: No, score=-1.0 required=5.0 tests=ALL_TRUSTED,SHORTCIRCUIT,\n\tURIBL_BLOCKED autolearn=disabled version=3.4.0\r\nX-Received: from mail-ob0-f176.google.com (mail-ob0-f176.google.com [209.85.214.176])\n\t(using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))\n\t(No client certificate requested)\n\t(Authenticated sender: nlevitt@...)\n\tby mail.archive.org (Postfix) with ESMTPSA id 39C14C13A\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed, 25 Feb 2015 01:31:10 +0000 (UTC)\r\nX-Received: by mail-ob0-f176.google.com with SMTP id wo20so816349obc.7\n        for &lt;archive-crawler@yahoogroups.com&gt;; Tue, 24 Feb 2015 17:31:09 -0800 (PST)\r\nMIME-Version: 1.0\r\nX-Received: by 10.202.228.81 with SMTP id b78mr539183oih.40.1424827869466;\n Tue, 24 Feb 2015 17:31:09 -0800 (PST)\r\nX-Received: by 10.76.96.174 with HTTP; Tue, 24 Feb 2015 17:31:09 -0800 (PST)\r\nIn-Reply-To: &lt;E486D93E372D8C4282E8DF078392F12DFD63AC@...&gt;\r\nReferences: &lt;E486D93E372D8C4282E8DF078392F12DFD1C2E@...&gt;\n\t&lt;CAA-z70LCqz6St7PfQ_5_Ew6QPy=fk3Hspz+uLiZ+R-nvC1V7wA@...&gt;\n\t&lt;E486D93E372D8C4282E8DF078392F12DFD63AC@...&gt;\r\nDate: Tue, 24 Feb 2015 17:31:09 -0800\r\nMessage-ID: &lt;CAA-z70+D6Z2i_JeqBB9-ZEmgAaE7vBGiyPPjwem2kWAaLG_kVw@...&gt;\r\nTo: &quot;archive-crawler@yahoogroups.com&quot; &lt;archive-crawler@yahoogroups.com&gt;\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\nSubject: Re: [archive-crawler] Do we need the check for 0.0.0.0 in DefaultServerCache?\r\nX-Yahoo-Group-Post: member; u=325624130; y=7Q5xHXslK90vOHq_fHYIPjdZrP40DVQ3DyZDb8gpnQGLmw\r\nX-Yahoo-Profile: nlevitt\r\nFrom: Noah Levitt &lt;nlevitt@...&gt;\r\n\r\nHey Kris,\n\n&gt; This seems to be happening due to link extraction of URLs like=\r\n: &quot;http://000.000.000.000/something&quot;. The links are nonsense, but this seem=\r\ns to be inferred as being IP based address at some point.\n\nI see. Yeah the =\r\nCrawlHost constructor sets its &quot;ip&quot; field if the\nhostname looks like an ipv=\r\n4 address.\n\n&gt; Shouldn&#39;t we also be triggering this on 127.0.0.1? As it happ=\r\nens, I just ran across at least one domain whose IP is reported as 127.0.0.=\r\n1 (www.beforemistermilesin.is).\n\nI&#39;m seeing 0.0.0.0 from www.beforemistermi=\r\nlesin.is actually. I wonder\nwhy this happens sometimes, maybe a default if =\r\nno value is set, in\nsome nameserver software?\n\nBut certainly dns returning =\r\n127.0.0.1 is possible. In fact the address\nlocalhost.archive.org does that.=\r\n (There was some reason for that, I\nremember Brad found it useful, but I do=\r\nn&#39;t remember what it was for.)\n\nNot only 127.0.0.1, but all of 127.x.x.x, a=\r\nre loopback addresses.\nProbably many of the various classes of reserved add=\r\nresses should be\nhandled specially. http://en.wikipedia.org/wiki/Reserved_I=\r\nP_addresses\n\nIt&#39;s not clear to me exactly how they all should be handled th=\r\nough.\nCertainly it is useful to be able to crawl localhost, for testing at\n=\r\nleast. In fact the unit tests do exactly that. In the case of private\nnetwo=\r\nrk addresses like 192.168.x.x, there could be cases where\ncrawling such an =\r\naddress could be a security problem, and other cases\nwhere it&#39;s entirely va=\r\nlid. I don&#39;t think there are any cases where it\nwould be desirable to crawl=\r\n 0.0.0.0, which is maybe why I left it in\nthere as a unique special case.\n\n=\r\nI do agree with you that this is handled in the wrong place. Maybe for\nnow =\r\na check can be added to CrawlHost.setIP(), that logs a warning and\nsets ip=\r\n=3Dnull when passed 0.0.0.0. Meanwhile we can continue to discuss\nwhat to d=\r\no with other reserved addresses. What do you think?\n\nNoah\n\n\nOn Tue, Feb 24,=\r\n 2015 at 2:27 AM, Kristinn Sigur=C3=B0sson\nkristinn@... [archi=\r\nve-crawler]\n&lt;archive-crawler@yahoogroups.com&gt; wrote:\n&gt; Hi Noah,\n&gt;\n&gt; This se=\r\nems to be happening due to link extraction of URLs like: &quot;http://000.000.00=\r\n0.000/something&quot;. The links are nonsense, but this seems to be inferred as =\r\nbeing IP based address at some point. None of these links get so much as an=\r\n attempted DNS lookup (as far as I can tell) but they do trigger the except=\r\nion in the IpAddressSetDecideRule that is used to determine if a sheet over=\r\nlay should be applied. Stacktrace:\n&gt;\n&gt; java.lang.IllegalStateException: got=\r\n suspicious value 0.0.0.0 for 000.000.000.000\n&gt;         at org.archive.modu=\r\nles.fetcher.DefaultServerCache.getHostFor(DefaultServerCache.java:112)\n&gt;   =\r\n      at org.archive.modules.net.ServerCache.getHostFor(ServerCache.java:64=\r\n)\n&gt;         at org.archive.modules.deciderules.IpAddressSetDecideRule.getHo=\r\nstAddress(IpAddressSetDecideRule.java:90)\n&gt;         at org.archive.modules.=\r\ndeciderules.IpAddressSetDecideRule.evaluate(IpAddressSetDecideRule.java:60)=\r\n\n&gt;         at org.archive.modules.deciderules.PredicatedDecideRule.innerDec=\r\nide(PredicatedDecideRule.java:47)\n&gt;         at org.archive.modules.decideru=\r\nles.DecideRule.decisionFor(DecideRule.java:60)\n&gt;         at org.archive.mod=\r\nules.deciderules.DecideRule.accepts(DecideRule.java:77)\n&gt;         at org.ar=\r\nchive.crawler.spring.SheetOverlaysManager.applyOverlaysTo(SheetOverlaysMana=\r\nger.java:331)\n&gt;         at org.archive.crawler.postprocessor.CandidatesProc=\r\nessor.runCandidateChain(CandidatesProcessor.java:164)\n&gt;         at org.arch=\r\nive.crawler.postprocessor.CandidatesProcessor.innerProcess(CandidatesProces=\r\nsor.java:230)\n&gt;         at org.archive.modules.Processor.innerProcessResult=\r\n(Processor.java:175)\n&gt;         at org.archive.modules.Processor.process(Pro=\r\ncessor.java:142)\n&gt;         at org.archive.modules.ProcessorChain.process(Pr=\r\nocessorChain.java:131)\n&gt;         at org.archive.crawler.framework.ToeThread=\r\n.run(ToeThread.java:152)\n&gt;\n&gt; A possible solution would be to throw a more n=\r\narrow (custom) exception and have IpAddressSetDecideRule catch that and log=\r\n it at debug level. It still feels like this is being handled at the wrong =\r\nplace, though.\n&gt;\n&gt; Shouldn&#39;t we also be triggering this on 127.0.0.1? As it=\r\n happens, I just ran across at least one domain whose IP is reported as 127=\r\n.0.0.1 (www.beforemistermilesin.is).\n&gt;\n&gt; - Kris\n&gt;\n&gt; -----------------------=\r\n--------------------------------------------------\n&gt; Landsb=C3=B3kasafn =C3=\r\n=8Dslands - H=C3=A1sk=C3=B3lab=C3=B3kasafn | Arngr=C3=ADmsg=C3=B6tu 3 - 107=\r\n Reykjav=C3=ADk\n&gt; S=C3=ADmi/Tel: +354 5255600 | www.landsbokasafn.is\n&gt; ----=\r\n---------------------------------------------------------------------\n&gt; fyr=\r\nirvari/disclaimer - http://fyrirvari.landsbokasafn.is\n&gt;&gt; -----Original Mess=\r\nage-----\n&gt;&gt; From: archive-crawler@yahoogroups.com [mailto:archive-\n&gt;&gt; crawl=\r\ner@yahoogroups.com]\n&gt;&gt; Sent: 23. febr=C3=BAar 2015 21:41\n&gt;&gt; To: archive-cra=\r\nwler@yahoogroups.com\n&gt;&gt; Subject: Re: [archive-crawler] Do we need the check=\r\n for 0.0.0.0 in\n&gt;&gt; DefaultServerCache?\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; Hello Kris,\n&gt;&gt;\n&gt;&gt; To ans=\r\nwer your question, I&#39;m very wary of simply removing that code\n&gt;&gt; without re=\r\nplacing it, or without better understanding the implications.\n&gt;&gt;\n&gt;&gt; I can r=\r\nemember some of the background on this commit, but unfortunately I\n&gt;&gt; can&#39;t=\r\n remember all of it. I&#39;m sorry now that I didn&#39;t write a better commit\n&gt;&gt; m=\r\nessage or code comment.\n&gt;&gt;\n&gt;&gt; I remember that heritrix was trying to crawl =\r\n0.0.0.0, which resolves to\n&gt;&gt; localhost (on ubuntu at least). That could ar=\r\nguably be a security problem, as\n&gt;&gt; well as a confusing problem of archival=\r\n accuracy. I remember that we\n&gt;&gt; discovered that sometimes dns servers retu=\r\nrn 0.0.0.0 for certain hosts, and\n&gt;&gt; we were trying to figure if 0.0.0.0 mi=\r\nght also pop up because of bdb\n&gt;&gt; corruption or similar. I&#39;m not sure if we=\r\n resolved the latter question. I also\n&gt;&gt; remember thinking at the time that=\r\n this check was not a very good solution\n&gt;&gt; to the problem, but that a good=\r\n solution would be a lot more work and might\n&gt;&gt; involve breaking APIs.\n&gt;&gt;\n&gt;=\r\n&gt; What I can&#39;t remember right now is what exactly the good solution would b=\r\ne,\n&gt;&gt; if I had a specific one in mind. I also can&#39;t remember how the proble=\r\nm came\n&gt;&gt; to our attention. Nor if there was a good reason to check only fo=\r\nr 0.0.0.0 and\n&gt;&gt; not for other unroutable addresses, or other addresses tha=\r\nt resolve to\n&gt;&gt; localhost.\n&gt;&gt;\n&gt;&gt; &gt; This can cause a lot of alerts when usin=\r\ng the IpAddressSetDecideRule to\n&gt;&gt; apply sheets to candidate URIs.\n&gt;&gt;\n&gt;&gt; Is=\r\n that because dns resolves some host as 0.0.0.0 in your crawl job, or is it=\r\n\n&gt;&gt; happening for some other reason?\n&gt;&gt;\n&gt;&gt; Noah\n&gt;&gt;\n&gt;&gt; On Mon, Feb 23, 2015 =\r\nat 5:17 AM, Kristinn Sigur=C3=B0sson\n&gt;&gt; kristinn@... [archive-=\r\ncrawler] &lt;archive-\n&gt;&gt; crawler@yahoogroups.com&gt; wrote:\n&gt;&gt; &gt; The DefaultServe=\r\nrCache.getHostFor(String hostname) method has the\n&gt;&gt; following peculiar che=\r\nck:\n&gt;&gt; &gt;\n&gt;&gt; &gt; if (host !=3D null && host.getIP() !=3D null &&\n&gt;&gt; &gt; &quot;0.0.0.0=\r\n&quot;.equals(host.getIP().getHostAddress())) { throw new\n&gt;&gt; &gt; IllegalStateExcep=\r\ntion(&quot;got suspicious value 0.0.0.0 for &quot; + hostname);\n&gt;&gt; &gt; }\n&gt;&gt; &gt;\n&gt;&gt; &gt; http=\r\ns://github.com/internetarchive/heritrix3/blob/master/modules/src/m\n&gt;&gt; &gt; ain=\r\n/java/org/archive/modules/fetcher/DefaultServerCache.java#L110\n&gt;&gt; &gt;\n&gt;&gt; &gt; Th=\r\nis was introduced in this commit:\n&gt;&gt; &gt;\n&gt;&gt; https://github.com/internetarchiv=\r\ne/heritrix3/commit/df2a313797b15d01e3\n&gt;&gt; &gt; 959e309842b25ebb92ca91\n&gt;&gt; &gt;\n&gt;&gt; &gt;=\r\n This can cause a lot of alerts when using the IpAddressSetDecideRule to\n&gt;&gt;=\r\n apply sheets to candidate URIs.\n&gt;&gt; &gt;\n&gt;&gt; &gt; While this doesn&#39;t actually lead=\r\n to us miss any content it creates a lot of\n&gt;&gt; noise in the alert log, poss=\r\nibly obscuring a more important alert. This also\n&gt;&gt; seems a very peculiar t=\r\nhing to do, checking for just one particular non-\n&gt;&gt; routable address.\n&gt;&gt; &gt;=\r\n\n&gt;&gt; &gt; Can we lose this check?\n&gt;&gt; &gt;\n&gt;&gt; &gt; - Kris\n&gt;&gt; &gt; -----------------------=\r\n-----------------------------------\n&gt;&gt; &gt; Landsb=C3=B3kasafn =C3=8Dslands - =\r\nH=C3=A1sk=C3=B3lab=C3=B3kasafn | Arngr=C3=ADmsg=C3=B6tu 3 - 107\n&gt;&gt; &gt; Reykja=\r\nv=C3=ADk\n&gt;&gt; &gt; S=C3=ADmi/Tel: +354 5255600 | www.landsbokasafn.is\n&gt;&gt; &gt; -----=\r\n-----------------------------------------------------\n&gt;&gt; &gt; fyrirvari/discla=\r\nimer - http://fyrirvari.landsbokasafn.is\n&gt;&gt; &gt;\n&gt;&gt; &gt;\n&gt;&gt; &gt; -------------------=\r\n-----------------\n&gt;&gt; &gt; Posted by: =3D?utf-8?B?S3Jpc3Rpbm4gU2lndXLDsHNzb24=\r\n=3D?=3D\n&gt;&gt; &gt; &lt;kristinn@...&gt;\n&gt;&gt; &gt; -----------------------------=\r\n-------\n&gt;&gt; &gt;\n&gt;&gt; &gt;\n&gt;&gt; &gt; ------------------------------------\n&gt;&gt; &gt;\n&gt;&gt; &gt; Yahoo=\r\n Groups Links\n&gt;&gt; &gt;\n&gt;&gt; &gt;\n&gt;&gt; &gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;\n&gt;\n&gt; -------------------------------=\r\n-----\n&gt; Posted by: =3D?utf-8?B?S3Jpc3Rpbm4gU2lndXLDsHNzb24=3D?=3D &lt;kristinn=\r\n@...&gt;\n&gt; ------------------------------------\n&gt;\n&gt;\n&gt; -----------=\r\n-------------------------\n&gt;\n&gt; Yahoo Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}