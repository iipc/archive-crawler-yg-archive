{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":163406187,"authorName":"Kristinn Sigurdsson","from":"&quot;Kristinn Sigurdsson&quot; &lt;kris@...&gt;","profile":"kristsi25","replyTo":"LIST","senderId":"tJBZHcLZJiip9OBSds-5UwsjyGf7AH6JmBegXBDcN84mFsVLqlRbTYWq2gQ38qpuVbw1_zwtG35vnOx40B26PNolthFPUwFHZYR3QdjWmg","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: Mid Fetch filter","postDate":"1212400962","msgId":5257,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGcyMGdnMituZ3M2QGVHcm91cHMuY29tPg==","inReplyToHeader":"PDQ4M0VGMUM5LjgwNzAzMDhAYXJjaGl2ZS5vcmc+"},"prevInTopic":5246,"nextInTopic":5269,"prevInTime":5256,"nextInTime":5258,"topicId":5222,"numMessagesInTopic":6,"msgSnippet":"Probably the easiest way to do this is to have the mid-fetch filter tag the CrawlURI (using CrawlURI.put methods) and then have a processor run directly","rawEmail":"Return-Path: &lt;kris@...&gt;\r\nX-Sender: kris@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 47898 invoked from network); 2 Jun 2008 10:02:43 -0000\r\nX-Received: from unknown (66.218.67.96)\n  by m36.grp.scd.yahoo.com with QMQP; 2 Jun 2008 10:02:43 -0000\r\nX-Received: from unknown (HELO n42b.bullet.mail.sp1.yahoo.com) (66.163.168.156)\n  by mta17.grp.scd.yahoo.com with SMTP; 2 Jun 2008 10:02:43 -0000\r\nX-Received: from [216.252.122.216] by n42.bullet.mail.sp1.yahoo.com with NNFMP; 02 Jun 2008 10:02:43 -0000\r\nX-Received: from [66.218.69.2] by t1.bullet.sp1.yahoo.com with NNFMP; 02 Jun 2008 10:02:42 -0000\r\nX-Received: from [66.218.66.86] by t2.bullet.scd.yahoo.com with NNFMP; 02 Jun 2008 10:02:42 -0000\r\nDate: Mon, 02 Jun 2008 10:02:42 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;g20gg2+ngs6@...&gt;\r\nIn-Reply-To: &lt;483EF1C9.8070308@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: &quot;Kristinn Sigurdsson&quot; &lt;kris@...&gt;\r\nSubject: Re: Mid Fetch filter\r\nX-Yahoo-Group-Post: member; u=163406187; y=gcS2NIugyWhODUWlMehs3qF--pC1xWAuzFMOA85CqmXYYT4J\r\nX-Yahoo-Profile: kristsi25\r\n\r\nProbably the easiest way to do this is to have the mid-fetch filter\n&#39;tag&#39; t=\r\nhe CrawlURI (using CrawlURI.put methods) and then have a\nprocessor run dire=\r\nctly after the FetchHTTP processor that checks for\nthis tag. Filters are no=\r\nt allowed to affect the order of processing,\nbut processors are. The new pr=\r\nocessor could then skip CrawlURIs with\nthe tag to the PostProcessing chain,=\r\n bypassing link extraction and\nwriting processors.\n\nThe new processor&#39;s inn=\r\nerProcess method would look something like:\n\nif(curi.containsKey(MY_TAG) &&=\r\n curi.getInt(MY_TAG)=3D=3DABORTED_MID_FETCH){\n  \ncuri.skipToProcessorChain(=\r\ngetController().getProcessorChainList().getProcessorChain(CrawlOrder.ATTR_P=\r\nOST_PROCESSORS));\n\n}\n\n- Kris\n\n--- In archive-crawler@yahoogroups.com, Gordo=\r\nn Mohr &lt;gojomo@...&gt; wrote:\n&gt;\n&gt; The mid-fetch filter is private to the Fetch=\r\nHTTP processor and has no \n&gt; effects outside that processor.\n&gt; \n&gt; If you wa=\r\nnt an URL to not even begin processing, it should be ruled-out \n&gt; by the sc=\r\nope rules. If you want it to not be written, rules inside the \n&gt; writer pro=\r\ncessor can cause writing to be skipped.\n&gt; \n&gt; - Gordon @ IA\n&gt; \n&gt; gkbrown22 w=\r\nrote:\n&gt; &gt; Thanks Gordon, I understand that many of these smaller images may=\r\n not\n&gt; &gt; have any bandwidth benefit on this however I am trying to eliminat=\r\ne\n&gt; &gt; any images from being captured. Right now, even these that are being\n=\r\n&gt; &gt; logged as &quot;REJECT&quot; are still going to the write processor and are\n&gt; &gt; b=\r\neing written. That is what is confusing to me. I understand that the\n&gt; &gt; be=\r\nnefit to the server is nill but once the reject is returned why does\n&gt; &gt; th=\r\ne FetchHTTP go and get(or reget) the uri?\n&gt; &gt; &quot;org.archive.modules.fetcher.=\r\nFetchHTTP\n&gt; &gt;&gt;&gt; innerProcess GET&quot;\n&gt; &gt; and then passes it on to the writer? =\r\n(This is after the rejection by\n&gt; &gt; the filter.)\n&gt; &gt; \n&gt; &gt; This is what has =\r\nme confused. \n&gt; &gt; \n&gt; &gt; thanks\n&gt; &gt; -glen\n&gt; &gt; \n&gt; &gt; \n&gt; &gt; I will try and captur=\r\ne them on a filter at the writer \n&gt; &gt; --- In archive-crawler@...=\r\nm, Gordon Mohr &lt;gojomo@&gt; wrote:\n&gt; &gt;&gt; At best, the mid-fetch filter can abor=\r\nt a fetch that&#39;s already begun.\n&gt; &gt;&gt;\n&gt; &gt;&gt; As your log shows 1x1 GIFs way sm=\r\naller than a single TCP packet, the \n&gt; &gt;&gt; abort in those cases is likely to=\r\n be irrelevant to the server --\nas far \n&gt; &gt;&gt; as it&#39;s concerned, it already =\r\nfinished serving the request.\n&gt; &gt;&gt;\n&gt; &gt;&gt; Even with a large GIF, I don&#39;t know=\r\n if the server-side log would\nshow \n&gt; &gt;&gt; anything other than a successful r=\r\nesponse. (It would depend on how \n&gt; &gt;&gt; broken connections are logged.)\n&gt; &gt;&gt;=\r\n\n&gt; &gt;&gt; On the crawler side, I think even a mid-fetch abort leaves the\nentry =\r\nin \n&gt; &gt;&gt; the crawl.log and at least truncated content available for\nwriting=\r\n to \n&gt; &gt;&gt; W/ARC files. Are you seeing or expecting something different?\n&gt; &gt;=\r\n&gt;\n&gt; &gt;&gt; - Gordon @ IA\n&gt; &gt;&gt;\n&gt; &gt;&gt;\n&gt; &gt;&gt; gkbrown22 wrote:\n&gt; &gt;&gt;&gt; I am trying to c=\r\natch some images in a midfetch filter. I am\nusing the\n&gt; &gt;&gt;&gt; ContentTypeMatc=\r\nhesRegExpDecideRule  and from the log the rule\nseems to\n&gt; &gt;&gt;&gt; be working. B=\r\nut the image is fetched anyway. Here&#39;s the output from\n&gt; &gt;&gt;&gt; the log that i=\r\ns relevant:\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; e.commons.httpclient.HttpMethodBase processResponse=\r\nHeaders enter\n&gt; &gt;&gt;&gt; HttpMethodBase.processResponseHeaders(HttpState, HttpCo=\r\nnnection)\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINE\n&gt; &gt;&gt;&gt; org.archive.modules.de=\r\nciderules.ContentTypeMatchesRegExpDecideRule\n&gt; &gt;&gt;&gt; evaluate testing MidFetc=\r\nh Check for CT=3Dimage/gif\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINE\n&gt; &gt;&gt;&gt; org.a=\r\nrchive.modules.deciderules.ContentTypeMatchesRegExpDecideRule\n&gt; &gt;&gt;&gt; evaluat=\r\ne MidFetch CT results:true\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org=\r\n.archive.modules.deciderules.DecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRul=\r\ne #0\n&gt; &gt;&gt;&gt; org.archive.modules.deciderules.ContentTypeMatchesRegExpDecideRu=\r\nle\n&gt; &gt;&gt;&gt; returned REJECT\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 INFO\n&gt; &gt;&gt;&gt; org.arc=\r\nhive.modules.deciderules.DecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSeq=\r\nuence returned REJECT\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.arch=\r\nive.modules.deciderules.DecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequ=\r\nence returned REJECT\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 INFO org.archive.modul=\r\nes.fetcher.FetchHTTP\n&gt; &gt;&gt;&gt; checkMidfetchAbort ### checkMidfetchAbort return=\r\ning true -&gt; abort\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINEST\norg.archive.module=\r\ns.fetcher.FetchHTTP\n&gt; &gt;&gt;&gt; doAbort Aborting URI fetch\n&gt; &gt;&gt;&gt; 05/20/2008 14:25=\r\n:59 +0000 FINE org.archive.util.Recorder close\n&gt; &gt;&gt;&gt; ToeThread #11:\n&gt; &gt;&gt;&gt;\n&gt;=\r\n &gt;\nhttp://dw.com.com/rubicsimp/c.gif?ver=3D2&ts=3D2008.05.20.07.25.46&edId=\r\n=3D&onId=3D&ptId=3D&sId=3D-2&appId=3D19&unitId=3D45&poolId=3D1&f1=3D14&f2=\r\n=3D%2d0&f3=3D%2d0&alg=3D8&opt=3D1&off=3D1610,-1\n&gt; &gt;&gt;&gt; closing\n&gt; &gt;&gt;&gt; 05/20/2=\r\n008 14:25:59 +0000 FINE org.archive.io.RecordingInputStream\n&gt; &gt;&gt;&gt; close Toe=\r\nThread #11:\n&gt; &gt;&gt;&gt;\n&gt; &gt;\nhttp://dw.com.com/rubicsimp/c.gif?ver=3D2&ts=3D2008.0=\r\n5.20.07.25.46&edId=3D&onId=3D&ptId=3D&sId=3D-2&appId=3D19&unitId=3D45&poolI=\r\nd=3D1&f1=3D14&f2=3D%2d0&f3=3D%2d0&alg=3D8&opt=3D1&off=3D1610,-1\n&gt; &gt;&gt;&gt; closi=\r\nng java.io.BufferedInputStream@17490ad, ToeThread #11:\n&gt; &gt;&gt;&gt;\n&gt; &gt;\nhttp://dw.=\r\ncom.com/rubicsimp/c.gif?ver=3D2&ts=3D2008.05.20.07.25.46&edId=3D&onId=3D&pt=\r\nId=3D&sId=3D-2&appId=3D19&unitId=3D45&poolId=3D1&f1=3D14&f2=3D%2d0&f3=3D%2d=\r\n0&alg=3D8&opt=3D1&off=3D1610,-1\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;=\r\n&gt; org.apache.commons.httpclient.HttpConnection close enter\n&gt; &gt;&gt;&gt; HttpConnec=\r\ntion.close()\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.apache.common=\r\ns.httpclient.HttpConnection closeSocketAndStreams\n&gt; &gt;&gt;&gt; enter HttpConnectio=\r\nn.closeSockedAndStreams()\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINE org.archive.=\r\nio.RecordingInputStream\n&gt; &gt;&gt;&gt; close ToeThread #11:\n&gt; &gt;&gt;&gt;\n&gt; &gt;\nhttp://dw.com.=\r\ncom/rubicsimp/c.gif?ver=3D2&ts=3D2008.05.20.07.25.46&edId=3D&onId=3D&ptId=\r\n=3D&sId=3D-2&appId=3D19&unitId=3D45&poolId=3D1&f1=3D14&f2=3D%2d0&f3=3D%2d0&=\r\nalg=3D8&opt=3D1&off=3D1610,-1\n&gt; &gt;&gt;&gt; closing null, ToeThread #11:\n&gt; &gt;&gt;&gt;\n&gt; &gt;\n=\r\nhttp://dw.com.com/rubicsimp/c.gif?ver=3D2&ts=3D2008.05.20.07.25.46&edId=3D&=\r\nonId=3D&ptId=3D&sId=3D-2&appId=3D19&unitId=3D45&poolId=3D1&f1=3D14&f2=3D%2d=\r\n0&f3=3D%2d0&alg=3D8&opt=3D1&off=3D1610,-1\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 F=\r\nINEST\n&gt; &gt;&gt;&gt; org.apache.commons.httpclient.HttpConnection releaseConnection =\r\nenter\n&gt; &gt;&gt;&gt; HttpConnection.releaseConnection()\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0=\r\n000 FINE\n&gt; &gt;&gt;&gt; org.apache.commons.httpclient.HttpConnection releaseConnecti=\r\non\n&gt; &gt;&gt;&gt; Releasing connection back to connection manager.\n&gt; &gt;&gt;&gt; 05/20/2008 =\r\n14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.apache.commons.httpclient.HttpConnection cl=\r\nose enter\n&gt; &gt;&gt;&gt; HttpConnection.close()\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINE=\r\nST\n&gt; &gt;&gt;&gt; org.apache.commons.httpclient.HttpConnection closeSocketAndStreams=\r\n\n&gt; &gt;&gt;&gt; enter HttpConnection.closeSockedAndStreams()\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:=\r\n59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.apache.commons.httpclient.HttpMethodBase getConte=\r\nntCharSet enter\n&gt; &gt;&gt;&gt; getContentCharSet( Header contentheader )\n&gt; &gt;&gt;&gt; 05/20=\r\n/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.apache.commons.httpclient.HeaderEleme=\r\nnt parseElements enter\n&gt; &gt;&gt;&gt; HeaderElement.parseElements(String)\n&gt; &gt;&gt;&gt; 05/2=\r\n0/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.apache.commons.httpclient.HeaderElem=\r\nent parseElements enter\n&gt; &gt;&gt;&gt; HeaderElement.parseElements(char[])\n&gt; &gt;&gt;&gt; 05/=\r\n20/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.apache.commons.httpclient.HeaderEle=\r\nment getParameterByName enter\n&gt; &gt;&gt;&gt; HeaderElement.getParameterByName(String=\r\n)\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINE\n&gt; &gt;&gt;&gt; org.apache.commons.httpclient.=\r\nHttpMethodBase getContentCharSet\nDefault\n&gt; &gt;&gt;&gt; charset used: ISO-8859-1\n&gt; &gt;=\r\n&gt;&gt; 05/20/2008 14:25:59 +0000 INFO org.archive.modules.fetcher.FetchHTTP\n&gt; &gt;=\r\n&gt;&gt; innerProcess GET\n&gt; &gt;&gt;&gt;\n&gt; &gt;\nhttp://dw.com.com/rubicsimp/c.gif?ver=3D2&ts=\r\n=3D2008.05.20.07.25.46&edId=3D&onId=3D&ptId=3D&sId=3D-2&appId=3D19&unitId=\r\n=3D45&poolId=3D1&f1=3D14&f2=3D%2d0&f3=3D%2d0&alg=3D8&opt=3D1&off=3D1610,-1\n=\r\n&gt; &gt;&gt;&gt; 200 353 image/gif\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 INFO\n&gt; &gt;&gt;&gt; org.arch=\r\nive.modules.deciderules.DecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequ=\r\nence returned PASS\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.archive=\r\n.modules.deciderules.DecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequenc=\r\ne returned PASS\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 INFO\n&gt; &gt;&gt;&gt; org.archive.modu=\r\nles.deciderules.DecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence ret=\r\nurned PASS\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.archive.modules=\r\n.deciderules.DecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence return=\r\ned PASS\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 INFO\n&gt; &gt;&gt;&gt; org.archive.modules.deci=\r\nderules.DecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence returned PA=\r\nSS\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.archive.modules.decider=\r\nules.DecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence returned PASS\n=\r\n&gt; &gt;&gt;&gt; 05/20/2008 14:25:59 +0000 INFO\n&gt; &gt;&gt;&gt; org.archive.modules.deciderules.=\r\nDecideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence returned PASS\n&gt; &gt;&gt;&gt;=\r\n 05/20/2008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.archive.modules.deciderules.Dec=\r\nideRuleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence returned PASS\n&gt; &gt;&gt;&gt; 05=\r\n/20/2008 14:25:59 +0000 INFO\n&gt; &gt;&gt;&gt; org.archive.modules.deciderules.DecideRu=\r\nleSequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence returned PASS\n&gt; &gt;&gt;&gt; 05/20/2=\r\n008 14:25:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.archive.modules.deciderules.DecideRuleS=\r\nequence innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence returned PASS\n&gt; &gt;&gt;&gt; 05/20/2008=\r\n 14:25:59 +0000 INFO\n&gt; &gt;&gt;&gt; org.archive.modules.deciderules.DecideRuleSequen=\r\nce innerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence returned PASS\n&gt; &gt;&gt;&gt; 05/20/2008 14:2=\r\n5:59 +0000 FINEST\n&gt; &gt;&gt;&gt; org.archive.modules.deciderules.DecideRuleSequence =\r\ninnerDecide\n&gt; &gt;&gt;&gt; DecideRuleSequence returned PASS\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; Then the lin=\r\nk is written. \n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; Any ideas?\n&gt; &gt;&gt;&gt; thanks\n&gt; &gt;&gt;&gt; -glen\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt;\n=\r\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; ------------------------------------\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt; Yahoo! Groups =\r\nLinks\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt;\n&gt; &gt;&gt;&gt;\n&gt; &gt; \n&gt; &gt; \n&gt; &gt; \n&gt; &gt; --------------------------------=\r\n----\n&gt; &gt; \n&gt; &gt; Yahoo! Groups Links\n&gt; &gt; \n&gt; &gt; \n&gt; &gt;\n&gt;\n\n\n\n"}}