{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"TdQTvYR5nWkbczX1x1OOw6-kKX7OYEuuTpAB29ccECMfhFv0Ag955ywk2rkmIfahvpy5wK9YBOx2Shg2t7kKSr3mtfTvINs","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: [archive-crawler] QuotaEnforcer and object limit","postDate":"1252456279","msgId":6014,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRBQTZGNzU3LjgwNjA2MDNAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDE1Y2VlYWI1MDkwOTAyMTAwNHIyNjEyYWUwMHE1OTIxYjdkODQ2NWFjYjZkQG1haWwuZ21haWwuY29tPg==","referencesHeader":"PDE1Y2VlYWI1MDkwOTAyMTAwNHIyNjEyYWUwMHE1OTIxYjdkODQ2NWFjYjZkQG1haWwuZ21haWwuY29tPg=="},"prevInTopic":6009,"nextInTopic":0,"prevInTime":6013,"nextInTime":6016,"topicId":6009,"numMessagesInTopic":2,"msgSnippet":"You ve found a bug! I made an issue... http://webarchive.jira.com/browse/HER-1675 ..and committed a simple fix that properly tallies all responses. We don t","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 94376 invoked from network); 9 Sep 2009 00:31:20 -0000\r\nX-Received: from unknown (98.137.34.46)\n  by m3.grp.re1.yahoo.com with QMQP; 9 Sep 2009 00:31:20 -0000\r\nX-Received: from unknown (HELO relay02.pair.com) (209.68.5.16)\n  by mta3.grp.sp2.yahoo.com with SMTP; 9 Sep 2009 00:31:20 -0000\r\nX-Received: (qmail 57912 invoked from network); 9 Sep 2009 00:31:18 -0000\r\nX-Received: from 67.188.14.54 (HELO ?192.168.1.84?) (67.188.14.54)\n  by relay02.pair.com with SMTP; 9 Sep 2009 00:31:18 -0000\r\nX-pair-Authenticated: 67.188.14.54\r\nMessage-ID: &lt;4AA6F757.8060603@...&gt;\r\nDate: Tue, 08 Sep 2009 17:31:19 -0700\r\nUser-Agent: Thunderbird 2.0.0.23 (Windows/20090812)\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;15ceeab50909021004r2612ae00q5921b7d8465acb6d@...&gt;\r\nIn-Reply-To: &lt;15ceeab50909021004r2612ae00q5921b7d8465acb6d@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 8bit\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] QuotaEnforcer and object limit\r\nX-Yahoo-Group-Post: member; u=137285340; y=3ts6mLhbhMdmB3wPOQgof4mHUoHbBUPX40WE_1gFez5g\r\nX-Yahoo-Profile: gojomo\r\n\r\nYou&#39;ve found a bug! I made an issue...\n\nhttp://webarchive.jira.com/browse/HER-1675\n\n..and committed a simple fix that properly tallies all responses.\n\nWe don&#39;t yet have a timeframe in mind for the next official release of \nthe H1 line (1.14.4), so if you need this fix you may want to grab a \nprerelease development build or patch a local copy yourself.\n\nAlternatively, if you can change your quota to be based on successes \n(rather than all responses), that should work even without the fix.\n\nThanks for bringing this to our attention,\n\n- Gordon @ IA\n\nNicolas Giraud wrote:\n&gt; \n&gt; \n&gt; Hi,\n&gt; \n&gt; I&#39;m trying to have queues retire when a certain object count has been \n&gt; reached for the CrawlURI&#39;s domain. I have configured the crawl to have \n&gt; one queue per domain. So the way I know about is to set the \n&gt; queue-total-budget parameter of the frontier to the limit I want. Here&#39;s \n&gt; my frontier configuration:\n&gt; \n&gt; &lt;newObject name=&quot;frontier&quot; class=&quot;org.archive.crawler.frontier.BdbFrontier&quot;&gt;\n&gt;       &lt;float name=&quot;delay-factor&quot;&gt;2.0&lt;/float&gt;\n&gt;       &lt;integer name=&quot;max-delay-ms&quot;&gt;10000&lt;/integer&gt;\n&gt;       &lt;integer name=&quot;min-delay-ms&quot;&gt;2000&lt;/integer&gt;\n&gt;       &lt;integer name=&quot;max-retries&quot;&gt;10&lt;/integer&gt;\n&gt;       &lt;long name=&quot;retry-delay-seconds&quot;&gt;60&lt;/long&gt;\n&gt;       &lt;integer name=&quot;preference-embed-hops&quot;&gt;1&lt;/integer&gt;\n&gt;       &lt;integer name=&quot;total-bandwidth-usage-KB-sec&quot;&gt;1500&lt;/integer&gt;\n&gt;       &lt;integer name=&quot;max-per-host-bandwidth-usage-KB-sec&quot;&gt;500&lt;/integer&gt;\n&gt;       &lt;string \n&gt; name=&quot;queue-assignment-policy&quot;&gt;dk.netarkivet.harvester.harvesting.DomainnameQueueAssignmentPolicy&lt;/string&gt;\n&gt;       &lt;string name=&quot;force-queue-assignment&quot;/&gt;\n&gt;       &lt;boolean name=&quot;pause-at-start&quot;&gt;false&lt;/boolean&gt;\n&gt;       &lt;boolean name=&quot;pause-at-finish&quot;&gt;false&lt;/boolean&gt;\n&gt;       &lt;boolean name=&quot;source-tag-seeds&quot;&gt;false&lt;/boolean&gt;\n&gt;       &lt;boolean name=&quot;recovery-log-enabled&quot;&gt;false&lt;/boolean&gt;\n&gt;       &lt;boolean name=&quot;hold-queues&quot;&gt;true&lt;/boolean&gt;\n&gt;       &lt;integer name=&quot;balance-replenish-amount&quot;&gt;500&lt;/integer&gt;\n&gt;       &lt;integer name=&quot;error-penalty-amount&quot;&gt;100&lt;/integer&gt;\n&gt;       &lt;long name=&quot;queue-total-budget&quot;&gt;50&lt;/long&gt;\n&gt;       &lt;string \n&gt; name=&quot;cost-policy&quot;&gt;org.archive.crawler.frontier.UnitCostAssignmentPolicy&lt;/string&gt;\n&gt;       &lt;long name=&quot;snooze-deactivate-ms&quot;&gt;2000&lt;/long&gt;\n&gt;       &lt;integer name=&quot;target-ready-backlog&quot;&gt;50&lt;/integer&gt;\n&gt;       &lt;string \n&gt; name=&quot;uri-included-structure&quot;&gt;org.archive.crawler.util.BdbUriUniqFilter&lt;/string&gt;\n&gt;     &lt;/newObject&gt;\n&gt; \n&gt; Some parameters are pretty low, this is a config for a dev test machine.\n&gt; \n&gt; I also use a QuotaEnforcer pre-fetch processor :\n&gt; \n&gt; &lt;newObject name=&quot;QuotaEnforcer&quot; \n&gt; class=&quot;org.archive.crawler.prefetch.QuotaEnforcer&quot;&gt;\n&gt;         &lt;boolean name=&quot;force-retire&quot;&gt;false&lt;/boolean&gt;\n&gt;         &lt;boolean name=&quot;enabled&quot;&gt;true&lt;/boolean&gt;\n&gt;         &lt;newObject name=&quot;QuotaEnforcer#decide-rules&quot; \n&gt; class=&quot;org.archive.crawler.deciderules.DecideRuleSequence&quot;&gt;\n&gt;           &lt;map name=&quot;rules&quot;/&gt;\n&gt;         &lt;/newObject&gt;\n&gt;         &lt;long name=&quot;server-max-fetch-successes&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;server-max-success-kb&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;server-max-fetch-responses&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;server-max-all-kb&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;host-max-fetch-successes&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;host-max-success-kb&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;host-max-fetch-responses&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;host-max-all-kb&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;group-max-fetch-successes&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;group-max-success-kb&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;group-max-fetch-responses&quot;&gt;-1&lt;/long&gt;\n&gt;         &lt;long name=&quot;group-max-all-kb&quot;&gt;[limit in kB]&lt;/long&gt;\n&gt;       &lt;/newObject&gt;\n&gt; \n&gt; So I wanted to try to also put the object limit in the QuotaEnforcer \n&gt; configuration, and made the following changes to my config:\n&gt; \n&gt; - queue-total-budget = -1\n&gt; - group-max-fetch-responses = my object count limit\n&gt; \n&gt; This doesn&#39;t seem to work, the crawls go beyond the configured limit, so \n&gt; there must be something wrong in my config. I&#39;ve tried to set the \n&gt; force-retire parameter of QuotaEnforcer to &quot;true&quot;, to no avail.\n&gt; \n&gt; Any suggestions, advice is more than welcome.\n&gt; \n&gt; Best regards,\n&gt; \n&gt; Nicolas Giraud\n&gt; ---------------------------------------------------------------------------------------------\n&gt; D�veloppeur Archives du Web - Web Archiving Developper\n&gt; Biblioth�que Nationale de France - National Library of France\n&gt; ---------------------------------------------------------------------------------------------\n&gt; \n&gt; \n&gt; \n\n"}}