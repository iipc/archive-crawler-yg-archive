{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137477665,"authorName":"igor@archive.org","from":"igor@...","profile":"iranitovic","replyTo":"LIST","senderId":"nsUZblKqFUvxFkijdrPT9e8_eKv1rkpCIYZ60Nd3MPxo0KmaLLZanvJnYYHstmr--bHgw9hkQQ","spamInfo":{"isSpam":false,"reason":"3"},"subject":"Re: [archive-crawler] ServerCache lookup stuck","postDate":"1252951860","msgId":6030,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDY0MTMzLjM4Ljk5LjQyLjI0NC4xMjUyOTUxODYwLnNxdWlycmVsQG1haWwuYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDRBQUUwODlCLjUwMzA4MDRAYXJjaGl2ZS5vcmc+","referencesHeader":"PGg4aXBmcytsaHBwQGVHcm91cHMuY29tPiAgICA8NjE3MDYuOTguMjM0Ljg2LjE2Ny4xMjUyODY4NTU2LnNxdWlycmVsQG1haWwuYXJjaGl2ZS5vcmc+ICAgIDw0QUFFMDg5Qi41MDMwODA0QGFyY2hpdmUub3JnPg=="},"prevInTopic":6029,"nextInTopic":6032,"prevInTime":6029,"nextInTime":6031,"topicId":6026,"numMessagesInTopic":15,"msgSnippet":"Hi Gordon, Thanks for looking into it. See comments below. ... Only one toe thread, that is right. ... There is more than one thread active given that there is","rawEmail":"Return-Path: &lt;igor@...&gt;\r\nX-Sender: igor@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 67717 invoked from network); 14 Sep 2009 18:11:15 -0000\r\nX-Received: from unknown (69.147.108.200)\n  by m4.grp.sp2.yahoo.com with QMQP; 14 Sep 2009 18:11:15 -0000\r\nX-Received: from unknown (HELO mail.archive.org) (207.241.231.239)\n  by mta1.grp.re1.yahoo.com with SMTP; 14 Sep 2009 18:11:14 -0000\r\nX-Received: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id D7B4226BBDF\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Mon, 14 Sep 2009 11:11:09 -0700 (PDT)\r\nX-Received: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id aX761PezQ92j for &lt;archive-crawler@yahoogroups.com&gt;;\n\tMon, 14 Sep 2009 11:11:01 -0700 (PDT)\r\nX-Received: from mail.archive.org (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id D5CBE26B829\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Mon, 14 Sep 2009 11:11:00 -0700 (PDT)\r\nX-Received: from 38.99.42.244\n        (SquirrelMail authenticated user igor@...)\n        by mail.archive.org with HTTP;\n        Mon, 14 Sep 2009 11:11:00 -0700 (PDT)\r\nMessage-ID: &lt;64133.38.99.42.244.1252951860.squirrel@...&gt;\r\nIn-Reply-To: &lt;4AAE089B.5030804@...&gt;\r\nReferences: &lt;h8ipfs+lhpp@...&gt;\n    &lt;61706.98.234.86.167.1252868556.squirrel@...&gt;\n    &lt;4AAE089B.5030804@...&gt;\r\nDate: Mon, 14 Sep 2009 11:11:00 -0700 (PDT)\r\nTo: archive-crawler@yahoogroups.com\r\nUser-Agent: SquirrelMail/1.4.10a\r\nMIME-Version: 1.0\r\nContent-Type: multipart/mixed;boundary=&quot;----=_20090914111100_41807&quot;\r\nX-Priority: 3 (Normal)\r\nImportance: Normal\r\nX-eGroups-Msg-Info: 2:3:4:0:0\r\nFrom: igor@...\r\nSubject: Re: [archive-crawler] ServerCache lookup stuck\r\nX-Yahoo-Group-Post: member; u=137477665; y=7URk3bUauBCTY1Qer2qAwtC4y1Spzh_-bvfo7UIPZl8vH1pONg\r\nX-Yahoo-Profile: iranitovic\r\n\r\n\r\n------=_20090914111100_41807\r\nContent-Type: text/plain; charset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: 8bit\r\n\r\nHi Gordon,\n\nThanks for looking into it. See comments below.\n\n&gt; The CachedBdbMap somewhat recently (since last official release)\n&gt; underwent some major refactoring to improve concurrency. The test\n&gt; coverage is reasonable and the code has been through some volume tests\n&gt; without showing problems, but this might be a new bug triggered by that\n&gt; code.\n&gt; If you pause the crawl, I presume only that one thread remains active.\n&gt; Is that right?\n\nOnly one toe thread, that is right.\n\n&gt; Is the CPU busy with only that thread active? I&#39;m still considering the\n&gt; other stacks you forwarded in a subsequent message; can you collect even\n&gt; more samples to get a sense of which branches are always being taken in\n&gt; the relevant methods?\n\nThere is more than one thread active given that there is JMX activities\neven when the crawl is paused.\n\nThere are at least two more JMX threads (trying to import an URI) that are\nstuck in the same loop as the toe thread.\n\nI attached a file with 100 quick thread dumps related to toe thread #19.\n\n&gt; The CachedBdbMap depends on some some garbage-collection-related\n&gt; trickery that might not be reliable in all JVMs. Can you say what\n&gt; JVM/host OS you&#39;re using?\n\nSun&#39;s 1.6 (1.6.0_10-b33) and CentOS (CentOS release 5.3 (Final)).\n\ni.\n\n&gt; igor@... wrote:\n&gt;&gt; I got a stuck thread that is disrupting the crawl.\n&gt;&gt;\n&gt;&gt; Heritrix verion:\n&gt;&gt; 1.15.4 (checked out on 9/9/2009)\n&gt;&gt;\n&gt;&gt; Java env:\n&gt;&gt; Linux 2.6.18-128.1.10.el5PAE #1 SMP Thu May 7 11:14:31 EDT 2009 i686\n&gt;&gt; i686\n&gt;&gt; i386 GNU/Linux\n&gt;&gt; java version &quot;1.6.0_10&quot;\n&gt;&gt; Java(TM) SE Runtime Environment (build 1.6.0_10-b33)\n&gt;&gt; Java HotSpot(TM) Server VM (build 11.0-b15, mixed mode)\n&gt;&gt; JAVA_OPTS=-Xmx512m\n&gt;&gt;\n&gt;&gt; Sleepycat:\n&gt;&gt; je-3.3.82.jar\n&gt;&gt;\n&gt;&gt; Here is the thread dump:\n&gt;&gt; ToeThread #19: http://newyork.craigslist.org/mnh/tix/1371733715.html\n&gt;&gt;  CrawlURI http://newyork.craigslist.org/mnh/tix/1371733715.html      1\n&gt;&gt; attempts\n&gt;&gt;     in processor: Preprocessor\n&gt;&gt;     ACTIVE for 16h25m22s108ms\n&gt;&gt;     step: ABOUT_TO_BEGIN_PROCESSOR for 16h25m22s108ms\n&gt;&gt;     org.archive.util.CachedBdbMap$SoftEntry.getPhantom(CachedBdbMap.java:1625)\n&gt;&gt;     org.archive.util.CachedBdbMap$SoftEntry.isCleared(CachedBdbMap.java:1632)\n&gt;&gt;     org.archive.util.CachedBdbMap$SoftEntry.startExpunge(CachedBdbMap.java:1693)\n&gt;&gt;     org.archive.util.CachedBdbMap.isExpunged(CachedBdbMap.java:490)\n&gt;&gt;     org.archive.util.CachedBdbMap._getMem(CachedBdbMap.java:698)\n&gt;&gt;     org.archive.util.CachedBdbMap.get(CachedBdbMap.java:627)\n&gt;&gt;     org.archive.crawler.datamodel.ServerCache.getServerFor(ServerCache.java:99)\n&gt;&gt;     org.archive.crawler.datamodel.ServerCache.getServerFor(ServerCache.java:124)\n&gt;&gt;     org.archive.crawler.prefetch.PreconditionEnforcer.considerDnsPreconditions(PreconditionEnforcer.java:227)\n&gt;&gt;     org.archive.crawler.prefetch.PreconditionEnforcer.innerProcess(PreconditionEnforcer.java:111)\n&gt;&gt;     org.archive.crawler.framework.Processor.process(Processor.java:112)\n&gt;&gt;     org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:302)\n&gt;&gt;     org.archive.crawler.framework.ToeThread.run(ToeThread.java:151)\n&gt;&gt;\n&gt;&gt; i.\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; ------------------------------------\n&gt;&gt;\n&gt;&gt; Yahoo! Groups Links\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n&gt;\n\r\n------=_20090914111100_41807\r\nContent-Type: text/plain; name=&quot;tt19.txt&quot;\r\nContent-Disposition: attachment; filename=&quot;tt19.txt&quot;\r\n\r\n[ Attachment content not displayed ]\r\n------=_20090914111100_41807--\r\n\n"}}