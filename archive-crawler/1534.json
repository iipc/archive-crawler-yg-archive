{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":4480673,"authorName":"Dave Skinner","from":"Dave Skinner &lt;dave@...&gt;","profile":"frodobay","replyTo":"LIST","senderId":"DWznkd1HYFXZgvU6yOtSUl3MrCXtY_mfPXSz4eyIcFruySwe6rz2W4F0orabrJ7hmeB_6z7b-c-Q8TI6DtRVhWdiQwo","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] a filter proposal","postDate":"1108072555","msgId":1534,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDYuMS4yLjAuMC4yMDA1MDIxMDEzMDE1Ni4wM2E1OWE4OEAyMDYuMTYzLjEwMy40Pg==","inReplyToHeader":"PDQyMEJBNUUyLjQwOTA0MDJAYXJjaGl2ZS5vcmc+","referencesHeader":"PDQyMDc5QTY0LjIwNjAyMDlAYXJjaGl2ZS5vcmc+IDwwNjc4REIxOTY4RUFDNzQwOUNDM0QwQUI3QTExQjg0QTA2RUM1N0Bza2FyZnVyLmJvay5sb2NhbD4gPDYuMS4yLjAuMC4yMDA1MDIwNzExNDAwNy4wNDM0MjE0OEAyMDYuMTYzLjEwMy40PiA8NDIwQkE1RTIuNDA5MDQwMkBhcmNoaXZlLm9yZz4="},"prevInTopic":1529,"nextInTopic":1537,"prevInTime":1533,"nextInTime":1535,"topicId":1452,"numMessagesInTopic":24,"msgSnippet":"... yep, been there, done that, etc ... I hope you are right.  In the distant past I did lots of term papers in a few hours.  Maybe I m reading more into the","rawEmail":"Return-Path: &lt;dave@...&gt;\r\nX-Sender: dave@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 28768 invoked from network); 10 Feb 2005 22:00:13 -0000\r\nReceived: from unknown (66.218.66.218)\n  by m21.grp.scd.yahoo.com with QMQP; 10 Feb 2005 22:00:13 -0000\r\nReceived: from unknown (HELO solid.net) (206.163.103.1)\n  by mta3.grp.scd.yahoo.com with SMTP; 10 Feb 2005 22:00:13 -0000\r\nReceived: from t_laptop.solid.net (or-65-40-182-229.dyn.sprint-hsd.net [65.40.182.229])\n\tby solid.net (8.12.8/8.12.8) with ESMTP id j1ALxlEv022762\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Thu, 10 Feb 2005 13:59:48 -0800\r\nMessage-Id: &lt;6.1.2.0.0.20050210130156.03a59a88@206.163.103.4&gt;\r\nX-Sender: dave@206.163.103.4 (Unverified)\r\nX-Mailer: QUALCOMM Windows Eudora Version 6.1.2.0\r\nDate: Thu, 10 Feb 2005 13:55:55 -0800\r\nTo: archive-crawler@yahoogroups.com\r\nIn-Reply-To: &lt;420BA5E2.4090402@...&gt;\r\nReferences: &lt;42079A64.2060209@...&gt;\n &lt;0678DB1968EAC7409CC3D0AB7A11B84A06EC57@...&gt;\n &lt;6.1.2.0.0.20050207114007.04342148@206.163.103.4&gt;\n &lt;420BA5E2.4090402@...&gt;\r\nMime-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;us-ascii&quot;; format=flowed\r\nX-eGroups-Remote-IP: 206.163.103.1\r\nFrom: Dave Skinner &lt;dave@...&gt;\r\nSubject: Re: [archive-crawler] a filter proposal\r\nX-Yahoo-Group-Post: member; u=4480673\r\nX-Yahoo-Profile: frodobay\r\n\r\n\n&gt;\n&gt;clarify their actions -- this&#39;d be a good thing -- having to reverse\n&gt;their operation in a few cases so they&#39;d fit with your proposal.  But we\n&gt;found that the changes quickly started to mount in number.  At a certain\n&gt;stage -- considering that any change to filters/scoping will be highly\n&gt;disruptive requiring reformulation of order files -- we called a halt\n\nyep, been there, done that, etc\n\n&gt;and decided that we&#39;d rather just go the whole hog and go for the\n&gt;already cited &#39;NewScopingModel&#39; described in\n&gt;http://crawler.archive.org/cgi-bin/wiki.pl?NewScopingModel\n&gt;&lt;http://crawler.archive.org/cgi-bin/wiki.pl?NewScopingModel.&gt;  The\n&gt;thinking here is that its more like a term paper than it is a master\n&gt;thesis (smile); that we could get it up and running pretty quickly.\n\nI hope you are right.  In the distant past I did lots of term papers in a \nfew hours.  Maybe I&#39;m reading more into the proposal than you really put in \nthere.\n\n&gt;We&#39;ve bumped up the priority on the scoping change to be the next\n&gt;feature we implement after we address OOME&#39;ing.\n\nI&#39;d like that, whatever the filter model is, it should simplify my life.\n\nIts strange you mention OOMEs.  I woke up this morning thinking about them \nand mentally put them on my list of things to look at today.  Then I \ndiscovered that I got one three hours into a 10-12 hour run last night.  A \n512Mb heap and it still shut down.  When I looked at it, the heritrix page \nheader said was only using about 170megs of heap.  I&#39;ve not looked for it, \nbut is heritrix forcing garbage collection once in a while?   I think that \nforcing it with gc()?? and runFinalization()?? does a better job than the \nautomatic garbage collection.  I&#39;d put together a chunk of pseudo code that \nshould not impact thruput if you like.   btw, most (all?) of the OOME&#39;s I&#39;m \ngetting are in one of the special extractors, ie js, pdf, doc....   Maybe \nthey should just create an alert and keep running instead of stopping.  It \nmay be that just the one thread is out of memory.\n\n&gt;In spite of the above, may we take a look at your patch, whatever its\n&gt;state, so we can see the nature of the changes made implementing your\n&gt;proposal?  Maybe its possible to get away with a small number of changes\n&gt;afterall.  Send it to me privately if you&#39;d like.\n\nright now its patch(es) and they are all over.  But I&#39;ll make some diffs, \nfigure out what really needs to be there for this, tar it up, and mail it \nto you.  I must be close to being done, they have been getting simpler.\n\ndo you want diffs or my &quot;working sources&quot;?  The sources I&#39;m using for this \nare based on head about a week ago.\n\n\n&gt;(Lets consider your suggestion that a filter return &#39;true&#39; if\n&gt;misconfigured or disabled separately as part of &#39;[ 1103015 ] If filter\n&gt;in main scope disabled heritrix aborts imme...&#39; and &#39;[ 1105025 ]\n&gt;Prefetch filter should skip eval if disabled&#39;).\n&gt;&lt;&gt;\n&gt;Yours,\n&gt;St.Ack\n&gt;\n&gt;P.S.  I fixed the manuals.  Thanks for pointing out the discrepency.\n&gt;\n&gt;\n&gt;\n&gt;Dave Skinner wrote:\n&gt;\n&gt; &gt; I normally do broad crawls and use lots of special filters to limit the\n&gt; &gt; scope so that heritrix does not just run out of memory and crash....\n&gt; &gt;\n&gt; &gt; However the internal issue that sometimes a filter normally returns true\n&gt; &gt; and sometime false is a problem for me and looking at the code and\n&gt; &gt; reading\n&gt; &gt; things like the user and developer manual makes me think that I&#39;m not the\n&gt; &gt; only person it has bothered.\n&gt; &gt;\n&gt; &gt; in a recent private email to me someone said\n&gt; &gt;\n&gt; &gt; &gt;Filters are not our proudest moment.  ..... was to have replaced the way\n&gt; &gt; &gt;they work by now.  Here is a writeup that was done on an alternative:\n&gt; &gt; &gt;http://crawler.archive.org/cgi-bin/wiki.pl?NewScopingModel.  We just\n&gt; &gt; &gt;haven&#39;t gotten around to it.\n&gt; &gt;\n&gt; &gt; The proposal would be a great thing to have implemented, but it looks\n&gt; &gt; to me\n&gt; &gt; that it has about as much work in it as some master thesis projects\n&gt; &gt; and its\n&gt; &gt; going to be hard to get someone to do it.\n&gt; &gt;\n&gt; &gt; I&#39;d like to propose something that would simplify things in the short\n&gt; &gt; term\n&gt; &gt; and hopefully make any future changes/testing easier.\n&gt; &gt;\n&gt; &gt; Let&#39;s change the definition of the result of filter to simply be\n&gt; &gt;\n&gt; &gt; *true* means to continue *normal processing*.\n&gt; &gt;\n&gt; &gt; (this compliments the result of the pre-fetch filters)\n&gt; &gt;\n&gt; &gt; I think everyone likely to read this knows what normal processing\n&gt; &gt; means but\n&gt; &gt; just to clarify what I think it means, let&#39;s say that normal\n&gt; &gt; processing is\n&gt; &gt; that a URI progresses step by step thru the chain illustrated in the user\n&gt; &gt; manual in section 6.1.3.\n&gt; &gt;\n&gt; &gt; As an extension of this I&#39;d like say that a filter that has *enabled* set\n&gt; &gt; to false or is incompletely configured (for example a regexp filter\n&gt; &gt; with no\n&gt; &gt; filter string) should normally return true.  (As an example of a current\n&gt; &gt; problem related to this, just set enabled in the pathdepth filter\n&gt; &gt; configured in the default profile to false.)\n&gt; &gt;\n&gt; &gt; I was going to suggest this last week and post some sample code but had a\n&gt; &gt; machine run out of disk storage while doing a crawl and linux instead of\n&gt; &gt; just crashing the job reused the disk space that was being occupied by\n&gt; &gt; recently referenced files.  As a result of that problem I had to\n&gt; &gt; recover my\n&gt; &gt; source and retest everything.\n&gt; &gt;\n&gt; &gt; As part of that I downloaded the current head and implemented this (so\n&gt; &gt; now\n&gt; &gt; I have real code).  Right now it is working but I need to review the\n&gt; &gt; following.\n&gt; &gt;\n&gt; &gt; Most filters can use the &quot;return true&quot; if not enabled or configured idea\n&gt; &gt; except some filters used in scopes.  They may have a special problem\n&gt; &gt; which\n&gt; &gt; I&#39;m going to look at later today.\n&gt; &gt;\n&gt; &gt; The following formula is in the user manual\n&gt; &gt;    ( ( focusFilter.accepts(u)\n&gt; &gt;          || transitiveFilter.accepts(u) )\n&gt; &gt;        && exclusionFilter.accepts(u) == false )\n&gt; &gt;\n&gt; &gt; The accurate version of it is in the developer manual\n&gt; &gt;\n&gt; &gt; protected final boolean innerAccepts(Object o) {\n&gt; &gt;      return ((isSeed(o) || focusAccepts(o)) ||\n&gt; &gt; additionalFocusAccepts(o) ||\n&gt; &gt;              transitiveAccepts(o)) && !excludeAccepts(o);\n&gt; &gt;\n&gt; &gt; the potential problem is in the focusAccepts and\n&gt; &gt; additionalFocusAccepts calls\n&gt; &gt;\n&gt; &gt; btw, in my code I&#39;ve changed this equation to be\n&gt; &gt;\n&gt; &gt;    return (((isSeed(o) || focusAccepts(o)) || additionalFocusAccepts(o) ||\n&gt; &gt;              transitiveAccepts(o)) && excludeAccepts(o);\n&gt; &gt;\n&gt; &gt; I&#39;m not too worried if the focusAccepts have to remain special cases\n&gt; &gt; because end users are not too likely to be changing them.\n&gt; &gt;\n&gt; &gt; the need for the &quot;OR&quot; filter has vanished.\n&gt; &gt;\n&gt; &gt; here is the diff between the current profile in head and the proposed\n&gt; &gt; new one\n&gt; &gt;\n&gt; &gt; 7,43c29,38\n&gt; &gt; &lt;       &lt;newObject name=&quot;exclude-filter&quot;\n&gt; &gt; class=&quot;org.archive.crawler.filter.OrFilter&quot;&gt;\n&gt; &gt; &lt;         &lt;boolean name=&quot;enabled&quot;&gt;true&lt;/boolean&gt;\n&gt; &gt; &lt;         &lt;boolean name=&quot;if-matches-return&quot;&gt;true&lt;/boolean&gt;\n&gt; &gt; &lt;         &lt;map name=&quot;filters&quot;&gt;\n&gt; &gt; &lt;             &lt;newObject name=&quot;pathdepth&quot;\n&gt; &gt; &lt;                     class=&quot;org.archive.crawler.filter.PathDepthFilter&quot;&gt;\n&gt; &gt; &lt;                 &lt;boolean name=&quot;enabled&quot;&gt;true&lt;/boolean&gt;\n&gt; &gt; &lt;                 &lt;integer name=&quot;max-path-depth&quot;&gt;20&lt;/integer&gt;\n&gt; &gt; &lt;                 &lt;boolean\n&gt; &gt; name=&quot;path-less-or-equal-return&quot;&gt;false&lt;/boolean&gt;\n&gt; &gt; &lt;             &lt;/newObject&gt;\n&gt; &gt; &lt;             &lt;newObject name=&quot;pathologicalpath&quot;\n&gt; &gt; &lt;\n&gt; &gt; class=&quot;org.archive.crawler.filter.PathologicalPathFilter&quot;&gt;\n&gt; &gt; &lt;                 &lt;boolean name=&quot;enabled&quot;&gt;true&lt;/boolean&gt;\n&gt; &gt; &lt;                 &lt;integer name=&quot;repetitions&quot;&gt;3&lt;/integer&gt;\n&gt; &gt; &lt;             &lt;/newObject&gt;\n&gt; &gt; &lt;         &lt;/map&gt;\n&gt; &gt; &lt;       &lt;/newObject&gt;\n&gt; &gt; ---\n&gt; &gt; &gt;       &lt;map name=&quot;exclude-filters&quot;&gt;\n&gt; &gt; &gt;         &lt;newObject name=&quot;pathdepth&quot;\n&gt; &gt; class=&quot;org.archive.crawler.filter.PathDepthFilter&quot;&gt;\n&gt; &gt; &gt;           &lt;boolean name=&quot;enabled&quot;&gt;true&lt;/boolean&gt;\n&gt; &gt; &gt;           &lt;integer name=&quot;max-path-depth&quot;&gt;20&lt;/integer&gt;\n&gt; &gt; &gt;         &lt;/newObject&gt;\n&gt; &gt; &gt;         &lt;newObject name=&quot;pathological&quot;\n&gt; &gt; class=&quot;org.archive.crawler.filter.PathologicalPathFilter&quot;&gt;\n&gt; &gt; &gt;           &lt;boolean name=&quot;enabled&quot;&gt;true&lt;/boolean&gt;\n&gt; &gt; &gt;           &lt;integer name=&quot;repetitions&quot;&gt;3&lt;/integer&gt;\n&gt; &gt; &gt;         &lt;/newObject&gt;\n&gt; &gt; &gt;       &lt;/map&gt;\n&gt; &gt;\n&gt; &gt; I&#39;d post code or diff&#39;s but there is just too much to post all of it and\n&gt; &gt; until there is some discussion about it I would not know what to use for\n&gt; &gt; examples...  and right now some of it looks hacked (I did not delete the\n&gt; &gt; previous code, I usually just commented it out and its full of print\n&gt; &gt; statements), I need to clean it up.\n&gt; &gt;\n&gt; &gt; I&#39;m serious enough about this that if someone is using special filters\n&gt; &gt; and\n&gt; &gt; does not have a programmer available to change or test them, I&#39;ll do\n&gt; &gt; it for\n&gt; &gt; them.\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; Dave Skinner   dave at solid dot net\n&gt; &gt;     High Performance Programming---assembly (lots of them), C, java, perl\n&gt; &gt;     Database and Non-trivial web site implementations\n&gt; &gt;     Real-time and embedded systems are my specialty\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; *Yahoo! Groups Sponsor*\n&gt; &gt; ADVERTISEMENT\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; ------------------------------------------------------------------------\n&gt; &gt; *Yahoo! Groups Links*\n&gt; &gt;\n&gt; &gt;     * To visit your group on the web, go to:\n&gt; &gt;       http://groups.yahoo.com/group/archive-crawler/\n&gt; &gt;\n&gt; &gt;     * To unsubscribe from this group, send an email to:\n&gt; &gt;       archive-crawler-unsubscribe@yahoogroups.com\n&gt; &gt; \n&gt; &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;\n&gt; &gt;\n&gt; &gt;     * Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt; &gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt; &gt;\n&gt; &gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n&gt;\n\n\nDave Skinner   dave at solid dot net\n    High Performance Programming---assembly (lots of them), C, java, perl\n    Database and Non-trivial web site implementations\n    Real-time and embedded systems are my specialty\n\n\n\n"}}