{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":168599281,"authorName":"Michael Stack","from":"Michael Stack &lt;stack@...&gt;","replyTo":"LIST","senderId":"cYzCbKudC0ADSoSZglo0mf28X_u5_032vjdBrMebul8A8GixD0K_Xv80H_I_KsyYth8-MB-hfe0exmGnjXmRJFxNSNtbmAJ8","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Re: [Fwd: Second draft of per host settings document]","postDate":"1071098758","msgId":198,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDNGRDdBQjg2LjcwODA2MDZAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDEwNzEwOTYwMjIuMTA5MDQuNjUuY2FtZWxAYjExNi1keW4tMzcuYXJjaGl2ZS5vcmc+","referencesHeader":"PDNGRDc4OEJELjYwNzA2MDFAYXJjaGl2ZS5vcmc+IDwxMDcxMDk2MDIyLjEwOTA0LjY1LmNhbWVsQGIxMTYtZHluLTM3LmFyY2hpdmUub3JnPg=="},"prevInTopic":197,"nextInTopic":204,"prevInTime":197,"nextInTime":199,"topicId":195,"numMessagesInTopic":5,"msgSnippet":"... So the UI updates the order file? ... How about saving changes to the order file to the configuration file that is at the root of the configuration","rawEmail":"Return-Path: &lt;stack@...&gt;\r\nX-Sender: stack@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 8675 invoked from network); 10 Dec 2003 23:31:42 -0000\r\nReceived: from unknown (66.218.66.217)\n  by m15.grp.scd.yahoo.com with QMQP; 10 Dec 2003 23:31:42 -0000\r\nReceived: from unknown (HELO ia00524.archive.org) (209.237.232.202)\n  by mta2.grp.scd.yahoo.com with SMTP; 10 Dec 2003 23:31:39 -0000\r\nReceived: (qmail 10695 invoked by uid 100); 10 Dec 2003 23:30:56 -0000\r\nReceived: from b116-dyn-60.archive.org (HELO archive.org) (stack@...@209.237.240.60)\n  by ia00524.archive.org with SMTP; 10 Dec 2003 23:30:56 -0000\r\nMessage-ID: &lt;3FD7AB86.7080606@...&gt;\r\nDate: Wed, 10 Dec 2003 15:25:58 -0800\r\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.5) Gecko/20031007\r\nX-Accept-Language: en-us, en\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nSubject: Re: [archive-crawler] Re: [Fwd: Second draft of per host settings\n document]\r\nReferences: &lt;3FD788BD.6070601@...&gt; &lt;1071096022.10904.65.camel@...&gt;\r\nIn-Reply-To: &lt;1071096022.10904.65.camel@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-Spam-Status: No, hits=-4.6 required=6.0\n\ttests=AWL,BAYES_10,EMAIL_ATTRIBUTION,IN_REP_TO,REFERENCES,\n\t      REPLY_WITH_QUOTES,TONER,USER_AGENT_MOZILLA_UA\n\tversion=2.55\r\nX-Spam-Level: \r\nX-Spam-Checker-Version: SpamAssassin 2.55 (1.174.2.19-2003-05-19-exp)\r\nX-eGroups-Remote-IP: 209.237.232.202\r\nFrom: Michael Stack &lt;stack@...&gt;\r\nX-Yahoo-Group-Post: member; u=168599281\r\n\r\nJohn Erik Halse wrote:\n\n&gt;Thanks, a lot of good points here.\n&gt;\n&gt;On Wed, 2003-12-10 at 12:57, Michael Stack wrote:\n&gt;  \n&gt;\n&gt;&gt;Proposal looks good to me.  Model reminds of me of apache &#39;.htaccess&#39; \n&gt;&gt;file scheme where you can insert directory specific config. to override \n&gt;&gt;the core httpd.conf.  I like it.  Below are some general \n&gt;&gt;comments/questions:\n&gt;&gt;\n&gt;&gt;+ Does the order file change as you do a crawl?  Where is state kept?  \n&gt;&gt;What if you want to tweak a setting during a crawl.  Where would that be \n&gt;&gt;done?  Would you change the order file or would you instead change UI \n&gt;&gt;and its value would be save to a state file subsequently used crawling?  \n&gt;&gt;Would such a change be one of the &#39;dynamic settings&#39; from the global \n&gt;&gt;configuration file saved at the head of the configuration dir \n&gt;&gt;(&#39;overrides&#39; for the order file) mentioned in your doc.?\n&gt;&gt;    \n&gt;&gt;\n&gt;It is, with the current code, possible to change the order file during a\n&gt;crawl. This is done trough the UI and the changes are stored to disk.\n&gt;\n&gt;  \n&gt;\nSo the UI updates the order file?\n\n&gt;&gt;+ Why can&#39;t I set any value?  What if during a crawl I want to up the \n&gt;&gt;number of running threads or change the logging levels or the way in \n&gt;&gt;which statistics are being gathered (e.g. move from &#39;pedestrian&#39; crawl \n&gt;&gt;to debug mode) or even instantiate new processors and change the order \n&gt;&gt;in which the processor chain works.  Some settings won&#39;t be changeable \n&gt;&gt;mid-crawl and these might fail w/ a polite message (e..g. changing heap \n&gt;&gt;size mid-run) but otherwise, I&#39;d suggest no constraint on what can be \n&gt;&gt;changed in configuration (Keep in mind I don&#39;t know much about crawler \n&gt;&gt;deploys).\n&gt;&gt;    \n&gt;&gt;\n&gt;Yes, most things should be changeable during a crawl. The distinction\n&gt;between the order file and the configuration hierarchy is that settings\n&gt;that should be possible to override on a per host basis goes to the\n&gt;crawl configuration, while settings that only makes sense for the\n&gt;crawler as a whole goes to the order file. The names of these two kind\n&gt;configurations should be changed to better reflect this.\n&gt;\n&gt;  \n&gt;\n\nHow about saving changes to the order file to the configuration file \nthat is at the root of the configuration hierarchy?  (Perhaps this is \nwhat you already propose?).\n\n+1 on clearer naming.  &#39;order&#39; seems like a good name considering what \nit does though it might strike newbies as odd.   &#39;newbies&#39; might find \n&#39;crawler&#39; or &#39;configuration&#39; more natural?  Or call all of the files \n&#39;crawler&#39; or &#39;configuration&#39;  and its their location that designates \nwhat they do?   Just suggestions.\n\nSounds like you might want to keep in mind the moving of configurations \namongst crawlers.  For instance, when the archive does broad crawls of \nthe internet, I can see our codifying our experience going against the \ngrand disaparity of sites that are out on the internet as configuration \nin the configuration directory hierarchy.  We might be constantly adding \nto it.  There might be a baseline config. we&#39;d hand out to others doing \nbroad internet crawls.\n\n&gt;&gt;+ I&#39;d imagine in the scheme of things, the reading of a new \n&gt;&gt;configuration file into memory, whether per host or per domain, a rare \n&gt;&gt;event.  Do you agree?  At what time are the domain/host configuration \n&gt;&gt;files read?  On initially crossing into a new domain or on first seeing \n&gt;&gt;a host?  Will we ever refresh what we have in mem?\n&gt;&gt;    \n&gt;&gt;\n&gt;My thought is that we read the configuration file when crossing into a\n&gt;new domain. However it is possible to imagine an arbitrary large number\n&gt;of per host configuration files. Then it might be possible that we\n&gt;cannot keep them all in memory at all times.\n&gt;\n&gt;  \n&gt;\nOk.  Later the &#39;Configuration&#39; class could take on memory management \ninterposing a cache that was cognizant of the configuration&#39;s tree \nhierarchy (so it favored the flushing of leaf nodes ahead of nodes \nhigher in the hierarchy).\n\n&gt;&gt;+ What are the plans for having multiple crawler instances working off \n&gt;&gt;the one Frontier instance?  If the frontier makes a CrawlServer to \n&gt;&gt;associate w/ a URI, how will we ensure that one crawler instance does \n&gt;&gt;one server only (Maybe frontier can do distribution between crawlers).\n&gt;&gt;    \n&gt;&gt;\n&gt;If you by multiple crawler instances mean a crawler spanning multiple\n&gt;machines (or VMs), then this has not been addressed yet.\n&gt;\n&gt;  \n&gt;\nOk.\n\n&gt;&gt;+ Won&#39;t there only be one instance of the configuration instance in \n&gt;&gt;memory? It won&#39;t be duplicated per CrawlerServer -- just a reference to \n&gt;&gt;the single instance?  Why then are we worried about XML DOM cost?  Won&#39;t \n&gt;&gt;the configuration just be read into an object tree w/ an xml serializer \n&gt;&gt;used creating the objects w/ periodic visits to the file on disk to \n&gt;&gt;check mod time?  The serializer would do something like, if a value \n&gt;&gt;exists at a certain node in the configuration hierarchy, a getter that \n&gt;&gt;returns the value at that location in the hierarchy is returned, else, \n&gt;&gt;we call super.  Or are we talking of doing per host an aggregation of \n&gt;&gt;all xml snippets to write a new configuration file to feed the crawler \n&gt;&gt;accessing a particular host?\n&gt;&gt;    \n&gt;&gt;\n&gt;When I started writing the document the DOM was used as the internal\n&gt;data structure and XPaths was used to get the different settings. This\n&gt;is costly if the values should be looked up for every URI. These days\n&gt;the settings are kept in a HashMap after the initial lookup which\n&gt;greatly decreases the cost. But if we are working with an internal data\n&gt;structure distinct from the DOM, it shouldn&#39;t by much harder to use SAX\n&gt;instead of the DOM to build it. Then as mentioned before there could\n&gt;possibly be thousands of per host configuration files and then\n&gt;performance becomes an issue. I&#39;d like the Configuration objects to\n&gt;represent a file on disk. If there is a configuration for a host the\n&gt;CrawlServer points to this. If there isn&#39;t, the CrawlServer will point\n&gt;to the configuration for its domain if present, or to the global\n&gt;configuration. When a module asks for a setting it will ask the\n&gt;configuration object which the CrawlServer references. The configuration\n&gt;objects knows its parent, so if the setting isn&#39;t there it will push the\n&gt;request up to that.\n&gt;\n&gt;  \n&gt;\nI see Processor inherits from XMLConfig.  On first reading, this looks a \nlittle odd. \nI don&#39;t know enough yet about how things work.  I&#39;d think we might want \nto move configuration out to classes that enscapsulate the mechanics of \nhow configuration is done, hiding its XML nature, caching of \nconfiguration (distributed?), etc.\n\n&gt;&gt;+ Author, date and section numbering make it easier to refer to a \n&gt;&gt;document and its sections.\n&gt;&gt;    \n&gt;&gt;\n&gt;Agree.\n&gt;\n&gt;  \n&gt;\n&gt;&gt;+ Later we might use an ldap server implementation behind your \n&gt;&gt;&#39;Configuration&#39; reader class to store config.  The hierarchical nature \n&gt;&gt;of the configuration w/ a rare write would make it a natural match.\n&gt;&gt;    \n&gt;&gt;\n&gt;That makes sense. You could even keep it in an RDBMS, but I think the\n&gt;default implementation shouldn&#39;t need external servers to be set up, so\n&gt;the concept of a hierarchy of XML files should probably be the default\n&gt;implementation.\n&gt;\n&gt;  \n&gt;\nYes.  I agree.\n\nSt.Ack\n\n&gt;&gt;Other comments:\n&gt;&gt;\n&gt;&gt;+ Is CrawlServer class to do w/ crawl accessing a particular server?  \n&gt;&gt;Maybe rename it Server?\n&gt;&gt;+ I have comments on the xml -- no schema nor dtd and extensive use of \n&gt;&gt;element attributes -- but they can go elsewhere.\n&gt;&gt;\n&gt;&gt;St.Ack\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;To unsubscribe from this group, send an email to:\n&gt;&gt;archive-crawler-unsubscribe@yahoogroups.com\n&gt;&gt;\n&gt;&gt; \n&gt;&gt;\n&gt;&gt;Your use of Yahoo! Groups is subject to http://docs.yahoo.com/info/terms/\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;    \n&gt;&gt;\n&gt;\n&gt;\n&gt;\n&gt;To unsubscribe from this group, send an email to:\n&gt;archive-crawler-unsubscribe@yahoogroups.com\n&gt;\n&gt; \n&gt;\n&gt;Your use of Yahoo! Groups is subject to http://docs.yahoo.com/info/terms/ \n&gt;\n&gt;\n&gt;  \n&gt;\n\n\n\n"}}