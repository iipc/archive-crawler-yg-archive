{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":168599281,"authorName":"Michael Stack","from":"Michael Stack &lt;stack@...&gt;","profile":"stackarchiveorg","replyTo":"LIST","senderId":"wtMEUZIQIyburbMOnI-WCgPT2dn8wGa2nqJiVbrrlBSqIu1jff2Jj3h0AKdxkeaitwHTRUTeDKFSTYhrvzeG9BL1ZS_-rIn1","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] Re: HeritrixProtocolSocketFactory","postDate":"1147731265","msgId":2863,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQ0NjhGRDQxLjUwMzAzQGFyY2hpdmUub3JnPg==","inReplyToHeader":"PDQ0NjNGM0RCLjUwNjA2MDBAYXJjaGl2ZS5vcmc+","referencesHeader":"PGU0MHFycStuMzUzQGVHcm91cHMuY29tPiA8NDQ2M0YzREIuNTA2MDYwMEBhcmNoaXZlLm9yZz4="},"prevInTopic":2858,"nextInTopic":2864,"prevInTime":2859,"nextInTime":2864,"topicId":2846,"numMessagesInTopic":8,"msgSnippet":"I ve made an issue for the below problem: http://sourceforge.net/tracker/index.php?func=detail&aid=1489155&group_id=73833&atid=539099. I ve attached a patch","rawEmail":"Return-Path: &lt;stack@...&gt;\r\nX-Sender: stack@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 64786 invoked from network); 15 May 2006 22:14:16 -0000\r\nReceived: from unknown (66.218.66.218)\n  by m21.grp.scd.yahoo.com with QMQP; 15 May 2006 22:14:16 -0000\r\nReceived: from unknown (HELO mail.archive.org) (207.241.227.188)\n  by mta3.grp.scd.yahoo.com with SMTP; 15 May 2006 22:14:16 -0000\r\nReceived: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 592FA141208DE;\n\tMon, 15 May 2006 15:13:54 -0700 (PDT)\r\nReceived: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id 08110-02-36; Mon, 15 May 2006 15:13:52 -0700 (PDT)\r\nReceived: from [192.168.1.204] (unknown [67.170.222.19])\n\tby mail.archive.org (Postfix) with ESMTP id 5D9E214114125;\n\tMon, 15 May 2006 15:13:52 -0700 (PDT)\r\nMessage-ID: &lt;4468FD41.50303@...&gt;\r\nDate: Mon, 15 May 2006 15:14:25 -0700\r\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686 (x86_64); en-US; rv:1.8.0.2) Gecko/20060405 SeaMonkey/1.0.1\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;e40qrq+n353@...&gt; &lt;4463F3DB.5060600@...&gt;\r\nIn-Reply-To: &lt;4463F3DB.5060600@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-Virus-Scanned: Debian amavisd-new at archive.org\r\nX-eGroups-Msg-Info: 1:12:0:0\r\nFrom: Michael Stack &lt;stack@...&gt;\r\nSubject: Re: [archive-crawler] Re: HeritrixProtocolSocketFactory\r\nX-Yahoo-Group-Post: member; u=168599281; y=0rWxDLOTuTzc3ux4bvlvljPyYwyNJEdGVH6XRyM47OGDk5TeyPjGmMy4\r\nX-Yahoo-Profile: stackarchiveorg\r\n\r\nI&#39;ve made an issue for the below problem: \nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1489155&group_id=73833&atid=539099.\n\nI&#39;ve attached a patch that you might want to try.  Let me know if it \nworks for you.\n\nSt.Ack\n\n\nMichael Stack wrote:\n&gt; tizo_trico wrote:\n&gt; &gt; St.Ack,\n&gt; &gt;\n&gt; &gt; Here is the deal:\n&gt; &gt;\n&gt; &gt; I have tested multiple instances with &#39;/local-instances.jsp&#39; page\n&gt; &gt; (Heritrix 1.8), and not our wrapper, but the problem is exactly the\n&gt; &gt; same!!!\n&gt;\n&gt; Thanks for finding the bug and trying to figure this out.\n&gt;\n&gt; I suspect the culprit is here:\n&gt;\n&gt; http://crawler.archive.org/xref/org/archive/crawler/fetcher/FetchHTTP.html#1011\n&gt;\n&gt; ... that we can only register one ProtocolSocketFactory with httpclient.\n&gt;\n&gt; INST_A from your illustration below registers first with INST_A&#39;s\n&gt; ServerCache.  When INST_B starts, it registers a new\n&gt; HeritrixProtocolSocketFactory with a ServerCache from a different\n&gt; CrawlController -- one that hasn&#39;t been populated with the server thats\n&gt; being looked up.\n&gt;\n&gt; I&#39;d guess this is the problem. I don&#39;t have the httpclient src to hand\n&gt; and have to head out... Suggestions for how to fix welcome.  I&#39;ll take a\n&gt; look in the morning.\n&gt;\n&gt; Good luck Tizo,\n&gt; St.Ack\n&gt; &gt;\n&gt; &gt; Steps to reproduce the problem:\n&gt; &gt;\n&gt; &gt; - Start Heritrix\n&gt; &gt; - Create another Heritrix instance in &#39;/local-instances.jsp&#39; page.\n&gt; &gt; Let&#39;s call the instantces INST_A and INST_B.\n&gt; &gt; - Make a long job in INST_A; i.e: a job with a lot of pages to\n&gt; &gt; download. (Do not create this job before creating INST_B, because\n&gt; &gt; otherwise, this job is taken by INST_B too).\n&gt; &gt; - Make a short job in INST_B.\n&gt; &gt; (Both jobs, are created with the default settings, changing the domain\n&gt; &gt; to DomainScope and the writer to MirrorWriterProcessor).\n&gt; &gt; - Start the crawling in INST_A.\n&gt; &gt; - Start the crawling in INST_B.\n&gt; &gt;\n&gt; &gt; While only INST_A is crawling, all is OK: the pages are downloading\n&gt; &gt; correctly and there are neither alerts nor errors in logs. As soon as\n&gt; &gt; INST_B starts to crawling, an error appears in local-errors.log of the\n&gt; &gt; long job (INST_A):\n&gt; &gt;\n&gt; &gt; 2006-05-12T01:15:52.540Z    -2          -\n&gt; &gt; http://www.elpais.com.uy/edicion/deportes PL\n&gt; &gt; http://www.elpais.com.uy/robots.txt no-type #050 - - - \n&gt; le:IOException@HTTP\n&gt; &gt; java.io.IOException: Failed to get host www.elpais.com.uy address\n&gt; &gt; from ServerCache\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.fetcher.HeritrixProtocolSocketFactory.getHostAddress(HeritrixProtocolSocketFactory.java:172)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.fetcher.HeritrixProtocolSocketFactory.createSocket(HeritrixProtocolSocketFactory.java:134)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpConnection.open(HttpConnection.java:707)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpMethodDirector.executeWithRetry(HttpMethodDirector.java:382)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpMethodDirector.executeMethod(HttpMethodDirector.java:168)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:396)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:324)\n&gt; &gt;       at\n&gt; &gt; org.archive.crawler.fetcher.FetchHTTP.innerProcess(FetchHTTP.java:408)\n&gt; &gt;       at\n&gt; &gt; org.archive.crawler.framework.Processor.process(Processor.java:103)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:306)\n&gt; &gt;       at org.archive.crawler.framework.ToeThread.run(ToeThread.java:153)\n&gt; &gt;\n&gt; &gt; And in the web, the job stay in the same percentage of done; no more\n&gt; &gt; pages are downloaded. INST_B, runs the short job correctly, downloads\n&gt; &gt; all the pages, and finishes it, and neither alerts nor\n&gt; &gt; errors appears.\n&gt; &gt;\n&gt; &gt; After about five minutes, the long job (INST_A) terminates with 12\n&gt; &gt; alerts!!! The only difference between alerts, are the page that is\n&gt; &gt; trying to download. The same alerts can be seen in runtime-errors.log,\n&gt; &gt; and are like the following:\n&gt; &gt;\n&gt; &gt; 2006-05-12T01:30:52.548Z    -5          -\n&gt; &gt; http://www.elpais.com.uy/edicion/deportes PL\n&gt; &gt; http://www.elpais.com.uy/robots.txt no-type #013 - - -\n&gt; &gt; err=java.lang.NullPointerException,2t\n&gt; &gt; java.lang.NullPointerException\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.datamodel.ServerCache.getHostFor(ServerCache.java:145)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.fetcher.HeritrixProtocolSocketFactory.getHostAddress(HeritrixProtocolSocketFactory.java:166)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.fetcher.HeritrixProtocolSocketFactory.createSocket(HeritrixProtocolSocketFactory.java:134)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpConnection.open(HttpConnection.java:707)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpMethodDirector.executeWithRetry(HttpMethodDirector.java:382)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpMethodDirector.executeMethod(HttpMethodDirector.java:168)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:396)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:324)\n&gt; &gt;       at\n&gt; &gt; org.archive.crawler.fetcher.FetchHTTP.innerProcess(FetchHTTP.java:408)\n&gt; &gt;       at\n&gt; &gt; org.archive.crawler.framework.Processor.process(Processor.java:103)\n&gt; &gt;       at\n&gt; &gt; \n&gt; org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:306)\n&gt; &gt;       at org.archive.crawler.framework.ToeThread.run(ToeThread.java:153)\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; It seems to me, that something static or singleton, is causing the\n&gt; &gt; trouble, as it happens when the INST_B starts crawling.\n&gt; &gt;\n&gt; &gt; Thanks very much,\n&gt; &gt;\n&gt; &gt; tizo\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; SPONSORED LINKS\n&gt; &gt; Computer security\n&gt; &gt; \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+security&w1=Computer+security&w2=Computer+training&c=2&s=46&.sig=BHmcxBg5sKfN9-gcWnJWDg \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+security&w1=Computer+security&w2=Computer+training&c=2&s=46&.sig=BHmcxBg5sKfN9-gcWnJWDg&gt;&gt; \n&gt;\n&gt; &gt;       Computer training\n&gt; &gt; \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+training&w1=Computer+security&w2=Computer+training&c=2&s=46&.sig=v0JjJWA4s7mLnWQWdFxuTQ \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+training&w1=Computer+security&w2=Computer+training&c=2&s=46&.sig=v0JjJWA4s7mLnWQWdFxuTQ&gt;&gt; \n&gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; ------------------------------------------------------------------------\n&gt; &gt; YAHOO! GROUPS LINKS\n&gt; &gt;\n&gt; &gt;     *  Visit your group &quot;archive-crawler\n&gt; &gt;       &lt;http://groups.yahoo.com/group/archive-crawler&gt;&quot; on the web.\n&gt; &gt;       \n&gt; &gt;     *  To unsubscribe from this group, send an email to:\n&gt; &gt;        archive-crawler-unsubscribe@yahoogroups.com\n&gt; &gt;       \n&gt; &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;\n&gt; &gt;       \n&gt; &gt;     *  Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt; &gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; ------------------------------------------------------------------------\n&gt; &gt;\n&gt;\n&gt;\n&gt;\n&gt; SPONSORED LINKS\n&gt; Computer security \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+security&w1=Computer+security&w2=Computer+training&c=2&s=46&.sig=BHmcxBg5sKfN9-gcWnJWDg&gt; \n&gt; \tComputer training \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+training&w1=Computer+security&w2=Computer+training&c=2&s=46&.sig=v0JjJWA4s7mLnWQWdFxuTQ&gt; \n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------------------------------------------\n&gt; YAHOO! GROUPS LINKS\n&gt;\n&gt;     *  Visit your group &quot;archive-crawler\n&gt;       &lt;http://groups.yahoo.com/group/archive-crawler&gt;&quot; on the web.\n&gt;        \n&gt;     *  To unsubscribe from this group, send an email to:\n&gt;        archive-crawler-unsubscribe@yahoogroups.com\n&gt;       &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;\n&gt;        \n&gt;     *  Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt;\n&gt;\n&gt; ------------------------------------------------------------------------\n&gt;\n\n\n"}}