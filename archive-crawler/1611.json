{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":215515511,"authorName":"Mike Schwartz","from":"Mike Schwartz &lt;mschwartz@...&gt;","profile":"mfschwartz","replyTo":"LIST","senderId":"9NcbMz6MJruBp9aaqCWFZkfqZLOSHMPJEEILkUwKaNmSUCt_QKn1QY-WeTgsOOpCE9YcMUyho8gWdHDNGee_1m0dUqpWxQ6MrLQ","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Re: URL Canonicalization regex to strip  sessionIds","postDate":"1109196485","msgId":1611,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDYuMi4wLjE0LjIuMjAwNTAyMjMxNTAyNDAuMDJhOTMyODBAdmhvc3Q2LmF0b21pY3NlcnZlcnMuY29tPg==","inReplyToHeader":"PGN2Z3NpNytxMGR2QGVHcm91cHMuY29tPg==","referencesHeader":"PGN2Z3FjbCtpZTNkQGVHcm91cHMuY29tPiA8Y3Znc2k3K3EwZHZAZUdyb3Vwcy5jb20+"},"prevInTopic":1609,"nextInTopic":1620,"prevInTime":1610,"nextInTime":1612,"topicId":1605,"numMessagesInTopic":5,"msgSnippet":"Hi, thanks for your answer.  The regex you suggested still didn t quite work, so I put some debugging output in ","rawEmail":"Return-Path: &lt;mschwartz@...&gt;\r\nX-Sender: mschwartz@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 16620 invoked from network); 23 Feb 2005 22:18:01 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m25.grp.scd.yahoo.com with QMQP; 23 Feb 2005 22:18:01 -0000\r\nReceived: from unknown (HELO vhost6.atomicservers.com) (216.58.160.194)\n  by mta4.grp.scd.yahoo.com with SMTP; 23 Feb 2005 22:18:01 -0000\r\nReceived: from dev4lt.aptas.com (nat1.aptas.com [64.78.237.254] (may be forged))\n\t(authenticated (0 bits))\n\tby vhost6.atomicservers.com (8.11.6/8.11.6) with ESMTP id j1NMI1X15361\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed, 23 Feb 2005 15:18:01 -0700\r\nMessage-Id: &lt;6.2.0.14.2.20050223150240.02a93280@...&gt;\r\nX-Mailer: QUALCOMM Windows Eudora Version 6.2.0.14\r\nDate: Wed, 23 Feb 2005 15:08:05 -0700\r\nTo: archive-crawler@yahoogroups.com\r\nIn-Reply-To: &lt;cvgsi7+q0dv@...&gt;\r\nReferences: &lt;cvgqcl+ie3d@...&gt;\n &lt;cvgsi7+q0dv@...&gt;\r\nMime-Version: 1.0\r\nContent-Type: multipart/alternative;\n\tboundary=&quot;=====================_871863921==.ALT&quot;\r\nX-eGroups-Remote-IP: 216.58.160.194\r\nFrom: Mike Schwartz &lt;mschwartz@...&gt;\r\nSubject: Re: [archive-crawler] Re: URL Canonicalization regex to strip\n  sessionIds\r\nX-Yahoo-Group-Post: member; u=215515511\r\nX-Yahoo-Profile: mfschwartz\r\n\r\n\r\n--=====================_871863921==.ALT\r\nContent-Type: text/plain; charset=&quot;us-ascii&quot;; format=flowed\r\n\r\nHi,\n\nthanks for your answer.  The regex you suggested still didn&#39;t quite work, \nso I put some debugging output in \norg.archive.crawler.url.canonicalize.RegexRule.canonicalize() and figured \nout what was going on.  There were three problems:\n\n1) you need to enter the regex into the settings page on the admin GUI \nwithout quotes.  In retrospect this seems obvious, but I suggest you change \nsection 6.2.1.1. of the user manual to say that you should put the \nexpression listed in quotes on the manual page into the admin GUI without \nquotes.\n\n2) the $ and ? escaping needs to be done with a single slash.  (I figured \nthis out by printing the regex that was being passed to \nTextUtils.getMatcher() -- with two slashes it ended up with 2 slashes being \npassed to TextUtils.getMatcher(), but you need 1 slash at that level.)  I \nthink maybe you were thinking of how you&#39;d format this string if it was \nbeing done from within some Java code, rather than as input via the admin GUI.\n\n3) I needed two different overrides to make things work for this case: one \nfor handling the case of URLs that included a sessionId without a catid, \nand one where there was sessionId with a catid.  I needed this because \ncases that didn&#39;t have a catid would either not match on the regex (if I \nrequired 1 or more of the catid part of the pattern), or, if I allowed 0 or \nmore of the catid part of the pattern, they would match but then cause a \n&quot;null&quot; to be put into the canonicalized URL where the ${2} was in my \nreplacement pattern.  The two patterns I ended up using were:\n     ^(.+)(?:;&#92;$sessionid&#92;$[A-Za-z0-9]{32})$\n     with the format string ${1}\n     to canonicalize URLs like \nhttp://joann.com/search/search_results.jhtml;$sessionid$kd0pc4qaakvxip4sy5lrhor50ld3uepo\n\nand\n     ^(.+)(?:;&#92;$sessionid&#92;$[A-Za-z0-9]{32})(&#92;?.*)$\n     with the format string ${1}${2}\n     to canonicalize URLs like \nhttp://joann.com/catalog.jhtml;$sessionid$kd0pc4qaakvxip4sy5lrhor50ld3uepo?catid=5\n\nOne other thing I noticed while debugging this: at one point I was confused \nabout whether to use ${2} or ${3} when I had a capturing followed by \nnon-capturing followed by capturing group.  When I used ${3} it silently \nstarted skipping crawling URLs, which happening because the call to \norg.archive.crawler.url.canonicalize.RegexRule.format() was getting an \nIndexOutOfBoundsException inside java.util.regex.group().  You might want \nto add a try/catch around the call:\n     buffer.append(matcher.group(groupIndex));\nand then log something about this to the log file.  I know this was a \nconfig error on my part, but having it fail silently made it harder to \nfigure out what was wrong.\n\nThanks\n  - Mike\n\n\nAt 08:16 PM 2/22/2005, stackarchiveorg wrote:\n\n&gt;--- In archive-crawler@yahoogroups.com, &quot;stackarchiveorg&quot; &lt;stack@a...&gt;\n&gt;wrote:\n&gt; &gt; Try this for the matching regex --\n&gt; &gt; &quot;^(.+)(?:&#92;&#92;$sessionid&#92;&#92;$[A-Z0-9]{32})(&#92;&#92;?.*)+$&quot; -- and this for the\n&gt; &gt; formatting expression: &quot;$1$1&quot;.\n&gt; &gt;\n&gt;Upon review, you probably want to include the &#39;;&#39; in the non-capturing\n&gt;group and the formatting expression should be &#39;$1$2&#39;, not &#39;$1$1&#39;.\n&gt;\n&gt;St.Ack\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;----------\n&gt;Yahoo! Groups Links\n&gt;    * To visit your group on the web, go to:\n&gt;    * \n&gt; &lt;http://groups.yahoo.com/group/archive-crawler/&gt;http://groups.yahoo.com/group/archive-crawler/ \n&gt;\n&gt;    *\n&gt;    * To unsubscribe from this group, send an email to:\n&gt;    * \n&gt; &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;archive-crawler-unsubscribe@yahoogroups.com \n&gt;\n&gt;    *\n&gt;    * Your use of Yahoo! Groups is subject to the \n&gt; &lt;http://docs.yahoo.com/info/terms/&gt;Yahoo! Terms of Service.\n\r\n--=====================_871863921==.ALT\r\nContent-Type: text/html; charset=&quot;us-ascii&quot;\r\n\r\n&lt;html&gt;\n&lt;body&gt;\n&lt;font size=3&gt;Hi,&lt;br&gt;&lt;br&gt;\nthanks for your answer.&nbsp; The regex you suggested still didn&#39;t quite\nwork, so I put some debugging output in\norg.archive.crawler.url.canonicalize.RegexRule.canonicalize() and figured\nout what was going on.&nbsp; There were three problems:&lt;br&gt;&lt;br&gt;\n1) you need to enter the regex into the settings page on the admin GUI\nwithout quotes.&nbsp; In retrospect this seems obvious, but I suggest you\nchange section 6.2.1.1. of the user manual to say that you should put the\nexpression listed in quotes on the manual page into the admin GUI without\nquotes.&lt;br&gt;&lt;br&gt;\n2) the $ and ? escaping needs to be done with a single slash.&nbsp; (I\nfigured this out by printing the regex that was being passed to\nTextUtils.getMatcher() -- with two slashes it ended up with 2 slashes\nbeing passed to TextUtils.getMatcher(), but you need 1 slash at that\nlevel.)&nbsp; I think maybe you were thinking of how you&#39;d format this\nstring if it was being done from within some Java code, rather than as\ninput via the admin GUI.&lt;br&gt;&lt;br&gt;\n3) I needed two different overrides to make things work for this case:\none for handling the case of URLs that included a sessionId without a\ncatid, and one where there was sessionId with a catid.&nbsp; I needed\nthis because cases that didn&#39;t have a catid would either not match on the\nregex (if I required 1 or more of the catid part of the pattern), or, if\nI allowed 0 or more of the catid part of the pattern, they would match\nbut then cause a &quot;null&quot; to be put into the canonicalized URL\nwhere the ${2} was in my replacement pattern.&nbsp; The two patterns I\nended up using were:&lt;br&gt;\n&nbsp;&nbsp;&nbsp; ^(.+)(?:;&#92;$sessionid&#92;$[A-Za-z0-9]{32})$&lt;br&gt;\n&nbsp;&nbsp;&nbsp; with the format string ${1}&lt;br&gt;\n&nbsp;&nbsp;&nbsp; to canonicalize URLs like\n&lt;a href=&quot;http://joann.com/search/search_results.jhtml;$sessionid$kd0pc4qaakvxip4sy5lrhor50ld3uepo&quot; eudora=&quot;autourl&quot;&gt;\nhttp://joann.com/search/search_results.jhtml;$sessionid$kd0pc4qaakvxip4sy5lrhor50ld3uepo&lt;br&gt;\n&lt;br&gt;\n&lt;/a&gt;and&lt;br&gt;\n&nbsp;&nbsp;&nbsp; ^(.+)(?:;&#92;$sessionid&#92;$[A-Za-z0-9]{32})(&#92;?.*)$&lt;br&gt;\n&nbsp;&nbsp;&nbsp; with the format string ${1}${2}&lt;br&gt;\n&nbsp;&nbsp;&nbsp; to canonicalize URLs like\n&lt;a href=&quot;http://joann.com/catalog.jhtml;$sessionid$kd0pc4qaakvxip4sy5lrhor50ld3uepo?catid=5&quot; eudora=&quot;autourl&quot;&gt;\nhttp://joann.com/catalog.jhtml;$sessionid$kd0pc4qaakvxip4sy5lrhor50ld3uepo?catid=5&lt;br&gt;\n&lt;br&gt;\n&lt;/a&gt;One other thing I noticed while debugging this: at one point I was\nconfused about whether to use ${2} or ${3} when I had a capturing\nfollowed by non-capturing followed by capturing group.&nbsp; When I used\n${3} it silently started skipping crawling URLs, which happening because\nthe call to org.archive.crawler.url.canonicalize.RegexRule.format() was\ngetting an IndexOutOfBoundsException inside\njava.util.regex.group().&nbsp; You might want to add a try/catch around\nthe call:&lt;br&gt;\n&nbsp;&nbsp;&nbsp; buffer.append(matcher.group(groupIndex));&lt;br&gt;\nand then log something about this to the log file.&nbsp; I know this was\na config error on my part, but having it fail silently made it harder to\nfigure out what was wrong.&lt;br&gt;&lt;br&gt;\nThanks&lt;br&gt;\n&nbsp;- Mike&lt;br&gt;&lt;br&gt;\n&lt;br&gt;\nAt 08:16 PM 2/22/2005, stackarchiveorg wrote:&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&lt;blockquote type=cite class=cite cite=&quot;&quot;&gt;&lt;tt&gt;--- In\narchive-crawler@yahoogroups.com, &quot;stackarchiveorg&quot;\n&lt;stack@a...&gt;&lt;br&gt;\nwrote:&lt;br&gt;\n&gt; Try this for the matching regex --&lt;br&gt;\n&gt; &quot;^(.+)(?:&#92;&#92;$sessionid&#92;&#92;$[A-Z0-9]{32})(&#92;&#92;?.*)+$&quot; -- and\nthis for the&lt;br&gt;\n&gt; formatting expression: &quot;$1$1&quot;.&lt;br&gt;\n&gt; &lt;br&gt;\nUpon review, you probably want to include the &#39;;&#39; in the\nnon-capturing&lt;br&gt;\ngroup and the formatting expression should be &#39;$1$2&#39;, not\n&#39;$1$1&#39;.&lt;br&gt;&lt;br&gt;\nSt.Ack&lt;br&gt;&lt;br&gt;\n&lt;br&gt;&lt;br&gt;\n&lt;/tt&gt;&lt;font size=3&gt;&lt;br&gt;\n&lt;hr&gt;\n&lt;/font&gt;&lt;tt&gt;Yahoo! Groups Links&lt;/b&gt;\n&lt;ul&gt;\n&lt;li&gt;To visit your group on the web, go to:\n&lt;li&gt;&lt;a href=&quot;http://groups.yahoo.com/group/archive-crawler/&quot;&gt;\nhttp://groups.yahoo.com/group/archive-crawler/&lt;/a&gt;\n&lt;li&gt;&nbsp; \n&lt;li&gt;To unsubscribe from this group, send an email to:\n&lt;li&gt;\n&lt;a href=&quot;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&quot;&gt;\narchive-crawler-unsubscribe@yahoogroups.com&lt;/a&gt;\n&lt;li&gt;&nbsp; \n&lt;li&gt;Your use of Yahoo! Groups is subject to the\n&lt;a href=&quot;http://docs.yahoo.com/info/terms/&quot;&gt;Yahoo! Terms of Service&lt;/a&gt;. \n&lt;/ul&gt;&lt;/blockquote&gt;&lt;/body&gt;\n&lt;/html&gt;\n\r\n--=====================_871863921==.ALT--\r\n\n"}}