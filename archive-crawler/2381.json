{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":168599281,"authorName":"stack","from":"stack &lt;stack@...&gt;","profile":"stackarchiveorg","replyTo":"LIST","senderId":"oYKVWPYKJdhLDWHIwuOf0jpGmYB6f_5AmBepKE0YMKzKQYLCwbLeWwt7h6l278wb8gnAmzLOm4fvtV_PPrji0A","spamInfo":{"isSpam":false,"reason":"4"},"subject":"Re: [archive-crawler] Re: Sometimes our embedded crawler never finishes (only writes CRAWL ENDING)","postDate":"1133462804","msgId":2381,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQzOEY0NTE0LjQwNjAwMDlAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGRtbW91cSttNWwzQGVHcm91cHMuY29tPg==","referencesHeader":"PGRtbW91cSttNWwzQGVHcm91cHMuY29tPg=="},"prevInTopic":2380,"nextInTopic":2382,"prevInTime":2380,"nextInTime":2382,"topicId":2376,"numMessagesInTopic":13,"msgSnippet":"... Sure. Looking at your log, it looks like we re stuck here: http://crawler.archive.org/xref/org/archive/crawler/framework/CrawlController.html#1031. I see","rawEmail":"Return-Path: &lt;stack@...&gt;\r\nX-Sender: stack@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 47287 invoked from network); 1 Dec 2005 18:55:57 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m31.grp.scd.yahoo.com with QMQP; 1 Dec 2005 18:55:57 -0000\r\nReceived: from unknown (HELO ia00524.archive.org) (207.241.224.171)\n  by mta1.grp.scd.yahoo.com with SMTP; 1 Dec 2005 18:55:57 -0000\r\nReceived: (qmail 12564 invoked by uid 100); 1 Dec 2005 18:50:04 -0000\r\nReceived: from adsl-71-130-102-78.dsl.pltn13.pacbell.net (HELO ?192.168.1.8?) (stack@...@71.130.102.78)\n  by mail-dev.archive.org with SMTP; 1 Dec 2005 18:50:04 -0000\r\nMessage-ID: &lt;438F4514.4060009@...&gt;\r\nDate: Thu, 01 Dec 2005 10:46:44 -0800\r\nUser-Agent: Debian Thunderbird 1.0.7 (X11/20051017)\r\nX-Accept-Language: en-us, en\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;dmmouq+m5l3@...&gt;\r\nIn-Reply-To: &lt;dmmouq+m5l3@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 8bit\r\nX-Spam-DCC: : \r\nX-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on ia00524.archive.org\r\nX-Spam-Level: \r\nX-Spam-Status: No, hits=-95.9 required=7.0 tests=AWL,USER_IN_WHITELIST \n\tautolearn=no version=2.63\r\nX-eGroups-Msg-Info: 2:4:12:0\r\nFrom: stack &lt;stack@...&gt;\r\nSubject: Re: [archive-crawler] Re: Sometimes our embedded crawler never finishes\n (only writes CRAWL ENDING)\r\nX-Yahoo-Group-Post: member; u=168599281; y=8rcbqQ05J9nMNOvUYjGu4beWevCnqEguJcBDmGy5nr3Y7P88NwSpewIU\r\nX-Yahoo-Profile: stackarchiveorg\r\n\r\nS�ren Vejrup Carlsen wrote:\n\n&gt; Dear St.Ack.\n&gt; I have now uploaded two files:\n&gt; HeritrixLauncher.java:  the class responsible for executing Heritrix.\n&gt; Netarkivet-log.txt (logs from a run, where the logging of the\n&gt; framework package is set to finest.\n&gt;\n&gt; Will you take a look at it?\n\nSure.\n\nLooking at your log, it looks like we&#39;re stuck here: \nhttp://crawler.archive.org/xref/org/archive/crawler/framework/CrawlController.html#1031. \n\n\nI see completion of beginCrawlStop message and then this:\n\nDec 1, 2005 11:54:38 AM org.archive.crawler.framework.CrawlController completeStop\nFINE: Entered complete stop.\n\n... which signals our entering CrawlController#completeStop.  We&#39;re not \nseeing in the log the sending to all listeners of the FINISHED message \n(notice how just earlier in the log we sent all the STOPPING message) so \nit looks like we&#39;re in CrawlController#runProcessorFinalTasks.\n\nHave you added a processor of your own that has a funky final task, one \nthat is not completing?\n\nOtherwise, Gordon&#39;s suggestion from yesterday that you thread dump would \nbe where to go next.  Take a few.  If its not clear comparing thread \ndumps where we&#39;re hungup, paste the output to the list.  Maybe someone \nelse can figure where we&#39;re sticking.\n\nGood luck,\nSt.Ack\n\n\n&gt; /S�ren\n&gt;\n&gt; --- In archive-crawler@yahoogroups.com, stack &lt;stack@a...&gt; wrote:\n&gt; &gt;\n&gt; &gt; Bjarne Andersen wrote:\n&gt; &gt;\n&gt; &gt; &gt; We stop the crawler by calling: crawlController.requestCrawlStop();\n&gt; &gt; &gt;\n&gt; &gt; &gt; That used to work in the build we used (from 15th june)\n&gt; &gt; &gt;\n&gt; &gt; &gt; The effect is that besides the crawler never ends we don&#39;t get the\n&gt; &gt; &gt; reports (hosts-report.txt...) files either (probably because it never\n&gt; &gt; &gt; ends ?)\n&gt; &gt; &gt;\n&gt; &gt; The Heritrix start/stop/shutdown was recently refactored to accomodate\n&gt; &gt; multiple instances of Heritrix in same &#39;container&#39; as well as\n&gt; &gt; registration/deregistration of Heritrix instances and jobs with JMX and\n&gt; &gt; JNDI.   This work may have inadvertently broken the way you embed\n&gt; Heritrix.\n&gt; &gt;\n&gt; &gt; Have you tried enabling CrawlController to log at level FINE or FINER?\n&gt; &gt; Might give clue on why we&#39;re shortcircuting job shutdown?  But I\n&gt; &gt; guessing your usage is bypassing some newly-added deregistrations now\n&gt; &gt; necessary letting go of a job. If you paste in the code, I can take\n&gt; a look.\n&gt; &gt;\n&gt; &gt; You might try using the same methods the UI and JMX uses? (See\n&gt; &gt; http://crawler.archive.org/xref/org/archive/crawler/Heritrix.html#281\n&gt; &gt; for listing of published JMX operations or checkout the 1.5 JVM&#39;s\n&gt; &gt; jconsole application to see a &#39;prettier&#39; listing).  Going via these\n&gt; &gt; methods will be safer in the long run.  These published methods are\n&gt; less\n&gt; &gt; likely to change over time.\n&gt; &gt;\n&gt; &gt; Sorry for any inconvenience caused.\n&gt; &gt; Yours,\n&gt; &gt; St.Ack\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; &gt; best\n&gt; &gt; &gt; Bjarne Andersen\n&gt; &gt; &gt;\n&gt; &gt; &gt; S�ren Vejrup Carlsen wrote:\n&gt; &gt; &gt; &gt; Sometimes our embedded crawler (using build 826) never finishes\n&gt; (only\n&gt; &gt; &gt; &gt; writes CRAWL ENDING), and then does nothing\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; What could be keeping the crawler from really finishing?\n&gt; &gt; &gt; &gt; In the same time we experience the NPE in the QuotaEnforcer class.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Could these two problems be related?\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; --\n&gt; &gt; &gt; Bjarne Andersen\n&gt; &gt; &gt; Funktionsansvarlig - Digitale Ressourcer\n&gt; &gt; &gt;\n&gt; &gt; &gt; STATSBIBLIOTEKET\n&gt; &gt; &gt; Universitetsparken\n&gt; &gt; &gt; 8000 �rhus C\n&gt; &gt; &gt; Tlf. 89462165 - Mobil 28713889\n&gt; &gt; &gt; CVR/SE 10100682 - EAN 5798000791084\n&gt; &gt; &gt; http://statsbiblioteket.dk\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; SPONSORED LINKS\n&gt; &gt; &gt; Computer internet security\n&gt; &gt; &gt;\n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+security&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=V04yaONvhRiZX9V-9vaMcA \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+security&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=V04yaONvhRiZX9V-9vaMcA&gt;&gt;\n&gt;\n&gt; &gt; &gt;       Computer internet business\n&gt; &gt; &gt;\n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+business&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=QEM5QXY5E4yokvfp8I9OxA \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+business&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=QEM5QXY5E4yokvfp8I9OxA&gt;&gt;\n&gt;\n&gt; &gt; &gt;       Computer internet access\n&gt; &gt; &gt;\n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+access&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=GvFjo1UJpzPMTQeQeWH-9Q \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+access&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=GvFjo1UJpzPMTQeQeWH-9Q&gt;&gt;\n&gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; Computer internet privacy securities\n&gt; &gt; &gt;\n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+privacy+securities&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=2cAxh4C_HeZYnGK5pWGQjg \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+privacy+securities&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=2cAxh4C_HeZYnGK5pWGQjg&gt;&gt;\n&gt;\n&gt; &gt; &gt;       Computer internet help\n&gt; &gt; &gt;\n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+help&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=XyuTAshDdmCMqHSTUW6r1Q \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+help&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=XyuTAshDdmCMqHSTUW6r1Q&gt;&gt;\n&gt;\n&gt; &gt; &gt;       Computer internet connection\n&gt; &gt; &gt;\n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+connection&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=PWZ1Hrcj8Yl7bPjnNBOESg \n&gt; &lt;http://groups.yahoo.com/gads?t=ms&k=Computer+internet+connection&w1=Computer+internet+security&w2=Computer+internet+business&w3=Computer+internet+access&w4=Computer+internet+privacy+securities&w5=Computer+internet+help&w6=Computer+internet+connection&c=6&s=198&.sig=PWZ1Hrcj8Yl7bPjnNBOESg&gt;&gt;\n&gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; ------------------------------------------------------------------------\n&gt; &gt; &gt; YAHOO! GROUPS LINKS\n&gt; &gt; &gt;\n&gt; &gt; &gt;     *  Visit your group &quot;archive-crawler\n&gt; &gt; &gt;       &lt;http://groups.yahoo.com/group/archive-crawler&gt;&quot; on the web.\n&gt; &gt; &gt;       \n&gt; &gt; &gt;     *  To unsubscribe from this group, send an email to:\n&gt; &gt; &gt;        archive-crawler-unsubscribe@yahoogroups.com\n&gt; &gt; &gt;     \n&gt; &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;\n&gt; &gt; &gt;       \n&gt; &gt; &gt;     *  Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt; &gt; &gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; ------------------------------------------------------------------------\n&gt; &gt; &gt;\n&gt; &gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------------------------------------------\n&gt; YAHOO! GROUPS LINKS\n&gt;\n&gt;     *  Visit your group &quot;archive-crawler\n&gt;       &lt;http://groups.yahoo.com/group/archive-crawler&gt;&quot; on the web.\n&gt;        \n&gt;     *  To unsubscribe from this group, send an email to:\n&gt;        archive-crawler-unsubscribe@yahoogroups.com\n&gt;       &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;\n&gt;        \n&gt;     *  Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt;\n&gt;\n&gt; ------------------------------------------------------------------------\n&gt;\n\n\n"}}