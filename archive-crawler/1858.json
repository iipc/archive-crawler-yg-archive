{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":168599281,"authorName":"stack@archive.org","from":"&quot;stack@...&quot; &lt;stack@...&gt;","profile":"stackarchiveorg","replyTo":"LIST","senderId":"jT8xAtaFYzTTnrihoncPOqnb1_8Lug1B4XrGCvr2yXtYdwhQpDJUHeRxGGU8r1-mHrxIuuWML8RMEOTBKcP2rLn9edGga7tmeHcu70C4","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] Re: very busy IO when running 1.4","postDate":"1116603478","msgId":1858,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQyOEUwNDU2LjgwMjA3MDlAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGQ2anZhcitvcmhyQGVHcm91cHMuY29tPg==","referencesHeader":"PGQ2anZhcitvcmhyQGVHcm91cHMuY29tPg=="},"prevInTopic":1855,"nextInTopic":1859,"prevInTime":1857,"nextInTime":1859,"topicId":1843,"numMessagesInTopic":11,"msgSnippet":"... I don t think so. The cleaner is always running. It does housekeeping (One such task is keeping cache within its bounds). Are your top and vmstat from a","rawEmail":"Return-Path: &lt;stack@...&gt;\r\nX-Sender: stack@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 6100 invoked from network); 20 May 2005 15:46:51 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m23.grp.scd.yahoo.com with QMQP; 20 May 2005 15:46:51 -0000\r\nReceived: from unknown (HELO dns.duboce.net) (63.203.238.114)\n  by mta1.grp.scd.yahoo.com with SMTP; 20 May 2005 15:46:50 -0000\r\nReceived: from [192.168.1.125] ([192.168.1.125])\n\t(authenticated)\n\tby dns-eth1.duboce.net (8.10.2/8.10.2) with ESMTP id j4KEhFC15249\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Fri, 20 May 2005 07:43:15 -0700\r\nMessage-ID: &lt;428E0456.8020709@...&gt;\r\nDate: Fri, 20 May 2005 08:37:58 -0700\r\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.7.5) Gecko/20050105 Debian/1.7.5-1\r\nX-Accept-Language: en\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;d6jvar+orhr@...&gt;\r\nIn-Reply-To: &lt;d6jvar+orhr@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:12:0\r\nFrom: &quot;stack@...&quot; &lt;stack@...&gt;\r\nSubject: Re: [archive-crawler] Re: very busy IO when running 1.4\r\nX-Yahoo-Group-Post: member; u=168599281\r\nX-Yahoo-Profile: stackarchiveorg\r\n\r\njoehung302 wrote:\n\n&gt; ...\n&gt; Is the bdb library doing something funny?\n\nI don&#39;t think so. The cleaner is always running. It does housekeeping \n(One such task is keeping cache within its bounds).\n\nAre your top and vmstat from a paused crawler.  If so, a load of 2.8 for \na quiescent crawler is very high.  Does the load tend down if you let \nthe pause last?\n\nYour heap allocations for tomcat -- whats this tomcat doing/running? Is \nit responsible for the load -- and heritrix leave no memory for the \nsystem itself if both heaps are at their maximum extent.  Are they at \ntheir maximums?  Your vmstat shows some pretty heavy swapping going on \n(Assuming its reporting blocks in/out).  Even if both the tomcat and \nheritrix apps were paused, the system alone going about its general busy \nhaving to rely on swap will put a load up on a machine.\n\nTry lowering the heap sizes for Heritrix to 800/900.\n\nYours,\nSt.Ack\n\n&gt;\n&gt; Thanks,\n&gt;\n&gt; -joe\n&gt;\n&gt; --- In archive-crawler@yahoogroups.com, &quot;joehung302&quot; &lt;joe.hung@c...&gt;\n&gt; wrote:\n&gt; &gt; Here is a snapshot of top:\n&gt; &gt;  16:22:13  up 56 days,  4:03,  1 user,  load average: 2.79, 2.64,\n&gt; &gt; 2.49\n&gt; &gt; 288 processes: 287 sleeping, 1 running, 0 zombie, 0 stopped\n&gt; &gt; CPU states:  cpu    user    nice  system    irq  softirq \n&gt; iowait   \n&gt; &gt; idle\n&gt; &gt;            total    0.0%   13.8%    1.0%   0.2%     0.1%   48.9%  \n&gt; &gt; 35.8%\n&gt; &gt;            cpu00    0.0%   11.8%    1.0%   0.2%     0.2%   25.6%  \n&gt; &gt; 61.1%\n&gt; &gt;            cpu01    0.0%   14.2%    1.2%   0.0%     0.0%   24.8%  \n&gt; &gt; 59.7%\n&gt; &gt;            cpu02    0.0%   12.6%    0.8%   0.2%     0.2%   74.1%  \n&gt; &gt; 12.0%\n&gt; &gt;            cpu03    0.2%   16.6%    1.0%   0.4%     0.0%   71.1%  \n&gt; &gt; 10.6%\n&gt; &gt;\n&gt; &gt; The machine has 2GB memory and I started heritrix with -Xmx1200m.\n&gt; I\n&gt; &gt; have another program (tomcat) which I started with -Xmx800m. But\n&gt; &gt; tomcat is mostly idle.\n&gt; &gt;\n&gt; &gt; Here is a few lines of vmstat 2:\n&gt; &gt; procs                      memory      swap          io    \n&gt; &gt; system         cpu\n&gt; &gt;  r  b   swpd   free   buff  cache   si   so    bi    bo   in    cs\n&gt; &gt; us sy wa id\n&gt; &gt;  1  2 2096600  17632  35160 662456    0    1     0     1    0    \n&gt; 1 \n&gt; &gt; 2  0  1  1\n&gt; &gt;  2  2 2096856  17312  35088 664776    0 1286  3552  1286 2254 \n&gt; 2258\n&gt; &gt; 21  2 45 31\n&gt; &gt;  1  2 2096712  20756  34980 663256   34 1464  3866  5194 1720 \n&gt; 1657\n&gt; &gt; 42  2 39 17\n&gt; &gt;  3  2 2096636  17660  34916 667060   18  580  3824   580 1547 \n&gt; 1740\n&gt; &gt; 29  2 47 22\n&gt; &gt;  0  2 2096440  17704  34836 667772  484  940  3586  4286 1149 \n&gt; 1220 \n&gt; &gt; 8  1 51 40\n&gt; &gt;  1  2 2096448  17396  34656 670040   80 1334  3996  1334 1653 \n&gt; 1839\n&gt; &gt; 25  2 51 23\n&gt; &gt;  0  1 2096456  17612  34772 670804   10 1166  4028  1166 1381 \n&gt; 1367\n&gt; &gt; 23  1 50 26\n&gt; &gt;  1  4 2096456  17828  34908 673088    4 1466  3850  2836 2326 \n&gt; 2264\n&gt; &gt; 15  2 57 26\n&gt; &gt;  0  2 2096456  17396  35020 675380  212 1466  3852  1466 2321 \n&gt; 2351\n&gt; &gt; 21  1 50 28\n&gt; &gt;  2  1 2096460  17504  35120 676540  402 1730  3912  4776 2384 \n&gt; 2875\n&gt; &gt; 17  2 54 27\n&gt; &gt;  2  2 2096460  17504  35228 677884  356 1462  2614  3296 1921 \n&gt; 2748\n&gt; &gt; 22  3 57 18\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; Let me try the hold-queues parameter and see how it works.\n&gt; &gt;\n&gt; &gt; Thanks,\n&gt; &gt;\n&gt; &gt; -joe\n&gt; &gt;\n&gt; &gt; --- In archive-crawler@yahoogroups.com, &quot;Gordon Mohr (Internet\n&gt; &gt; Archive)&quot; &lt;gojomo@a...&gt; wrote:\n&gt; &gt; &gt; Memory use (and traffic to disk) is more a function of the\n&gt; &gt; &gt; number of hosts/queues that have been discovered or active,\n&gt; &gt; &gt; than of the total number of URLs discovered or crawled. So\n&gt; &gt; &gt; any &#39;broader&#39; crawls will strain resources more than\n&gt; &gt; &gt; &#39;narrower&#39; ones with a smaller or fixed number of hosts\n&gt; &gt; &gt; of interest.\n&gt; &gt; &gt;\n&gt; &gt; &gt; Your machine may be swapping heavily. Things to check:\n&gt; &gt; &gt;\n&gt; &gt; &gt;   - Does &#39;top&#39; show swap in use?\n&gt; &gt; &gt;   - How does your configured max heap and current heap size\n&gt; &gt; &gt;     compare with RAM? (Max heap should be 25% or more smaller\n&gt; &gt; &gt;   - Do the &#39;si&#39; and &#39;so&#39; columns in &#39;vmstat 2&#39;\n&gt; &gt; &gt;     (sample every 2 seconds) show activity?\n&gt; &gt; &gt;\n&gt; &gt; &gt; Separately from OS virtual memory, the new BDB/soft-reference\n&gt; &gt; &gt; mechanism for &#39;paging&#39; per-host/per-queue data out when not in\n&gt; &gt; &gt; immediate use could theoretically reach some excessive IO states\n&gt; &gt; &gt; in low-memory conditions. This would be more likely if you\n&gt; weren&#39;t\n&gt; &gt; &gt; using the &#39;hold-queues&#39; setting and were instead round-robinning\n&gt; &gt; &gt; among all queues in a big crawl.\n&gt; &gt; &gt;\n&gt; &gt; &gt; - Gordon @ IA\n&gt; &gt; &gt;\n&gt; &gt; &gt; joehung302 wrote:\n&gt; &gt; &gt; &gt; I started a crawl about a week ago (using 1.4 broad scope and\n&gt; &gt; the\n&gt; &gt; &gt; &gt; default BdbFrontier). So far I&#39;ve collected &gt;7 million docs\n&gt; but\n&gt; &gt; IO is\n&gt; &gt; &gt; &gt; consistently at &gt;50% using top. Sometimes even higher at 90+%.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Here is what&#39;s interesting...even if I pause the crawl, IO is\n&gt; &gt; still\n&gt; &gt; &gt; &gt; busy. The number never dropped.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; I&#39;m running on a dual Xeon with a direct attached SCSI array,\n&gt; &gt; using\n&gt; &gt; &gt; &gt; Sun&#39;s JDK 1.4.2. -Xmx1200.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; I&#39;ve done a 7 million docs crawl using 1.0.4 before on the\n&gt; same\n&gt; &gt; &gt; &gt; hardware (using domainscope though). From what I remember the\n&gt; &gt; disk IO\n&gt; &gt; &gt; &gt; was at around 5%.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Is it becuase of BdbFrontier? Any hints?\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Thanks,\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; -joe\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; \n&gt; &gt; &gt; &gt; Yahoo! Groups Links\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; \n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------------------------------------------\n&gt; *Yahoo! Groups Links*\n&gt;\n&gt;     * To visit your group on the web, go to:\n&gt;       http://groups.yahoo.com/group/archive-crawler/\n&gt;        \n&gt;     * To unsubscribe from this group, send an email to:\n&gt;       archive-crawler-unsubscribe@yahoogroups.com\n&gt;       &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;\n&gt;        \n&gt;     * Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt;\n&gt;\n\n\n"}}