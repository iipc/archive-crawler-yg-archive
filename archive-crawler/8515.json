{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":325624130,"authorName":"Noah Levitt","from":"Noah Levitt &lt;nlevitt@...&gt;","profile":"nlevitt","replyTo":"LIST","senderId":"itqyUKoG32BVwv_JJVpoE5eKCyCMYwnKeWS79OjnQNn_CiDIsIWIz0QTk2F0VnR5nC3Qs_spu6v9b6YSFsP99zZZmm5mEKKT","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] IpAddressSetDecideRule killing threads?","postDate":"1400021937","msgId":8515,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PENBQS16NzArblhVLWp6N3ZMVkw5VDhjSHNxSi04VUdkPUZ4VFJwY09rWHI0VW53NzRaZ0BtYWlsLmdtYWlsLmNvbT4=","inReplyToHeader":"PDkxRDEyNTFEOUM2ODhCNEQ4NDQ4RDRGRjUwMDAzMzFEMkFEMTFGODhAVjhCLUVYQ0hBTkdFMDEuYWQuYmwudWs+","referencesHeader":"PDkxRDEyNTFEOUM2ODhCNEQ4NDQ4RDRGRjUwMDAzMzFEMkFEMTFGODhAVjhCLUVYQ0hBTkdFMDEuYWQuYmwudWs+"},"prevInTopic":8514,"nextInTopic":8516,"prevInTime":8514,"nextInTime":8516,"topicId":8514,"numMessagesInTopic":3,"msgSnippet":"Hey Roger, Interesting. Usually when that exception is thrown, it s from inside the inner try block in ToeThread.run(), so it s caught and handled cleanly. In","rawEmail":"Return-Path: &lt;nlevitt@...&gt;\r\nX-Sender: nlevitt@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 14720 invoked by uid 102); 13 May 2014 22:59:03 -0000\r\nX-Received: from unknown (HELO mtaq2.grp.gq1.yahoo.com) (10.210.181.87)\n  by m11.grp.gq1.yahoo.com with SMTP; 13 May 2014 22:59:03 -0000\r\nX-Received: (qmail 26805 invoked from network); 13 May 2014 22:59:03 -0000\r\nX-Received: from unknown (HELO mail.archive.org) (207.241.224.6)\n  by mtaq2.grp.gq1.yahoo.com with SMTP; 13 May 2014 22:59:03 -0000\r\nX-Received: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id DAB0FA62017\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Tue, 13 May 2014 15:59:02 -0700 (PDT)\r\nX-Received: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id OBCyjCGIIqhQ for &lt;archive-crawler@yahoogroups.com&gt;;\n\tTue, 13 May 2014 15:58:58 -0700 (PDT)\r\nX-Received: from mail-oa0-f52.google.com (mail-oa0-f52.google.com [209.85.219.52])\n\tby mail.archive.org (Postfix) with ESMTPSA id A2B3FA62012\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Tue, 13 May 2014 15:58:58 -0700 (PDT)\r\nX-Received: by mail-oa0-f52.google.com with SMTP id eb12so1252432oac.11\n        for &lt;archive-crawler@yahoogroups.com&gt;; Tue, 13 May 2014 15:58:57 -0700 (PDT)\r\nMIME-Version: 1.0\r\nX-Received: by 10.60.65.99 with SMTP id w3mr46009214oes.7.1400021937551; Tue,\n 13 May 2014 15:58:57 -0700 (PDT)\r\nX-Received: by 10.76.3.211 with HTTP; Tue, 13 May 2014 15:58:57 -0700 (PDT)\r\nIn-Reply-To: &lt;91D1251D9C688B4D8448D4FF5000331D2AD11F88@...&gt;\r\nReferences: &lt;91D1251D9C688B4D8448D4FF5000331D2AD11F88@...&gt;\r\nDate: Tue, 13 May 2014 15:58:57 -0700\r\nMessage-ID: &lt;CAA-z70+nXU-jz7vLVL9T8cHsqJ-8UGd=FxTRpcOkXr4Unw74Zg@...&gt;\r\nTo: &quot;archive-crawler@yahoogroups.com&quot; &lt;archive-crawler@yahoogroups.com&gt;\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\nSubject: Re: [archive-crawler] IpAddressSetDecideRule killing threads?\r\nX-Yahoo-Group-Post: member; u=325624130; y=5LN3vm_9ByAvjT9en0VN5ugVAz5DtiAz-JmM-CMvxp9GVQ\r\nX-Yahoo-Profile: nlevitt\r\nFrom: Noah Levitt &lt;nlevitt@...&gt;\r\n\r\nHey Roger,\n\nInteresting. Usually when that exception is thrown, it&#39;s from i=\r\nnside\nthe inner try block in ToeThread.run(), so it&#39;s caught and handled\ncl=\r\neanly. In this case it&#39;s being thrown inside of a decide rule that\nis decid=\r\ning whether to apply an overlay, so nothing catches it.\n\nI chose to throw t=\r\nhat exception in that spot because the root cause\ncould be two very differe=\r\nnt kinds of things, namely bad dns responses,\nand data corruption within he=\r\nritrix. We want to handle both cases, and\nit&#39;s trivial to do it right there=\r\n. To really properly handle the\n0.0.0.0 case all the way through would prob=\r\nably require touching a lot\nof code in different places, but this compromis=\r\ne is good enough in\nmost cases.\n\nMaybe the easiest thing to do about this i=\r\ns catch exceptions in\nSheetOverlaysManager.applyOverlaysTo(). I made a pull=\r\n request to this\neffect: https://github.com/internetarchive/heritrix3/pull/=\r\n68 If that\nmakes sense to you, feel free to merge.\n\nNoah\n\nOn Mon, May 12, 2=\r\n014 at 8:21 AM, &#39;Coram, Roger&#39; Roger.Coram@...\n[archive-crawler] &lt;archive=\r\n-crawler@yahoogroups.com&gt; wrote:\n&gt; We=E2=80=99re using the IpAddressSetDeci=\r\ndeRule to map Sheets to IP addresses; occasionally we=E2=80=99re coming acr=\r\noss a bad domain which returns 0.0.0.0 as its IP which seems to cause the r=\r\nelevant thread to die.\n&gt;\n&gt; An example:\n&gt;\n&gt; 2014-05-12 14:44:22.145 SEVERE t=\r\nhread-48 org.archive.crawler.framework.ToeThread.run() Fatal exception in T=\r\noeThread #109:\n&gt; java.lang.IllegalStateException: got suspicious value 0.0.=\r\n0.0 for silenaautomotive.co.uk\n&gt;         at org.archive.modules.fetcher.Def=\r\naultServerCache.getHostFor(DefaultServerCache.java:112)\n&gt;         at org.ar=\r\nchive.modules.net.ServerCache.getHostFor(ServerCache.java:64)\n&gt;         at =\r\norg.archive.modules.deciderules.IpAddressSetDecideRule.getHostAddress(IpAdd=\r\nressSetDecideRule.java:85)\n&gt;         at org.archive.modules.deciderules.IpA=\r\nddressSetDecideRule.evaluate(IpAddressSetDecideRule.java:57)\n&gt;         at o=\r\nrg.archive.modules.deciderules.PredicatedDecideRule.innerDecide(PredicatedD=\r\necideRule.java:47)\n&gt;         at org.archive.modules.deciderules.DecideRule.=\r\ndecisionFor(DecideRule.java:60)\n&gt;         at org.archive.modules.deciderule=\r\ns.DecideRule.accepts(DecideRule.java:77)\n&gt;         at org.archive.crawler.s=\r\npring.SheetOverlaysManager.applyOverlaysTo(SheetOverlaysManager.java:329)\n&gt;=\r\n         at org.archive.crawler.frontier.WorkQueueFrontier.findEligibleURI(=\r\nWorkQueueFrontier.java:632)\n&gt;         at org.archive.crawler.frontier.Abstr=\r\nactFrontier.next(AbstractFrontier.java:455)\n&gt;         at org.archive.crawle=\r\nr.framework.ToeThread.run(ToeThread.java:134)\n&gt;\n&gt; It looks like the Default=\r\nServerCache is manually throwing a IllegalStateException which doesn&#39;t get =\r\ncaught anywhere=E2=80=94is this intended?\n&gt;\n&gt; Thanks,\n&gt; Roger\n&gt;\n&gt;\n&gt; *******=\r\n***************************************************************************=\r\n********************************\n&gt; Experience the British Library online at=\r\n www.bl.uk&lt;http://www.bl.uk/&gt;\n&gt; The British Library=E2=80=99s latest Annual=\r\n Report and Accounts : www.bl.uk/aboutus/annrep/index.html&lt;http://www.bl.uk=\r\n/aboutus/annrep/index.html&gt;\n&gt; Help the British Library conserve the world&#39;s=\r\n knowledge. Adopt a Book. www.bl.uk/adoptabook&lt;http://www.bl.uk/adoptabook&gt;=\r\n\n&gt; The Library&#39;s St Pancras site is WiFi - enabled\n&gt; **********************=\r\n***************************************************************************=\r\n****************\n&gt; The information contained in this e-mail is confidential=\r\n and may be legally privileged. It is intended for the addressee(s) only. I=\r\nf you are not the intended recipient, please delete this e-mail and notify =\r\nthe postmaster@...&lt;mailto:postmaster@...&gt; : The contents of this e-mail=\r\n must not be disclosed or copied without the sender&#39;s consent.\n&gt; The statem=\r\nents and opinions expressed in this message are those of the author and do =\r\nnot necessarily reflect those of the British Library. The British Library d=\r\noes not take any responsibility for the views of the author.\n&gt; ************=\r\n***************************************************************************=\r\n**************************\n&gt; Think before you print\n&gt;\n&gt;\n&gt; -----------------=\r\n-------------------\n&gt;\n&gt; Yahoo Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}