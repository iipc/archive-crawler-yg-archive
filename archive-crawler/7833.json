{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":545403647,"authorName":"Juan Manuel Caicedo Carvajal","from":"Juan Manuel Caicedo Carvajal &lt;jcaicedo@...&gt;","replyTo":"LIST","senderId":"hwA9I-8SRFmJe6fsbGAvK7RlN-59_wBBAqEj1cpEFfqvhK2VHsBTX6t7FuO0TMjct15-gf-ayEvdKkKuxXa3_hXk_LnEITx99qG84aycDL72MPM4NAnx8Zw","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] Best way to throttle down Heritrix for a period","postDate":"1351272481","msgId":7833,"canDelete":false,"contentTrasformed":false,"systemMessage":true,"headers":{"messageIdInHeader":"PENBRlI3Mkhtb1RGM2JTLTlXQXoyaS04dWZSendreU41Y2NHRlVwZldjUmNXWTI1c0p0UUBtYWlsLmdtYWlsLmNvbT4=","inReplyToHeader":"PDUwODcwN0MwLjcwNTA3MDdAYXJjaGl2ZS5vcmc+","referencesHeader":"PGs1czJkMCtwdXVhQGVHcm91cHMuY29tPiA8NTA4NzA3QzAuNzA1MDcwN0BhcmNoaXZlLm9yZz4="},"prevInTopic":7830,"nextInTopic":7834,"prevInTime":7832,"nextInTime":7834,"topicId":7826,"numMessagesInTopic":4,"msgSnippet":"Thank you for your reply Gordon, it was very useful. I initially did not consider to address the problem at the OS level or with a proxy, but I agree that","rawEmail":"Return-Path: &lt;jcaicedo@...&gt;\r\nReceived: (qmail 248 invoked from network); 26 Oct 2012 18:13:23 -0000\r\nReceived: from unknown (98.137.35.161)\n  by m1.grp.sp2.yahoo.com with QMQP; 26 Oct 2012 18:13:23 -0000\r\nReceived: from unknown (HELO ng7-vm5.bullet.mail.gq1.yahoo.com) (98.136.219.83)\n  by mta5.grp.sp2.yahoo.com with SMTP; 26 Oct 2012 18:13:23 -0000\r\nDKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoogroups.com; s=lima; t=1351275202; bh=xJyPjLxlJAYt1SjqDL3F7gBCjnK3g3qNyRNCpg/CZKQ=; h=Received:Received:X-Sender:X-Apparently-To:X-Received:X-Received:X-Received:X-Received:X-Received:X-Received:MIME-Version:X-Received:In-Reply-To:References:Date:Message-ID:To:Content-Type:Content-Transfer-Encoding:X-Scanned-By:X-Originating-IP:X-eGroups-Msg-Info:From:Subject:X-Yahoo-Group-Post:X-YGroups-SubInfo:Sender:X-Yahoo-Newman-Property:X-eGroups-Approved-By:X-eGroups-Auth; b=VvkFg399moYzoGbZeZek3S9u1D1ex/g5vyp6QrjouUn1dsSZ7MWlQ1NJ93EbtS6eO0nktvb+ktRRzg0ZVSnBeh7fgz5KAkoGD6P+0VHefjmkPTeMfUiFMWrlWCGT9gur\r\nReceived: from [98.137.0.82] by ng7.bullet.mail.gq1.yahoo.com with NNFMP; 26 Oct 2012 18:13:22 -0000\r\nReceived: from [98.137.35.12] by tg2.bullet.mail.gq1.yahoo.com with NNFMP; 26 Oct 2012 18:13:22 -0000\r\nX-Sender: jcaicedo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 15790 invoked from network); 26 Oct 2012 17:28:43 -0000\r\nX-Received: from unknown (98.137.34.44)\n  by m8.grp.sp2.yahoo.com with QMQP; 26 Oct 2012 17:28:43 -0000\r\nX-Received: from unknown (HELO smtp01.srv.cs.cmu.edu) (128.2.217.196)\n  by mta1.grp.sp2.yahoo.com with SMTP; 26 Oct 2012 17:28:43 -0000\r\nX-Received: from mail-vb0-f45.google.com (mail-vb0-f45.google.com [209.85.212.45])\n\t(authenticated bits=0)\n\tby smtp01.srv.cs.cmu.edu (8.13.6/8.13.6) with ESMTP id q9QHSgL1019810\n\t(version=TLSv1/SSLv3 cipher=RC4-SHA bits=128 verify=FAIL)\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Fri, 26 Oct 2012 13:28:42 -0400 (EDT)\r\nX-Received: by mail-vb0-f45.google.com with SMTP id p1so4268664vbi.18\n        for &lt;archive-crawler@yahoogroups.com&gt;; Fri, 26 Oct 2012 10:28:42 -0700 (PDT)\r\nX-Received: by 10.220.155.132 with SMTP id s4mr19959247vcw.15.1351272522156;\n Fri, 26 Oct 2012 10:28:42 -0700 (PDT)\r\nMIME-Version: 1.0\r\nX-Received: by 10.58.218.164 with HTTP; Fri, 26 Oct 2012 10:28:01 -0700 (PDT)\r\nIn-Reply-To: &lt;508707C0.7050707@...&gt;\r\nReferences: &lt;k5s2d0+puua@...&gt; &lt;508707C0.7050707@...&gt;\r\nDate: Fri, 26 Oct 2012 13:28:01 -0400\r\nMessage-ID: &lt;CAFR72HmoTF3bS-9WAz2i-8ufRzwkyN5ccGFUpfWcRcWY25sJtQ@...&gt;\r\nTo: archive-crawler@yahoogroups.com\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Scanned-By: mimedefang-cmuscs on 128.2.217.196\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Juan Manuel Caicedo Carvajal &lt;jcaicedo@...&gt;\r\nSubject: Re: [archive-crawler] Best way to throttle down Heritrix for a period\r\nX-Yahoo-Group-Post: member; u=545403647\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Approved-By: nlevitt &lt;nlevitt@...&gt; via web; 26 Oct 2012 18:13:20 -0000\r\n\r\nThank you for your reply Gordon, it was very useful.\n\nI initially did not c=\r\nonsider to address the problem at the OS level or\nwith a proxy, but I agree=\r\n that those solutions are more direct and\nreliable ways of limiting the ban=\r\ndwidth used.\n\nI have a question though regarding the DecideRule. I just sta=\r\nrted\nlearning about Heritrix and it seems to me that they are used to\ndecid=\r\ne whether a discovered URL should be added to the queue or not;\nthat is, if=\r\n they are rejected they are not stored anywhere. However, I\ndon&#39;t want to d=\r\niscard completely URLs based on the time of the day, so\nI wonder if there i=\r\ns a way of keeping or storing those URLs.\n\nShould I add that logic to my De=\r\ncideRule or does Heritrix already\nprovide a way of doing that?\n\nThanks agai=\r\nn,\n\nJuan Manuel Caicedo\n\nOn Tue, Oct 23, 2012 at 5:10 PM, Gordon Mohr &lt;gojo=\r\nmo@...&gt; wrote:\n&gt; On 10/19/12 10:24 AM, juanmcc wrote:\n&gt;&gt; I would li=\r\nke to be able to control the bandwidth used by Heritrix\n&gt;&gt; during certain h=\r\nours.\n&gt;&gt;\n&gt;&gt; So far, I have seen that I could use sheet overlays to increase=\r\n the\n&gt;&gt; values of properties such as disposition.minDelayMs or\n&gt;&gt; dispositi=\r\non.maxPerHostBandwidthUsageKbSec, so that the politeness\n&gt;&gt; delay for all t=\r\nhe URLs increases. With higher delays, the crawler\n&gt;&gt; will make less reques=\r\nts and thus this will control (indirectly) the\n&gt;&gt; bandwidth.\n&gt;&gt;\n&gt;&gt; I also h=\r\nave seen that I can use the scripting engine to manage sheet\n&gt;&gt; overlays, s=\r\no I could write a script that uses the REST API and makes\n&gt;&gt; the changes wh=\r\nen they are needed (without stopping the job).\n&gt;&gt;\n&gt;&gt; Although my approach d=\r\noes not seem to be complicated to implement\n&gt;&gt; (and I try to do it today), =\r\nI would like to know what would be the\n&gt;&gt; potential problems and if there i=\r\ns a better way of doing that.\n&gt;&gt;\n&gt;&gt; Do you have any advice or have you done=\r\n anything similar?\n&gt;\n&gt; If you&#39;re considering external scripting, you might =\r\nalso want to\n&gt; consider options at the OS level, or intervening network. Th=\r\nat is,\n&gt; Heritrix wouldn&#39;t know any limits or time-of-day changes itself, b=\r\nut\n&gt; some external system would change the maximum bandwidth that Heritrix\n=\r\n&gt; could use.\n&gt;\n&gt; Some things to consider in that realm:\n&gt;\n&gt; =E2=80=A2 on Li=\r\nnux OSes, look into &#39;iptables&#39; filtering for some local shaping\n&gt; capabilit=\r\nies\n&gt;\n&gt; =E2=80=A2 alternatively, Heritrix can be configured to send all its=\r\n requests\n&gt; through an outbound HTTP proxy. Many such proxies exist, and ma=\r\nny have\n&gt; configuration options like total or per-origin-IP bandwidth limit=\r\ns\n&gt;\n&gt; The bandwidth-throttling facilities inside Heritrix are relatively cr=\r\nude\n&gt; and less-often used. They keep raw totals of data transferred, overal=\r\nl\n&gt; or per-host, and when recent activity exceeds the preferred\n&gt; rate-sinc=\r\ne-crawl-start, Heritrix adds whatever delay is necessary to get\n&gt; under the=\r\n target.\n&gt;\n&gt; So note that this means no particular *second* or even *range =\r\nof\n&gt; seconds* is guaranteed to be under your target rates, just the long-te=\r\nrm\n&gt; average. (Individual requests in progress will transfer data as fast a=\r\ns\n&gt; the OS/network-paths allow.) So if your concern is total or average\n&gt; t=\r\nransferred data, the Heritrix settings may work well for you, but if\n&gt; the =\r\nconcern is avoiding even temporary saturation inconveniencing\n&gt; network nei=\r\nghbors, you&#39;ll want to use OS/network shaping mechanisms\n&gt; instead.\n&gt;\n&gt; As =\r\nfar as changing Heritrix configuration values by time-of-day, there&#39;s\n&gt; no =\r\nbuilt-in mechanism for doing that. Your suggestion of having an\n&gt; external =\r\nscript poke changes into the configuration values should work\n&gt; -- though n=\r\note per above that because the bandwidth settings are\n&gt; *average-since-craw=\r\nl-launch* rather than *recent-period-usage*, a simple\n&gt; alternation between=\r\n values is unlikely to have the desired effect.\n&gt;\n&gt; Another option would be=\r\n to create a custom DecideRule (either in Java or\n&gt; using the ScriptedDecid=\r\neRule) that gives an ACCEPT decision based on the\n&gt; time of day, and use th=\r\nat DecideRule via a  DecideRuleSheetAssociation\n&gt; to apply a certain overla=\r\ny Sheet with different politeness delays. If\n&gt; you want to go this way and =\r\nthe mention of these class names isn&#39;t\n&gt; enough to get you started, let me =\r\nknow.\n&gt;\n&gt; Hope this helps,\n&gt;\n&gt; - Gordon\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;&gt; Thanks,\n&gt;&gt;\n&gt;&gt; Ju=\r\nan Manuel Caicedo\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; ------------------------------------\n&gt;&gt;=\r\n\n&gt;&gt; Yahoo! Groups Links\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;\n&gt;\n&gt; ------------------------------------=\r\n\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}