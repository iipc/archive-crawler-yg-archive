{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":325624130,"authorName":"Noah Levitt","from":"Noah Levitt &lt;nlevitt@...&gt;","replyTo":"LIST","senderId":"qP6OUBu6eSgVwMc6bSFqXGpN10aF04bL8VxiiAwdRF-8zkPysLNer-cty28qG7iKSIiDoSjj60CaddOHFkeSRa4ufmRYgbSi","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Re: Loading cookies from a file on H3","postDate":"1311790881","msgId":7232,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRFMzA1NzIxLjcwMjA1QGFyY2hpdmUub3JnPg==","inReplyToHeader":"PGowcDNodiszbjQ2QGVHcm91cHMuY29tPg==","referencesHeader":"PGowcDNodiszbjQ2QGVHcm91cHMuY29tPg=="},"prevInTopic":7231,"nextInTopic":7240,"prevInTime":7231,"nextInTime":7233,"topicId":7227,"numMessagesInTopic":7,"msgSnippet":"Hi progre55, Thanks for confirming the fix. Adding cookies in a custom SeedModule the way you describe sounds like it should work. If you use an IDE you might","rawEmail":"Return-Path: &lt;nlevitt@...&gt;\r\nX-Sender: nlevitt@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 65397 invoked from network); 27 Jul 2011 18:21:23 -0000\r\nX-Received: from unknown (66.196.94.106)\n  by m17.grp.re1.yahoo.com with QMQP; 27 Jul 2011 18:21:23 -0000\r\nX-Received: from unknown (HELO mail.archive.org) (207.241.224.6)\n  by mta2.grp.re1.yahoo.com with SMTP; 27 Jul 2011 18:21:23 -0000\r\nX-Received: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 52C2968410B8;\n\tWed, 27 Jul 2011 11:21:21 -0700 (PDT)\r\nX-Received: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id 33Jzjj6-S9wI; Wed, 27 Jul 2011 11:21:20 -0700 (PDT)\r\nX-Received: from Noah-Levitts-MacBook-Pro.local (c-174-62-77-252.hsd1.ca.comcast.net [174.62.77.252])\n\tby mail.archive.org (Postfix) with ESMTPSA id 05ED0684106D;\n\tWed, 27 Jul 2011 11:21:20 -0700 (PDT)\r\nMessage-ID: &lt;4E305721.70205@...&gt;\r\nDate: Wed, 27 Jul 2011 11:21:21 -0700\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:5.0) Gecko/20110624 Thunderbird/5.0\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: progre55 &lt;ikromchik@...&gt;\r\nReferences: &lt;j0p3hv+3n46@...&gt;\r\nIn-Reply-To: &lt;j0p3hv+3n46@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nFrom: Noah Levitt &lt;nlevitt@...&gt;\r\nSubject: Re: [archive-crawler] Re: Loading cookies from a file on H3\r\nX-Yahoo-Group-Post: member; u=325624130\r\n\r\nHi progre55,\n\nThanks for confirming the fix.\n\nAdding cookies in a custom SeedModule the way you describe sounds like it should work. If you use an IDE you might try stepping through CookieSpecBase.match(String, int, String, boolean, SortedMap) to see what&#39;s happening when it comes time to send the cookie.\n\nNoah\n\nOn 2011-07-27 06:24 , progre55 wrote:\n&gt; Hi Noah,\n&gt;\n&gt; Thanks for the quick fix!\n&gt; I&#39;ve tested loading cookies from a file, and they get sent, and after the job is finished/terminated, they&#39;re dumped into a file, too. So I suppose everything works now.\n&gt;\n&gt; But now I was more interested in setting cookies dynamically, in the code, not using the config files, as I have integrated heritrix into my application. So I have a custom SeedModule, which basically reads seeds from a database and schedules them with heritrix. Because the seeds could have active cookies bound to them, I dynamically try to add the cookies into the cookieStore. For that, I have autowired the AbstractCookieStore, and before I add the seed, I put the cookie that comes with it into the store:\n&gt; getCookieStore().getCookiesMap().put(cookie.getSortKey(), cookie);\n&gt;\n&gt; However, it doesn&#39;t get sent and I was wondering why..\n&gt;\n&gt; Would really appreciate any comments and/or suggestions! Or at least let me know how I can debug it.\n&gt;\n&gt; progre55\n&gt;\n&gt; --- In archive-crawler@yahoogroups.com, Noah Levitt&lt;nlevitt@...&gt;  wrote:\n&gt;&gt;\n&gt;&gt; Hello progre55,\n&gt;&gt;\n&gt;&gt; Thanks for reporting this issue. It should be fixed now, along with related problems. It would appear that the cookie loading/saving functionality had never even been tried. :( https://webarchive.jira.com/browse/HER-1914\n&gt;&gt;\n&gt;&gt; Also while looking at this issue it became apparent that cookies were not being sent at all, in both h1 and h3, since a commit in February. That should be fixed now as well in svn. https://webarchive.jira.com/browse/HER-1913\n&gt;&gt;\n&gt;&gt; You&#39;ll want to get the latest code from svn (or the latest snapshot from the build box). If you can confirm that cookie handling works as expected after these changes, that would be very helpful.\n&gt;&gt;\n&gt;&gt; Noah\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; On 2011-07-26 05:22 , progre55 wrote:\n&gt;&gt;&gt; Hi guys,\n&gt;&gt;&gt;\n&gt;&gt;&gt; I&#39;ve been playing around with H3, and noticed that loading cookies from a file doesn&#39;t really work. When tried analyzing the code, I found out that the loadCookies() method reads the file, but doesn&#39;t store the cookies read. Here is the method in original form, and as you can see, Cookie objects are created, but not put into the SortedMap:\n&gt;&gt;&gt;\n&gt;&gt;&gt;       public static void loadCookies(String cookiesFile,\n&gt;&gt;&gt;               SortedMap&lt;String,Cookie&gt;   result) {\n&gt;&gt;&gt;\n&gt;&gt;&gt;           // Do nothing if cookiesFile is not specified.\n&gt;&gt;&gt;           if (cookiesFile == null || cookiesFile.length()&lt;= 0) {\n&gt;&gt;&gt;               return;\n&gt;&gt;&gt;           }\n&gt;&gt;&gt;           RandomAccessFile raf = null;\n&gt;&gt;&gt;           try {\n&gt;&gt;&gt;               raf = new RandomAccessFile(cookiesFile, &quot;r&quot;);\n&gt;&gt;&gt;               String[] cookieParts;\n&gt;&gt;&gt;               String line;\n&gt;&gt;&gt;               Cookie cookie = null;\n&gt;&gt;&gt;               while ((line = raf.readLine()) != null) {\n&gt;&gt;&gt;                   // Line that starts with # is commented line, therefore skip it.\n&gt;&gt;&gt;                   if (!line.startsWith(&quot;#&quot;)) {\n&gt;&gt;&gt;                       cookieParts = line.split(&quot;&#92;&#92;t&quot;);\n&gt;&gt;&gt;                       if (cookieParts.length == 7) {\n&gt;&gt;&gt;                           // Create cookie with not expiration date (-1 value).\n&gt;&gt;&gt;                           // TODO: add this as an option.\n&gt;&gt;&gt;                           cookie = new Cookie(cookieParts[0], cookieParts[5],\n&gt;&gt;&gt;                                   cookieParts[6], cookieParts[2], -1, Boolean\n&gt;&gt;&gt;                                           .valueOf(cookieParts[3]).booleanValue());\n&gt;&gt;&gt;\n&gt;&gt;&gt;                           if (cookieParts[1].toLowerCase().equals(&quot;true&quot;)) {\n&gt;&gt;&gt;                               cookie.setDomainAttributeSpecified(true);\n&gt;&gt;&gt;                           } else {\n&gt;&gt;&gt;                               cookie.setDomainAttributeSpecified(false);\n&gt;&gt;&gt;                           }\n&gt;&gt;&gt;\n&gt;&gt;&gt;                           LOGGER.fine(&quot;Adding cookie: &quot;\n&gt;&gt;&gt;                                           + cookie.toExternalForm());\n&gt;&gt;&gt;                       }\n&gt;&gt;&gt;                   }\n&gt;&gt;&gt;               }\n&gt;&gt;&gt;           } catch (FileNotFoundException e) {\n&gt;&gt;&gt;               LOGGER.log(Level.WARNING,&quot;Could not find file: &quot; + cookiesFile, e);\n&gt;&gt;&gt;           } catch (IOException e) {\n&gt;&gt;&gt;               LOGGER.log(Level.WARNING,e.getMessage(), e);\n&gt;&gt;&gt;           } finally {\n&gt;&gt;&gt;               ArchiveUtils.closeQuietly(raf);\n&gt;&gt;&gt;           }\n&gt;&gt;&gt;       }\n&gt;&gt;&gt;\n&gt;&gt;&gt; Or am I missing something here? I have just checked out heritrix 3 from this svn url https://archive-crawler.svn.sourceforge.net/svnroot/archive-crawler/trunk/heritrix3/ and hope it&#39;s the right place.\n&gt;&gt;&gt;\n&gt;&gt;&gt; Regards,\n&gt;&gt;&gt; progre55\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; ------------------------------------\n&gt;&gt;&gt;\n&gt;&gt;&gt; Yahoo! Groups Links\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}