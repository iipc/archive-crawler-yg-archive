{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":319937233,"authorName":"acidbluebriggs","from":"&quot;acidbluebriggs&quot; &lt;acidbriggs@...&gt;","profile":"acidbluebriggs","replyTo":"LIST","senderId":"hsoOjcV5HKq1xGF2977q03gB4pN24RejW_sldCpbiEGnX8gDr3L0GWshPa9pWVumus8TcD8e_R7-63QRuTNtiKWkfmfiwRo_ckFqIgOw","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: Connecting to JMX eventually fails after many calls","postDate":"1194294985","msgId":4658,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGZnbnVzOSthZHFyQGVHcm91cHMuY29tPg==","inReplyToHeader":"PDQ3MkY3ODhGLjUwMTA5MDFAZHVib2NlLm5ldD4="},"prevInTopic":4657,"nextInTopic":0,"prevInTime":4657,"nextInTime":4659,"topicId":4652,"numMessagesInTopic":7,"msgSnippet":"The issue is in the web application. The /admin/include/handler.jsp contains the code: snip ... if (handler == null) { if(Heritrix.isSingleInstance()) { ","rawEmail":"Return-Path: &lt;acidbriggs@...&gt;\r\nX-Sender: acidbriggs@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 3920 invoked from network); 5 Nov 2007 20:36:27 -0000\r\nX-Received: from unknown (66.218.67.97)\n  by m51.grp.scd.yahoo.com with QMQP; 5 Nov 2007 20:36:27 -0000\r\nX-Received: from unknown (HELO n23d.bullet.scd.yahoo.com) (66.218.67.213)\n  by mta18.grp.scd.yahoo.com with SMTP; 5 Nov 2007 20:36:27 -0000\r\nX-Received: from [66.218.69.5] by n23.bullet.scd.yahoo.com with NNFMP; 05 Nov 2007 20:36:27 -0000\r\nX-Received: from [66.218.66.92] by t5.bullet.scd.yahoo.com with NNFMP; 05 Nov 2007 20:36:27 -0000\r\nDate: Mon, 05 Nov 2007 20:36:25 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;fgnus9+adqr@...&gt;\r\nIn-Reply-To: &lt;472F788F.5010901@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: &quot;acidbluebriggs&quot; &lt;acidbriggs@...&gt;\r\nSubject: Re: Connecting to JMX eventually fails after many calls\r\nX-Yahoo-Group-Post: member; u=319937233; y=aPMkgROK41JNzdR0HyunMInN68VuM7fj5wjuoTTYN0i7AU-5gbIIZDE\r\nX-Yahoo-Profile: acidbluebriggs\r\n\r\nThe issue is in the web application. The /admin/include/handler.jsp\ncontain=\r\ns the code:\n\nsnip\n----------------------------------------\n\n   if (handler =\r\n=3D=3D null) {\n        if(Heritrix.isSingleInstance()) {\n            heritr=\r\nix =3D Heritrix.getSingleInstance();\n            handler =3D heritrix.getJo=\r\nbHandler();\n            application.setAttribute(&quot;heritrix&quot;, heritrix);\n   =\r\n         application.setAttribute(&quot;handler&quot;, handler);\n        } else {\n   =\r\n         // TODO:\n            // If we get here, then there are multiple he=\r\nritrix instances\n            // and we have to put up a screen allowing the=\r\n user choose\nbetween.\n            // Otherwise, there is no Heritrix instan=\r\nce.  Thats a problem.\n            throw new RuntimeException(&quot;No heritrix i=\r\nnstance (or\nmultiple &quot; +\n                    &quot;to choose from and we haven&#39;t=\r\n implemented this\nyet)&quot;);\n        }\n    \n\n---------------------------------=\r\n-------\nend snip\n\nWhich in turn calls:\n\nsnip\n------------------------------=\r\n---------\n\n    /**\n     * @return True if only one instance of Heritrix.\n  =\r\n   */\n    public static boolean isSingleInstance() {\n        return Heritri=\r\nx.instances !=3D null && Heritrix.instances.size()\n=3D=3D 1;\n    }\n\n-------=\r\n---------------------------------\nend snip\n\nso, that is the problem.  it&#39;s =\r\njust not supported this way. I&#39;ll have\nto look around and see if I can add =\r\nthe functionality or something. \nMy crawlers are just like you had mentione=\r\nd (incremental naming\nHeritrix2, Heritrix3 etc). When you create instances =\r\nwithin the UI it\nknows about these and allows you to view them. But, the is=\r\nsue is that\nthe UI is what keeps a handle on these instances (unfortunately=\r\n).  I\nsuppose that is why version 2 has removed the UI dependency.\n\n\n \n\n\n  =\r\n \n\n\n--- In archive-crawler@yahoogroups.com, Michael Stack &lt;stack@...&gt; wrote=\r\n:\n&gt;\n&gt; acidbluebriggs wrote:\n&gt; &gt;\n&gt; &gt; ... it might be due to the fact that he=\r\nritrix is using\n&gt; &gt; 100% of the processor and is just not able to respond t=\r\no the\n&gt; &gt; connection request (my own DOS attack).\n&gt; &gt;\n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; You =\r\nare your own worst enemy.  Smile.\n&gt; \n&gt; &gt;\n&gt; &gt; As for the UI, I can&#39;t connect=\r\n to it anyway when I have multiple\n&gt; &gt; crawlers. I get this error (if I sta=\r\nrt heritrix with 10 crawlers via a\n&gt; &gt; shell script and JMX)\n&gt; &gt;\n&gt; &gt; &quot;java.=\r\nlang.RuntimeException: No heritrix instance (or multiple to\n&gt; &gt; choose from=\r\n and we haven&#39;t implemented this yet)&quot;\n&gt; &gt;\n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; Cou=\r\nld be because the code that prints out that message ain&#39;t too\nsmart.  \n&gt; Th=\r\ne UI is looking for an instance named &quot;Heritrix&quot; IIRC and I&#39;m\nguessing \n&gt; t=\r\nhat when you make the ten instances, they&#39;re probably called 0, 1,\n2, 3 \n&gt; =\r\nor mary, bartholemew, and aloyisus... not Heritrix?  (Look for the \n&gt; messa=\r\nge in Heritrix.java).\n&gt; \n&gt; St.Ack\n&gt; \n&gt; \n&gt; \n&gt; &gt;\n&gt; &gt; --- In archive-crawler@y=\r\nahoogroups.com \n&gt; &gt; &lt;mailto:archive-crawler%40yahoogroups.com&gt;, &quot;acidbluebr=\r\niggs&quot;\n&gt; &gt; &lt;acidbriggs@&gt; wrote:\n&gt; &gt; &gt;\n&gt; &gt; &gt; I&#39;ll submit my jobs to reproduce=\r\n it. It will take quite while\nbut when\n&gt; &gt; &gt; it happens again I&#39;ll dump the=\r\n threads.\n&gt; &gt; &gt;\n&gt; &gt; &gt; The UI is dead when this problem occurs so I can&#39;t ch=\r\neck it for\n&gt; &gt; &gt; errors. But, the heritrix log file along with the job logs=\r\n\ncontain no\n&gt; &gt; &gt; errors.\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; --- In archive-crawler@yahoogro=\r\nups.com \n&gt; &gt; &lt;mailto:archive-crawler%40yahoogroups.com&gt;, Michael Stack &lt;sta=\r\nck@&gt;\nwrote:\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Can you get thread dumps from the heritrix inst=\r\nance and try and\n&gt; &gt; figure\n&gt; &gt; &gt; &gt; why its stopped accepting connections a=\r\nnd what its doing w/ that\n&gt; &gt; &gt; 100% of\n&gt; &gt; &gt; &gt; CPU (Would be particularly =\r\ngood if you could get dumps across the\n&gt; &gt; &gt; &gt; transistion going from accep=\r\nting JMX connections to its going\ndeaf to\n&gt; &gt; &gt; &gt; JMX connections)? If you =\r\nbrowse to the UI, it all seems to be\n&gt; &gt; working\n&gt; &gt; &gt; &gt; fine? Anything in =\r\nthe UI Alerts list?\n&gt; &gt; &gt; &gt; St.Ack\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; acidbluebriggs wrote:\n&gt; =\r\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; So, I have a simple class to invoke crawl jobs on Heritri=\r\nx\nvia JMX.\n&gt; &gt; &gt; &gt; &gt; It seems to work fine for about 600 total jobs submitt=\r\ned, but\n&gt; &gt; &gt; &gt; &gt; eventually I cannot connect to the MBean server (or the\nW=\r\nebUI); I&#39;ll\n&gt; &gt; &gt; &gt; &gt; just get socket timeout exceptions. I can&#39;t connect v=\r\nia\neither the\n&gt; &gt; &gt; &gt; &gt; JConsole application nor the command line also.\n&gt; &gt;=\r\n &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; The process is that I have 10 heritrix instances up (withi=\r\nn\nthe one\n&gt; &gt; &gt; &gt; &gt; jvm) and I look for an available crawler mbean (via a j=\r\nmx query)\n&gt; &gt; when\n&gt; &gt; &gt; &gt; &gt; a job needs to be submitted.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;=\r\n &gt; Does anyone know of any issues like this? I am using\nHeritrix 1.12.1\n&gt; &gt;=\r\n &gt; &gt; &gt; and java build 1.5.0_11-b03.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; I see no OOME or an=\r\nything in the logs. But, if I run &#39;top&#39; I\ncan see\n&gt; &gt; &gt; &gt; &gt; that the CPU us=\r\nage has spiked to 100%. But, the current crawls I\n&gt; &gt; have\n&gt; &gt; &gt; &gt; &gt; seem t=\r\no be stalled (no more output to the logs or the arc\nfiles have\n&gt; &gt; &gt; &gt; &gt; be=\r\nen appended for over a day).\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; I hope this is enough info=\r\n to jog some memories if the issue has\n&gt; &gt; been\n&gt; &gt; &gt; &gt; &gt; seen before.\n&gt; &gt; =\r\n&gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; --briggs\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt;\n\n\n\n"}}