{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":473207283,"authorName":"kristsi25","from":"&quot;kristsi25&quot; &lt;kristinn@...&gt;","profile":"kristsi25","replyTo":"LIST","senderId":"sBJVRKppNA9BcchIc7nTvICCX1P-FyIkqy10zrqXwLZNvS0Zn_VePcKLNXWbnAxP_t9RX0Ao1pOlr_WjYcRZ5bUDlefN2l52Jvhj9bU1","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: What happens on internet connection failure?","postDate":"1340794462","msgId":7718,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGpzZW9vdSsyMXU0QGVHcm91cHMuY29tPg==","inReplyToHeader":"PGpzNGphaCtsNG51QGVHcm91cHMuY29tPg=="},"prevInTopic":7716,"nextInTopic":0,"prevInTime":7717,"nextInTime":7719,"topicId":7716,"numMessagesInTopic":2,"msgSnippet":"In these instances, the URL is marked as failed and will be retried. Typically, the relevant queue is snoozed for a decent amount of time so it will not be","rawEmail":"Return-Path: &lt;kristinn@...&gt;\r\nX-Sender: kristinn@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 57459 invoked from network); 27 Jun 2012 10:54:24 -0000\r\nX-Received: from unknown (98.137.34.44)\n  by m10.grp.sp2.yahoo.com with QMQP; 27 Jun 2012 10:54:24 -0000\r\nX-Received: from unknown (HELO ng18-ip2.bullet.mail.bf1.yahoo.com) (98.139.165.158)\n  by mta1.grp.sp2.yahoo.com with SMTP; 27 Jun 2012 10:54:23 -0000\r\nX-Received: from [98.139.164.123] by ng18.bullet.mail.bf1.yahoo.com with NNFMP; 27 Jun 2012 10:54:23 -0000\r\nX-Received: from [98.137.34.51] by tg4.bullet.mail.bf1.yahoo.com with NNFMP; 27 Jun 2012 10:54:23 -0000\r\nDate: Wed, 27 Jun 2012 10:54:22 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;jseoou+21u4@...&gt;\r\nIn-Reply-To: &lt;js4jah+l4nu@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: &quot;kristsi25&quot; &lt;kristinn@...&gt;\r\nSubject: Re: What happens on internet connection failure?\r\nX-Yahoo-Group-Post: member; u=473207283; y=2utbS4Ni781whZWu8M7JctcWgpYYZQYTdKYuO7DR2jtGTHpr\r\nX-Yahoo-Profile: kristsi25\r\n\r\nIn these instances, the URL is marked as failed and will be retried. Typica=\r\nlly, the relevant queue is snoozed for a decent amount of time so it will n=\r\not be retried immediately, I believe the default wait is 900 seconds, 15 mi=\r\nnutes. The URL will then be retried every 15 minutes until the maximum numb=\r\ner for retires (default 30) is exhausted. This means that after about a 7,5=\r\n hour outage, URLs will begin to fail permanently. \n\nThere is no auto-pause=\r\n facility, although it should be fairly straight forward to write a module =\r\nthat monitored the crawler for this condition. I.e. if no URL successfully =\r\ndownloaded in the last X minutes, then pause. \n\nSomething like:\n\n---\nimport=\r\n java.util.logging.Level;\nimport java.util.logging.Logger;\n\nimport org.arch=\r\nive.crawler.event.CrawlURIDispositionEvent;\nimport org.archive.crawler.fram=\r\nework.CrawlController;\nimport org.archive.modules.CrawlURI;\nimport org.spri=\r\nngframework.beans.factory.annotation.Autowired;\nimport org.springframework.=\r\ncontext.ApplicationEvent;\nimport org.springframework.context.ApplicationLis=\r\ntener;\n\npublic class LostConnectionMonitor implements ApplicationListener&lt;A=\r\npplicationEvent&gt; {\n    private long lastSuccess =3D -1;\n\n    protected Craw=\r\nlController controller;\n    public CrawlController getCrawlController() {\n =\r\n       return this.controller;\n    }\n    @Autowired\n    public void setCraw=\r\nlController(CrawlController controller) {\n        this.controller =3D contr=\r\noller;\n    }\n    \n    private static final Logger logger =3D Logger.getLogg=\r\ner(LowDiskPauseProcessor.class.getName());\n    \n    long maxMinWithoutSucce=\r\nss =3D 20;  \n    public long getMaxMinWithoutSuccess() {\n        return thi=\r\ns.maxMinWithoutSuccess;\n    }\n    public void setMaxMinWithoutSuccess(long =\r\nmaxMinWithoutSuccess) {\n        this.maxMinWithoutSuccess =3D maxMinWithout=\r\nSuccess;\n    }\n    \n    @Override\n    public void onApplicationEvent(Applic=\r\nationEvent event) {\n        if (event instanceof CrawlURIDispositionEvent) =\r\n{\n            CrawlURI curi =3D ((CrawlURIDispositionEvent)event).getCrawlU=\r\nRI();\n            if (!curi.isHttpTransaction()) {\n                return; =\r\n// Ignore DNS lookups that may succeed without \n                        // =\r\nInternet connection if using local DNS cache\n            }\n            if (=\r\nlastSuccess=3D=3D-1 || curi.getFetchStatus() &gt; 0) {\n                lastSuc=\r\ncess =3D System.currentTimeMillis();\n            }\n            if (lastSucc=\r\ness + (maxMinWithoutSuccess*60*1000) &lt; System.currentTimeMillis()) {\n      =\r\n          logger.log(Level.SEVERE, &quot;Pausing due to likely connection failur=\r\ne. No success in - &quot; + \n                        maxMinWithoutSuccess + &quot; mi=\r\nnutes.&quot;);\n                controller.requestCrawlPause();\n                l=\r\nastSuccess =3D -1;\n            }\n        }\n    }\n}\n---\n\nshould work (the co=\r\nde above is COMPLETELY untested). You only need to instantiate the bean and=\r\n you&#39;re done. No need to wire it into anything, it takes care of that by it=\r\nself. \n\n\n- Kris\n\n--- In archive-crawler@yahoogroups.com, &quot;crawltst&quot; &lt;crawlt=\r\nst@...&gt; wrote:\n&gt;\n&gt; Hi  \n&gt; What happens for H3 on internet connection failur=\r\ne?\n&gt; \n&gt; I mean if internet get disconnected; do H3 pauses until next connec=\r\ntion or it simply marks URL as failed and goes to next one (and mark it too=\r\n to the end)?\n&gt;  \n&gt; If it marks URLs as failed one after the other; does it=\r\n re-tries to fetch them on next connection or those URLs will never fetched=\r\n? \n&gt; \n&gt; Thanks\n&gt;\n\n\n\n"}}