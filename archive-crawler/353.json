{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":172190008,"authorName":"Andrew Boyko","from":"&quot;Andrew Boyko&quot; &lt;aboy@...&gt;","profile":"andyboyko","replyTo":"LIST","senderId":"EK6c_4Ub31az9HVNxebvW7HnnPQYf1ZDH1Ln3kuguTtejbOIIfQQ792DNEdrWDIHX-Oto0NtBCPfu1U4BB-CWHIe__g","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Large seed lists: some troubles","postDate":"1083159778","msgId":353,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PHMwOGY3ZDMyLjAwNEBsb2MuZ292Pg=="},"prevInTopic":0,"nextInTopic":355,"prevInTime":352,"nextInTime":354,"topicId":353,"numMessagesInTopic":4,"msgSnippet":"I happen to have a seed list of nearly 1024 entries.  Not totally surprisingly, Heritrix behaves a little oddly with that many seeds. First, crawls with either","rawEmail":"Return-Path: &lt;aboy@...&gt;\r\nX-Sender: aboy@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 19465 invoked from network); 28 Apr 2004 13:57:05 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m6.grp.scd.yahoo.com with QMQP; 28 Apr 2004 13:57:05 -0000\r\nReceived: from unknown (HELO loc.gov) (140.147.137.18)\n  by mta4.grp.scd.yahoo.com with SMTP; 28 Apr 2004 13:57:05 -0000\r\nReceived: from LCHub-MTA by loc.gov\n\twith Novell_GroupWise; Wed, 28 Apr 2004 09:45:22 -0400\r\nMessage-Id: &lt;s08f7d32.004@...&gt;\r\nX-Mailer: Novell GroupWise Internet Agent 6.5.1 \r\nDate: Wed, 28 Apr 2004 09:42:58 -0400\r\nTo: &lt;archive-crawler@yahoogroups.com&gt;\r\nMime-Version: 1.0\r\nContent-Type: multipart/alternative; boundary=&quot;=__PartE1C023F2.0__=&quot;\r\nX-eGroups-Remote-IP: 140.147.137.18\r\nFrom: &quot;Andrew Boyko&quot; &lt;aboy@...&gt;\r\nSubject: Large seed lists: some troubles\r\nX-Yahoo-Group-Post: member; u=172190008\r\nX-Yahoo-Profile: andyboyko\r\n\r\n\r\n--=__PartE1C023F2.0__=\r\nContent-Type: text/plain; charset=US-ASCII\r\nContent-Transfer-Encoding: 7bit\r\n\r\nI happen to have a seed list of nearly 1024 entries.  Not totally\nsurprisingly, Heritrix behaves a little oddly with that many seeds. \nFirst, crawls with either 0.6.0 or the latest CVS build fail because too\nmany files are opened almost immediately, and then neither socket\noperations nor file logging are able to proceed.  A typical exception:\n \n java.io.FileNotFoundException:\n/crawl/heritrix/heritrix-0.6.0/jobs/crs-20040427190708335/disk/scratch/bphc.hrsa.gov.ff0\n(Too many open files)\n        at java.io.FileOutputStream.open(Native Method)\n        at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:179)\n        at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:131)\n        at\norg.archive.io.FlipFileOutputStream.&lt;init&gt;(FlipFileOutputStream.java:69)\n        at\norg.archive.io.DiskBackedByteQueue.initializeStreams(DiskBackedByteQueue.java:67)\n        at org.archive.util.DiskQueue.&lt;init&gt;(DiskQueue.java:100)\n        at\norg.archive.util.DiskBackedQueue.&lt;init&gt;(DiskBackedQueue.java:59)\n        at\norg.archive.crawler.basic.KeyedQueue.&lt;init&gt;(KeyedQueue.java:76)\n        at\norg.archive.crawler.basic.Frontier.keyedQueueFor(Frontier.java:927)\n        at\norg.archive.crawler.basic.Frontier.scheduleForRetry(Frontier.java:1333)\n        at\norg.archive.crawler.basic.Frontier.finished(Frontier.java:676)\n        at\norg.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:200)\n        at\norg.archive.crawler.framework.ToeThread.run(ToeThread.java:124)\n\nYou can get past that by allowing a larger number of open files for the\nprocess (which requires running Heritrix with root privilege), as in:\n   # (ulimit -n 4096; JAVA_OPTS=-Xmx320 bin/heritrix -p 9876)\n \nNext up, using the current CVS build, a surprising number (like, ~70)\nof java.util.ConcurrentModificationExceptions occurred in the first\nmoments of the crawl (and then intermittently throughout), all with the\nsame stack trace.  An example:\n \n20040427194255925    -5      39804 #48 http://eia.doe.gov/ 124\ntext/html 3t\n java.util.ConcurrentModificationException\n        at\njava.util.AbstractList$Itr.checkForComodification(AbstractList.java:448)\n        at java.util.AbstractList$Itr.next(AbstractList.java:419)\n        at\norg.archive.crawler.scope.HostScope.focusAccepts(HostScope.java:120)\n        at\norg.archive.crawler.framework.CrawlScope.innerAccepts(CrawlScope.java:198)\n        at\norg.archive.crawler.framework.Filter.accepts(Filter.java:94)\n        at\norg.archive.crawler.basic.Postselector.schedule(Postselector.java:200)\n        at\norg.archive.crawler.basic.Postselector.handleLinkCollection(Postselector.java:262)\n        at\norg.archive.crawler.basic.Postselector.innerProcess(Postselector.java:112)\n        at\norg.archive.crawler.framework.Processor.process(Processor.java:106)\n        at\norg.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:205)\n        at\norg.archive.crawler.framework.ToeThread.run(ToeThread.java:135)\n\nLooking at the code, it looks like the CrawlScope class hands out an\niterator on the scope&#39;s seeds list; that iteration needs to synchronize\non the list (per the note in \nhttp://java.sun.com/j2se/1.4.2/docs/api/java/util/Collections.html#synchronizedCollection(java.util.Collection)\n), which I guess is going to take some refactoring.\n \nShould it be relevant, the few changes made to the default\nconfiguration for this crawl, other than adding a pile of seeds, were:\n- HostScope\n- max-link-hops 1 \n- total-bandwidth-usage-KB-sec 500\n\nOtherwise, the crawl for this large seed list seems to be proceeding\napace.\n \nAndy Boyko    aboy@...\n \n\r\n--=__PartE1C023F2.0__=\r\nContent-Type: text/html; charset=ISO-8859-1\r\nContent-Transfer-Encoding: 8bit\r\nContent-Description: HTML\r\n\r\n&lt;HTML&gt;&lt;HEAD&gt;\n&lt;META http-equiv=Content-Type content=&quot;text/html; charset=iso-8859-1&quot;&gt;\n&lt;META content=&quot;MSHTML 6.00.2800.1400&quot; name=GENERATOR&gt;&lt;/HEAD&gt;\n&lt;BODY style=&quot;MARGIN: 4px 4px 1px; FONT: 10pt Microsoft Sans Serif&quot;&gt;\n&lt;DIV&gt;I happen to have a seed list of nearly 1024 entries.&nbsp; Not totally surprisingly, Heritrix behaves a little oddly with that many seeds.&nbsp; First,&nbsp;crawls with either 0.6.0 or the latest CVS build fail because too many files are opened almost immediately, and then neither socket operations nor file logging are able to proceed.&nbsp; A typical exception:&lt;/DIV&gt;\n&lt;DIV&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;&nbsp;java.io.FileNotFoundException: /crawl/heritrix/heritrix-0.6.0/jobs/crs-20040427190708335/disk/scratch/bphc.hrsa.gov.ff0 (Too many open files)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at java.io.FileOutputStream.open(Native Method)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:179)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:131)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.io.FlipFileOutputStream.&lt;init&gt;(FlipFileOutputStream.java:69)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.io.DiskBackedByteQueue.initializeStreams(DiskBackedByteQueue.java:67)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.util.DiskQueue.&lt;init&gt;(DiskQueue.java:100)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.util.DiskBackedQueue.&lt;init&gt;(DiskBackedQueue.java:59)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.basic.KeyedQueue.&lt;init&gt;(KeyedQueue.java:76)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.basic.Frontier.keyedQueueFor(Frontier.java:927)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.basic.Frontier.scheduleForRetry(Frontier.java:1333)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.basic.Frontier.finished(Frontier.java:676)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:200)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.framework.ToeThread.run(ToeThread.java:124)&lt;BR&gt;&lt;/DIV&gt;\n&lt;DIV&gt;You can get past that by allowing a larger number of open files for the process (which requires running Heritrix with&nbsp;root privilege), as in:&lt;BR&gt;&nbsp;&nbsp;&nbsp;# (ulimit -n 4096; JAVA_OPTS=-Xmx320 bin/heritrix -p 9876)&lt;/DIV&gt;\n&lt;DIV&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;Next up, using the current CVS build, a surprising number (like, ~70)&nbsp;of java.util.ConcurrentModificationExceptions occurred in the first moments of the crawl (and then intermittently throughout), all with the same stack trace. &nbsp;An example:&lt;/DIV&gt;\n&lt;DIV&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;20040427194255925&nbsp;&nbsp;&nbsp; -5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 39804 #48 &lt;A href=&quot;http://eia.doe.gov/&quot;&gt;http://eia.doe.gov/&lt;/A&gt; 124 text/html 3t&lt;/DIV&gt;\n&lt;DIV&gt;&nbsp;java.util.ConcurrentModificationException&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at java.util.AbstractList$Itr.checkForComodification(AbstractList.java:448)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at java.util.AbstractList$Itr.next(AbstractList.java:419)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.scope.HostScope.focusAccepts(HostScope.java:120)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.framework.CrawlScope.innerAccepts(CrawlScope.java:198)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.framework.Filter.accepts(Filter.java:94)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.basic.Postselector.schedule(Postselector.java:200)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.basic.Postselector.handleLinkCollection(Postselector.java:262)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.basic.Postselector.innerProcess(Postselector.java:112)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.framework.Processor.process(Processor.java:106)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:205)&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at org.archive.crawler.framework.ToeThread.run(ToeThread.java:135)&lt;BR&gt;&lt;/DIV&gt;\n&lt;DIV&gt;Looking at the code, it looks like the&nbsp;CrawlScope class hands out&nbsp;an iterator on the scope&#39;s seeds list; that iteration needs to synchronize on the list (per the note in&nbsp; &lt;A href=&quot;http://java.sun.com/j2se/1.4.2/docs/api/java/util/Collections.html#synchronizedCollection(java.util.Collection&quot;&gt;http://java.sun.com/j2se/1.4.2/docs/api/java/util/Collections.html#synchronizedCollection(java.util.Collection&lt;/A&gt;) ), which I guess is going to take some refactoring.&lt;/DIV&gt;\n&lt;DIV&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;Should it be relevant, the few changes made to the default configuration for this crawl, other than adding a pile of seeds, were:&lt;/DIV&gt;\n&lt;DIV&gt;- HostScope&lt;/DIV&gt;\n&lt;DIV&gt;- max-link-hops 1 &lt;/DIV&gt;\n&lt;DIV&gt;- total-bandwidth-usage-KB-sec 500&lt;BR&gt;&lt;/DIV&gt;\n&lt;DIV&gt;Otherwise, the crawl for this large seed list seems to be proceeding apace.&lt;/DIV&gt;\n&lt;DIV&gt;&nbsp;&lt;/DIV&gt;\n&lt;DIV&gt;Andy Boyko&nbsp;&nbsp; &nbsp;&lt;A href=&quot;mailto:aboy@...&quot;&gt;aboy@...&lt;/A&gt;&lt;/DIV&gt;\n&lt;DIV&gt;&nbsp;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;\r\n--=__PartE1C023F2.0__=--\r\n\n"}}