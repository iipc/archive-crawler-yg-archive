{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137477665,"authorName":"Igor Ranitovic","from":"Igor Ranitovic &lt;igor@...&gt;","profile":"iranitovic","replyTo":"LIST","senderId":"dB9DXna34H5MCi4Bow4Qz45zsYDjNdvaa9AvNsepTdSYj47ZtpjWiFWtt1JqRbuvLUMb0mSWkU3HyuakK3jlnI8Uasz8evJZ","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Re: Beanshell script format (?)","postDate":"1161120909","msgId":3461,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQ1MzU0QzhELjQwMjA1MDZAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGVoM2cxYytucmpoQGVHcm91cHMuY29tPg==","referencesHeader":"PGVoM2cxYytucmpoQGVHcm91cHMuY29tPg=="},"prevInTopic":3460,"nextInTopic":0,"prevInTime":3460,"nextInTime":3462,"topicId":3452,"numMessagesInTopic":4,"msgSnippet":"I would keep as much code as possible out of the script itself. Try adding DecidingFilter to BeanShellProcessor and use existing filters such as: ","rawEmail":"Return-Path: &lt;igor@...&gt;\r\nX-Sender: igor@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 1110 invoked from network); 17 Oct 2006 21:37:18 -0000\r\nReceived: from unknown (66.218.66.167)\n  by m27.grp.scd.yahoo.com with QMQP; 17 Oct 2006 21:37:18 -0000\r\nReceived: from unknown (HELO mail.archive.org) (207.241.233.246)\n  by mta6.grp.scd.yahoo.com with SMTP; 17 Oct 2006 21:37:18 -0000\r\nReceived: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 3451D1415FE8E\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Tue, 17 Oct 2006 14:35:14 -0700 (PDT)\r\nReceived: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id 01986-03-91 for &lt;archive-crawler@yahoogroups.com&gt;;\n\tTue, 17 Oct 2006 14:35:12 -0700 (PDT)\r\nReceived: from [127.0.0.1] (c-71-198-60-165.hsd1.ca.comcast.net [71.198.60.165])\n\tby mail.archive.org (Postfix) with ESMTP id E321B1415FF32\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Tue, 17 Oct 2006 14:35:11 -0700 (PDT)\r\nMessage-ID: &lt;45354C8D.4020506@...&gt;\r\nDate: Tue, 17 Oct 2006 14:35:09 -0700\r\nUser-Agent: Thunderbird 1.5.0.7 (Windows/20060909)\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;eh3g1c+nrjh@...&gt;\r\nIn-Reply-To: &lt;eh3g1c+nrjh@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-Virus-Scanned: Debian amavisd-new at archive.org\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nFrom: Igor Ranitovic &lt;igor@...&gt;\r\nSubject: Re: [archive-crawler] Re: Beanshell script format (?)\r\nX-Yahoo-Group-Post: member; u=137477665; y=L5Pr23YSrGWXgwSJUC-S57zTZc67Nr-NILUq02LTf20aK2Kedw\r\nX-Yahoo-Profile: iranitovic\r\n\r\nI would keep as much code as possible out of the script itself. Try \nadding DecidingFilter to BeanShellProcessor and use existing filters \nsuch as:\nFetchStatusDecideRule\nHopsPathMatchesRegExpDecideRule\nMatchesFilePatternDecideRule\n\nIf an URL passes the filter than just simply change the fetch status \ncode within the script.\n\nHope this helps.\ni.\n\nastar_t wrote:\n&gt; Thanks for the help, getPathFromSeed is the method I&#39;m after.  I&#39;ve \n&gt; decided instead though to not check the hop type and instead just go \n&gt; with file extension for now, since I just want to capture all images, \n&gt; CSS and JS.\n&gt; \n&gt; So here&#39;s the script I came up with:\n&gt; \n&gt; //: allow_images.bsh\n&gt; import org.archive.crawler.datamodel.*;\n&gt; import java.io.*;\n&gt; import java.util.regex.*;\n&gt; \n&gt; process(CrawlURI curi) { \n&gt;   if (curi.getFetchStatus() == FetchStatusCodes.S_ROBOTS_PRECLUDED)\n&gt;   {\n&gt;     Pattern pat = Pattern.compile(&quot;.*&#92;&#92;.(bmp|gif|jpe?g|png|tiff?\n&gt; |css|js)$&quot;, Pattern.CASE_INSENSITIVE);\n&gt;     Matcher matcher = pat.matcher(curi.getURIString().trim());\n&gt;     if (matcher.matches())\n&gt;       curi.setFetchStatus(FetchStatusCodes.S_UNATTEMPTED);\n&gt;   }  \n&gt; }\n&gt; \n&gt; On my first test run it seems to work like a charm.  Any suggestions \n&gt; welcome. :)\n&gt; \n&gt; --- In archive-crawler@yahoogroups.com, Michael Stack &lt;stack@...&gt; \n&gt; wrote:\n&gt;&gt; astar_t wrote:\n&gt;&gt;&gt; Okay, so I am getting closer now. I have managed to get a \n&gt; beanshell\n&gt;&gt;&gt; script to modify the CrawlURI and ignore robots.txt using this:\n&gt;&gt;&gt;\n&gt;&gt;&gt; //---- allow_robots.bsh ---\n&gt;&gt;&gt;\n&gt;&gt;&gt; addClassPath( &quot;/home/heritrix/local/heritrix-1.10.1/lib&quot; );\n&gt;&gt;&gt; import *;\n&gt;&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt; process(CrawlURI curi) {\n&gt;&gt;&gt; if (curi.getFetchStatus() == FetchStatusCodes.S_ROBOTS_PRECLUDED)\n&gt;&gt;&gt; curi.setFetchStatus(FetchStatusCodes.S_UNATTEMPTED);\n&gt;&gt;&gt; }\n&gt;&gt;&gt; //:~\n&gt;&gt;&gt;\n&gt;&gt;&gt; Now this script will ignore all robots.txt. Obviously not what I&#39;m\n&gt;&gt;&gt; trying to so next step is to check the last hop type of the \n&gt; CrawlURI to\n&gt;&gt;&gt; see if it is &#39;E&#39; or &#39;X&#39; or has file extension such as bmp, gif, \n&gt; jpe?g,\n&gt;&gt;&gt; png, etc.\n&gt;&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; Is CrawlURI#getPathFromSeed() what you are after?  (And perhaps \n&gt;&gt; CrawlURI#getUURI()#getPath()?)\n&gt;&gt;\n&gt;&gt; St.Ack\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt; Is there a method to get last hop type of the CrawlURI ? I have \n&gt; looked\n&gt;&gt;&gt; in the Javadoc and couldn&#39;t find one. I&#39;ll take another look and\n&gt;&gt;&gt; document my findings ......\n&gt;&gt;&gt;\n&gt;&gt;&gt; --- In archive-crawler@yahoogroups.com \n&gt;&gt;&gt; &lt;mailto:archive-crawler%40yahoogroups.com&gt;, &quot;astar_t&quot; &lt;astar_t@&gt; \n&gt; wrote:\n&gt;&gt;&gt;&gt; Hi, I am wondering how exactly to write a Beanshell script. I\n&gt;&gt;&gt;&gt; understand that a process method is required that gets a passed \n&gt; in\n&gt;&gt;&gt;&gt; Crawl URI. Does the script require a main method or a specific \n&gt; class\n&gt;&gt;&gt;&gt; name?\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; Specifically, I&#39;d like to place it between the Precondition \n&gt; enforcer\n&gt;&gt;&gt;&gt; and the fetchers so I can allow specific folders to be ignored \n&gt; from\n&gt;&gt;&gt;&gt; robots.txt. i.e. I&#39;d like to change the status of a CrawlURI \n&gt; from -\n&gt;&gt;&gt;&gt; 9998 to an &quot;accept&quot; code only if it is in a specific path to \n&gt; all an\n&gt;&gt;&gt;&gt; images folder that is in robots.txt to still be crawled.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; By chance does anyone have an example beanshell script that \n&gt; would do\n&gt;&gt;&gt;&gt; this?\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; Thanks\n&gt;&gt;&gt;&gt; Adam T.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt;  \n&gt; Yahoo! Groups Links\n&gt; \n&gt; \n&gt; \n&gt; \n\n\n"}}