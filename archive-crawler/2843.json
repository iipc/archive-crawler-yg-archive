{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"K8ZymMuQeMO1v3IMxPZMPhQakeo5onGVXMiw7OZH1PZq6wrj6WnABcZ34DcCTfJMDW84UaY79IV-9eibEj05sQJd0QrLfYQ","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] Re: Heritrix &quot;hangs&quot; and doesn&#39;t finish its job","postDate":"1147203428","msgId":2843,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQ0NjBFRjY0LjQwMzA3MDJAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGUzcG51OSsyaTUyQGVHcm91cHMuY29tPg==","referencesHeader":"PGUzcG51OSsyaTUyQGVHcm91cHMuY29tPg=="},"prevInTopic":2840,"nextInTopic":2845,"prevInTime":2842,"nextInTime":2844,"topicId":2822,"numMessagesInTopic":9,"msgSnippet":"Olaf, I apologize for not responding to you initial report sooner. Of course, this should never happen: the queued tally should match the total number of","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 48460 invoked from network); 9 May 2006 19:37:04 -0000\r\nReceived: from unknown (66.218.67.33)\n  by m34.grp.scd.yahoo.com with QMQP; 9 May 2006 19:37:04 -0000\r\nReceived: from unknown (HELO mail.archive.org) (207.241.227.188)\n  by mta7.grp.scd.yahoo.com with SMTP; 9 May 2006 19:37:04 -0000\r\nReceived: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id AC99914113FE1\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Tue,  9 May 2006 12:37:04 -0700 (PDT)\r\nReceived: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id 29048-01-27 for &lt;archive-crawler@yahoogroups.com&gt;;\n\tTue, 9 May 2006 12:37:02 -0700 (PDT)\r\nReceived: from [192.168.1.9] (unknown [67.170.222.19])\n\tby mail.archive.org (Postfix) with ESMTP id 41A62140FC165\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Tue,  9 May 2006 12:37:02 -0700 (PDT)\r\nMessage-ID: &lt;4460EF64.4030702@...&gt;\r\nDate: Tue, 09 May 2006 12:37:08 -0700\r\nUser-Agent: Mail/News 1.5 (X11/20060309)\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;e3pnu9+2i52@...&gt;\r\nIn-Reply-To: &lt;e3pnu9+2i52@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-Virus-Scanned: Debian amavisd-new at archive.org\r\nX-eGroups-Msg-Info: 1:12:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] Re: Heritrix &quot;hangs&quot; and doesn&#39;t finish its\n job\r\nX-Yahoo-Group-Post: member; u=137285340; y=RqegmD8wmRwwHCIQyhrnQKV3aNnvv6jipn_S25U9swC8\r\nX-Yahoo-Profile: gojomo\r\n\r\nOlaf,\n\nI apologize for not responding to you initial report sooner.\n\nOf course, this should never happen: the &#39;queued&#39; tally should match the \ntotal number of URIs in non-exhausted, non-retired queues. Maintenance \nof this sum and the queue states should all be synchronized against any \n  timing/race bugs like you hypothesize.\n\nBut, of course, bugs happen. My two initial hunches for what to look \ninto would be:\n\n(1) A careful examination of heritrix_out.log for any error stacks. \nUnhandled exceptions in the frontier can leave queues in an \nindeterminate state, so they might be neither among the &#39;active&#39; queues \nnor the inactive/retried/exhausted.\n\n(2) The maintenance of the queuedUriCount with respect to the retiring \nof over-budget queues. The &#39;retiring&#39; feature is newer than the general \nqueue lifecycle, and through Heritrix-1.6 queues weren&#39;t properly \n&#39;unretired&#39; to continue offering URIs for crawling when a increase in \nbudgetting occurred. (Did the affected crawl have any settings changes \nmid-crawl?)\n\nWe haven&#39;t seen this, but if you&#39;re seeing it regularly, perhaps there&#39;s \nsomething specific about your approach that is essentialy to reproducing \nthe bug. What&#39;s the *smallest* crawl you&#39;ve seen this happen for?\n\n- Gordon @ IA\n\npandae667 wrote:\n&gt; Hi everyone,\n&gt; \n&gt; I&#39;v dug some more through the Heritrix sources to track down the\n&gt; problem but haven&#39;t found a solution yet. This problem starts to get\n&gt; really annoying as it happens on almost every big crawl I&#39;m running\n&gt; (500+ seeds) but rarly on small ones with less seeds.\n&gt; \n&gt; I haven&#39;t found a cause yet but have some theories what might cause it\n&gt; (even though I might be totally wrong).\n&gt; \n&gt; The most propable theory so far is the following:\n&gt; Two ToeThreads working on different URIs from different queues come\n&gt; accross the same (so far unseen) URI at more or less &quot;the exact same\n&gt; moment&quot;. Both threads come to the conclusion that their URI is new and\n&gt; try to enqueue it in the currect queue. While doing this both of them\n&gt; increment to queuedUriCount by 1 but the queue itself being smart\n&gt; enough only contains one of them.\n&gt; \n&gt; I&#39;ll increase logging to see if my theory might be true and report\n&gt; back later.\n&gt; \n&gt; \n&gt; If anyone has any other idea in the meantime I&#39;ll be happy to hear\n&gt; about it.\n&gt; \n&gt; Thanks alot\n&gt;   Olaf Freyer\n&gt; \n&gt; \n&gt; --- In archive-crawler@yahoogroups.com, &quot;pandae667&quot; &lt;aaron667@...&gt; wrote:\n&gt;&gt; Hi everyone here at archive-crawler,\n&gt;&gt;\n&gt;&gt; I&#39;m experiencing a strange problem with my crawler (heritrix cvs +\n&gt;&gt; AddRedirectFromRootServerToScope fix from Gordon). It happened to me\n&gt;&gt; twice so far.\n&gt;&gt;\n&gt;&gt; After about 1 hour it has fetched (allmost?) all the documents it is\n&gt;&gt; supposed to (about 9000 seeds and a limit of 100 documents per host)\n&gt;&gt; and then just &quot;hangs&quot;.\n&gt;&gt;\n&gt;&gt; The Frontier Report tells me:\n&gt;&gt;\n&gt;&gt;  -----===== STATS =====-----\n&gt;&gt;  Discovered:    1008968\n&gt;&gt;  Queued:        24\n&gt;&gt;  Finished:      432424\n&gt;&gt;   Successfully: 426289\n&gt;&gt;   Failed:       1565\n&gt;&gt;   Disregarded:  4570\n&gt;&gt;\n&gt;&gt;  -----===== QUEUES =====-----\n&gt;&gt;  Already included size:     1008968\n&gt;&gt;                pending:     0\n&gt;&gt;\n&gt;&gt;  All class queues map size: 12872\n&gt;&gt;              Active queues: 0\n&gt;&gt;                     In-process: 0\n&gt;&gt;                          Ready: 0\n&gt;&gt;                        Snoozed: 0\n&gt;&gt;            Inactive queues: 0\n&gt;&gt;             Retired queues: 2226\n&gt;&gt;           Exhausted queues: 10646\n&gt;&gt;\n&gt;&gt;  -----===== IN-PROCESS QUEUES =====-----\n&gt;&gt;\n&gt;&gt; So there are still 24 queued URIs - but no active queue left (last\n&gt;&gt; time a queue did anything was about 12 hours ago).\n&gt;&gt;\n&gt;&gt; Thanks in advance for any ideas\n&gt;&gt;   Olaf Freyer\n&gt;&gt;\n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt;  \n&gt; Yahoo! Groups Links\n&gt; \n&gt; \n&gt; \n&gt;  \n&gt; \n&gt; \n\n\n"}}