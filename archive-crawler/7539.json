{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"lllzarSnXKHxdihEQzowAb3lSFGdReE1wAmJjVZK5wtPg3RPH0ZDaaxbR2x90dl8-tzbq5ynlck1SlVe0pyGCwUMWLjgViY","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: Configuring ContentLengthDecideRule","postDate":"1327021064","msgId":7539,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRGMThCQzA4LjYwODA0MDlAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDRGMTYzQ0E1LjkwMTAwMDRAY3MuY211LmVkdT4=","referencesHeader":"PDRGMTYzQ0E1LjkwMTAwMDRAY3MuY211LmVkdT4="},"prevInTopic":7530,"nextInTopic":7557,"prevInTime":7538,"nextInTime":7540,"topicId":7530,"numMessagesInTopic":9,"msgSnippet":"(FYI, your last separate question revealed a serious bug in scoping after checkpoint resumes, but I ll handle it in order at the very end.) Re:","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 63742 invoked from network); 20 Jan 2012 00:57:47 -0000\r\nX-Received: from unknown (98.137.34.45)\n  by m4.grp.sp2.yahoo.com with QMQP; 20 Jan 2012 00:57:47 -0000\r\nX-Received: from unknown (HELO relay03.pair.com) (209.68.5.17)\n  by mta2.grp.sp2.yahoo.com with SMTP; 20 Jan 2012 00:57:47 -0000\r\nX-Received: (qmail 81420 invoked by uid 0); 20 Jan 2012 00:57:45 -0000\r\nX-Received: from 76.218.213.38 (HELO silverbook.local) (76.218.213.38)\n  by relay03.pair.com with SMTP; 20 Jan 2012 00:57:45 -0000\r\nX-pair-Authenticated: 76.218.213.38\r\nMessage-ID: &lt;4F18BC08.6080409@...&gt;\r\nDate: Thu, 19 Jan 2012 16:57:44 -0800\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:9.0) Gecko/20111222 Thunderbird/9.0.1\r\nMIME-Version: 1.0\r\nTo: David Pane &lt;dpane@...&gt;, archive-crawler@yahoogroups.com\r\nCc: Noah Levitt &lt;nlevitt@...&gt;\r\nReferences: &lt;4F163CA5.9010004@...&gt;\r\nIn-Reply-To: &lt;4F163CA5.9010004@...&gt;\r\nContent-Type: text/plain; charset=windows-1252; format=flowed\r\nContent-Transfer-Encoding: 8bit\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: Configuring ContentLengthDecideRule\r\nX-Yahoo-Group-Post: member; u=137285340; y=qId7Y1RNZQivzgrfrNNTxEcP1IP6wnCtMrvXsXlRaA2D\r\nX-Yahoo-Profile: gojomo\r\n\r\n(FYI, your last separate question revealed a serious bug in scoping \nafter checkpoint resumes, but I&#39;ll handle it in order at the very end.)\n\nRe: ContentLengthDecideRule\n\nSince you only know the length of a resource after the HTTP response has \nbegin, the ContentLengthDecideRule is only usable as a &#39;mid-fetch&#39; rule \nthat&#39;s specific to the FetchHTTP processor. (That is, it&#39;s not mixed in \nwith normal &#39;scoping&#39; rules to decide whether a URI should be enqueued.)\n\nIf you put a set of rules at the mid-fetch point, and they answer \nREJECT, the download will be cut off before downloading the content.\n\nI don&#39;t know of an online example of setting up these rules for H3. \n(There was some prior discussion of the similar rules in H1, though.)\n\nWhen going beyond simple substitution of the settings in the default \nconfiguration (and comments), the key is usually to understand the \nSpring 3 &#39;beans.xml&#39; format, as documented at...\n\nhttp://static.springsource.org/spring/docs/2.5.x/reference/beans.html\n\n...and be able to consult the Heritrix source to find other settable \nproperties, or use other analogues in working CXML as a guide. (For \nexample, the mid-fetch rules would be declared much like the scope \nrules, but inline for FetchHTTP and with just a rule or two.) More \nexample recipes (CXML excerpts) on the wiki are always welcome.\n\nChanges in the crawler-beans.cxml *do* take effect after a checkpoint. \nEssentially, the resumption is a complete rebuild of the crawler \ncomponents from the current state of the crawler-beans.cxml, then a \nnotice to all components to try to recover their state from the checkpoint.\n\nOf course, in the event of major configuration changes, a new component \nmight find no preexisting state, and old state might be ignored if the \ncomponent which saved it to the checkpoint is gone. Our hope was that in \ncases where it is sensible to do so, new components either start fresh, \nor possibly even reuse fields of the same name/purpose from their \nprecursor elements. But, this hasn&#39;t been stressed enough to be \nconfident that goal has been met -- major changes in a crawl&#39;s &quot;shape&quot; \nbetween checkpoints could even require manual fixup of the on-disk \ncheckpoint to get the desired effect.\n\nRe: scope changes dropped into a running crawl via the &#39;action&#39; directory\n\nIt was intended that these be retained through checkpoints but after \nlooking at the code I saw that the module that accumulates the running \nchanges (by noticing new seeds or +/- directives), \nSurtPrefixedDecideRule, does *not* store its state for post-checkpoint \nrecovery.\n\nThis is a bug ï¿½ and it&#39;s even worse than just missing mid-crawl \nrefinements. Any other implied patterns, learned from the original set \nof seeds or +/- directives in the seeds text, will also be forgotten.\n\nOnly SURT-prefixes coming from an explicitly configured &#39;surtsSource&#39; \nare restored after a checkpoint-resume. Note that this file is just \nliteral SURTs, not the +/- syntax that can be used in seeds files.\n\nThis bug is now in the tracking system as:\n\nhttps://webarchive.jira.com/browse/HER-1985\n\nUntil it&#39;s fixed, possible workaround would include:\n\n(1) Always configuring SurtPrefixedDecideRules to use a surtsSource, and \nmaking sure that surtsSource is kept up-to-date as the canonical list of \nprefixes to rule-in (for an +/ACCEPT rule) or rule-out (for a -/REJECT \nrule), before any resumes.\n\n(2) After a checkpoint resume, while crawl is still paused, re-present \nall previously &#39;done&#39; files (including original seed-set/directives) to \n&#39;action&#39; directory for re-learning.\n\n- Gordon\n\n\nOn 1/17/12 7:29 PM, David Pane wrote:\n&gt; I am using Heritrix 3.1.1. After some analysis of the average size of\n&gt; documents that we have been crawling, I would like to configure the\n&gt; crawler (mid-crawl) to begin only downloading documents under a certail\n&gt; size threshold. I am considering a size limit of 3-5MB.\n&gt;\n&gt; I understand that maxLengthBytes in the Http fetcher module can be\n&gt; configure with the maximum length in bytes to fetch. The document, if\n&gt; larger than this, is truncated at this threshold. It seems the\n&gt; ContentLengthDecideRule is more attractive because it can be configured\n&gt; to avoid downloading documents that are larger than a certain threshold.\n&gt;\n&gt; I searched for an example of the syntax to configure this decide rule to\n&gt; no avail. Can someone help me with this? Can I put this someplace near\n&gt; the Transclusion decide rule in the crawler-beans.cxml.\n&gt;\n&gt; Is there an easy way for a Heritrix user to find the correct syntax and\n&gt; options for these options? The default crawler-beans.cxml is useful for\n&gt; many options, but I have found it difficult to understand how to include\n&gt; items that are not already in this file.\n&gt;\n&gt; Due to our server&#39;s network going down tomorrow morning, I will be\n&gt; pausing our 5 instances of Heritrix. I am considering shutting down the\n&gt; crawlers completely and resuming them from the last checkpoint. Will\n&gt; changes in the crawler-beans.cxml take effect when doing this\n&gt; (i.e. configuring the ContentLengthDecideRule)?\n&gt;\n&gt; Additionally, I have been dropping additional bla.seeds files into the\n&gt; action directory when someone asks us to avoid their site. Am I correct\n&gt; that the checkpoint will preserve these opt-out domains?\n&gt;\n&gt;\n\n"}}