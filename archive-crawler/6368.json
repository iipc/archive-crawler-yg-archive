{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"CcTHX-9FQ4NBdhd_oLt5aIN5ZQI2KtASBWU-Bqyv2Y0z2L6sResASgZCBjIDnSvGmDE1ZYyb0gF94S4GMd13onBsvvTevmU","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: [archive-crawler] Re: Heritrix traffic pattern over time","postDate":"1265312362","msgId":6368,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRCNkIyMjZBLjcwNzA0MDhAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDQyRDJGQ0NBLUJEMDktNEUzMC1BMEVDLUM4MjAzRjFGODM2MkBnbWFpbC5jb20+","referencesHeader":"PDRCNjkyNjRFLjYwODA5MDJAYXJjaGl2ZS5vcmc+IDxBQTg2QkVCNC0xMzNCLTQ1OTItQjc2Ri02QzQxQTVGNzNDODhAZ21haWwuY29tPiA8NEI2OUM2OTMuNDA4MDUwM0BhcmNoaXZlLm9yZz4gPEIyNTJEMUMyLUExQUItNEZENi04QjVBLTE0RDJGMEIzMjk2MkBnbWFpbC5jb20+IDw0QjZBMTNCNS40MDUwMjAyQGFyY2hpdmUub3JnPiA8NDJEMkZDQ0EtQkQwOS00RTMwLUEwRUMtQzgyMDNGMUY4MzYyQGdtYWlsLmNvbT4="},"prevInTopic":6367,"nextInTopic":6371,"prevInTime":6367,"nextInTime":6369,"topicId":6359,"numMessagesInTopic":10,"msgSnippet":"FYI, the images did not display for me in this message; a paste of the text would be as useful. Swapping won t be an issue here, but it could still be: - a","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 20198 invoked from network); 4 Feb 2010 19:39:24 -0000\r\nX-Received: from unknown (66.196.94.107)\n  by m4.grp.sp2.yahoo.com with QMQP; 4 Feb 2010 19:39:24 -0000\r\nX-Received: from unknown (HELO relay02.pair.com) (209.68.5.16)\n  by mta3.grp.re1.yahoo.com with SMTP; 4 Feb 2010 19:39:24 -0000\r\nX-Received: (qmail 50906 invoked from network); 4 Feb 2010 19:39:22 -0000\r\nX-Received: from 70.137.148.203 (HELO ?192.168.23.128?) (70.137.148.203)\n  by relay02.pair.com with SMTP; 4 Feb 2010 19:39:22 -0000\r\nX-pair-Authenticated: 70.137.148.203\r\nMessage-ID: &lt;4B6B226A.7070408@...&gt;\r\nDate: Thu, 04 Feb 2010 11:39:22 -0800\r\nUser-Agent: Thunderbird 2.0.0.23 (Windows/20090812)\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;4B69264E.6080902@...&gt; &lt;AA86BEB4-133B-4592-B76F-6C41A5F73C88@...&gt; &lt;4B69C693.4080503@...&gt; &lt;B252D1C2-A1AB-4FD6-8B5A-14D2F0B32962@...&gt; &lt;4B6A13B5.4050202@...&gt; &lt;42D2FCCA-BD09-4E30-A0EC-C8203F1F8362@...&gt;\r\nIn-Reply-To: &lt;42D2FCCA-BD09-4E30-A0EC-C8203F1F8362@...&gt;\r\nContent-Type: text/plain; charset=windows-1252; format=flowed\r\nContent-Transfer-Encoding: 8bit\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] Re: Heritrix traffic pattern over time\r\nX-Yahoo-Group-Post: member; u=137285340; y=9UT4WYm5SP-isFQ2th5f7xSG2LHq8WHz1YiNONtWiIeZ\r\nX-Yahoo-Profile: gojomo\r\n\r\nFYI, the images did not display for me in this message; a paste of the \ntext would be as useful.\n\nSwapping won&#39;t be an issue here, but it could still be:\n\n- a large number of queues trying hosts that don&#39;t respond: the \nspecifics of what queues are in-process, ready, snoozed, inactive -- \nplus their cycle times and any connect-errors in local-errors.log -- \nwill indicate if that&#39;s the case. (How are the queues that are still in \nprogress different from the ones that have finished?) (The threads \nreport can also provide a clue here -- are all the threads working on \nsites that are slow to timeout?)\n\n- if there&#39;s an effective cap on network traffic somewhere downstream. \nYou&#39;d mentioned 4 crawlers all going slow; and separately a 20Mbps \nbandwidth cap. How many machines and applications are sharing that \n20Mbps? Might the reverse direction also be saturated (which can kill \nthroughput)?\n\n- Gordon @ IA\n\n\n\nDerek Pappas wrote:\n&gt; Here is another example on a quad core that started out at 16 URI&#39;s/sec \n&gt; and is down to 8.\n&gt; \n&gt; heap used         : 1.4 GB  \n&gt; heap max/allocated: 1.8 GB \n&gt; RAM               : 8   GB \n&gt; \n&gt; Swapping should not be the cause of this problem.\n&gt; \n&gt; SwapTotal:     2031608 kB\n&gt; SwapFree:      2031468 kB\n&gt; \n&gt; Nothing else is running on this box.\n&gt; \n&gt; This is suspicious.\n&gt; MemTotal:      8177536 kB\n&gt; MemFree:         46192 kB\n&gt; \n&gt; 0.\n&gt; top - 09:16:40 up 35 days, 19:41,  1 user,  load average: 3.25, 3.25, 3.25\n&gt; Tasks: 163 total,   1 running, 162 sleeping,   0 stopped,   0 zombie\n&gt; Cpu(s):  7.2%us,  0.8%sy,  0.0%ni, 66.6%id, 25.1%wa,  0.1%hi,  0.1%si, \n&gt;  0.0%st\n&gt; Mem:   8177536k total,  8078252k used,    99284k free,   165576k buffers\n&gt; Swap:  2031608k total,      140k used,  2031468k free,  4977244k cached\n&gt; \n&gt;   PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND     \n&gt;                                        \n&gt;  2520 root      17   0 2616m 2.1g 9044 S 31.6 27.2  13413:32 java       \n&gt;                                          \n&gt;     1 root      15   0 10352  644  544 S  0.0  0.0   0:16.38 init       \n&gt;                                          \n&gt;     2 root      RT  -5     0    0    0 S  0.0  0.0   0:00.92 migration/0 \n&gt;                                         \n&gt;     3 root      34  19     0    0    0 S  0.0  0.0   0:00.13 ksoftirqd/0 \n&gt;                                         \n&gt;     4 root      RT  -5     0    0    0 S  0.0  0.0   0:00.00 watchdog/0 \n&gt;                                          \n&gt;     5 root      RT  -5     0    0    0 S  0.0  0.0   0:00.51 migration/1 \n&gt; \n&gt; 1. Started with 2mb jvm\n&gt; \n&gt; # cat /etc/*/*heritrix*\n&gt; #!/bin/bash\n&gt; export  JAVA_OPTS=&quot; -Xmx2048m&quot;\n&gt; /opt/heritrix/bin/heritrix --bind=yowb2 --admin=admin:admin\n&gt; \n&gt; 2. RAM is 8MB\n&gt; \n&gt; $ cat /proc/meminfo \n&gt; MemTotal:      8177536 kB\n&gt; MemFree:         46192 kB\n&gt; Buffers:        167312 kB\n&gt; Cached:        5023020 kB\n&gt; SwapCached:          0 kB\n&gt; Active:        4424524 kB\n&gt; Inactive:      3268204 kB\n&gt; HighTotal:           0 kB\n&gt; HighFree:            0 kB\n&gt; LowTotal:      8177536 kB\n&gt; LowFree:         46192 kB\n&gt; SwapTotal:     2031608 kB\n&gt; SwapFree:      2031468 kB\n&gt; Dirty:           16224 kB\n&gt; Writeback:           0 kB\n&gt; AnonPages:     2501356 kB\n&gt; Mapped:          46076 kB\n&gt; Slab:           396104 kB\n&gt; PageTables:      17200 kB\n&gt; NFS_Unstable:        0 kB\n&gt; Bounce:              0 kB\n&gt; CommitLimit:   6120376 kB\n&gt; Committed_AS:  3323316 kB\n&gt; VmallocTotal: 34359738367 kB\n&gt; VmallocUsed:    264244 kB\n&gt; VmallocChunk: 34359473159 kB\n&gt; HugePages_Total:     0\n&gt; HugePages_Free:      0\n&gt; HugePages_Rsvd:      0\n&gt; Hugepagesize:     2048 kB\n&gt; \n&gt; 3. Frontier report\n&gt; Frontier report &lt;http://yowb2:8070/reports/frontier.jsp&gt;\n&gt; 9931 queues: 176 active (50 in-process; 94 ready; 32 snoozed); 870 \n&gt; inactive; 0 retired; 8885 exhausted\n&gt; \n&gt; rontier report - 201002041711\n&gt;  Job being crawled: top_500_internet_retailers\n&gt; \n&gt;  -----===== STATS =====-----\n&gt;  Discovered:    101473107\n&gt;  Queued:        86097051\n&gt;  Finished:      15421818\n&gt;   Successfully: 13249266\n&gt;   Failed:       2861\n&gt;   Disregarded:  2169691\n&gt; \n&gt;  -----===== QUEUES =====-----\n&gt;  Already included size:     101473107\n&gt;                pending:     0\n&gt; \n&gt;  All class queues map size: 9931\n&gt;              Active queues: 176\n&gt;                     In-process: 50\n&gt;                          Ready: 108\n&gt;                        Snoozed: 18\n&gt;            Inactive queues: 870\n&gt;             Retired queues: 0\n&gt;           Exhausted queues: 8885\n&gt; \n&gt; \n&gt; 4. console png&#39;s\n&gt; \n&gt; \n&gt; \n&gt; \n&gt; On Feb 3, 2010, at 4:24 PM, Gordon Mohr wrote:\n&gt; \n&gt;&gt; Derek Pappas wrote:\n&gt;&gt;&gt;&gt; What&#39;s the hardware like?\n&gt;&gt;\n&gt;&gt;&gt; $ cat /proc/meminfo\n&gt;&gt;&gt; MemTotal:      1026792 kB\n&gt;&gt;\n&gt;&gt; Your screenshot reported 1.3GB heap used; 1.8GB heap max/allocated. With\n&gt;&gt; only 1GB RAM, that means lots of swapping, which probably explains the\n&gt;&gt; slowness. Java heap memory usage is very non-local -- essentially by\n&gt;&gt; design of the garbage-collection system -- and so you always want the\n&gt;&gt; heap size to be less than RAM. I would recommend a max-heap setting of\n&gt;&gt; no more than 700MB-800MB on a 1GB machine.\n&gt;&gt;\n&gt;&gt;&gt; ï¿½ Frontier report\n&gt;&gt;&gt; 15179 queues: 191 active (50 in-process; 31 ready; 110 snoozed); 78  \n&gt;&gt;&gt; inactive; 0 retired; 14910 exhausted\n&gt;&gt;\n&gt;&gt; I believe the swapping is enough to explain the slowdown, but this\n&gt;&gt; *might* be slightly suggestive there are a disproportionate number of\n&gt;&gt; queues that are non-responsive. With typical politeness waits that are\n&gt;&gt; 10X or more of the fetch-times, if the queues are all &#39;lively&#39; (fetching\n&gt;&gt; quickly) then the total number of ready+snoozed queues would be larger\n&gt;&gt; than just 1.4 times the number of in-process queues, up to all the\n&gt;&gt; available inactive queues.\n&gt;&gt;\n&gt;&gt; Looking at the full frontier report for queues that are in long\n&gt;&gt; (multi-minute) snoozes, or have odd domain names and have never made any\n&gt;&gt; progress, will be one indication that this is happening. Connect errors\n&gt;&gt; in the &#39;local-errors.log&#39; are another indication.\n&gt;&gt;\n&gt;&gt; When the queues&#39; target hosts aren&#39;t responsive and not expected to\n&gt;&gt; become responsive, it&#39;s just an operator judgment call as to when to\n&gt;&gt; terminate the crawl.\n&gt;&gt;\n&gt;&gt; I think you&#39;ll get much better performance if you restart with a\n&gt;&gt; max-heap (JVM -Xmx) below total RAM.\n&gt;&gt;\n&gt;&gt; - Gordon @ IA\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; ------------------------------------\n&gt;&gt;\n&gt;&gt; Yahoo! Groups Links\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;    archive-crawler-fullfeatured@yahoogroups.com \n&gt;&gt; &lt;mailto:archive-crawler-fullfeatured@yahoogroups.com&gt;\n&gt;&gt;\n&gt;&gt;\n&gt; \n\n"}}