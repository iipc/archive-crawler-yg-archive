{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"LdG3TKgZ4CwjC9C-WwobXVPBXAy8EYxYrATp8JWwv-2Gged_h5YQM96Lb4T3RWRS8PN9YJtbpbgesGnMnBAK5m-EJy5EE5k","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: [archive-crawler] Re: Write a WARC-File with many mets.xml (metadata).","postDate":"1301934491","msgId":7084,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDREOTlGMTlCLjQwNjA2MDJAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGluYm5xbCt0Nmw2QGVHcm91cHMuY29tPg==","referencesHeader":"PGluYm5xbCt0Nmw2QGVHcm91cHMuY29tPg=="},"prevInTopic":7082,"nextInTopic":7086,"prevInTime":7083,"nextInTime":7085,"topicId":7077,"numMessagesInTopic":5,"msgSnippet":"The flow should be roughly: writer = new WARCWriter(...); ... writer.writeMetadataRecord(...); ... writer.writeMetadataRecord(...); ... ","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 95620 invoked from network); 4 Apr 2011 16:28:13 -0000\r\nX-Received: from unknown (98.137.34.45)\n  by m3.grp.sp2.yahoo.com with QMQP; 4 Apr 2011 16:28:13 -0000\r\nX-Received: from unknown (HELO relay03.pair.com) (209.68.5.17)\n  by mta2.grp.sp2.yahoo.com with SMTP; 4 Apr 2011 16:28:13 -0000\r\nX-Received: (qmail 56236 invoked by uid 0); 4 Apr 2011 16:28:11 -0000\r\nX-Received: from 76.218.213.38 (HELO silverbook.local) (76.218.213.38)\n  by relay03.pair.com with SMTP; 4 Apr 2011 16:28:11 -0000\r\nX-pair-Authenticated: 76.218.213.38\r\nMessage-ID: &lt;4D99F19B.4060602@...&gt;\r\nDate: Mon, 04 Apr 2011 09:28:11 -0700\r\nUser-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.15) Gecko/20110303 Thunderbird/3.1.9\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: virginie &lt;mbakom@...&gt;\r\nReferences: &lt;inbnql+t6l6@...&gt;\r\nIn-Reply-To: &lt;inbnql+t6l6@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] Re: Write a WARC-File with many mets.xml (metadata).\r\nX-Yahoo-Group-Post: member; u=137285340; y=0oI41SCHoit0pXO9u9gkkQAIatGmSgz0r4bsBSx4DfCq\r\nX-Yahoo-Profile: gojomo\r\n\r\nThe flow should be roughly:\n\nwriter = new WARCWriter(...);\n...\nwriter.writeMetadataRecord(...);\n...\nwriter.writeMetadataRecord(...);\n...\nwriter.writeMetadataRecord(...);\n...\nwriter.close();\n\nAre you saying that when you do this, you are getting 3 WARC files?\n\nIf so, can you place a breakpoint (or (new \nException()).prinstStackTrace()) inside WARCWriter.createFile(), and \nreport what&#39;s causing that method to be reached when the second WARC \nfile is created?\n\n- Gordon @ IA\n\nOn 4/3/11 11:17 PM, virginie wrote:\n&gt; Hi Gordon,\n&gt;\n&gt; Thanks for your reply.\n&gt; yes I am using the same code from Heritrix. Notably I Create a WARC Writer like that : WARCWriter writer = new WARCWriter (aint,dirs,prefix,suffix,compressed,WARCReader.DEFAULT_MAX_WARC_FILE_SIZE,metadata); and so I call the method writer.writeMetadataRecord(java.lang.String url,\n&gt;                                  java.lang.String create14DigitDate,\n&gt;                                  java.lang.String mimetype,\n&gt;                                  java.net.URI recordId,\n&gt;                                  ANVLRecord namedFields,\n&gt;                                  java.io.InputStream metadata,\n&gt;                                  long metadataLength);\n&gt; once only and by the java.io.InputStream metadata,I put a\n&gt; new FileInputStream(mets[j]), so all mets files are store into (mets[j].\n&gt; so I would like to build a WARC-file with all this(mets[j])file.\n&gt;\n&gt; Cheers!\n&gt; Virginie\n&gt;\n&gt; --- In archive-crawler@yahoogroups.com, Gordon Mohr&lt;gojomo@...&gt;  wrote:\n&gt;&gt;\n&gt;&gt; Is this in the context of an extension to Heritrix or using the same\n&gt;&gt; code elsewhere?\n&gt;&gt;\n&gt;&gt; It might be tricky to reuse the WARCWriter code elsewhere, given its\n&gt;&gt; assumptions that it will be handed CrawlURI instances as prefilled by\n&gt;&gt; Heritrix, but should still be possible. Notably, the\n&gt;&gt; WARCWriter.writeMetadataRecord() method assumes it will write a set of\n&gt;&gt; &#39;ANVLRecord&#39; fields (an internal class representing a simple fielded set\n&gt;&gt; of metadata) rather than any of the other arbitrary kinds of metadata\n&gt;&gt; that would also be legal by the WARC spec.\n&gt;&gt;\n&gt;&gt; Are you calling the &quot;new WARCWriter()&quot; code each time, or reusing one\n&gt;&gt; &#39;writer&#39; instance for each call to writeMetadataRecord()? (The\n&gt;&gt; instantiation of a new WARCWriter always starts a new file, never\n&gt;&gt; appending to an existing file.)\n&gt;&gt;\n&gt;&gt; If you are already reusing a single &#39;writer&#39; properly, perhaps something\n&gt;&gt; else about your use pattern is triggering the automatic rollover to a\n&gt;&gt; new file that usually happens only when the max-size is exceeded. I\n&gt;&gt; would set a breakpoint or other debugging output at WARCWriter&#39;s\n&gt;&gt; createFile method(s), and see what is triggering a new file rather than\n&gt;&gt; the reuse of the first file.\n&gt;&gt;\n&gt;&gt; Hope this helps,\n&gt;&gt;\n&gt;&gt; - Gordon @ IA\n&gt;&gt;\n&gt;&gt; On 4/1/11 5:31 AM, virginie wrote:\n&gt;&gt;&gt; Hi All,\n&gt;&gt;&gt;\n&gt;&gt;&gt; I would like to write many mets.xml file in one WARC File, but without success.\n&gt;&gt;&gt; At the moment when I write with\n&gt;&gt;&gt; WARCWriter writer = new WARCWriter (aint,dirs,prefix, suffix,compressed,WARCReader.DEFAULT_MAX_WARC_FILE_SIZE,metadata);\n&gt;&gt;&gt; And later\n&gt;&gt;&gt; writer.writeMetadataRecord(.-------)\n&gt;&gt;&gt; I receive per mets.xml file one WARC file but I would like to store all the mets.xml in the one whole WARC-File.\n&gt;&gt;&gt; Any idea why?\n&gt;&gt;&gt; How can I do it?\n&gt;&gt;&gt; Cheers\n&gt;&gt;&gt; Virginie\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; ------------------------------------\n&gt;&gt;&gt;\n&gt;&gt;&gt; Yahoo! Groups Links\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}