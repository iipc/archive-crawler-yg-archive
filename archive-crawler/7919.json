{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"QUxt_jk06z6ZOB4T-S0WmxCi9a8bNRdrWMPDUgWfkmhAPPffGcxFFH3a3z-KoWzyn6b6UsWJzrqV-ZefvUzLax8215e6fm4","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: [archive-crawler] Usage of QuotaEnforcer [1 Attachment]","postDate":"1358407068","msgId":7919,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDUwRjdBNTlDLjgwODA5MDNAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDFBMTJBOUM1MTBBMTI0NEQ4MERDNDYzMEU3OTVCODU1MTdBRkMzQkRAbWFpbHN0b3JlMS5hcHB0dXMubG9jYWw+","referencesHeader":"PDFBMTJBOUM1MTBBMTI0NEQ4MERDNDYzMEU3OTVCODU1MTdBRkJGNjhAbWFpbHN0b3JlMS5hcHB0dXMubG9jYWw+IDw1MEVGMEI5Mi43MDkwNDAyQGFyY2hpdmUub3JnPiA8MUExMkE5QzUxMEExMjQ0RDgwREM0NjMwRTc5NUI4NTUxN0FGQzNCREBtYWlsc3RvcmUxLmFwcHR1cy5sb2NhbD4="},"prevInTopic":7916,"nextInTopic":7920,"prevInTime":7918,"nextInTime":7920,"topicId":7900,"numMessagesInTopic":7,"msgSnippet":"Are you sure the seeds that are NOTCRAWLED are valid, responding URIs? From your screenshot, 200 threads in a 800MB heap might be a bit much, though without","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 55769 invoked from network); 17 Jan 2013 07:17:57 -0000\r\nX-Received: from unknown (10.193.84.131)\n  by m12.grp.bf1.yahoo.com with QMQP; 17 Jan 2013 07:17:57 -0000\r\nX-Received: from unknown (HELO relay01.pair.com) (209.68.5.15)\n  by mta4.grp.bf1.yahoo.com with SMTP; 17 Jan 2013 07:17:56 -0000\r\nX-Received: (qmail 29809 invoked by uid 0); 17 Jan 2013 07:17:49 -0000\r\nX-Received: from 70.36.143.102 (HELO silverbook.local) (70.36.143.102)\n  by relay01.pair.com with SMTP; 17 Jan 2013 07:17:49 -0000\r\nX-pair-Authenticated: 70.36.143.102\r\nMessage-ID: &lt;50F7A59C.8080903@...&gt;\r\nDate: Wed, 16 Jan 2013 23:17:48 -0800\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:17.0) Gecko/20130107 Thunderbird/17.0.2\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: Henrik Ranthin &lt;Henrik.Ranthin@...&gt;\r\nReferences: &lt;1A12A9C510A1244D80DC4630E795B85517AFBF68@...&gt; &lt;50EF0B92.7090402@...&gt; &lt;1A12A9C510A1244D80DC4630E795B85517AFC3BD@...&gt;\r\nIn-Reply-To: &lt;1A12A9C510A1244D80DC4630E795B85517AFC3BD@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] Usage of QuotaEnforcer [1 Attachment]\r\nX-Yahoo-Group-Post: member; u=137285340; y=gQ0E-DCSGUoxKz7nuMHQFAGpb_p39zhE3yHZdTUiq0Xz\r\nX-Yahoo-Profile: gojomo\r\n\r\nAre you sure the seeds that are NOTCRAWLED are valid, responding URIs?\n\n From your screenshot, 200 threads in a 800MB heap might be a bit much, \nthough without other errors/alerts, that&#39;s probably not the problem \nyou&#39;re hitting.\n\nI notice that in the screenshot, the largest number of queues (24,730) \nare in the &#39;RETIRED&#39; state. That indicates that they&#39;ve hit a limit for \ncrawling, either the queueTotalBudget or something that the \nQuotaEnforcer saw and used the &#39;force-retire&#39; option to enforce.\n\nDid you change any of the other &#39;budget&#39;-related settings?\n\nAlso, your crawl-report shows over 24K &#39;URI failures&#39;. These may appear \nin the crawl-log with a status code; do they? What&#39;s a representative \nline for a seed that you expect would be collected but isn&#39;t?\n\n- Gordon\n\nOn 1/16/13 1:04 AM, Henrik Ranthin wrote:\n&gt; Hi!\n&gt;\n&gt; The status is set to NONCRAWLED in the seeds report.\n&gt;\n&gt; I tried to run the job again and after a while it seems like the threads are starving. The crawling runs fast in the beginning and after a while it&#39;s just getting slower and slower until it finally stops.\n&gt;  From the job page in the Heritrix UI:\n&gt; 200 threads: 200 ABOUT_TO_GET_URI; 200 noActiveProcessor\n&gt;\n&gt; I also attached a screenshot of the job page.\n&gt;\n&gt; I checked the logs and reports and in the uri-errors.log and I have about 700 items similar to the line below but with different uri:\n&gt; 2013-01-11T12:03:49.728Z http://ablemove.net/ &quot;http scheme specific part is too short: //&quot; http://\n&gt; But I don&#39;t know if that could contribute?\n&gt;\n&gt;  From crawl-report.log:\n&gt; #######################################################\n&gt; crawl name: basic\n&gt; crawl status: Finished\n&gt; duration: 7h15m20s364ms\n&gt;\n&gt; seeds crawled: 235\n&gt; seeds uncrawled: 23946\n&gt;\n&gt; hosts visited: 24828\n&gt;\n&gt; URIs processed: 40636\n&gt; URI successes: 14043\n&gt; URI failures: 24734\n&gt; URI disregards: 1859\n&gt;\n&gt; novel URIs: 14043\n&gt;\n&gt; total crawled bytes: 764213072 (729 MiB)\n&gt; novel crawled bytes: 764213072 (729 MiB)\n&gt;\n&gt; URIs/sec: 0.54\n&gt; KB/sec: 28\n&gt; #######################################################\n&gt;\n&gt;\n&gt; Regards,\n&gt; Henrik\n&gt;\n&gt;\n&gt;\n&gt; -----Original Message-----\n&gt; From: archive-crawler@yahoogroups.com [mailto:archive-crawler@yahoogroups.com] On Behalf Of Noah Levitt\n&gt; Sent: den 10 januari 2013 19:42\n&gt; To: archive-crawler@yahoogroups.com\n&gt; Cc: Henrik Ranthin\n&gt; Subject: Re: [archive-crawler] Usage of QuotaEnforcer\n&gt;\n&gt; Hello Henrik,\n&gt;\n&gt; In my brief test, QuotaEnforcer configured as you describe worked fine for me and didn&#39;t prevent any seeds from being crawled. Maybe some other part of your configuration is responsible? What&#39;s the fetch status in the seeds report of the uncrawled seeds? Anything else in the logs?\n&gt;\n&gt; Noah\n&gt;\n&gt; On 2013-01-09 01:57 , Henrik Ranthin wrote:\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; Hi!\n&gt;&gt;\n&gt;&gt; I want to limit the number of documents per site and I tried using the QuotaEnforcer to do so (I&#39;m using Heritrix 3.1.1).\n&gt;&gt;\n&gt;&gt; At first it seemed to work and in the hosts report it looks like that the correct number of documents has been crawled for each host.\n&gt;&gt;\n&gt;&gt; However, when I checked the status a few hours later the job had finished and most of the seeds had not been crawled.\n&gt;&gt;\n&gt;&gt;   From the job log:\n&gt;&gt;\n&gt;&gt; 2013-01-08T20:38:06.740Z INFO FINISHED 20130108131240\n&gt;&gt;\n&gt;&gt; 2013-01-08T20:38:04.739Z INFO EMPTY 20130108131240\n&gt;&gt;\n&gt;&gt; 2013-01-08T20:38:04.739Z INFO STOPPING 20130108131240\n&gt;&gt;\n&gt;&gt; 2013-01-08T13:12:58.056Z INFO RUNNING 20130108131240\n&gt;&gt;\n&gt;&gt; Am I using the correct configuration for QuotaEnforcer? And is this the prescribed way to limit the number of documents per site?\n&gt;&gt;\n&gt;&gt; Below is the configuration I changed for QuotaEnforcer (other configuration is just default):\n&gt;&gt;\n&gt;&gt; &lt;bean id=&quot;quotaEnforcer&quot; class=&quot;org.archive.crawler.prefetch.QuotaEnforcer&quot;&gt;\n&gt;&gt;\n&gt;&gt;     &lt;property name=&quot;enabled&quot; value=&quot;true&quot;/&gt;\n&gt;&gt;\n&gt;&gt;     &lt;property name=&quot;hostMaxFetchSuccesses&quot; value=&quot;100&quot;/&gt;\n&gt;&gt;\n&gt;&gt; &lt;/bean&gt;\n&gt;&gt;\n&gt;&gt; &lt;bean id=&quot;fetchProcessors&quot; class=&quot;org.archive.modules.FetchChain&quot;&gt;\n&gt;&gt;\n&gt;&gt;     &lt;property name=&quot;processors&quot;&gt;\n&gt;&gt;\n&gt;&gt;      &lt;list&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;preselector&quot;/&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;quotaEnforcer&quot;/&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;preconditions&quot;/&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;fetchDns&quot;/&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;fetchHttp&quot;/&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;extractorHttp&quot;/&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;extractorHtml&quot;/&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;extractorCss&quot;/&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;extractorJs&quot;/&gt;\n&gt;&gt;\n&gt;&gt;       &lt;ref bean=&quot;extractorSwf&quot;/&gt;\n&gt;&gt;\n&gt;&gt;      &lt;/list&gt;\n&gt;&gt;\n&gt;&gt;     &lt;/property&gt;\n&gt;&gt;\n&gt;&gt; &lt;/bean&gt;\n&gt;&gt;\n&gt;&gt; Regards,\n&gt;&gt;\n&gt;&gt; Henrik\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}