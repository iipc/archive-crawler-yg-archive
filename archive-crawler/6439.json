{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":354174125,"authorName":"matthewyau12","from":"&quot;matthewyau12&quot; &lt;matthewyau12@...&gt;","profile":"matthewyau12","replyTo":"LIST","senderId":"FyDScEGPU6AnugP07IPxCG5bJCjKdfbSb_O8oH6TF7W0j799rH3522giai0rf3lCsHcIhkOxpTtn5ibKvah0X7bDEniGRY3ZwiLJTAkmfLA6","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: inserting content information into a mysql database","postDate":"1268929854","msgId":6439,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGhudGtmdStrNWxpQGVHcm91cHMuY29tPg==","inReplyToHeader":"PGhucXZibytmbWE4QGVHcm91cHMuY29tPg=="},"prevInTopic":6437,"nextInTopic":0,"prevInTime":6438,"nextInTime":6440,"topicId":6437,"numMessagesInTopic":2,"msgSnippet":"fixed, thx","rawEmail":"Return-Path: &lt;matthewyau12@...&gt;\r\nX-Sender: matthewyau12@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 93814 invoked from network); 18 Mar 2010 16:38:21 -0000\r\nX-Received: from unknown (98.137.34.46)\n  by m13.grp.re1.yahoo.com with QMQP; 18 Mar 2010 16:38:21 -0000\r\nX-Received: from unknown (HELO n39b.bullet.mail.sp1.yahoo.com) (66.163.168.153)\n  by mta3.grp.sp2.yahoo.com with SMTP; 18 Mar 2010 16:38:21 -0000\r\nX-Received: from [69.147.65.150] by n39.bullet.mail.sp1.yahoo.com with NNFMP; 18 Mar 2010 16:30:57 -0000\r\nX-Received: from [98.137.34.34] by t7.bullet.mail.sp1.yahoo.com with NNFMP; 18 Mar 2010 16:30:57 -0000\r\nDate: Thu, 18 Mar 2010 16:30:54 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;hntkfu+k5li@...&gt;\r\nIn-Reply-To: &lt;hnqvbo+fma8@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: &quot;matthewyau12&quot; &lt;matthewyau12@...&gt;\r\nSubject: Re: inserting content information into a mysql database\r\nX-Yahoo-Group-Post: member; u=354174125; y=-Z8m2xYeA9JB-5CFrjElj3o0tYe30BtFWzbiLOyYdcBLn3sSIiYE\r\nX-Yahoo-Profile: matthewyau12\r\n\r\nfixed, thx\n\n--- In archive-crawler@yahoogroups.com, &quot;matthewyau12&quot; &lt;matthew=\r\nyau12@...&gt; wrote:\n&gt;\n&gt; hi,\n&gt; \n&gt; I am trying to do something similar with you=\r\nr work and inserting content information into a mysql database. I am able t=\r\no see the JDBC setting in user interface. However, I can not insert the con=\r\ntent into database, and I have placed the mysql-connector-java-5.0.8-bin.ja=\r\nr to the library in &#92;heritrix-1.14.3&#92;lib. I can not find any error message =\r\nin the heritrix windows but some warning message (org.arhive.rawler.setting=\r\ns.CrawlerSettingsSAXHandler$SimpleElementHandler endElement Unknown attribu=\r\nte &#39;com.mysql.jdbc.Driver&#39; in file:../order.xml&#39; line: 234, column: 76\n&gt; \n&gt;=\r\n Attached please find a java file.\n&gt; \n&gt; Thx\n&gt; Mat\n&gt; \n&gt; package org.archive.=\r\ncrawler.writer;\n&gt; \n&gt; import org.archive.crawler.datamodel.CoreAttributeCons=\r\ntants;\n&gt; import org.archive.crawler.datamodel.CrawlURI;\n&gt; import org.archiv=\r\ne.crawler.framework.Processor;\n&gt; import org.archive.crawler.settings.Simple=\r\nType;\n&gt; import org.archive.io.RecordingInputStream;\n&gt; import org.archive.io=\r\n.ReplayInputStream;\n&gt; import org.archive.net.UURI;\n&gt; \n&gt; \n&gt; \n&gt; import java.i=\r\no.ByteArrayOutputStream;\n&gt; import java.io.IOException;\n&gt; import java.sql.*;=\r\n\n&gt; import java.util.logging.Logger ;\n&gt; import javax.management.AttributeNot=\r\nFoundException;\n&gt; \n&gt; /**\n&gt; * Processor module that writes the results of su=\r\nccessful fetches to\n&gt; * Database via JDBC.\n&gt; */\n&gt; public class JDBCWriterPr=\r\nocessor \n&gt; extends Processor implements CoreAttributeConstants {\n&gt; \n&gt; priva=\r\nte static final long serialVersionUID =3D 111407556238389168L;\n&gt; \n&gt; /**\n&gt; *=\r\n Key to use asking settings for JDBC driver.\n&gt; */\n&gt; public static final Str=\r\ning ATTR_JDBC_DRIVER =3D &quot;com.mysql.jdbc.Driver&quot;;\n&gt; \n&gt; /**\n&gt; * Key to use a=\r\nsking settings for JDBC URL.\n&gt; */\n&gt; public static final String ATTR_JDBC_UR=\r\nL =3D &quot;jdbc:mysql://localhost/&quot;;\n&gt; \n&gt; // Key to use asking database name\n&gt; =\r\npublic static final String ATTR_JDBC_DBNAME =3D &quot;northwind&quot;;\n&gt; \n&gt; // Key to=\r\n use asking table name\n&gt; public static final String ATTR_JDBC_TBNAME =3D &quot;t=\r\nesting&quot;;\n&gt; \n&gt; /**\n&gt; * Key to use asking settings for username.\n&gt; */\n&gt; publi=\r\nc static final String ATTR_JDBC_USERNAME =3D &quot;root&quot;;\n&gt; \n&gt; /**\n&gt; * Key to us=\r\ne asking settings for passwd.\n&gt; */\n&gt; public static final String ATTR_JDBC_P=\r\nASSWD =3D &quot;zxc&quot;;\n&gt; \n&gt; /**\n&gt; * Logger.\n&gt; */\n&gt; private static final Logger lo=\r\ngger =3D\n&gt; Logger.getLogger(JDBCWriterProcessor.class.getName());\n&gt; \n&gt; /**\n=\r\n&gt; * @param name Name of this processor.\n&gt; */\n&gt; public JDBCWriterProcessor(S=\r\ntring name) {\n&gt; //for adding attributes to heritrix processor, appears in W=\r\nebUI&#92;\n&gt; //be sure to define variables in the format up above first.\n&gt; super=\r\n(name, &quot;JDBCWriter processor. &quot; +\n&gt; &quot;A writer that writes each URL to datab=\r\nase via jdbc &quot;);\n&gt; addElementToDefinition(new SimpleType(ATTR_JDBC_DRIVER,\n=\r\n&gt; &quot;jdbc driver name&quot;, &quot;com.mysql.jdbc.Driver&quot;));\n&gt; addElementToDefinition(n=\r\new SimpleType(ATTR_JDBC_URL,\n&gt; &quot;jdbc url in this form:jdbc:databasetype://U=\r\nRL_to_db:port/&quot;, &quot;&quot;));\n&gt; //the last / is necessary after port b/c the full =\r\nURL of a jdbc is\n&gt; //jdbc:databasetype://URL_to_db:port/db_name\n&gt; addElemen=\r\ntToDefinition(new SimpleType(ATTR_JDBC_DBNAME,\n&gt; &quot;database name&quot;, &quot;&quot;));\n&gt; a=\r\nddElementToDefinition(new SimpleType(ATTR_JDBC_TBNAME,\n&gt; &quot;table name&quot;, &quot;&quot;))=\r\n;\n&gt; addElementToDefinition(new SimpleType(ATTR_JDBC_USERNAME,\n&gt; &quot;username&quot;,=\r\n &quot;&quot;));\n&gt; addElementToDefinition(new SimpleType(ATTR_JDBC_PASSWD,\n&gt; &quot;passwor=\r\nd&quot;, &quot;&quot;));\n&gt; }\n&gt; \n&gt; protected void innerProcess(CrawlURI curi) {\n&gt; if (!curi=\r\n.isSuccess()) {\n&gt; return;\n&gt; }\n&gt; UURI uuri =3D curi.getUURI(); // Current UR=\r\nI.\n&gt; \n&gt; // Only http and https schemes are supported.\n&gt; String scheme =3D u=\r\nuri.getScheme();\n&gt; if (!&quot;http&quot;.equalsIgnoreCase(scheme)\n&gt; && !&quot;https&quot;.equal=\r\nsIgnoreCase(scheme)) {\n&gt; return;\n&gt; }\n&gt; \n&gt; //Only xml file will store in dat=\r\nabase, change this expression to accept different content types\n&gt; String co=\r\nntenttype =3D curi.getContentType();\n&gt; if (null =3D=3D contenttype ||\n&gt; !&quot;a=\r\npplication/xml&quot;.equalsIgnoreCase(contenttype)) {\n&gt; return;\n&gt; }\n&gt; \n&gt; Recordi=\r\nngInputStream recis =3D\n&gt; curi.getHttpRecorder().getRecordedInput();\n&gt; if (=\r\n0L =3D=3D recis.getResponseContentLength()) {\n&gt; return;\n&gt; }\n&gt; \n&gt; try {\n&gt; wr=\r\niteToDatabase(curi); //calls the function write to database\n&gt; } catch (IOEx=\r\nception e) {\n&gt; logger.warning(e.getLocalizedMessage());\n&gt; }\n&gt; }\n&gt; \n&gt; /**\n&gt; =\r\n* write into database\n&gt; *\n&gt; * @param curi the curi that recorded the conten=\r\nts\n&gt; * of the resource\n&gt; * @throws java.io.IOException when something error=\r\n;\n&gt; */\n&gt; private void writeToDatabase(CrawlURI curi) throws IOException {\n&gt;=\r\n ReplayInputStream replayis =3D\n&gt; curi.getHttpRecorder().getRecordedInput()=\r\n.getContentReplayInputStream();\n&gt; ByteArrayOutputStream sContent =3D new By=\r\nteArrayOutputStream();\n&gt; \n&gt; try {\n&gt; replayis.readContentTo(sContent);\n&gt; } f=\r\ninally {\n&gt; replayis.close();\n&gt; }\n&gt; \n&gt; Connection conn =3D null;\n&gt; PreparedS=\r\ntatement stmt =3D null;\n&gt; //calls a function getAttrValue to set each varia=\r\nble from webUI settings\n&gt; String driver =3D getAttrValue(ATTR_JDBC_DRIVER);=\r\n\n&gt; String URL =3D getAttrValue(ATTR_JDBC_URL);\n&gt; String db =3D getAttrValue=\r\n(ATTR_JDBC_DBNAME);\n&gt; String table =3D getAttrValue(ATTR_JDBC_TBNAME);\n&gt; St=\r\nring user =3D getAttrValue(ATTR_JDBC_USERNAME);\n&gt; String pass =3D getAttrVa=\r\nlue(ATTR_JDBC_PASSWD);\n&gt; \n&gt; System.out.println(driver+&quot; &quot;+URL+&quot; &quot;+db+&quot; &quot;+ta=\r\nble+&quot; &quot;+user+&quot; &quot;+pass);\n&gt; try {// ERROR OCCURS HERE DUE TO INABILITY TO SEE=\r\n THE DRIVER\n&gt; Class.forName(driver); //loads the JDBC driver.\n&gt; } catch (Ex=\r\nception e) {\n&gt; //handle error\n&gt; System.out.println(&quot;Failed to load JDBC Dri=\r\nver.&quot;);\n&gt; logger.warning(e.getLocalizedMessage());\n&gt; }\n&gt; try {\n&gt; conn =3D D=\r\nriverManager.getConnection(URL+db,user,pass);\n&gt; //insert into table section=\r\n, change if column names are\n&gt; //different\n&gt; //Note this assumes you alread=\r\ny made the table with these columns\n&gt; \n&gt; stmt =3D conn.prepareStatement(&quot;IN=\r\nSERT INTO&quot;+table+&quot;(site,url,content,creation_date) VALUES(?,?,?,NOW())&quot;);\n&gt;=\r\n stmt.setString(1, curi.getUURI().getHost()); //contains host\n&gt; //address\n&gt;=\r\n stmt.setString(2, curi.getUURI().getURI()); //contains\n&gt; //URL of content\n=\r\n&gt; stmt.setString(3, sContent.toString()); //contains actual\n&gt; //content of =\r\nthe page\n&gt; stmt.executeUpdate();\n&gt; stmt.close();\n&gt; conn.close();\n&gt; } catch =\r\n(SQLException ex) {\n&gt; logger.warning(curi.getUURI().getURI() + &quot;--&gt;&quot; +\n&gt; ex=\r\n.getLocalizedMessage());\n&gt; System.out.println(&quot;SQLException: &quot; + ex.getMess=\r\nage());\n&gt; System.out.println(&quot;SQLState: &quot; + ex.getSQLState());\n&gt; System.out=\r\n.println(&quot;VendorError: &quot; + ex.getErrorCode());\n&gt; } finally {\n&gt; /*\n&gt; * close=\r\n any jdbc instances here that weren&#39;t\n&gt; * explicitly closed during normal c=\r\node path, so\n&gt; * that we don&#39;t &#39;leak&#39; resources...\n&gt; */\n&gt; if (stmt !=3D nul=\r\nl) {\n&gt; try {\n&gt; stmt.close();\n&gt; } catch (SQLException sqlex) {\n&gt; // ignore -=\r\n- as we can&#39;t do anything about it here\n&gt; }\n&gt; stmt =3D null;\n&gt; }\n&gt; if (conn=\r\n !=3D null) {\n&gt; try {\n&gt; conn.close();\n&gt; } catch (SQLException sqlex) {\n&gt; //=\r\n ignore -- as we can&#39;t do anything about it here\n&gt; }\n&gt; conn =3D null;\n&gt; }\n&gt;=\r\n }\n&gt; } //function writeToDB ends\n&gt; \n&gt; public String getAttrValue(String set=\r\ntingvalue) {\n&gt; //function gets and sets the attribute values entered in web=\r\nUI,\n&gt; //other similar functions with different return types can be used\n&gt; /=\r\n/if needed.\n&gt; String varname =3D null;\n&gt; try {\n&gt; varname =3D ((String) getA=\r\nttribute(settingvalue));\n&gt; } catch (AttributeNotFoundException e) {\n&gt; logge=\r\nr.warning(e.getLocalizedMessage());\n&gt; } finally { return varname; }\n&gt; }\n&gt; }=\r\n// end of class\n&gt;\n\n\n\n"}}