{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr (Internet Archive)","from":"&quot;Gordon Mohr (Internet Archive)&quot; &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"tqJp9GK49GJyC8tWrNSP_9CQtAl6Q5Ed1EWHQVSQgiQCE60up5P5KLjWhpWAOir1dcblNvDIb-hlxt4LyB1bBRhPqr_5eYHa5386ci18fwy_ai78a6RE6XnpcLU","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Problem about link hops","postDate":"1089927589","msgId":655,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQwRjZGOUE1LjgwNDAyMDJAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDQwRjZERTVFLjMwOTA4MDhAYXJjaGl2ZS5vcmc+","referencesHeader":"PDQwRjZEMUQ0LjUwNTA0MDdAYXJjaGl2ZS5vcmc+IDw0MEY2REU1RS4zMDkwODA4QGFyY2hpdmUub3JnPg=="},"prevInTopic":654,"nextInTopic":0,"prevInTime":654,"nextInTime":656,"topicId":621,"numMessagesInTopic":10,"msgSnippet":"There is a preexisting RFE for the ability to abort fetches after the headers are received, but before the content-body. [ 941072 ] Allow operator-configured","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 88946 invoked from network); 15 Jul 2004 21:41:06 -0000\r\nReceived: from unknown (66.218.66.217)\n  by m25.grp.scd.yahoo.com with QMQP; 15 Jul 2004 21:41:06 -0000\r\nReceived: from unknown (HELO ia00524.archive.org) (209.237.232.202)\n  by mta2.grp.scd.yahoo.com with SMTP; 15 Jul 2004 21:41:01 -0000\r\nReceived: (qmail 15312 invoked by uid 100); 15 Jul 2004 21:30:51 -0000\r\nReceived: from b116-dyn-52.archive.org (HELO ?209.237.240.52?) (gojomo@...@209.237.240.52)\n  by mail-dev.archive.org with SMTP; 15 Jul 2004 21:30:51 -0000\r\nMessage-ID: &lt;40F6F9A5.8040202@...&gt;\r\nDate: Thu, 15 Jul 2004 14:39:49 -0700\r\nUser-Agent: Mozilla Thunderbird 0.6 (X11/20040502)\r\nX-Accept-Language: en-us, en\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;40F6D1D4.5050407@...&gt; &lt;40F6DE5E.3090808@...&gt;\r\nIn-Reply-To: &lt;40F6DE5E.3090808@...&gt;\r\nContent-Type: text/plain; charset=GB2312\r\nContent-Transfer-Encoding: 8bit\r\nX-Spam-DCC: : \r\nX-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on ia00524.archive.org\r\nX-Spam-Level: \r\nX-Spam-Status: No, hits=0.0 required=6.0 tests=AWL autolearn=ham version=2.63\r\nX-eGroups-Remote-IP: 209.237.232.202\r\nFrom: &quot;Gordon Mohr (Internet Archive)&quot; &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] Problem about link hops\r\nX-Yahoo-Group-Post: member; u=137285340\r\nX-Yahoo-Profile: gojomo\r\n\r\nThere is a preexisting RFE for the ability to abort fetches\nafter the headers are received, but before the content-body.\n\n  [ 941072 ] Allow operator-configured mid-HTTP-fetch filters\n  http://sourceforge.net/tracker/index.php?func=detail&aid=941072&group_id=73833&atid=539102\n\nIt shouldn&#39;t be that hard to add, but isn&#39;t currently a priority,\nso anyone who needs it is encouraged to implement it themselves and\nsubmit a patch for official inclusion.\n\nIn the meantime, you could set up a filter on either FetchHTTP or\nARCWriterProcessor based on URI pattern that leaves out all items\nthat are unlikely to be of interest, for example those ending\nwith .gif/.jpeg/.jpg/etc.\n\n- Gordon @ IA\n\nstack wrote:\n&gt; Igor pointed out my misreading of the question.\n&gt; \n&gt; The question I answered was, &quot;Would it be worth developing a filter for\n&gt; the ARCWriterProcessor so only blessed content types made it into the\n&gt; archive.&quot;\n&gt; \n&gt; Rather, the question asks about developing a filter that somehow, before\n&gt; we made the request (or mid-request), makes a ruling on whether the HTTP\n&gt; GET should proceed. There&#39;s no attachment point for such a filter in the\n&gt; current processing model. To allow for such an attachment point, we\n&gt; would need to do something like insert into our HTTP Fetcher a HTTP HEAD\n&gt; request, examine the HTTP HEAD return, and if it passes the proposed\n&gt; filter test, only then go ahead and HTTP GET.\n&gt; \n&gt; Our general thinking on such a model is that the HTTP HEAD, in the\n&gt; scheme of things, is probably just as expensive as a HTTP GET so little\n&gt; point in first doing a HTTP HEAD request. We should probably add this\n&gt; facility at some stage, but until we do, it won&#39;t be possible to write\n&gt; such as the suggested filter.\n&gt; \n&gt; Is this what you were thinking Ansi?\n&gt; \n&gt; Yours,\n&gt; St.Ack\n&gt; \n&gt; \n&gt; \n&gt; stack wrote:\n&gt; \n&gt; \n&gt;&gt;zhousp wrote:\n&gt;&gt;\n&gt;&gt; \n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt;Is it suitable to developea  filter to check the HTTP Header before download the whole page?\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;   \n&gt;&gt;&gt;\n&gt;&gt;\n&gt;&gt;This sounds like a useful addition. Look at how other filters are done.\n&gt;&gt;I&#39;d imagine your&#39;s would be called something like MimetypeFilter. Using\n&gt;&gt;the UI, it&#39;d then be possible to add the filter to write-processors.\n&gt;&gt;St.Ack\n&gt;&gt;\n&gt;&gt; \n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt;\t\n&gt;&gt;&gt;\n&gt;&gt;&gt;======= 2004-07-15 00:44:33 ��=======\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;   \n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;zhousp wrote:\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;  \n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;     \n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;hi,Tom Emerson,\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;thanks for your advice.\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;It seems if I just want the HTML pages,there is only one way to check the \n&gt;&gt;&gt;&gt;&gt;response HTTP Header,if there is &quot;Content-Type: text/html&quot;\t,then save it \n&gt;&gt;&gt;&gt;&gt;to ARC file ,else ,discard it.\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;    \n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;       \n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;To implement the above, you probably need to make a new\n&gt;&gt;&gt;&gt;ARCWriterProcessor that overrides ARCWriterProcessor#writeHttp. Your\n&gt;&gt;&gt;&gt;version would ask the passed CrawlURI for its content type --\n&gt;&gt;&gt;&gt;CrawlURI#getContentType -- and then if not text/html, you&#39;d return\n&gt;&gt;&gt;&gt;otherwise call the parent&#39;s writeHttp implementation.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;St.Ack\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;  \n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;     \n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;ansi\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;======= 2004-07-14 13:35:01 =======\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;    \n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;       \n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;It looks like the actual implementation of content negotiation with\n&gt;&gt;&gt;&gt;&gt;&gt;the &#39;Accept:&#39; header does not work the way you think it does. I tried\n&gt;&gt;&gt;&gt;&gt;&gt;with various servers (IIS, Apache, and GWS) and they all appear to\n&gt;&gt;&gt;&gt;&gt;&gt;have the same behavior: if the content type of the requested resource\n&gt;&gt;&gt;&gt;&gt;&gt;is a complete mismatch of the Accept: header, the resource is returned\n&gt;&gt;&gt;&gt;&gt;&gt;anyway instead of returning a 406 as the HTTP/1.1 specification would\n&gt;&gt;&gt;&gt;&gt;&gt;imply they should.\n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;That would explain why forcing &quot;Accept: text/html&quot; will still return\n&gt;&gt;&gt;&gt;&gt;&gt;images with a 200 response.\n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;It could also be the case that the individual servers have content\n&gt;&gt;&gt;&gt;&gt;&gt;negotiation turned off, or it is not fully implemented, or...\n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;A quick scan of the Apache 2.0.50 content negotiation module would\n&gt;&gt;&gt;&gt;&gt;&gt;imply that a 406 should be returned.\n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;FWIW, I added the &quot;accept-headers&quot; parameter to the HTML fetcher so I\n&gt;&gt;&gt;&gt;&gt;&gt;could force the Accept-Language header --- I&#39;ve never used straight\n&gt;&gt;&gt;&gt;&gt;&gt;&quot;Accept:&quot;.\n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;-tree\n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;-- \n&gt;&gt;&gt;&gt;&gt;&gt;Tom Emerson                                          Basis Technology Corp.\n&gt;&gt;&gt;&gt;&gt;&gt;Software Architect                                 http://www.basistech.com\n&gt;&gt;&gt;&gt;&gt;&gt;&quot;Beware the lollipop of mediocrity: lick it once and you suck forever&quot;\n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt; \n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;      \n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;&gt;         \n&gt;&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;Yahoo! Groups Links\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;    \n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;&gt;       \n&gt;&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;Yahoo! Groups Links\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;.\n&gt;&gt;&gt;&gt;  \n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;     \n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;= = = = = = = = = = = = = = = = = = = =\n&gt;&gt;&gt;\t\t\t\n&gt;&gt;&gt;\n&gt;&gt;&gt;������������������\n&gt;&gt;&gt;��\n&gt;&gt;&gt;\n&gt;&gt;&gt;\t\t\t\t \n&gt;&gt;&gt;����������������zhousp\n&gt;&gt;&gt;����������������zhousp@...\n&gt;&gt;&gt;��������������������2004-07-15\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;Yahoo! Groups Links\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;   \n&gt;&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; \n&gt;&gt;\n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt;  \n&gt; Yahoo! Groups Links\n&gt; \n&gt; \n&gt; \n&gt;  \n&gt; \n\n\n"}}