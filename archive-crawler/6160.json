{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":165458231,"authorName":"Bjarne Andersen","from":"Bjarne Andersen &lt;bja@...&gt;","profile":"bjarne_dk2000","replyTo":"LIST","senderId":"Sdx9bdCjDvCUq3QVDmbQrnHmjM22nzte9I0hnRgmtRetLs_8RbPTdFzGexrLiK6JZVeXZeKpg960lyU8ZNwma9CjcwmZLYxTE4bTm71kKMs","spamInfo":{"isSpam":false,"reason":"6"},"subject":"SV: [archive-crawler] Re: Avoiding overloading webservers hosting many virtual servers","postDate":"1258649095","msgId":6160,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PEE4NzMyRUZCMTQzREU1NDU5OUJFMTlCMjY3MDEzRUFCMDEwNDM1NDA4Mjk5QFNCTUFJTEJPWDEuc2Iuc3RhdHNiaWJsaW90ZWtldC5kaz4="},"prevInTopic":0,"nextInTopic":6174,"prevInTime":6159,"nextInTime":6161,"topicId":6160,"numMessagesInTopic":3,"msgSnippet":"Our main challenge is that we need the queues sperated on TLD (foo.com and bar.com) to use the quota-enforcer to limit number of bytes on each TLD but at the","rawEmail":"Return-Path: &lt;bja@...&gt;\r\nX-Sender: bja@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 91807 invoked from network); 19 Nov 2009 16:44:58 -0000\r\nX-Received: from unknown (98.137.34.45)\n  by m4.grp.sp2.yahoo.com with QMQP; 19 Nov 2009 16:44:58 -0000\r\nX-Received: from unknown (HELO sbexch03.sb.statsbiblioteket.dk) (130.225.24.68)\n  by mta2.grp.sp2.yahoo.com with SMTP; 19 Nov 2009 16:44:57 -0000\r\nX-Received: from SBMAILBOX1.sb.statsbiblioteket.dk ([130.225.24.61]) by\n sbexch03.sb.statsbiblioteket.dk ([130.225.24.68]) with mapi; Thu, 19 Nov 2009\n 17:44:56 +0100\r\nTo: &quot;archive-crawler@yahoogroups.com&quot; &lt;archive-crawler@yahoogroups.com&gt;\r\nDate: Thu, 19 Nov 2009 17:44:55 +0100\r\nThread-Topic: [archive-crawler] Re: Avoiding overloading webservers hosting\n many virtual servers\r\nThread-Index: AcppMptO784jKFHfTzebNEUpR+X8VQABQRti\r\nMessage-ID: &lt;A8732EFB143DE54599BE19B267013EAB010435408299@...&gt;\r\nAccept-Language: da-DK\r\nContent-Language: da-DK\r\nX-MS-Has-Attach:\r\nX-MS-TNEF-Correlator:\r\nacceptlanguage: da-DK\r\nContent-Type: multipart/alternative;\n\tboundary=&quot;_000_A8732EFB143DE54599BE19B267013EAB010435408299SBMAILBOX1s_&quot;\r\nMIME-Version: 1.0\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Bjarne Andersen &lt;bja@...&gt;\r\nSubject: SV: [archive-crawler] Re: Avoiding overloading webservers hosting\n many virtual servers\r\nX-Yahoo-Group-Post: member; u=165458231\r\nX-Yahoo-Profile: bjarne_dk2000\r\n\r\n\r\n--_000_A8732EFB143DE54599BE19B267013EAB010435408299SBMAILBOX1s_\r\nContent-Type: text/plain; charset=&quot;Windows-1252&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nOur main challenge is that we need the queues sperated on TLD (foo.com and =\r\nbar.com) to use the quota-enforcer to limit number of bytes on each TLD but=\r\n at the same time calculate politeness based on the IP-number so that thous=\r\nands of TLDs on the same IP-number does not overload the server.\nWill this =\r\nbe easier to implement with heritrix 3.x ??\n\nBest\nBjarne andersen\nNetarchiv=\r\ne.dk\n\nSent fra min HTC Touch Pro\n\n________________________________\nFra: kri=\r\nstsi25 &lt;kris@...&gt;\nSendt: 19. november 2009 17:09\nTil: archive-crawl=\r\ner@yahoogroups.com &lt;archive-crawler@yahoogroups.com&gt;\nEmne: [archive-crawler=\r\n] Re: Avoiding overloading webservers hosting many virtual servers\n\n\n\nJohn =\r\npretty much sums up the problem.\n\nThe way I&#39;ve dealt with this has been on =\r\na case by case basis. Each time we detect this situation, we override the f=\r\nrontier&#39;s &quot;force-queue-assignment&quot; setting to ensure that all the domains a=\r\nre dumped in the same politeness bucket.\n\nThis is quite simple when you are=\r\n dealing with a multitude of sub-domains as you can just throw in the overr=\r\nide on the parent domain.\n\n- Kris\n\n--- In archive-crawler@yahoogroups.com&lt;m=\r\nailto:archive-crawler%40yahoogroups.com&gt;, John Lekashman &lt;lekash@...&gt; wrote=\r\n:\n&gt;\n&gt; Hi,\n&gt;\n&gt; It is not actually possible to guarantee this.\n&gt; There is no =\r\nreal way to distinguish for sure where the actual physical\n&gt; hardware that =\r\nhosts a name is.\n&gt;\n&gt; There has been some discussion of adding IP addresses =\r\nto the politeness\n&gt; capability, which\n&gt; would do some of it.\n&gt;\n&gt; But, that =\r\nwould be defeated if the provider doing the service has given\n&gt; separate IP=\r\n addresses\n&gt; to each virtual server, e.g. as would be done if they had ssl =\r\nclients on\n&gt; each virtual machine.\n&gt;\n&gt; Another thing that can be considered=\r\n is to extend politeness behavior\n&gt; into parent domains,\n&gt; e.g. act polite =\r\nacross all of:\n&gt; *.foo.com\n&gt;\n&gt; Which would again handle some of it, if the =\r\nvirtual servers all had a\n&gt; common parent.\n&gt; Of course, this would be wrong=\r\n for large scale domains spread across\n&gt; multiple disparate\n&gt; locations.\n&gt;\n=\r\n&gt; If your scope is relatively small, you can also put those things you\n&gt; de=\r\ntect as virtual servers in a separate\n&gt; crawl job, turn off in the other jo=\r\nb, increase the inter arrival time,\n&gt; and limit the number of threads to sl=\r\now it all down.\n&gt;\n&gt; These are all workarounds for the problem, that may hel=\r\np a little.\n&gt; There are probably others you can try.\n&gt;\n&gt; Its just that the =\r\nInternet architecture was designed such that the\n&gt; bandwidth limiting\n&gt; sho=\r\nuld happen lower in the stack, like at the border router to that\n&gt; actual v=\r\nirtualized machine,\n&gt; or on the overloaded host itself, and most ISPs have =\r\nno incentive to do\n&gt; so. (Some guy is using extra bandwidth, so I\n&gt; can bil=\r\nl more? Great. . .) Or no clue that they even should.\n&gt;\n&gt; John\n&gt;\n&gt;\n&gt; S=F8re=\r\nn Vejrup Carlsen wrote:\n&gt;\n&gt; &gt; Hi all.\n&gt; &gt; Is it possible in Heritrix 1.14.3=\r\n to avoid overloading webservers\n&gt; &gt; hosting many virtual servers.\n&gt; &gt; We c=\r\nurrently have the problem that those webservers often choose to\n&gt; &gt; ban our=\r\n harvesters from their site.\n&gt; &gt; And we would very much like to avoid that.=\r\n\n&gt; &gt;\n&gt; &gt; best regards\n&gt; &gt; -------------------------------------------------=\r\n---------\n&gt; &gt; S=F8ren Vejrup Carlsen, NetarchiveSuite developer\n&gt; &gt; Departm=\r\nent of Digital Preservation, Royal Library, Copenhagen, Denmark\n&gt; &gt; tlf: (+=\r\n45) 33 47 48 41\n&gt; &gt; email: svc@... &lt;mailto:svc%40kb.dk&gt;\n&gt; &gt; ---------------=\r\n-------------------------------------------\n&gt; &gt; Non omnia possumus omnes\n&gt; =\r\n&gt; --- Macrobius, Saturnalia, VI, 1, 35 -------\n&gt; &gt;\n&gt; &gt;\n&gt;\n\n\n\n\r\n--_000_A8732EFB143DE54599BE19B267013EAB010435408299SBMAILBOX1s_\r\nContent-Type: text/html; charset=&quot;Windows-1252&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;http://www.w3.org/TR/htm=\r\nl4/strict.dtd&quot;&gt;&lt;html&gt;&lt;head&gt;\n&lt;meta http-equiv=3D&quot;Content-Type&quot; content=3D&quot;te=\r\nxt/html; charset=3DWindows-1252&quot;&gt;\n&lt;/head&gt;\n&lt;body style=3D&quot;background-color: =\r\n#fff;&quot;&gt;\n&lt;span style=3D&quot;FONT-SIZE: 10pt; FONT-FAMILY: Arial; FONT-WEIGHT:Nor=\r\nmal;&quot;&gt;Our main challenge is that we need the queues sperated on TLD (foo.co=\r\nm and bar.com) to use the quota-enforcer to limit number of bytes on each T=\r\nLD but at the same time calculate politeness\n based on the IP-number so tha=\r\nt thousands of TLDs on the same IP-number does not overload the server.&lt;br&gt;=\r\n\nWill this be easier to implement with heritrix 3.x ??&lt;br&gt;\n&lt;br&gt;\nBest&lt;br&gt;\nBj=\r\narne andersen&lt;br&gt;\nNetarchive.dk&lt;br&gt;\n&lt;br&gt;\nSent fra min HTC Touch Pro&lt;br&gt;\n&lt;br=\r\n&gt;\n&lt;hr&gt;\n&lt;span style=3D&quot;font-size:10pt;font-family:Tahoma; font-weight:bold&quot;&gt;=\r\nFra: &lt;/span&gt;&lt;span style=3D&quot;font-size:10pt;font-family:Tahoma; font-weight:n=\r\normal;&quot;&gt;kristsi25 &lt;kris@...&gt;&lt;/span&gt;&lt;br&gt;\n&lt;span style=3D&quot;font-s=\r\nize:10pt;font-family:Tahoma; font-weight:bold&quot;&gt;Sendt: &lt;/span&gt;&lt;span style=3D=\r\n&quot;font-size:10pt;font-family:Tahoma; font-weight:normal;&quot;&gt;19. november 2009 =\r\n17:09&lt;/span&gt;&lt;br&gt;\n&lt;span style=3D&quot;font-size:10pt;font-family:Tahoma; font-wei=\r\nght:bold&quot;&gt;Til: &lt;/span&gt;&lt;span style=3D&quot;font-size:10pt;font-family:Tahoma; fon=\r\nt-weight:normal;&quot;&gt;archive-crawler@yahoogroups.com &lt;archive-crawler@yahoo=\r\ngroups.com&gt;&lt;/span&gt;&lt;br&gt;\n&lt;span style=3D&quot;font-size:10pt;font-family:Tahoma;=\r\n font-weight:bold&quot;&gt;Emne: &lt;/span&gt;&lt;span style=3D&quot;font-size:10pt;font-family:T=\r\nahoma; font-weight:normal;&quot;&gt;[archive-crawler] Re: Avoiding overloading webs=\r\nervers hosting many virtual servers&lt;/span&gt;&lt;br&gt;\n&lt;br&gt;\n&lt;/span&gt;\n&lt;div&gt;&lt;span styl=\r\ne=3D&quot;display:none&quot;&gt;&nbsp;&lt;/span&gt;\n&lt;div id=3D&quot;ygrp-text&quot;&gt;\n&lt;p&gt;John pretty much=\r\n sums up the problem.&lt;br&gt;\n&lt;br&gt;\nThe way I&#39;ve dealt with this has been on a c=\r\nase by case basis. Each time we detect this situation, we override the fron=\r\ntier&#39;s &quot;force-queue-&lt;wbr&gt;assignment&quot; setting to ensure that all t=\r\nhe domains are dumped in the same politeness bucket.\n&lt;br&gt;\n&lt;br&gt;\nThis is quit=\r\ne simple when you are dealing with a multitude of sub-domains as you can ju=\r\nst throw in the override on the parent domain.\n&lt;br&gt;\n&lt;br&gt;\n- Kris&lt;br&gt;\n&lt;br&gt;\n--=\r\n- In &lt;a href=3D&quot;mailto:archive-crawler%40yahoogroups.com&quot;&gt;archive-crawler@&lt;=\r\nwbr&gt;yahoogroups.&lt;wbr&gt;com&lt;/a&gt;, John Lekashman &lt;lekash@...&gt; wrote:&lt;br&gt;\n=\r\n&gt;&lt;br&gt;\n&gt; Hi,&lt;br&gt;\n&gt; &lt;br&gt;\n&gt; It is not actually possible to guarant=\r\nee this.&lt;br&gt;\n&gt; There is no real way to distinguish for sure where the ac=\r\ntual physical&lt;br&gt;\n&gt; hardware that hosts a name is.&lt;br&gt;\n&gt; &lt;br&gt;\n&gt; Th=\r\nere has been some discussion of adding IP addresses to the politeness &lt;br&gt;\n=\r\n&gt; capability, which&lt;br&gt;\n&gt; would do some of it.&lt;br&gt;\n&gt; &lt;br&gt;\n&gt; But=\r\n, that would be defeated if the provider doing the service has given &lt;br&gt;\n&=\r\ngt; separate IP addresses&lt;br&gt;\n&gt; to each virtual server, e.g. as would be=\r\n done if they had ssl clients on &lt;br&gt;\n&gt; each virtual machine.&lt;br&gt;\n&gt; &lt;=\r\nbr&gt;\n&gt; Another thing that can be considered is to extend politeness behav=\r\nior &lt;br&gt;\n&gt; into parent domains,&lt;br&gt;\n&gt; e.g. act polite across all of:&lt;=\r\nbr&gt;\n&gt; *.foo.com&lt;br&gt;\n&gt; &lt;br&gt;\n&gt; Which would again handle some of it, =\r\nif the virtual servers all had a &lt;br&gt;\n&gt; common parent.&lt;br&gt;\n&gt; Of cours=\r\ne, this would be wrong for large scale domains spread across &lt;br&gt;\n&gt; mult=\r\niple disparate&lt;br&gt;\n&gt; locations.&lt;br&gt;\n&gt; &lt;br&gt;\n&gt; If your scope is rela=\r\ntively small, you can also put those things you &lt;br&gt;\n&gt; detect as virtual=\r\n servers in a separate&lt;br&gt;\n&gt; crawl job, turn off in the other job, incre=\r\nase the inter arrival time, &lt;br&gt;\n&gt; and limit the number of threads to sl=\r\now it all down.&lt;br&gt;\n&gt; &lt;br&gt;\n&gt; These are all workarounds for the proble=\r\nm, that may help a little.&lt;br&gt;\n&gt; There are probably others you can try.&lt;=\r\nbr&gt;\n&gt; &lt;br&gt;\n&gt; Its just that the Internet architecture was designed suc=\r\nh that the &lt;br&gt;\n&gt; bandwidth limiting&lt;br&gt;\n&gt; should happen lower in the=\r\n stack, like at the border router to that &lt;br&gt;\n&gt; actual virtualized mach=\r\nine,&lt;br&gt;\n&gt; or on the overloaded host itself, and most ISPs have no incen=\r\ntive to do &lt;br&gt;\n&gt; so. (Some guy is using extra bandwidth, so I&lt;br&gt;\n&gt; =\r\ncan bill more? Great. . .) Or no clue that they even should.&lt;br&gt;\n&gt; &lt;br&gt;\n=\r\n&gt; John&lt;br&gt;\n&gt; &lt;br&gt;\n&gt; &lt;br&gt;\n&gt; S=F8ren Vejrup Carlsen wrote:&lt;br&gt;\n&g=\r\nt; &lt;br&gt;\n&gt; &gt; Hi all.&lt;br&gt;\n&gt; &gt; Is it possible in Heritrix 1.14.3 t=\r\no avoid overloading webservers &lt;br&gt;\n&gt; &gt; hosting many virtual servers.=\r\n&lt;br&gt;\n&gt; &gt; We currently have the problem that those webservers often ch=\r\noose to &lt;br&gt;\n&gt; &gt; ban our harvesters from their site.&lt;br&gt;\n&gt; &gt; An=\r\nd we would very much like to avoid that.&lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt; &gt; best r=\r\negards&lt;br&gt;\n&gt; &gt; ------------&lt;wbr&gt;---------&lt;wbr&gt;---------&lt;wbr&gt;---------=\r\n&lt;wbr&gt;---------&lt;wbr&gt;---------&lt;wbr&gt;-&lt;br&gt;\n&gt; &gt; S=F8ren Vejrup Carlsen, Ne=\r\ntarchiveSuite developer&lt;br&gt;\n&gt; &gt; Department of Digital Preservation, R=\r\noyal Library, Copenhagen, Denmark&lt;br&gt;\n&gt; &gt; tlf: (&#43;45) 33 47 48 41&lt;=\r\nbr&gt;\n&gt; &gt; email: svc@... &lt;mailto:svc%&lt;wbr&gt;40kb.dk&gt;&lt;br&gt;\n&gt; &gt; =\r\n------------&lt;wbr&gt;---------&lt;wbr&gt;---------&lt;wbr&gt;---------&lt;wbr&gt;---------&lt;wbr&gt;--=\r\n-------&lt;wbr&gt;-&lt;br&gt;\n&gt; &gt; Non omnia possumus omnes&lt;br&gt;\n&gt; &gt; --- Macr=\r\nobius, Saturnalia, VI, 1, 35 -------&lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt; &gt;&lt;br&gt;\n&gt;&lt;b=\r\nr&gt;\n&lt;br&gt;\n&lt;/p&gt;\n&lt;/div&gt;\n&lt;!-- end group email --&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\r\n--_000_A8732EFB143DE54599BE19B267013EAB010435408299SBMAILBOX1s_--\r\n\n"}}