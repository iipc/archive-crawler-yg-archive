{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":241416423,"authorName":"Andrea Goethals","from":"Andrea Goethals &lt;andrea_goethals@...&gt;","replyTo":"LIST","senderId":"KmCZx6F__q5dbueQO_tijhqgVQigPCcyzRbaQgnEnIbXKsVhyhthjY2Cww6xYWdVbsfuMbOlaJh7uPBFQ2rAcnd7ChjiJ3Wr3_lma8LItGnRGqQq","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] NullPointerException when writing to ARC   file","postDate":"1137009888","msgId":2540,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDUuMi4xLjEuMi4yMDA2MDExMTE0NTg1Ny4wMjVjOWEyMEBodWxtYWlsLmhhcnZhcmQuZWR1Pg==","inReplyToHeader":"PDQzQzU2RUM5LjEwODA5MDlAYXJjaGl2ZS5vcmc+","referencesHeader":"PDUuMi4xLjEuMi4yMDA2MDExMTEyNDMyNC4wMjVlN2ViOEBodWxtYWlsLmhhcnZhcmQuZWR1PiA8NS4yLjEuMS4yLjIwMDYwMTEwMTIyNTU2LjAyNGE5N2U4QGh1bG1haWwuaGFydmFyZC5lZHU+IDw1LjIuMS4xLjIuMjAwNjAxMTAxMjI1NTYuMDI0YTk3ZThAaHVsbWFpbC5oYXJ2YXJkLmVkdT4gPDUuMi4xLjEuMi4yMDA2MDExMTEyNDMyNC4wMjVlN2ViOEBodWxtYWlsLmhhcnZhcmQuZWR1Pg=="},"prevInTopic":2539,"nextInTopic":2541,"prevInTime":2539,"nextInTime":2541,"topicId":2527,"numMessagesInTopic":6,"msgSnippet":"I think I just figured it out. I tried a test of making no change to the crawl except switching the jre version - and now it works. It appears that the regular","rawEmail":"Return-Path: &lt;andrea_goethals@...&gt;\r\nX-Sender: andrea_goethals@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 11497 invoked from network); 11 Jan 2006 20:04:56 -0000\r\nReceived: from unknown (66.218.66.166)\n  by m32.grp.scd.yahoo.com with QMQP; 11 Jan 2006 20:04:56 -0000\r\nReceived: from unknown (HELO rockhop.harvard.edu) (128.103.60.229)\n  by mta5.grp.scd.yahoo.com with SMTP; 11 Jan 2006 20:04:55 -0000\r\nReceived: from kcml6fy.harvard.edu (hulpres61.harvard.edu [128.103.151.61])\n\tby rockhop.harvard.edu (8.11.6/8.11.6) with ESMTP id k0BK4ig28791\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed, 11 Jan 2006 15:04:50 -0500\r\nMessage-Id: &lt;5.2.1.1.2.20060111145857.025c9a20@...&gt;\r\nX-Sender: andreag@...\r\nX-Mailer: QUALCOMM Windows Eudora Version 5.2.1\r\nDate: Wed, 11 Jan 2006 15:04:48 -0500\r\nTo: archive-crawler@yahoogroups.com\r\nIn-Reply-To: &lt;43C56EC9.1080909@...&gt;\r\nReferences: &lt;5.2.1.1.2.20060111124324.025e7eb8@...&gt;\n &lt;5.2.1.1.2.20060110122556.024a97e8@...&gt;\n &lt;5.2.1.1.2.20060110122556.024a97e8@...&gt;\n &lt;5.2.1.1.2.20060111124324.025e7eb8@...&gt;\r\nMime-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;us-ascii&quot;; format=flowed\r\nX-eGroups-Msg-Info: 1:12:0:0\r\nFrom: Andrea Goethals &lt;andrea_goethals@...&gt;\r\nSubject: Re: [archive-crawler] NullPointerException when writing to ARC\n   file\r\nX-Yahoo-Group-Post: member; u=241416423\r\n\r\nI think I just figured it out.\n\nI tried a test of making no change to the crawl except switching the jre \nversion - and now it works. It appears that the regular expressions \nevaluation is different even between 1.4 versions. The first machine I used \nwhere it worked fine was:\n\n[andreag@fledge andreag]$ /usr/java/bin/java -version\njava version &quot;1.4.2_02&quot;\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.4.2_02-b03)\nJava HotSpot(TM) Client VM (build 1.4.2_02-b03, mixed mode)\n\nThis one is the one where the regular expression didn&#39;t evaluate correctly:\n\n[andreag@chaz heritrix-1.7.0-200601101902]$ /usr/java/bin/java -version\njava version &quot;1.4.1_02&quot;\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.4.1_02-b06)\nJava HotSpot(TM) Client VM (build 1.4.1_02-b06, mixed mode)\n\nIncidentally this one works fine too:\n[andreag@chaz heritrix-1.7.0-200601101902]$ java -version\njava version &quot;1.5.0_06&quot;\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_06-b05)\nJava HotSpot(TM) Client VM (build 1.5.0_06-b05, mixed mode, sharing)\n\nThese are linux machines.\n\n[andreag@chaz heritrix-1.7.0-200601101902]$ uname -a\nLinux chaz.hul.harvard.edu 2.4.9-e.49enterprise #1 SMP Fri Aug 6 11:32:58 \nEDT 2004 i686 unknown\n\n[andreag@fledge andreag]$ uname -a\nLinux fledge.hul.harvard.edu 2.4.9-e.49smp #1 SMP Fri Aug 6 11:44:58 EDT \n2004 i686 unknown\n\n\nAndrea\n\n\nAt 12:47 PM 1/11/2006 -0800, you wrote:\n&gt;Andrea Goethals wrote:\n&gt; &gt; ....\n&gt; &gt;\n&gt; &gt; Now here&#39;s a better exception trace (all the exceptions are the same but\n&gt; &gt; for different URIs):\n&gt; &gt; Message:\n&gt; &gt;\n&gt; &gt; Failed write of ARC Record: http://www.aandw.net/images/walden2.png(in\n&gt; &gt; processor Archiver)\n&gt; &gt;\n&gt; &gt; Exception:\n&gt; &gt;\n&gt; &gt; java.io.IOException: Metadata line doesn&#39;t match expected pattern:\n&gt; &gt; http://www.aandw.net/images/walden2.png 128.197.34.86 20060111174224\n&gt; &gt; image/png 2160\n&gt; &gt;\n&gt; &gt; Stacktrace: java.io.IOException: Metadata line doesn&#39;t match expected\n&gt; &gt; pattern: http://www.aandw.net/images/walden2.png 128.197.34.86\n&gt; &gt; 20060111174224 image/png 2160\n&gt; &gt;\n&gt; &gt;          at\n&gt; &gt; org.archive.io.arc.ARCWriter.validateMetaLine(ARCWriter.java:793)\n&gt; &gt;          at org.archive.io.arc.ARCWriter.getMetaLine(ARCWriter.java:764)\n&gt; &gt;          at org.archive.io.arc.ARCWriter.write(ARCWriter.java:687)\n&gt; &gt;          at\n&gt;\n&gt;Odd.  I passed the &#39;problematic&#39; meta line by a unit test that tests the\n&gt;validate metadata line code and it passes fine.\n&gt;\n&gt;I tried crawling the URL mentioned in the meta line and it works too.\n&gt;\n&gt;So, looking at the regex, &quot;^&#92;&#92;S+ &#92;&#92;S+ &#92;&#92;S+ &#92;&#92;S+ &#92;&#92;S+(&quot; + LINE_SEPARATOR\n&gt;+ &quot;?)$&quot; where LINE_SEPARATOR = &#39;&#92;n&#39;, I&#39;m guessing we&#39;re failing because\n&gt;we&#39;re not matching on end-of-line.\n&gt;\n&gt;Tell me more about this new platform that you&#39;ve moved Heritrix to?\n&gt;Windows?\n&gt;\n&gt;If you look in logs, say heritrix_out.log, the raw exception might show\n&gt;characters at end of the metadata line -- perhaps &#39;&#92;r&#92;n&#39;?\n&gt;\n&gt;St.Ack\n&gt;\n&gt;\n&gt; &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.write(ARCWriterProcessor.java:475)\n&gt; &gt;          at\n&gt; &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.writeHttp(ARCWriterProcessor.java:417)\n&gt; &gt;          at\n&gt; &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.innerProcess(ARCWriterProcessor.java:394)\n&gt; &gt;          at\n&gt; &gt; org.archive.crawler.framework.Processor.process(Processor.java:103)\n&gt; &gt;          at\n&gt; &gt; org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:306)\n&gt; &gt;          at org.archive.crawler.framework.ToeThread.run(ToeThread.java:153)\n&gt; &gt;\n&gt; &gt; Somehow the ARCWriter.METADATA_LINE_PATTERN isn&#39;t matching exactly with the\n&gt; &gt; metadata line.\n&gt; &gt;\n&gt; &gt; What ends up happening is that it writes the very first part of an ARC file\n&gt; &gt; (like below) gets the IOException, renames the file to *invalid, opens a\n&gt; &gt; new file and starts the process again. So it continues to write *invalid\n&gt; &gt; files with just the first part of the ARC file until you see all the alerts\n&gt; &gt; and stop it.\n&gt; &gt;\n&gt; &gt; The only part that gets written to each ARC file:\n&gt; &gt; [andreag@chaz unzipped]$ more\n&gt; &gt; IAH-20060110181306-00028-chaz.hul.harvard.edu.arc\n&gt; &gt; filedesc://IAH-20060110181306-00028-chaz.hul.harvard.edu.arc 0.0.0.0\n&gt; &gt; 20060110181306 text/plain 1214\n&gt; &gt; 1 1 InternetArchive\n&gt; &gt; URL IP-address Archive-date Content-type Archive-length\n&gt; &gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;\n&gt; &gt; &lt;arcmetadata xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n&gt; &gt; xmlns:dcterms=&quot;http://purl.org/dc/terms/&quot;\n&gt; &gt; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot;\n&gt; &gt; xmlns:arc=&quot;http://archive.org/arc/1.0/&quot; xmlns=&quot;http://archive.org/arc/1.0/&quot;\n&gt; &gt; xsi:schemaLocation=&quot;http://archive.org/arc/1.0/\n&gt; &gt; http://www.archive.org/arc/1.0/arc.xsd&quot;&gt;\n&gt; &gt; &lt;arc:software&gt;Heritrix 1.6.0 http://crawler.archive.org&lt;/arc:software&gt;\n&gt; &gt; &lt;arc:hostname&gt;chaz.hul.harvard.edu&lt;/arc:hostname&gt;\n&gt; &gt; &lt;arc:ip&gt;128.103.151.249&lt;/arc:ip&gt;\n&gt; &gt; &lt;dcterms:isPartOf&gt;test2&lt;/dcterms:isPartOf&gt;\n&gt; &gt; &lt;dc:description&gt;Default Profile&lt;/dc:description&gt;\n&gt; &gt; &lt;arc:operator&gt;Admin&lt;/arc:operator&gt;\n&gt; &gt; &lt;dc:date xsi:type=&quot;dcterms:W3CDTF&quot;&gt;2006-01-10T18:11:55+00:00&lt;/dc:date&gt;\n&gt; &gt; &lt;arc:http-header-user-agent&gt;Mozilla/5.0 (compatible; heritrix/1.6.0\n&gt; &gt; +http://hul.harvard.edu/ois/)&lt;/arc:http-header-user-agent&gt;\n&gt; &gt; &lt;arc:http-header-from&gt;andrea_goethals@...&lt;/arc:http-header-from&gt;\n&gt; &gt; &lt;arc:robots&gt;classic&lt;/arc:robots&gt;\n&gt; &gt; &lt;dc:format&gt;ARC file version 1.1&lt;/dc:format&gt;\n&gt; &gt; &lt;dcterms:conformsTo\n&gt; &gt; \n&gt; xsi:type=&quot;dcterms:URI&quot;&gt;http://www.archive.org/web/researcher/ArcFileFormat.php&lt;/dcterms:conformsTo&gt;\n&gt; &gt; &lt;/arcmetadata&gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; Andrea\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;  &gt;St.Ack\n&gt; &gt;  &gt;\n&gt; &gt;  &gt;\n&gt; &gt;  &gt;Andrea Goethals wrote:\n&gt; &gt;  &gt; &gt; Hello,\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt; I recently changed the machine I am doing crawls on. Now every time\n&gt; &gt; I try\n&gt; &gt;  &gt; &gt; to run a crawl I get a NullPointerException - even doing the Charset\n&gt; &gt;  &gt; &gt; self-test. These are the kind of entries I&#39;m getting in my console &\n&gt; &gt;  &gt; &gt; heritrix_out.log:\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt; Message:\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt; Problem java.lang.NullPointerException occured when trying to process\n&gt; &gt;  &gt; &gt; &#39;http://127.0.0.1:8181/robots.txt&#39;\n&gt; &gt;  &gt; &gt; &lt;http://127.0.0.1:8181/robots.txt%27&gt; at step ABOUT_TO_BEGIN_PROCESSOR\n&gt; &gt;  &gt; &gt; in Archiver\n&gt; &gt;  &gt; &gt; (in processor Archiver)\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt; java.lang.NullPointerException\n&gt; &gt;  &gt; &gt; Stacktrace: java.lang.NullPointerException\n&gt; &gt;  &gt; &gt;       at\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt;\n&gt; &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.write(ARCWriterProcessor.java:492)\n&gt; &gt;  &gt; &gt;       at\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt;\n&gt; &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.writeHttp(ARCWriterProcessor.java:417)\n&gt; &gt;  &gt; &gt;       at\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt;\n&gt; &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.innerProcess(ARCWriterProcessor.java:394)\n&gt; &gt;  &gt; &gt;       at\n&gt; &gt;  &gt; &gt; org.archive.crawler.framework.Processor.process(Processor.java:103)\n&gt; &gt;  &gt; &gt;       at\n&gt; &gt;  &gt; &gt;\n&gt; &gt; org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:306)\n&gt; &gt;  &gt; &gt;       at\n&gt; &gt; org.archive.crawler.framework.ToeThread.run(ToeThread.java:153)\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt; I can kind of see from the source why the NullPointerException \n&gt; might be\n&gt; &gt;  &gt; &gt; thrown. In the ArcWriterProcessor when an IOException is thrown, on\n&gt; &gt; line\n&gt; &gt;  &gt; &gt; 489 the writer is being set to null. Then in the finally clause on\n&gt; &gt;  &gt; &gt; line 492\n&gt; &gt;  &gt; &gt; it tries to call getPosition() on the null writer.\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt; The arc files are being written with the invalid suffix. I don&#39;t\n&gt; &gt; know why\n&gt; &gt;  &gt; &gt; the IOException occurs if that is what&#39;s happening. I was able to do\n&gt; &gt;  &gt; &gt; crawls\n&gt; &gt;  &gt; &gt; on a different machine (both linux, both heritrix 1.6). Any help is\n&gt; &gt;  &gt; &gt; appreciated.\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt; thanks,\n&gt; &gt;  &gt; &gt; Andrea\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt;\n&gt; &gt;  &gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; ------------------------------------------------------------------------\n&gt; &gt; YAHOO! GROUPS LINKS\n&gt; &gt;\n&gt; &gt;     *  Visit your group &quot;archive-crawler\n&gt; &gt;       &lt;http://groups.yahoo.com/group/archive-crawler&gt;&quot; on the web.\n&gt; &gt;\n&gt; &gt;     *  To unsubscribe from this group, send an email to:\n&gt; &gt;        archive-crawler-unsubscribe@yahoogroups.com\n&gt; &gt; \n&gt; &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;\n&gt; &gt;\n&gt; &gt;     *  Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt; &gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; ------------------------------------------------------------------------\n&gt; &gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n&gt;\n\n\n\n"}}