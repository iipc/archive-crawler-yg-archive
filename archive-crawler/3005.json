{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"MUHDCPaWJ7nKYdXGyY5Q60Po7cpYM_lwXIcsWNnhJQnL9mzZrmgPCucB0i2lZRNIWwDHaCqX571YA-cSVmRxNsS9VGcns-Q","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Resolution Re: [archive-crawler] slow crawls with 1.8: mail per heritrix list","postDate":"1151969901","msgId":3005,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQ0QTlBQTZELjYwMTA1MDFAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDQ0QTVBODhGLjgwMjAwMDJAYXJjaGl2ZS5vcmc+","referencesHeader":"PDQ0QTI0RUQ1LjgwMDA1MDFAc3NsbWl0LnVuaWJvLml0PiA8NDRBMkZDQkUuODA3MDAwMkBhcmNoaXZlLm9yZz4gPDQ0QTUwNTE2LjQwNzAxMDlAc3NsbWl0LnVuaWJvLml0PiA8NDRBNUE4OEYuODAyMDAwMkBhcmNoaXZlLm9yZz4="},"prevInTopic":2997,"nextInTopic":0,"prevInTime":3004,"nextInTime":3006,"topicId":2984,"numMessagesInTopic":5,"msgSnippet":"Marco sent me his order files offlist and looking them over, I was reminded of this previously-discussed issue, where the syntax for SURT-prefix-files changed","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 10411 invoked from network); 3 Jul 2006 23:38:46 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m36.grp.scd.yahoo.com with QMQP; 3 Jul 2006 23:38:46 -0000\r\nReceived: from unknown (HELO relay03.pair.com) (209.68.5.17)\n  by mta1.grp.scd.yahoo.com with SMTP; 3 Jul 2006 23:38:46 -0000\r\nReceived: (qmail 16254 invoked from network); 3 Jul 2006 23:38:22 -0000\r\nReceived: from unknown (HELO ?10.0.10.13?) (unknown)\n  by unknown with SMTP; 3 Jul 2006 23:38:22 -0000\r\nX-pair-Authenticated: 71.141.107.177\r\nMessage-ID: &lt;44A9AA6D.6010501@...&gt;\r\nDate: Mon, 03 Jul 2006 16:38:21 -0700\r\nUser-Agent: Mozilla Thunderbird 1.0.8-1.1.fc4 (X11/20060501)\r\nX-Accept-Language: en-us, en\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;44A24ED5.8000501@...&gt; &lt;44A2FCBE.8070002@...&gt; &lt;44A50516.4070109@...&gt; &lt;44A5A88F.8020002@...&gt;\r\nIn-Reply-To: &lt;44A5A88F.8020002@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Resolution Re: [archive-crawler] slow crawls with 1.8: mail per heritrix\n list\r\nX-Yahoo-Group-Post: member; u=137285340; y=B5TXqyGHII5wiXsdyuGiSAwiCidO4o77ye5udTjH_15L\r\nX-Yahoo-Profile: gojomo\r\n\r\nMarco sent me his order files offlist and looking them over, I was \nreminded of this previously-discussed issue, where the syntax for \nSURT-prefix-files changed just after 1.4:\n\n  http://groups.yahoo.com/group/archive-crawler/message/2680\n\nMarco reports that updating the file of SURT prefixes to prepend \nlines with a &#39;+&#39; resolved the problem.\n\n- Gordon @ IA\n\nGordon Mohr wrote:\n&gt; These reports look typical for a crawl that has simply reached a stage \n&gt; where there are not enough eligible queues to keep the threads busy.\n&gt; \n&gt; Specifically, it&#39;s showing only 120 queues with eligible URIs. If some \n&gt; are in long retry delays (because the target hosts didn&#39;t respond at \n&gt; all), and your politeness delays are otherwise reasonable, only a few \n&gt; will be available at any time.\n&gt; \n&gt; That suggests whatever is different compared to your 1.4 runs is keeping \n&gt; URIs from being scheduled; perhaps there&#39;s a subtle or unintended \n&gt; difference in your scoping rules? Perhaps the sense of a filter could be \n&gt; inverted?\n&gt; \n&gt; If you&#39;d like to send me your 1.4 and 1.8 order.xml files (on or off \n&gt; list), I&#39;ll see if I notice anything that could account for the difference.\n&gt; \n&gt; - Gordon @ IA\n&gt; \n&gt; \n&gt; Marco Baroni wrote:\n&gt; \n&gt;&gt;Thanks for your help!\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt;Once it reaches the &#39;slow&#39; state, it would be useful to check:\n&gt;&gt;&gt;- does the UI show any alerts?\n&gt;&gt;\n&gt;&gt;No alerts.\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt;- does the heritrix_out.log show any exceptions (esp. those that\n&gt;&gt;&gt;might cause thread death)?\n&gt;&gt;\n&gt;&gt;Nope, there are some warnings when we start heritrix but they only concern \n&gt;&gt;older (pre-1.4) jobs, and they don&#39;t seem relevant.\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt;- what does the UI &#39;threads report&#39; show as the state of running\n&gt;&gt;&gt;threads?\n&gt;&gt;\n&gt;&gt;ToeThread report\n&gt;&gt;150 threads: 150 ABOUT_TO_GET_URI\n&gt;&gt;\n&gt;&gt;The report looks like this:\n&gt;&gt;\n&gt;&gt;Toe threads report - 200606301056\n&gt;&gt;  Job being crawled: itwac-like2\n&gt;&gt;  Number of toe threads in pool: 150 (0 active)\n&gt;&gt;    ToeThread #1\n&gt;&gt;[ToeThread #1:\n&gt;&gt;  -no CrawlURI-\n&gt;&gt;     WAITING for 9s930ms\n&gt;&gt;     step: ABOUT_TO_GET_URI for 9s930ms\n&gt;&gt;]\n&gt;&gt;    ToeThread #2\n&gt;&gt;[ToeThread #2:\n&gt;&gt;  -no CrawlURI-\n&gt;&gt;     WAITING for 15s20ms\n&gt;&gt;     step: ABOUT_TO_GET_URI for 15s20ms\n&gt;&gt;]\n&gt;&gt;\n&gt;&gt;and so on for all the threads\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt;- what does the &#39;frontier report&#39; show as the distribution of\n&gt;&gt;&gt;queue states?\n&gt;&gt;\n&gt;&gt;Frontier report\n&gt;&gt;3782 queues: 120 active (0 in-process; 0 ready; 120 snoozed); 0 inactive; 0 \n&gt;&gt;retired; 3662 exhausted\n&gt;&gt;\n&gt;&gt;Frontier report - 200606301058\n&gt;&gt;  Job being crawled: itwac-like2\n&gt;&gt;\n&gt;&gt;  -----===== STATS =====-----\n&gt;&gt;  Discovered:    27470\n&gt;&gt;  Queued:        2513\n&gt;&gt;  Finished:      25014\n&gt;&gt;   Successfully: 19759\n&gt;&gt;   Failed:       3\n&gt;&gt;   Disregarded:  5252\n&gt;&gt;\n&gt;&gt;  -----===== QUEUES =====-----\n&gt;&gt;  Already included size:     27470\n&gt;&gt;                pending:     0\n&gt;&gt;\n&gt;&gt;  All class queues map size: 3782\n&gt;&gt;              Active queues: 120\n&gt;&gt;                     In-process: 0\n&gt;&gt;                          Ready: 0\n&gt;&gt;                        Snoozed: 120\n&gt;&gt;            Inactive queues: 0\n&gt;&gt;             Retired queues: 0\n&gt;&gt;           Exhausted queues: 3662\n&gt;&gt;\n&gt;&gt;  -----===== IN-PROCESS QUEUES =====-----\n&gt;&gt;\n&gt;&gt;  -----===== READY QUEUES =====-----\n&gt;&gt;\n&gt;&gt;  -----===== SNOOZED QUEUES =====-----\n&gt;&gt;Queue weather.yahoo.com\n&gt;&gt;   10 items\n&gt;&gt;    wakes in: 684ms\n&gt;&gt;     last enqueued: \n&gt;&gt;http://weather.yahoo.com/forecast/BRXX0232_c.html?force_units=1\n&gt;&gt;       last peeked: http://weather.yahoo.com/forecast/SFXX0023_f.html\n&gt;&gt;    total expended: 99 (total budget: -1)\n&gt;&gt;    active balance: 2901\n&gt;&gt;    last(avg) cost: 1(1.0)\n&gt;&gt;\n&gt;&gt;Queue forum.cellularmagazine.it\n&gt;&gt;   152 items\n&gt;&gt;    wakes in: 744ms\n&gt;&gt;     last enqueued: \n&gt;&gt;http://forum.cellularmagazine.it/viewtopic.php?t=6786&view=previous\n&gt;&gt;       last peeked: http://forum.cellularmagazine.it/viewtopic.php?t=6786\n&gt;&gt;    total expended: 72 (total budget: -1)\n&gt;&gt;    active balance: 2928\n&gt;&gt;    last(avg) cost: 1(1.0)\n&gt;&gt;\n&gt;&gt;Queue www.fondazionecrvenezia.it\n&gt;&gt;   25 items\n&gt;&gt;    wakes in: 1s342ms\n&gt;&gt;     last enqueued: \n&gt;&gt;http://www.fondazionecrvenezia.it/patrimonioartistico/dipinti/scheda171.html\n&gt;&gt;       last peeked: \n&gt;&gt;http://www.fondazionecrvenezia.it/patrimonioartistico/dipinti/scheda118.html\n&gt;&gt;    total expended: 222 (total budget: -1)\n&gt;&gt;    active balance: 2778\n&gt;&gt;    last(avg) cost: 1(1.0)\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;...\n&gt;&gt;\n&gt;&gt;  -----===== LONGEST QUEUE =====-----\n&gt;&gt;Queue forum.amdplanet.it\n&gt;&gt;   1418 items\n&gt;&gt;    wakes in: 8s465ms\n&gt;&gt;     last enqueued: \n&gt;&gt;http://forum.amdplanet.it/viewtopic.php?t=17426&view=previous\n&gt;&gt;       last peeked: http://forum.amdplanet.it/viewtopic.php?t=17426\n&gt;&gt;    total expended: 67 (total budget: -1)\n&gt;&gt;    active balance: 2933\n&gt;&gt;    last(avg) cost: 1(1.0)\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;  -----===== INACTIVE QUEUES =====-----\n&gt;&gt;\n&gt;&gt;  -----===== RETIRED QUEUES =====-----\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt;Another outside possibility is a large number of non-responsive\n&gt;&gt;&gt;hosts. Depending on your settings, non-responsive hosts could take\n&gt;&gt;&gt;tens of seconds to minutes to time out. Having hundreds or\n&gt;&gt;&gt;thousands among the queues could monopolize all the threads\n&gt;&gt;&gt;wiating for timeouts. This would likely be evident in the threads\n&gt;&gt;&gt;report if this were the case.\n&gt;&gt;\n&gt;&gt;See above.\n&gt;&gt;\n&gt;&gt;But isn&#39;t this something that should have happened in 1.4 as well?\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;&gt;&gt;Hope this helps -- feel free to send whatever crawl output you\n&gt;&gt;&gt;feel comfortable sharing to the list or to me directly for more\n&gt;&gt;&gt;analysis.\n&gt;&gt;\n&gt;&gt;Thanks a lot -- we feel comfortable sharing everything, but I&#39;m not sure \n&gt;&gt;about what kind of information would be useful and I don&#39;t want to submerge \n&gt;&gt;you and/or the list with useless stuff... if there is anything that you \n&gt;&gt;thing would be informative in diagnosing the problem, please let me know, \n&gt;&gt;and I&#39;ll send it!\n&gt;&gt;\n&gt;&gt;Thanks again.\n&gt;&gt;\n&gt;&gt;Regards,\n&gt;&gt;\n&gt;&gt;Marco\n&gt;&gt;\n&gt;&gt;\n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt;  \n&gt; Yahoo! Groups Links\n&gt; \n&gt; \n&gt; \n&gt;  \n&gt; \n&gt; \n&gt; \n\n\n"}}