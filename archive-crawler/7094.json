{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"EWSsOHeVj3Oh3EbNK6619ixxkuWlCQNkIHkEtMZ2YBRx7w0h3MuMqUG-jP4vjNPk1vr8DvFzwaqNHa6d10JL5Wngihc3kD4","spamInfo":{"isSpam":false,"reason":"6"},"subject":"Re: [archive-crawler] Disk Space Problem","postDate":"1302508751","msgId":7094,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDREQTJCNENGLjYwMjA0MDlAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDREQTFBM0Q4LjMwOTA3MDhAYmliYWxleC5vcmc+","referencesHeader":"PDREQTFBM0Q4LjMwOTA3MDhAYmliYWxleC5vcmc+"},"prevInTopic":7092,"nextInTopic":7101,"prevInTime":7093,"nextInTime":7095,"topicId":7092,"numMessagesInTopic":4,"msgSnippet":"... If your state directory has many .DEL files, most can safely be deleted. They re only needed if the same-numbered .JDB file is referenced in a","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 29510 invoked from network); 11 Apr 2011 07:59:13 -0000\r\nX-Received: from unknown (98.137.34.45)\n  by m6.grp.sp2.yahoo.com with QMQP; 11 Apr 2011 07:59:13 -0000\r\nX-Received: from unknown (HELO relay00.pair.com) (209.68.5.9)\n  by mta2.grp.sp2.yahoo.com with SMTP; 11 Apr 2011 07:59:13 -0000\r\nX-Received: (qmail 53323 invoked by uid 0); 11 Apr 2011 07:59:11 -0000\r\nX-Received: from 76.218.213.38 (HELO silverbook.local) (76.218.213.38)\n  by relay00.pair.com with SMTP; 11 Apr 2011 07:59:11 -0000\r\nX-pair-Authenticated: 76.218.213.38\r\nMessage-ID: &lt;4DA2B4CF.6020409@...&gt;\r\nDate: Mon, 11 Apr 2011 00:59:11 -0700\r\nUser-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.15) Gecko/20110303 Thunderbird/3.1.9\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: Mahmoud Mubarak &lt;mahmoud.mubarak@...&gt;\r\nReferences: &lt;4DA1A3D8.3090708@...&gt;\r\nIn-Reply-To: &lt;4DA1A3D8.3090708@...&gt;\r\nContent-Type: text/plain; charset=windows-1252; format=flowed\r\nContent-Transfer-Encoding: 8bit\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] Disk Space Problem\r\nX-Yahoo-Group-Post: member; u=137285340; y=9ldExNx--8T4pbxdQO_9flCkiwrEVjRDhrD5c9ia6ljJ\r\nX-Yahoo-Profile: gojomo\r\n\r\nOn 4/10/11 5:34 AM, Mahmoud Mubarak wrote:\n&gt; I&#39;m using a machine with 4 disks. Heritrix directory is on /0. The\n&gt; directories of warc.gz files are /1, /2, and /3. I tried to reduce the\n&gt; size of the heritrix/jobs/My-Job directory. I took a checkpoint one time\n&gt; per two days and gzip the log files of the checkpoint. But, the state\n&gt; directory increased very fast:\n&gt;\n&gt; root@My-Machine:/0/heritrix/jobs/My-Job# du -hs *\n&gt; 0 action\n&gt; 880K checkpoints\n&gt; 24K crawler-beans.cxml\n&gt; 4.0K job.log\n&gt; 0 job.log.lck\n&gt; 12G logs\n&gt; 108K negative-surts.dump\n&gt; 8.0K scratch\n&gt; 112K seeds.txt\n&gt; *236G state*\n&gt; 100K surts.dump\n&gt;\n&gt; The problem is that /0 is fully used now:\n&gt;\n&gt; ~# df -h /?\n&gt; Filesystem Size Used Avail Use% Mounted on\n&gt; /dev/sda1 252G 252G 0 100% /0\n&gt; /dev/sdb1 373G 61G 313G 17% /1\n&gt; /dev/sdc1 373G 60G 314G 16% /2\n&gt; /dev/sdd1 373G 59G 315G 16% /3\n&gt;\n&gt; My solution is to start a new job and put frontier.recover.gz in action\n&gt; directory to continue crawling uncrawled URIs and remove state directory\n&gt; from the previous job, is this solution reasonable? I want to ask too\n&gt; about the size i have to provide to continue crawling without filling up\n&gt; the size by .jdb files in state directory.\n\nIf your &#39;state&#39; directory has many &#39;.DEL&#39; files, most can safely be \ndeleted. They&#39;re only needed if the same-numbered &#39;.JDB&#39; file is \nreferenced in a checkpoint&#39;s &#39;jdbfiles.manifest&#39;, and you need to be \nable to recover from that checkpoint.\n\n(The next version will make this process a lot easier by collecting the \nlog files needed for each checkpoint as hard links. Thus, the normal \nBDB-JE &#39;cleaner&#39; can delete unused files instead of &#39;.DEL&#39; renaming \nthem... and the hard links will keep just those that are truly needed. \nWhen an operator decides to delete the corresponding checkpoint \ndirectory, all linked log files no longer needed by other checkpoints \nwill be deleted along with it. See issue \n&lt;https://webarchive.jira.com/browse/HER-1821&gt; for details.)\n\nIf that doesn&#39;t free up enough headroom, the next thing to consider is \nwhether the data structures that account for the &#39;state&#39; directory are \novergrown. The largest contributor to the &#39;state&#39; directory are the \nqueues of URIs to be crawled.\n\nA crawler collecting many valueless URIs deep on &#39;trap&#39; paths will have \na larger state directory, so keeping an eye on the largest queues, and \nadding mid-crawl adjustments to either � (1) block more unwanted URIs \nfrom being enqueued; or (2) quickly discard unwanted URIs from where \nthey&#39;ve collected � may help shrink your state directory significantly.\n\nOther possible contributors to its size are the default BdbUriUniqFilter \n(&#39;alreadyIncluded&#39; set of URIs discovered), and the &#39;URI history&#39; \ndatabase (if using the &#39;Persist&#39; processors for crawl-over-crawl \nduplication-reduction). Switching away from the BdbUriUniqFilter to the \nBloomUriUniqFilter will save disk space, though with all the other \ncaveats (more RAM requirements, guaranteed small error-rate in \ninclusion-testing) that choise entails. Each of these *could* also be \nretargeted to use their own separate BdbModule (by explicitly specifying \nmultiple BdbModules in the Spring configuration, rather than allowing \nthem all to discover the main BdbModule via &#39;autowiring&#39;). These \nalternate BdbModules would be backed by different environment \ndirectories (like &#39;state&#39;), on other volumes, perhaps preventing any one \nvolume from filling up.\n\nGiven the above, I would only expect your idea of recovering from the \nrecovery-log to help a little (beyond the benefit from clearing out the \n.DEL files). That log-recovery roughly rebuilds the queues and \nalready-included set as they were � so the largest contributors to the \nstate directory size would remain the same after the recovery. While \nsome other accumulated data for hosts/servers/robots would be left out \nof the rebuilt state-directory, they&#39;d come back if those sites were \nrevisited in the continuing crawl, and my hunch is that data is dwarfed \nby the queues/URI-set anyway.\n\nHope this helps,\n\n- Gordon @ IA\n\n&gt; --\n&gt; Mahmoud A. Mubarak\n&gt; Software Engineer, ICT Sector\n&gt; Bibliotheca Alexandrina\n&gt; P.O. Box 138\n&gt; 21526 El Shatby, Alexandria\n&gt; Tel: +20-3-4839999\n&gt; Fax: +20-3-4820405\n&gt; E-mail:mahmoud.mubarak@...\n&gt;\n&gt;\n\n"}}