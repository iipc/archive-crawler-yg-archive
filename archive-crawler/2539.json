{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":168599281,"authorName":"stack","from":"stack &lt;stack@...&gt;","profile":"stackarchiveorg","replyTo":"LIST","senderId":"DspLD0FuZbgrWNlGa6qO3pbdTa5qM7V8cUhgugGdUQUGRY6CT9DnhmJBxpixbYth80SJmGhSGkteIDnjTFSy2w","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] NullPointerException when writing to ARC  file","postDate":"1137012425","msgId":2539,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQzQzU2RUM5LjEwODA5MDlAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDUuMi4xLjEuMi4yMDA2MDExMTEyNDMyNC4wMjVlN2ViOEBodWxtYWlsLmhhcnZhcmQuZWR1Pg==","referencesHeader":"PDUuMi4xLjEuMi4yMDA2MDExMDEyMjU1Ni4wMjRhOTdlOEBodWxtYWlsLmhhcnZhcmQuZWR1PiA8NS4yLjEuMS4yLjIwMDYwMTEwMTIyNTU2LjAyNGE5N2U4QGh1bG1haWwuaGFydmFyZC5lZHU+IDw1LjIuMS4xLjIuMjAwNjAxMTExMjQzMjQuMDI1ZTdlYjhAaHVsbWFpbC5oYXJ2YXJkLmVkdT4="},"prevInTopic":2533,"nextInTopic":2540,"prevInTime":2538,"nextInTime":2540,"topicId":2527,"numMessagesInTopic":6,"msgSnippet":"... Odd.  I passed the problematic meta line by a unit test that tests the validate metadata line code and it passes fine. I tried crawling the URL mentioned","rawEmail":"Return-Path: &lt;stack@...&gt;\r\nX-Sender: stack@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 7963 invoked from network); 11 Jan 2006 19:56:18 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m29.grp.scd.yahoo.com with QMQP; 11 Jan 2006 19:56:18 -0000\r\nReceived: from unknown (HELO ia00524.archive.org) (207.241.224.171)\n  by mta1.grp.scd.yahoo.com with SMTP; 11 Jan 2006 19:56:18 -0000\r\nReceived: (qmail 3079 invoked by uid 100); 11 Jan 2006 19:49:55 -0000\r\nReceived: from adsl-71-130-102-78.dsl.pltn13.pacbell.net (HELO ?192.168.1.8?) (stack@...@71.130.102.78)\n  by mail-dev.archive.org with SMTP; 11 Jan 2006 19:49:55 -0000\r\nMessage-ID: &lt;43C56EC9.1080909@...&gt;\r\nDate: Wed, 11 Jan 2006 12:47:05 -0800\r\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8) Gecko/20051219 SeaMonkey/1.0b\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;5.2.1.1.2.20060110122556.024a97e8@...&gt; &lt;5.2.1.1.2.20060110122556.024a97e8@...&gt; &lt;5.2.1.1.2.20060111124324.025e7eb8@...&gt;\r\nIn-Reply-To: &lt;5.2.1.1.2.20060111124324.025e7eb8@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-Spam-DCC: : \r\nX-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on ia00524.archive.org\r\nX-Spam-Level: \r\nX-Spam-Status: No, hits=-95.5 required=7.0 tests=AWL,NORMAL_HTTP_TO_IP,\n\tUSER_IN_WHITELIST,WEIRD_PORT autolearn=no version=2.63\r\nX-eGroups-Msg-Info: 2:12:4:0\r\nFrom: stack &lt;stack@...&gt;\r\nSubject: Re: [archive-crawler] NullPointerException when writing to ARC  file\r\nX-Yahoo-Group-Post: member; u=168599281; y=M7sX73C9o5XiwpDXzoOxdzFJFe_cB2Ct3S_0Lt139kaf1GuhnvbOcKlU\r\nX-Yahoo-Profile: stackarchiveorg\r\n\r\nAndrea Goethals wrote:\n&gt; ....\n&gt; \n&gt; Now here&#39;s a better exception trace (all the exceptions are the same but\n&gt; for different URIs):\n&gt; Message:\n&gt; \n&gt; Failed write of ARC Record: http://www.aandw.net/images/walden2.png(in\n&gt; processor Archiver)\n&gt; \n&gt; Exception:\n&gt; \n&gt; java.io.IOException: Metadata line doesn&#39;t match expected pattern:\n&gt; http://www.aandw.net/images/walden2.png 128.197.34.86 20060111174224\n&gt; image/png 2160\n&gt; \n&gt; Stacktrace: java.io.IOException: Metadata line doesn&#39;t match expected\n&gt; pattern: http://www.aandw.net/images/walden2.png 128.197.34.86\n&gt; 20060111174224 image/png 2160\n&gt; \n&gt;          at \n&gt; org.archive.io.arc.ARCWriter.validateMetaLine(ARCWriter.java:793)\n&gt;          at org.archive.io.arc.ARCWriter.getMetaLine(ARCWriter.java:764)\n&gt;          at org.archive.io.arc.ARCWriter.write(ARCWriter.java:687)\n&gt;          at\n\nOdd.  I passed the &#39;problematic&#39; meta line by a unit test that tests the \nvalidate metadata line code and it passes fine.\n\nI tried crawling the URL mentioned in the meta line and it works too.\n\nSo, looking at the regex, &quot;^&#92;&#92;S+ &#92;&#92;S+ &#92;&#92;S+ &#92;&#92;S+ &#92;&#92;S+(&quot; + LINE_SEPARATOR \n+ &quot;?)$&quot; where LINE_SEPARATOR = &#39;&#92;n&#39;, I&#39;m guessing we&#39;re failing because \nwe&#39;re not matching on end-of-line.\n\nTell me more about this new platform that you&#39;ve moved Heritrix to? \nWindows?\n\nIf you look in logs, say heritrix_out.log, the raw exception might show \ncharacters at end of the metadata line -- perhaps &#39;&#92;r&#92;n&#39;?\n\nSt.Ack\n\n\n&gt; org.archive.crawler.writer.ARCWriterProcessor.write(ARCWriterProcessor.java:475)\n&gt;          at\n&gt; org.archive.crawler.writer.ARCWriterProcessor.writeHttp(ARCWriterProcessor.java:417)\n&gt;          at\n&gt; org.archive.crawler.writer.ARCWriterProcessor.innerProcess(ARCWriterProcessor.java:394)\n&gt;          at \n&gt; org.archive.crawler.framework.Processor.process(Processor.java:103)\n&gt;          at\n&gt; org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:306)\n&gt;          at org.archive.crawler.framework.ToeThread.run(ToeThread.java:153)\n&gt; \n&gt; Somehow the ARCWriter.METADATA_LINE_PATTERN isn&#39;t matching exactly with the\n&gt; metadata line.\n&gt; \n&gt; What ends up happening is that it writes the very first part of an ARC file\n&gt; (like below) gets the IOException, renames the file to *invalid, opens a\n&gt; new file and starts the process again. So it continues to write *invalid\n&gt; files with just the first part of the ARC file until you see all the alerts\n&gt; and stop it.\n&gt; \n&gt; The only part that gets written to each ARC file:\n&gt; [andreag@chaz unzipped]$ more \n&gt; IAH-20060110181306-00028-chaz.hul.harvard.edu.arc\n&gt; filedesc://IAH-20060110181306-00028-chaz.hul.harvard.edu.arc 0.0.0.0\n&gt; 20060110181306 text/plain 1214\n&gt; 1 1 InternetArchive\n&gt; URL IP-address Archive-date Content-type Archive-length\n&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;\n&gt; &lt;arcmetadata xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n&gt; xmlns:dcterms=&quot;http://purl.org/dc/terms/&quot;\n&gt; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot;\n&gt; xmlns:arc=&quot;http://archive.org/arc/1.0/&quot; xmlns=&quot;http://archive.org/arc/1.0/&quot;\n&gt; xsi:schemaLocation=&quot;http://archive.org/arc/1.0/\n&gt; http://www.archive.org/arc/1.0/arc.xsd&quot;&gt;\n&gt; &lt;arc:software&gt;Heritrix 1.6.0 http://crawler.archive.org&lt;/arc:software&gt;\n&gt; &lt;arc:hostname&gt;chaz.hul.harvard.edu&lt;/arc:hostname&gt;\n&gt; &lt;arc:ip&gt;128.103.151.249&lt;/arc:ip&gt;\n&gt; &lt;dcterms:isPartOf&gt;test2&lt;/dcterms:isPartOf&gt;\n&gt; &lt;dc:description&gt;Default Profile&lt;/dc:description&gt;\n&gt; &lt;arc:operator&gt;Admin&lt;/arc:operator&gt;\n&gt; &lt;dc:date xsi:type=&quot;dcterms:W3CDTF&quot;&gt;2006-01-10T18:11:55+00:00&lt;/dc:date&gt;\n&gt; &lt;arc:http-header-user-agent&gt;Mozilla/5.0 (compatible; heritrix/1.6.0\n&gt; +http://hul.harvard.edu/ois/)&lt;/arc:http-header-user-agent&gt;\n&gt; &lt;arc:http-header-from&gt;andrea_goethals@...&lt;/arc:http-header-from&gt;\n&gt; &lt;arc:robots&gt;classic&lt;/arc:robots&gt;\n&gt; &lt;dc:format&gt;ARC file version 1.1&lt;/dc:format&gt;\n&gt; &lt;dcterms:conformsTo\n&gt; xsi:type=&quot;dcterms:URI&quot;&gt;http://www.archive.org/web/researcher/ArcFileFormat.php&lt;/dcterms:conformsTo&gt;\n&gt; &lt;/arcmetadata&gt;\n&gt; \n&gt; \n&gt; \n&gt; Andrea\n&gt; \n&gt; \n&gt;  &gt;St.Ack\n&gt;  &gt;\n&gt;  &gt;\n&gt;  &gt;Andrea Goethals wrote:\n&gt;  &gt; &gt; Hello,\n&gt;  &gt; &gt;\n&gt;  &gt; &gt; I recently changed the machine I am doing crawls on. Now every time \n&gt; I try\n&gt;  &gt; &gt; to run a crawl I get a NullPointerException - even doing the Charset\n&gt;  &gt; &gt; self-test. These are the kind of entries I&#39;m getting in my console &\n&gt;  &gt; &gt; heritrix_out.log:\n&gt;  &gt; &gt;\n&gt;  &gt; &gt; Message:\n&gt;  &gt; &gt;\n&gt;  &gt; &gt; Problem java.lang.NullPointerException occured when trying to process\n&gt;  &gt; &gt; &#39;http://127.0.0.1:8181/robots.txt&#39;\n&gt;  &gt; &gt; &lt;http://127.0.0.1:8181/robots.txt%27&gt; at step ABOUT_TO_BEGIN_PROCESSOR\n&gt;  &gt; &gt; in Archiver\n&gt;  &gt; &gt; (in processor Archiver)\n&gt;  &gt; &gt;\n&gt;  &gt; &gt; java.lang.NullPointerException\n&gt;  &gt; &gt; Stacktrace: java.lang.NullPointerException\n&gt;  &gt; &gt;       at\n&gt;  &gt; &gt;\n&gt;  &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.write(ARCWriterProcessor.java:492)\n&gt;  &gt; &gt;       at\n&gt;  &gt; &gt;\n&gt;  &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.writeHttp(ARCWriterProcessor.java:417)\n&gt;  &gt; &gt;       at\n&gt;  &gt; &gt;\n&gt;  &gt; \n&gt; org.archive.crawler.writer.ARCWriterProcessor.innerProcess(ARCWriterProcessor.java:394)\n&gt;  &gt; &gt;       at\n&gt;  &gt; &gt; org.archive.crawler.framework.Processor.process(Processor.java:103)\n&gt;  &gt; &gt;       at\n&gt;  &gt; &gt; \n&gt; org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:306)\n&gt;  &gt; &gt;       at \n&gt; org.archive.crawler.framework.ToeThread.run(ToeThread.java:153)\n&gt;  &gt; &gt;\n&gt;  &gt; &gt;\n&gt;  &gt; &gt; I can kind of see from the source why the NullPointerException might be\n&gt;  &gt; &gt; thrown. In the ArcWriterProcessor when an IOException is thrown, on \n&gt; line\n&gt;  &gt; &gt; 489 the writer is being set to null. Then in the finally clause on\n&gt;  &gt; &gt; line 492\n&gt;  &gt; &gt; it tries to call getPosition() on the null writer.\n&gt;  &gt; &gt;\n&gt;  &gt; &gt; The arc files are being written with the invalid suffix. I don&#39;t \n&gt; know why\n&gt;  &gt; &gt; the IOException occurs if that is what&#39;s happening. I was able to do\n&gt;  &gt; &gt; crawls\n&gt;  &gt; &gt; on a different machine (both linux, both heritrix 1.6). Any help is\n&gt;  &gt; &gt; appreciated.\n&gt;  &gt; &gt;\n&gt;  &gt; &gt; thanks,\n&gt;  &gt; &gt; Andrea\n&gt;  &gt; &gt;\n&gt;  &gt; &gt;\n&gt;  &gt; &gt;\n&gt; \n&gt; \n&gt; \n&gt; ------------------------------------------------------------------------\n&gt; YAHOO! GROUPS LINKS\n&gt; \n&gt;     *  Visit your group &quot;archive-crawler\n&gt;       &lt;http://groups.yahoo.com/group/archive-crawler&gt;&quot; on the web.\n&gt;        \n&gt;     *  To unsubscribe from this group, send an email to:\n&gt;        archive-crawler-unsubscribe@yahoogroups.com\n&gt;       &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt;\n&gt;        \n&gt;     *  Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;. \n&gt; \n&gt; \n&gt; ------------------------------------------------------------------------\n&gt; \n\n\n"}}