{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":325624130,"authorName":"Noah Levitt","from":"Noah Levitt &lt;nlevitt@...&gt;","profile":"nlevitt","replyTo":"LIST","senderId":"nuWCUTNLoe3pPi4fhDvIxFElzNPhliPU4TOwGJiR8oIESvTmm09cPAf6fE_oaXVZZKoGYEuO3whk_8nqEXlEGFXE9XfH6vMv","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] Retrieving Non-Text Data from CrawlURI&#39;s ReplayInputStream","postDate":"1316404967","msgId":7321,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDRFNzZCRUU3LjQwOTAwMDBAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGo1NXFqdSsyb2oyQGVHcm91cHMuY29tPg==","referencesHeader":"PGo1NXFqdSsyb2oyQGVHcm91cHMuY29tPg=="},"prevInTopic":7320,"nextInTopic":7322,"prevInTime":7320,"nextInTime":7322,"topicId":7320,"numMessagesInTopic":4,"msgSnippet":"Hello Miles, A possible cause of your problem is that Reader implementations like InputStreamReader assume the input is text. It looks like there s another","rawEmail":"Return-Path: &lt;nlevitt@...&gt;\r\nX-Sender: nlevitt@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 10501 invoked from network); 19 Sep 2011 04:02:49 -0000\r\nX-Received: from unknown (98.137.35.160)\n  by m11.grp.sp2.yahoo.com with QMQP; 19 Sep 2011 04:02:49 -0000\r\nX-Received: from unknown (HELO mail.archive.org) (207.241.224.6)\n  by mta4.grp.sp2.yahoo.com with SMTP; 19 Sep 2011 04:02:49 -0000\r\nX-Received: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id EB45A684103F;\n\tSun, 18 Sep 2011 21:02:45 -0700 (PDT)\r\nX-Received: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id x2PJAbfcTuZ1; Sun, 18 Sep 2011 21:02:45 -0700 (PDT)\r\nX-Received: from Noah-Levitts-MacBook-Pro.local (c-174-62-77-252.hsd1.ca.comcast.net [174.62.77.252])\n\tby mail.archive.org (Postfix) with ESMTPSA id E199A6840143;\n\tSun, 18 Sep 2011 21:02:44 -0700 (PDT)\r\nMessage-ID: &lt;4E76BEE7.4090000@...&gt;\r\nDate: Sun, 18 Sep 2011 21:02:47 -0700\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:6.0) Gecko/20110812 Thunderbird/6.0\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: cmiles74 &lt;twitch@...&gt;\r\nReferences: &lt;j55qju+2oj2@...&gt;\r\nIn-Reply-To: &lt;j55qju+2oj2@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Noah Levitt &lt;nlevitt@...&gt;\r\nSubject: Re: [archive-crawler] Retrieving Non-Text Data from CrawlURI&#39;s ReplayInputStream\r\nX-Yahoo-Group-Post: member; u=325624130; y=LjS-vaGoDJNVChXULXjzMMUU_I9nw789d4OEedznHgug4w\r\nX-Yahoo-Profile: nlevitt\r\n\r\nHello Miles,\n\nA possible cause of your problem is that Reader implementations like InputStreamReader assume the input is text. It looks like there&#39;s another IOUtils.toByteArray() method that takes an InputStream, so this might do the trick:\n\nbyte[] bytesResponse = IOUtils.toByteArray(crawluri.getRecorder().getContentReplayInputStream());\n\nIf that doesn&#39;t work I&#39;d recommend comparing the stored data with the expected data to try to get an idea of what might be happening. Compare the sizes for starters, and inspect hex dumps side by side.\n\nAs an aside, if Riak can accept input from a stream, it would be preferable to use that api. You run the risk of exhausting available memory when you load arbitrarily large files into byte arrays.\n\nNoah\n\n\nOn 2011-09-18 15:16 , cmiles74 wrote:\n&gt;\n&gt;\n&gt; Hello,\n&gt;\n&gt; I&#39;m trying to code-up my own writer that stores the crawled data in buckets in a Riak cluster instead of writing the data to a WARC file. This code is mostly working in that HTML and plain-text content are being correctly stored. Binary content (specifically PDF files) are not working so well, they are being garbled along the way.\n&gt;\n&gt; I&#39;m using the following code to fetch this data from the CrawlURI instance:\n&gt;\n&gt; InputStreamReader reader =\n&gt; new InputStreamReader(crawluri.getRecorder().getContentReplayInputStream());\n&gt; byte[] bytesResponse = IOUtils.toByteArray(reader);\n&gt; inputstreamResponse.close();\n&gt;\n&gt; I&#39;m then storing this data i n Riak as a ByteArray. When I pull the data back out, it&#39;s clearly garbled. These are PDF files and while they open in a PDF reader, all of the pages are blank. I&#39;m not sure where I might be going wrong.\n&gt;\n&gt; Does this approach seem reasonable? Any help or feedback would be greatly appreciated.\n&gt;\n&gt; Thank you\n&gt; --\n&gt; Miles\n&gt;\n&gt;\n&gt; \n\n"}}