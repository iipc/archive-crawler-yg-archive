{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":207498816,"authorName":"ogrenholm","from":"&quot;ogrenholm&quot; &lt;oskar.grenholm@...&gt;","profile":"ogrenholm","replyTo":"LIST","senderId":"A45HQcgMW7WEpbpv-20e-UiRQDUT6EgbYv4TfeAV2wNdD-4vVcy6PmjGzX1eevfKo0dlQBOMk6YnFNb2eqhqygQQV76MUr-T7Q","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: limiting # of documents dowloaded per site","postDate":"1102246514","msgId":1251,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PGNvdXJwaSt2NTYxQGVHcm91cHMuY29tPg==","inReplyToHeader":"PDQxQjBDODdGLjYwMTAxMDFAYXJjaGl2ZS5vcmc+"},"prevInTopic":1249,"nextInTopic":1259,"prevInTime":1250,"nextInTime":1253,"topicId":1235,"numMessagesInTopic":20,"msgSnippet":"Hey, I did reply to this just shortly before I left for the weekend, but it seems that the reply didn t make it (hope this one do). And yeah, it doesn t work","rawEmail":"Return-Path: &lt;oskar.grenholm@...&gt;\r\nX-Sender: oskar.grenholm@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 37520 invoked from network); 5 Dec 2004 11:35:56 -0000\r\nReceived: from unknown (66.218.66.218)\n  by m11.grp.scd.yahoo.com with QMQP; 5 Dec 2004 11:35:56 -0000\r\nReceived: from unknown (HELO n18a.bulk.scd.yahoo.com) (66.94.237.47)\n  by mta3.grp.scd.yahoo.com with SMTP; 5 Dec 2004 11:35:56 -0000\r\nReceived: from [66.218.66.58] by n18.bulk.scd.yahoo.com with NNFMP; 05 Dec 2004 11:35:21 -0000\r\nReceived: from [66.218.67.145] by mailer7.bulk.scd.yahoo.com with NNFMP; 05 Dec 2004 11:35:21 -0000\r\nDate: Sun, 05 Dec 2004 11:35:14 -0000\r\nTo: archive-crawler@yahoogroups.com\r\nMessage-ID: &lt;courpi+v561@...&gt;\r\nIn-Reply-To: &lt;41B0C87F.6010101@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Length: 11242\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Remote-IP: 66.94.237.47\r\nFrom: &quot;ogrenholm&quot; &lt;oskar.grenholm@...&gt;\r\nSubject: Re: limiting # of documents dowloaded per site\r\nX-Yahoo-Group-Post: member; u=207498816\r\nX-Yahoo-Profile: ogrenholm\r\n\r\n\nHey, I did reply to this just shortly before I left for the weekend, \nbut it seems that the reply didn&#39;t make it (hope this one do).\n\nAnd yeah, it doesn&#39;t work now, but it sure did when I tested it back \non 1.0. But since I set up the job I wanted it to do (downloading \nthe frontpage of all Swedish online newspapers) I haven&#39;t looked att \nin anymore.\n\nBut now I had a look at this at Friday and I think the problem is \nthat the method deleteMatchedItems() in TieredQueue.java doesn&#39;t \nupdate the length of the queue and therefore when asked if it&#39;s \nempty answers no. One solution might be to add a call to \nrecalculateLength() in deleteMatchedItems(), just before it returns, \ni.e. \npublic long deleteMatchedItems(Predicate matcher) {\n        long count = 0;\n        for (int i = 0; i &lt;= lastQueue; i++) {\n            count += innerQueues[i].deleteMatchedItems(matcher);\n        }\n        recalculateLength();  //ADDED\n        return count;\n    }\n \nI did this and it seems to work (only basic testing, then weekend). \nIf someone think this is a bad idea (yes, I mean you Stack) or has a \nbetter solution, please let me know.\n\n/Oskar\n\nPs. I have a better look at this on Monday. Ds.\n\n--- In archive-crawler@yahoogroups.com, stack &lt;stack@a...&gt; wrote:\n&gt; robeger wrote:\n&gt; \n&gt; &gt;\n&gt; &gt; Just tried this out.  It seems that the crawl never &quot;finishes&quot;.  \nTried\n&gt; &gt; it on a single URL, limiting it to 10 docs for that site.  Once \nit\n&gt; &gt; reaches 10, it starts giving -6000 as the status code for \nsubsequent\n&gt; &gt; pages, but the crawl never finishes, console just sits at &quot;13 of \n39\n&gt; &gt; DOWNLOADED/QUEUED RATIO&quot;.  It also seems to count docs from\n&gt; &gt; macromedia.com as part of the 10.  If I switch back to the \ndefault\n&gt; &gt; frontier, it crawls the site and finishes.\n&gt; \n&gt; \n&gt; &lt;&gt;The way that the DomainSensitiveFrontier works is that when it \nhits the\n&gt; max-docs-for-this-domain threshold, it marks all remaining queued \nURLs as\n&gt; &#39;deleted&#39;. But Frontier continues to run. As it comes across these\n&gt; deleted URLs that are still in the queue, it discards them logging \nas\n&gt; crawl.log -- the -6000s (&#39;Deleted from Frontier by user&#39;).\n&gt; \n&gt; That the crawl never finishes is a bug (I just tried it and had \nsame issue.\n&gt; Is your heritrix_out.log filled with exceptions?). I made an issue \nto cover\n&gt; this: &#39;[ 1078581 ] DomainSensitiveFrontier never finishes&#39;.  Let \nme see if\n&gt; we can get the fella that donated this Frontier to fix it.\n&gt; \n&gt; (The macromedias being counted has to do with your scope settings.\n&gt; Try changing max-embed-hops)\n&gt; \n&gt; St.Ack\n&gt; \n&gt; \n&gt; \n&gt; &gt;\n&gt; &gt; seed: http://www.aptas.com\n&gt; &gt; DomainSensitiveFrontier\n&gt; &gt; HostScope\n&gt; &gt; midfetch text/html content-type filter\n&gt; &gt; Tom&#39;s filetype exclude filter\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; Here&#39;s the crawl log:\n&gt; &gt;\n&gt; &gt; 20041202181418695     1         56 dns:www.aptas.com P\n&gt; &gt; http://www.aptas.com/ text/dns #002 1 - -\n&gt; &gt; 20041202181420811   404        274 \nhttp://www.aptas.com/robots.txt P\n&gt; &gt; http://www.aptas.com/ text/html #002 110\n&gt; &gt; TA7E5YOEVDKWKDAY3OMY3UZIRJ5HAC37 -\n&gt; &gt; 20041202181422845   200       2919 http://www.aptas.com/ - - \ntext/html\n&gt; &gt; #002 26 OZCPJFDKCIKBZGCYJBL3T5YGOIFFC7F3 3t\n&gt; &gt; 20041202181422898     1         65 dns:download.macromedia.com EP\n&gt; &gt; \nhttp://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab\n&gt; &gt; text/dns #006 0 - -\n&gt; &gt; 20041202181424934   200       3792\n&gt; &gt; http://www.aptas.com/about/index.html L http://www.aptas.com/\n&gt; &gt; text/html #002 85 6L3D4EUYU7TFYYZDZUDTANNIKAXVPZSJ -\n&gt; &gt; 20041202181425028   404        299\n&gt; &gt; http://download.macromedia.com/robots.txt EP\n&gt; &gt; \nhttp://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab\n&gt; &gt; text/html #013 116 Y7Z537IX2DEPQSPGQMEYQVX54EJTTFVY -\n&gt; &gt; 20041202181426979   200       2855\n&gt; &gt; http://www.aptas.com/contact/index.html L http://www.aptas.com/\n&gt; &gt; text/html #002 30 JTF7REDEPNFDR4OGNTDLWI5LDYUSJO7C -\n&gt; &gt; 20041202181427243   302        344\n&gt; &gt; \nhttp://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab E\n&gt; &gt; http://www.aptas.com/ text/html #002 204\n&gt; &gt; ZYDQROCFMD3AZWCGKEFG2ZXLMCEF2NH3 3t\n&gt; &gt; 20041202181427364     1        135 dns:fpdownload.macromedia.com \nERP\n&gt; &gt; \nhttp://fpdownload.macromedia.com/get/shockwave/cabs/flash/swflash.cab\n&gt; &gt; text/dns #002 86 - -\n&gt; &gt; 20041202181429025   200       3591\n&gt; &gt; http://www.aptas.com/solutions/index.html L http://www.aptas.com/\n&gt; &gt; text/html #035 36 O6ZJHW7HL73S4BN3PVCWCXGMVOWQAGKD -\n&gt; &gt; 20041202181429499   404        299\n&gt; &gt; http://fpdownload.macromedia.com/robots.txt ERP\n&gt; &gt; \nhttp://fpdownload.macromedia.com/get/shockwave/cabs/flash/swflash.cab\n&gt; &gt; text/html #008 117 Y7Z537IX2DEPQSPGQMEYQVX54EJTTFVY -\n&gt; &gt; 20041202181431094   200       5440\n&gt; &gt; http://www.aptas.com/about/news.html L http://www.aptas.com/ \ntext/html\n&gt; &gt; #004 55 FS46CN6PZXRGLD5VDS536E2GEY2BNGHY -\n&gt; &gt; 20041202181432143   200     487462\n&gt; &gt; \nhttp://fpdownload.macromedia.com/get/shockwave/cabs/flash/swflash.cab\n&gt; &gt; ER \nhttp://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab\n&gt; &gt; text/plain #035 634 IV6KIS7ADLQQM6USJKLYE7VNYLENRZ6O \nmidFetchAbort,3t\n&gt; &gt; 20041202181433099 -5000          -\n&gt; &gt; http://www.aptas.com/products/index.html L http://www.aptas.com/\n&gt; &gt; no-type #035 - - -\n&gt; &gt; 20041202181433100 -6000          - \nhttp://www.aptas.com/index.html LL\n&gt; &gt; http://www.aptas.com/about/index.html no-type #000 - - -\n&gt; &gt; 20041202181433100 -6000          -\n&gt; &gt; http://www.aptas.com/about/investors.html LL\n&gt; &gt; http://www.aptas.com/about/index.html no-type #000 - - -\n&gt; &gt; 20041202181433100 -6000          -\n&gt; &gt; http://www.aptas.com/about/board.html LL\n&gt; &gt; http://www.aptas.com/about/index.html no-type #000 - - -\n&gt; &gt; 20041202181433100 -6000          -\n&gt; &gt; http://www.aptas.com/about/management.html LL\n&gt; &gt; http://www.aptas.com/about/index.html no-type #000 - - -\n&gt; &gt; 20041202181433101 -6000          -\n&gt; &gt; http://www.aptas.com/about/partners.html LL\n&gt; &gt; http://www.aptas.com/about/index.html no-type #000 - - -\n&gt; &gt; 20041202181433101 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-gallinatti.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433101 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-sensis.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433101 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-perozzii.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433101 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-dexlaunch.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433101 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-aptas.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433101 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-ypsolutions.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433102 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-aptframe.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433102 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-dalton.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433102 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-batten.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433102 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-telecom.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433102 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-365media.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433102 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-walter.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433103 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-fast.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433103 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-dex.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt; 20041202181433103 -6000          -\n&gt; &gt; http://www.aptas.com/about/pr-moore.html LL\n&gt; &gt; http://www.aptas.com/about/news.html no-type #000 - - -\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; --- In archive-crawler@yahoogroups.com, stack &lt;stack@a...&gt; wrote:\n&gt; &gt; &gt; robeger wrote:\n&gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; I know you can put a max number of documents for a crawl, \nbut can you\n&gt; &gt; &gt; &gt; set a max number of documents per site?\n&gt; &gt; &gt;\n&gt; &gt; &gt; Take a look at the DomainSensitiveFrontier:\n&gt; &gt; &gt;\n&gt; &gt; \nhttp://crawler.archive.org/xref/org/archive/crawler/frontier/DomainSe\nnsitiveFrontier.html.\n&gt; &gt;\n&gt; &gt; &gt; Here is from its description:\n&gt; &gt; &gt;\n&gt; &gt; &gt; 41\n&gt; &gt; \n&lt;http://crawler.archive.org/xref/org/archive/crawler/frontier/DomainS\nensitiveFrontier.html#41&gt;\n&gt; &gt; / * Behaves like {@link HostQueuesFrontier} (i.e., a basic mostly\n&gt; &gt; breadth-first frontier),/\n&gt; &gt; &gt; 42\n&gt; &gt; \n&lt;http://crawler.archive.org/xref/org/archive/crawler/frontier/DomainS\nensitiveFrontier.html#42&gt;\n&gt; &gt; / * but with the addition that you can override the number of\n&gt; &gt; documents to/\n&gt; &gt; &gt; 43\n&gt; &gt; \n&lt;http://crawler.archive.org/xref/org/archive/crawler/frontier/DomainS\nensitiveFrontier.html#43&gt;\n&gt; &gt; / * download for a specific host or domain.  Useful for case of \nfrequent/\n&gt; &gt; &gt; 44\n&gt; &gt; \n&lt;http://crawler.archive.org/xref/org/archive/crawler/frontier/DomainS\nensitiveFrontier.html#44&gt;\n&gt; &gt; / * revisits of a site of frequent changes.\n&gt; &gt; &gt;\n&gt; &gt; &gt; St.Ack\n&gt; &gt; &gt; /\n&gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Thanks,\n&gt; &gt; &gt; &gt; Rob Eger\n&gt; &gt; &gt; &gt; Aptas, Inc.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; *Yahoo! Groups Sponsor*\n&gt; &gt; &gt; &gt; ADVERTISEMENT\n&gt; &gt; &gt; &gt; click here\n&gt; &gt; &gt; &gt;\n&gt; &gt; \n&lt;http://us.ard.yahoo.com/SIG=1299fh1gb/M=298184.5639630.6699735.30011\n76/D=groups/S=1705004924:HM/EXP=1102026902/A=2434971/R=0/SIG=11eeoolb\n0/*http://www.netflix.com/Default?mqso=60185400&gt;\n&gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; -----------------------------------------------------------------\n-------\n&gt; &gt; &gt; &gt; *Yahoo! Groups Links*\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;     * To visit your group on the web, go to:\n&gt; &gt; &gt; &gt;       http://groups.yahoo.com/group/archive-crawler/\n&gt; &gt; &gt; &gt;       \n&gt; &gt; &gt; &gt;     * To unsubscribe from this group, send an email to:\n&gt; &gt; &gt; &gt;       archive-crawler-unsubscribe@yahoogroups.com\n&gt; &gt; &gt; &gt;     \n&gt; &gt; &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?\nsubject=Unsubscribe&gt;\n&gt; &gt; &gt; &gt;       \n&gt; &gt; &gt; &gt;     * Your use of Yahoo! Groups is subject to the Yahoo! \nTerms of\n&gt; &gt; &gt; &gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; *Yahoo! Groups Sponsor*\n&gt; &gt; ADVERTISEMENT\n&gt; &gt; click here \n&gt; &gt; \n&lt;http://us.ard.yahoo.com/SIG=1290rkj35/M=294855.5468653.6549235.30011\n76/D=groups/S=1705004924:HM/EXP=1102098368/A=2376776/R=0/SIG=11ldm1jv\nc/*http://promotions.yahoo.com/ydomains2004/index.html&gt; \n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; -----------------------------------------------------------------\n-------\n&gt; &gt; *Yahoo! Groups Links*\n&gt; &gt;\n&gt; &gt;     * To visit your group on the web, go to:\n&gt; &gt;       http://groups.yahoo.com/group/archive-crawler/\n&gt; &gt;        \n&gt; &gt;     * To unsubscribe from this group, send an email to:\n&gt; &gt;       archive-crawler-unsubscribe@yahoogroups.com\n&gt; &gt;       &lt;mailto:archive-crawler-unsubscribe@yahoogroups.com?\nsubject=Unsubscribe&gt;\n&gt; &gt;        \n&gt; &gt;     * Your use of Yahoo! Groups is subject to the Yahoo! Terms of\n&gt; &gt;       Service &lt;http://docs.yahoo.com/info/terms/&gt;.\n&gt; &gt;\n&gt; &gt;\n\n\n\n\n"}}