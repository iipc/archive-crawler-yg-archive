{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":325624130,"authorName":"Noah Levitt","from":"Noah Levitt &lt;nlevitt@...&gt;","profile":"nlevitt","replyTo":"LIST","senderId":"IU5r6Nx4wuoS4BpteRgbf_LPulrLgm1aC7d27x21QwnFcw7gAIjoOlCawsk6eInIWvouOmUZ0LR0QcSMeqdePxvbx_0dmZ6D","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] WARCWriter and empty payload","postDate":"1345598049","msgId":7751,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDUwMzQzMjYxLjkwMDA5MDRAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PDU2MkUxOTBEOTJFODkxNDg4NDFCREYwNTVENjQyQzg0MUQ0MzM0RkVARVhDSEFOR0UtMDEua2IuZGs+","referencesHeader":"PDU2MkUxOTBEOTJFODkxNDg4NDFCREYwNTVENjQyQzg0MUQ0MzM0RkVARVhDSEFOR0UtMDEua2IuZGs+"},"prevInTopic":7750,"nextInTopic":7752,"prevInTime":7750,"nextInTime":7752,"topicId":7750,"numMessagesInTopic":3,"msgSnippet":"Hello Nicholas, Do you have a test case for that? There are a number of things that could be considered a record with empty payload. I tried to reproduce with","rawEmail":"Return-Path: &lt;nlevitt@...&gt;\r\nX-Sender: nlevitt@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 44565 invoked from network); 22 Aug 2012 01:14:12 -0000\r\nX-Received: from unknown (98.137.35.161)\n  by m16.grp.sp2.yahoo.com with QMQP; 22 Aug 2012 01:14:12 -0000\r\nX-Received: from unknown (HELO mail.archive.org) (207.241.224.6)\n  by mta5.grp.sp2.yahoo.com with SMTP; 22 Aug 2012 01:14:12 -0000\r\nX-Received: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 2F5866841040;\n\tTue, 21 Aug 2012 18:14:12 -0700 (PDT)\r\nX-Received: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id GRLnyBz6Oeln; Tue, 21 Aug 2012 18:14:10 -0700 (PDT)\r\nX-Received: from [208.70.27.155] (desktop-nlevitt.sf.archive.org [208.70.27.155])\n\tby mail.archive.org (Postfix) with ESMTPSA id E24996841039;\n\tTue, 21 Aug 2012 18:14:09 -0700 (PDT)\r\nMessage-ID: &lt;50343261.9000904@...&gt;\r\nDate: Tue, 21 Aug 2012 18:14:09 -0700\r\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:14.0) Gecko/20120714 Thunderbird/14.0\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: Nicholas Clarke &lt;nicl@...&gt;\r\nReferences: &lt;562E190D92E89148841BDF055D642C841D4334FE@...&gt;\r\nIn-Reply-To: &lt;562E190D92E89148841BDF055D642C841D4334FE@...&gt;\r\nContent-Type: multipart/alternative;\n boundary=&quot;------------060408050201020200090309&quot;\r\nFrom: Noah Levitt &lt;nlevitt@...&gt;\r\nSubject: Re: [archive-crawler] WARCWriter and empty payload\r\nX-Yahoo-Group-Post: member; u=325624130; y=-sd5rwLp3bL6Oq8FiNTO7fUa3S7m5TZ3BO8xwTCKkMu0cQ\r\nX-Yahoo-Profile: nlevitt\r\n\r\n\r\n--------------060408050201020200090309\r\nContent-Type: text/plain; charset=us-ascii; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\n\r\nHello Nicholas,\n\nDo you have a test case for that?\n\nThere are a number of things that could be considered a record with \nempty payload. I tried to reproduce with the h3 WARCWriter using this code:\n\nANVLRecord headers = new ANVLRecord(1);\nheaders.addLabelValue(NAMED_FIELD_IP_LABEL, &quot;127.0.0.1&quot;);\nw.writeResourceRecord(&quot;http://example.org/empty&quot;,\nArchiveUtils.get14DigitDate(), &quot;text/plain&quot;, headers,\nnew ByteArrayInputStream(new byte[0]), 0);\n\nFound that it WARCWriter.createRecordHeader() chooses not to write a \ncontent-type header because the content length is 0. WARCReader chokes \nbecause it expects the content-type header. I don&#39;t know if it&#39;s worth \nworrying about that because it may not ever happen in the wild. But in \nany case it doesn&#39;t match your description of the problem.\n\nNoah\n\nOn 08/21/2012 09:21 AM, Nicholas Clarke wrote:\n&gt;\n&gt;\n&gt; Hello all\n&gt;\n&gt; When using the H1 WarcWriter to write a record with empty(=0) payload \n&gt; it somehow forgets to write a CRLF pair after the WARC header or in \n&gt; the 2 trailing CRLF pairs.\n&gt;\n&gt; Is this only a H1 problem?\n&gt;\n&gt; And is there a workaround short of extending the WARCWriter and making \n&gt; a method for this special case.\n&gt;\n&gt; PS: Trying to read the buggy record with ArchiveReader kills the reader.\n&gt;\n&gt; -Nicholas\n&gt;\n&gt; ------------------------------------------------------------------------------\n&gt;\n&gt; Nicholas Clarke, Software Developer\n&gt;\n&gt; Department of Digital Preservation, Royal Library, Copenhagen, Denmark\n&gt;\n&gt; tlf: (+45) 33 47 48 38\n&gt;\n&gt; email: nicl@... &lt;mailto:svc@...&gt;\n&gt;\n&gt; ------------------------------------------------------------------------------\n&gt;\n&gt; Building complex programs one state machine at a time.\n&gt;\n&gt;\n&gt;\n&gt; \n\n\r\n--------------060408050201020200090309\r\nContent-Type: text/html; charset=us-ascii\r\nContent-Transfer-Encoding: 7bit\r\n\r\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta content=&quot;text/html; charset=us-ascii&quot;\n      http-equiv=&quot;Content-Type&quot;&gt;\n  &lt;/head&gt;\n  &lt;body text=&quot;#000000&quot; bgcolor=&quot;#FFFFFF&quot;&gt;\n    &lt;div class=&quot;moz-cite-prefix&quot;&gt;Hello Nicholas,&lt;br&gt;\n      &lt;br&gt;\n      Do you have a test case for that? &lt;br&gt;\n      &lt;br&gt;\n      There are a number of things that could be considered a record\n      with empty payload. I tried to reproduce with the h3 WARCWriter\n      using this code:&lt;br&gt;\n      &lt;br&gt;\n      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ANVLRecord headers = new ANVLRecord(1);&lt;br&gt;\n      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; headers.addLabelValue(NAMED_FIELD_IP_LABEL, &quot;127.0.0.1&quot;);&lt;br&gt;\n      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.writeResourceRecord(&lt;a class=&quot;moz-txt-link-rfc2396E&quot; href=&quot;http://example.org/empty&quot;&gt;&quot;http://example.org/empty&quot;&lt;/a&gt;,&lt;br&gt;\n      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ArchiveUtils.get14DigitDate(), &quot;text/plain&quot;,\n      headers,&lt;br&gt;\n      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ByteArrayInputStream(new byte[0]), 0);&lt;br&gt;\n      &lt;br&gt;\n      Found that it WARCWriter.createRecordHeader() chooses not to write\n      a content-type header because the content length is 0. WARCReader\n      chokes because it expects the content-type header. I don&#39;t know if\n      it&#39;s worth worrying about that because it may not ever happen in\n      the wild. But in any case it doesn&#39;t match your description of the\n      problem.&lt;br&gt;\n      &lt;br&gt;\n      Noah&lt;br&gt;\n      &lt;br&gt;\n      On 08/21/2012 09:21 AM, Nicholas Clarke wrote:&lt;br&gt;\n    &lt;/div&gt;\n    &lt;blockquote\n      cite=&quot;mid:562E190D92E89148841BDF055D642C841D4334FE@...&quot;\n      type=&quot;cite&quot;&gt;\n      &lt;style type=&quot;text/css&quot;&gt;\n&lt;!--\n\n/* start of attachment style */\n       .ygrp-photo-title{\n         clear: both;\n         font-size: smaller;\n         height: 15px;\n         overflow: hidden;\n         text-align: center;\n         width: 75px;\n       }\n       div.ygrp-photo{\n         background-position: center;\n         background-repeat: no-repeat;\n         background-color: white;\n         border: 1px solid black;\n         height: 62px;\n         width: 62px;\n       }\n\n       div.photo-title \n         a,\n         div.photo-title a:active,\n         div.photo-title a:hover,\n         div.photo-title a:visited {\n           text-decoration: none; \n       }\n\n       div.attach-table div.attach-row {\n         clear: both;\n       }\n\n       div.attach-table div.attach-row div {\n         float: left;\n         /* margin: 2px;*/\n       }\n\n       p {\n         clear: both;\n         padding: 15px 0 3px 0;\n\t overflow: hidden;\n       }\n\n       div.ygrp-file {\n         width: 30px;\n         valign: middle;\n       }\n       div.attach-table div.attach-row div div a {\n         text-decoration: none;\n       }\n\n       div.attach-table div.attach-row div div span {\n         font-weight: normal;\n       }\n\n       div.ygrp-file-title {\n         font-weight: bold;\n       }\n /* end of attachment style */\n        --&gt;\n        &lt;/style&gt;\n      &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;\n        charset=us-ascii&quot;&gt;\n      &lt;meta name=&quot;Generator&quot; content=&quot;Microsoft Word 12 (filtered\n        medium)&quot;&gt;\n      &lt;style&gt;&lt;!--\n/* Font Definitions */\n@font-face\n\t{font-family:&quot;Cambria Math&quot;;\n\tpanose-1:2 4 5 3 5 4 6 3 2 4;}\n@font-face\n\t{font-family:Calibri;\n\tpanose-1:2 15 5 2 2 2 4 3 2 4;}\n@font-face\n\t{font-family:Consolas;\n\tpanose-1:2 11 6 9 2 2 4 3 2 4;}\n/* Style Definitions */\np.MsoNormal, li.MsoNormal, div.MsoNormal\n\t{margin:0cm;\n\tmargin-bottom:.0001pt;\n\tfont-size:11.0pt;\n\tfont-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;}\na:link, span.MsoHyperlink\n\t{mso-style-priority:99;\n\tcolor:blue;\n\ttext-decoration:underline;}\na:visited, span.MsoHyperlinkFollowed\n\t{mso-style-priority:99;\n\tcolor:purple;\n\ttext-decoration:underline;}\nspan.EmailStyle17\n\t{mso-style-type:personal-compose;\n\tfont-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;\n\tcolor:windowtext;}\n.MsoChpDefault\n\t{mso-style-type:export-only;}\n@page WordSection1\n\t{size:612.0pt 792.0pt;\n\tmargin:72.0pt 72.0pt 72.0pt 72.0pt;}\ndiv.WordSection1\n\t{page:WordSection1;}\n--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;\n&lt;o:shapedefaults v:ext=&quot;edit&quot; spidmax=&quot;1026&quot; /&gt;\n&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;\n&lt;o:shapelayout v:ext=&quot;edit&quot;&gt;\n&lt;o:idmap v:ext=&quot;edit&quot; data=&quot;1&quot; /&gt;\n&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;\n      \n      &lt;div class=&quot;WordSection1&quot;&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;Hello all&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;When using the H1\n            WarcWriter to write a record with empty(=0) payload it\n            somehow forgets to write a CRLF pair after the WARC header\n            or in the 2 trailing CRLF pairs.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;Is this only a H1\n            problem?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;And is there a\n            workaround short of extending the WARCWriter and making a\n            method for this special case.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;PS: Trying to read the\n            buggy record with ArchiveReader kills the reader.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;-Nicholas&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span\n            style=&quot;font-size:10.5pt;font-family:Consolas&quot; lang=&quot;EN-US&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span\n            style=&quot;font-size:10.5pt;font-family:Consolas&quot; lang=&quot;EN-US&quot;&gt;------------------------------------------------------------------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;Nicholas Clarke,\n            Software Developer&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;Department of Digital\n            Preservation, Royal Library, Copenhagen, Denmark&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;tlf: (+45) 33 47 48 38&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;email: &lt;a\n              moz-do-not-send=&quot;true&quot; href=&quot;mailto:svc@...&quot;&gt;&lt;span\n                style=&quot;color:blue&quot;&gt;nicl@...&lt;/span&gt;&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span\n            style=&quot;font-size:10.5pt;font-family:Consolas&quot; lang=&quot;EN-US&quot;&gt;------------------------------------------------------------------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;Building complex\n            programs one state machine at a time.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n      &lt;/div&gt;\n      \n      &lt;div width=&quot;1&quot; style=&quot;color: white; clear: both;&quot;&gt;&lt;/div&gt;\n    &lt;/blockquote&gt;\n    &lt;br&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n\r\n--------------060408050201020200090309--\r\n\n"}}