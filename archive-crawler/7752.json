{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":526789874,"authorName":"Nicholas Clarke","from":"Nicholas Clarke &lt;nicl@...&gt;","replyTo":"LIST","senderId":"rCQ-qrGfYRuDK9B7sAiw0cdHIfvYcXb9hDuA0ooFb_jLGTgUnFnvKCfRwJOj24NONEwn3zLmz4aiIqEKS9Dd7AyWKg","spamInfo":{"isSpam":false,"reason":"6"},"subject":"SV: [archive-crawler] WARCWriter and empty payload","postDate":"1345638667","msgId":7752,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDU2MkUxOTBEOTJFODkxNDg4NDFCREYwNTVENjQyQzg0MUQ0Mzk5QURARVhDSEFOR0UtMDEua2IuZGs+","inReplyToHeader":"PDUwMzQzMjYxLjkwMDA5MDRAYXJjaGl2ZS5vcmc+","referencesHeader":"PDU2MkUxOTBEOTJFODkxNDg4NDFCREYwNTVENjQyQzg0MUQ0MzM0RkVARVhDSEFOR0UtMDEua2IuZGs+IDw1MDM0MzI2MS45MDAwOTA0QGFyY2hpdmUub3JnPg=="},"prevInTopic":7751,"nextInTopic":0,"prevInTime":7751,"nextInTime":7753,"topicId":7750,"numMessagesInTopic":3,"msgSnippet":"Hello Noah, The solution to my problem was to extend the WARCWriter and override the writeRecord method. Looking at the source in both H1 and H3 I understand","rawEmail":"Return-Path: &lt;nicl@...&gt;\r\nX-Sender: nicl@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 30976 invoked from network); 22 Aug 2012 12:31:09 -0000\r\nX-Received: from unknown (98.137.35.162)\n  by m10.grp.sp2.yahoo.com with QMQP; 22 Aug 2012 12:31:09 -0000\r\nX-Received: from unknown (HELO post.kb.dk) (130.226.229.20)\n  by mta6.grp.sp2.yahoo.com with SMTP; 22 Aug 2012 12:31:08 -0000\r\nX-Received: from localhost (localhost.localdomain [127.0.0.1])\n\tby post.kb.dk (Postfix) with ESMTP id C7C0F417147\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed, 22 Aug 2012 14:31:07 +0200 (CEST)\r\nX-Quarantine-ID: &lt;KxarEwI3fgw9&gt;\r\nX-Received: from post.kb.dk ([127.0.0.1])\n\tby localhost (post.kb.dk [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id KxarEwI3fgw9 for &lt;archive-crawler@yahoogroups.com&gt;;\n\tWed, 22 Aug 2012 14:31:07 +0200 (CEST)\r\nX-Received: from EXCHANGE-03.kb.dk (unknown [130.226.220.132])\n\tby post.kb.dk (Postfix) with ESMTP id B68F6417137\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed, 22 Aug 2012 14:31:07 +0200 (CEST)\r\nX-Received: from EXCHANGE-01.kb.dk ([fe80::f4ed:9e9f:7925:a8e2]) by\n EXCHANGE-03.kb.dk ([fe80::1c1e:10e0:ad3a:6c4b%17]) with mapi id\n 14.02.0298.004; Wed, 22 Aug 2012 14:31:07 +0200\r\nTo: &quot;archive-crawler@yahoogroups.com&quot; &lt;archive-crawler@yahoogroups.com&gt;\r\nThread-Topic: [archive-crawler] WARCWriter and empty payload\r\nThread-Index: Ac1/uRRuZUlrthyMSUyDnK3uDq01NwAOZZ+AABvOOjA=\r\nDate: Wed, 22 Aug 2012 12:31:07 +0000\r\nMessage-ID: &lt;562E190D92E89148841BDF055D642C841D4399AD@...&gt;\r\nReferences: &lt;562E190D92E89148841BDF055D642C841D4334FE@...&gt;\n &lt;50343261.9000904@...&gt;\r\nIn-Reply-To: &lt;50343261.9000904@...&gt;\r\nAccept-Language: en-US, da-DK\r\nContent-Language: da-DK\r\nX-MS-Has-Attach: yes\r\nX-MS-TNEF-Correlator:\r\nContent-Type: multipart/related;\n\tboundary=&quot;_004_562E190D92E89148841BDF055D642C841D4399ADEXCHANGE01kbdk_&quot;;\n\ttype=&quot;multipart/alternative&quot;\r\nMIME-Version: 1.0\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: Nicholas Clarke &lt;nicl@...&gt;\r\nSubject: SV: [archive-crawler] WARCWriter and empty payload\r\nX-Yahoo-Group-Post: member; u=526789874\r\n\r\n\r\n--_004_562E190D92E89148841BDF055D642C841D4399ADEXCHANGE01kbdk_\r\nContent-Type: multipart/alternative;\n\tboundary=&quot;_000_562E190D92E89148841BDF055D642C841D4399ADEXCHANGE01kbdk_&quot;\r\n\r\n\r\n--_000_562E190D92E89148841BDF055D642C841D4399ADEXCHANGE01kbdk_\r\nContent-Type: text/plain; charset=&quot;us-ascii&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nHello Noah,\n\nThe solution to my problem was to extend the WARCWriter and ov=\r\nerride the writeRecord method.\n\nLooking at the source in both H1 and H3 I u=\r\nnderstand why I&#39;m having this problem.\n\n--\n            if (contentStream !=\r\n=3D null && contentLength &gt; 0) {\n                // Write out the header/bo=\r\ndy separator.\n                write(CRLF_BYTES); // TODO: should this be wr=\r\nitten even for zero-length?\n                totalBytes +=3D CRLF_BYTES.leng=\r\nth;\n                contentBytes +=3D copyFrom(contentStream, contentLength=\r\n, enforceLength);\n                totalBytes +=3D contentBytes;\n           =\r\n }\n--\n\nFollowing the WARC standard that CRLF must always be written after a=\r\n WARC record header.\n\nWell it happened in NetArchiveSuite when using WARC i=\r\nnstead of ARC for our metadata files.\n\n-Nicholas\n\nFra: Noah Levitt [mailto:=\r\nnlevitt@...]\nSendt: 22. august 2012 03:14\nTil: archive-crawler@yaho=\r\nogroups.com\nCc: Nicholas Clarke\nEmne: Re: [archive-crawler] WARCWriter and =\r\nempty payload\n\nHello Nicholas,\n\nDo you have a test case for that?\n\nThere ar=\r\ne a number of things that could be considered a record with empty payload. =\r\nI tried to reproduce with the h3 WARCWriter using this code:\n\n        ANVLR=\r\necord headers =3D new ANVLRecord(1);\n        headers.addLabelValue(NAMED_FI=\r\nELD_IP_LABEL, &quot;127.0.0.1&quot;);\n        w.writeResourceRecord(&quot;http://example.o=\r\nrg/empty&quot;&lt;http://example.org/empty&gt;,\n                ArchiveUtils.get14Digi=\r\ntDate(), &quot;text/plain&quot;, headers,\n                new ByteArrayInputStream(ne=\r\nw byte[0]), 0);\n\nFound that it WARCWriter.createRecordHeader() chooses not =\r\nto write a content-type header because the content length is 0. WARCReader =\r\nchokes because it expects the content-type header. I don&#39;t know if it&#39;s wor=\r\nth worrying about that because it may not ever happen in the wild. But in a=\r\nny case it doesn&#39;t match your description of the problem.\n\nNoah\n\nOn 08/21/2=\r\n012 09:21 AM, Nicholas Clarke wrote:\n\n\n\nHello all\n\nWhen using the H1 WarcWr=\r\niter to write a record with empty(=3D0) payload it somehow forgets to write=\r\n a CRLF pair after the WARC header or in the 2 trailing CRLF pairs.\n\nIs thi=\r\ns only a H1 problem?\n\nAnd is there a workaround short of extending the WARC=\r\nWriter and making a method for this special case.\n\nPS: Trying to read the b=\r\nuggy record with ArchiveReader kills the reader.\n\n-Nicholas\n\n--------------=\r\n----------------------------------------------------------------\nNicholas C=\r\nlarke, Software Developer\nDepartment of Digital Preservation, Royal Library=\r\n, Copenhagen, Denmark\ntlf: (+45) 33 47 48 38\nemail: nicl@...&lt;mailto:svc@k=\r\nb.dk&gt;\n---------------------------------------------------------------------=\r\n---------\nBuilding complex programs one state machine at a time.\n\n\n\n\n\n\n\r\n--_000_562E190D92E89148841BDF055D642C841D4399ADEXCHANGE01kbdk_\r\nContent-Type: text/html; charset=&quot;us-ascii&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n&lt;html xmlns:v=3D&quot;urn:schemas-microsoft-com:vml&quot; xmlns:o=3D&quot;urn:schemas-micr=\r\nosoft-com:office:office&quot; xmlns:w=3D&quot;urn:schemas-microsoft-com:office:word&quot; =\r\nxmlns:m=3D&quot;http://schemas.microsoft.com/office/2004/12/omml&quot; xmlns=3D&quot;http:=\r\n//www.w3.org/TR/REC-html40&quot;&gt;\n&lt;head&gt;\n&lt;meta http-equiv=3D&quot;Content-Type&quot; conte=\r\nnt=3D&quot;text/html; charset=3Dus-ascii&quot;&gt;\n&lt;meta name=3D&quot;Generator&quot; content=3D&quot;M=\r\nicrosoft Word 12 (filtered medium)&quot;&gt;\n&lt;!--[if !mso]&gt;&lt;style&gt;v&#92;:* {behavior:ur=\r\nl(#default#VML);}\no&#92;:* {behavior:url(#default#VML);}\nw&#92;:* {behavior:url(#de=\r\nfault#VML);}\n.shape {behavior:url(#default#VML);}\n&lt;/style&gt;&lt;![endif]--&gt;&lt;styl=\r\ne&gt;&lt;!--\n/* Font Definitions */\n@font-face\n\t{font-family:&quot;Cambria Math&quot;;\n\tpan=\r\nose-1:2 4 5 3 5 4 6 3 2 4;}\n@font-face\n\t{font-family:Calibri;\n\tpanose-1:2 1=\r\n5 5 2 2 2 4 3 2 4;}\n@font-face\n\t{font-family:Tahoma;\n\tpanose-1:2 11 6 4 3 5=\r\n 4 4 2 4;}\n@font-face\n\t{font-family:Consolas;\n\tpanose-1:2 11 6 9 2 2 4 3 2 =\r\n4;}\n@font-face\n\t{font-family:Verdana;\n\tpanose-1:2 11 6 4 3 5 4 4 2 4;}\n/* S=\r\ntyle Definitions */\np.MsoNormal, li.MsoNormal, div.MsoNormal\n\t{margin:0cm;\n=\r\n\tmargin-bottom:.0001pt;\n\tfont-size:11.0pt;\n\tfont-family:&quot;Calibri&quot;,&quot;sans-ser=\r\nif&quot;;\n\tcolor:black;}\na:link, span.MsoHyperlink\n\t{mso-style-priority:99;\n\tcol=\r\nor:blue;\n\ttext-decoration:underline;}\na:visited, span.MsoHyperlinkFollowed\n=\r\n\t{mso-style-priority:99;\n\tcolor:purple;\n\ttext-decoration:underline;}\np\n\t{ms=\r\no-style-priority:99;\n\tmso-margin-top-alt:auto;\n\tmargin-right:0cm;\n\tmso-marg=\r\nin-bottom-alt:auto;\n\tmargin-left:0cm;\n\tfont-size:12.0pt;\n\tfont-family:&quot;Time=\r\ns New Roman&quot;,&quot;serif&quot;;\n\tcolor:black;}\np.ygrp-photo-title, li.ygrp-photo-titl=\r\ne, div.ygrp-photo-title\n\t{mso-style-name:ygrp-photo-title;\n\tmso-margin-top-=\r\nalt:auto;\n\tmargin-right:0cm;\n\tmso-margin-bottom-alt:auto;\n\tmargin-left:0cm;=\r\n\n\ttext-align:center;\n\tfont-size:10.0pt;\n\tfont-family:&quot;Times New Roman&quot;,&quot;ser=\r\nif&quot;;\n\tcolor:black;}\nspan.EmailStyle19\n\t{mso-style-type:personal;\n\tfont-fami=\r\nly:&quot;Calibri&quot;,&quot;sans-serif&quot;;\n\tcolor:windowtext;}\nspan.EmailStyle20\n\t{mso-styl=\r\ne-type:personal-reply;\n\tfont-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;\n\tcolor:#1F497D;=\r\n}\n.MsoChpDefault\n\t{mso-style-type:export-only;\n\tfont-size:10.0pt;}\n@page Wo=\r\nrdSection1\n\t{size:612.0pt 792.0pt;\n\tmargin:72.0pt 72.0pt 72.0pt 72.0pt;}\ndi=\r\nv.WordSection1\n\t{page:WordSection1;}\n--&gt;&lt;/style&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;\n&lt;o=\r\n:shapedefaults v:ext=3D&quot;edit&quot; spidmax=3D&quot;1026&quot; /&gt;\n&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if=\r\n gte mso 9]&gt;&lt;xml&gt;\n&lt;o:shapelayout v:ext=3D&quot;edit&quot;&gt;\n&lt;o:idmap v:ext=3D&quot;edit&quot; da=\r\nta=3D&quot;1&quot; /&gt;\n&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;\n&lt;/head&gt;\n&lt;body bgcolor=3D&quot;whi=\r\nte&quot; lang=3D&quot;DA&quot; link=3D&quot;blue&quot; vlink=3D&quot;purple&quot;&gt;\n&lt;div class=3D&quot;WordSection1&quot;=\r\n&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;Hello=\r\n Noah,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; st=\r\nyle=3D&quot;color:#1F497D&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;=\r\nspan lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;The solution to my problem was =\r\nto extend the WARCWriter and override the writeRecord method.&lt;o:p&gt;&lt;/o:p&gt;&lt;/s=\r\npan&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D=\r\n&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; =\r\nstyle=3D&quot;color:#1F497D&quot;&gt;Looking at the source in both H1 and H3 I understan=\r\nd why I&#8217;m having this problem.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoN=\r\normal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span=\r\n&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;-=\r\n-&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=\r\n=3D&quot;color:#1F497D&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=\r\nbsp;&nbsp; if (contentStream !=3D null &amp;&amp; contentLength &gt; 0) {&lt;o=\r\n:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;c=\r\nolor:#1F497D&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=\r\nnbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Write out the header/body separator.&lt;o:p&gt;&lt;=\r\n/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color=\r\n:#1F497D&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=\r\n;&nbsp;&nbsp;&nbsp;&nbsp; write(CRLF_BYTES); // TODO: should this be writte=\r\nn even for zero-length?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span =\r\nlang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; totalBytes &#43;=3D =\r\nCRLF_BYTES.length;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=\r\n=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=\r\np;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contentBytes &#43;=3D co=\r\npyFrom(contentStream, contentLength, enforceLength);&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n=\r\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;&nbsp;&=\r\nnbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=\r\np;&nbsp; totalBytes &#43;=3D contentBytes;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=\r\n=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;&nbsp;&nbsp;&nb=\r\nsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;=\r\n\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;--&lt;o:p=\r\n&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;col=\r\nor:#1F497D&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=\r\n=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;Following the WARC standard that CRLF mu=\r\nst always be written after a WARC record header.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p c=\r\nlass=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;&lt;o:p&gt;&nbsp;=\r\n&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;colo=\r\nr:#1F497D&quot;&gt;Well it happened in NetArchiveSuite when using WARC instead of A=\r\nRC for our metadata files.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;sp=\r\nan lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p c=\r\nlass=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;color:#1F497D&quot;&gt;-Nicholas&lt;o=\r\n:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span style=3D&quot;color:#1F497D&quot;&gt;&lt;=\r\no:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;div style=3D&quot;border:none;border-left:solid blu=\r\ne 1.5pt;padding:0cm 0cm 0cm 4.0pt&quot;&gt;\n&lt;div&gt;\n&lt;div style=3D&quot;border:none;border-=\r\ntop:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm&quot;&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;=\r\n&lt;b&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;font-size:10.0pt;font-family:&quot;Tahoma&=\r\nquot;,&quot;sans-serif&quot;;color:windowtext&quot;&gt;Fra:&lt;/span&gt;&lt;/b&gt;&lt;span lang=3D=\r\n&quot;EN-US&quot; style=3D&quot;font-size:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans=\r\n-serif&quot;;color:windowtext&quot;&gt; Noah Levitt [mailto:nlevitt@...]\n&lt;b=\r\nr&gt;\n&lt;b&gt;Sendt:&lt;/b&gt; 22. august 2012 03:14&lt;br&gt;\n&lt;b&gt;Til:&lt;/b&gt; archive-crawler@yaho=\r\nogroups.com&lt;br&gt;\n&lt;b&gt;Cc:&lt;/b&gt; Nicholas Clarke&lt;br&gt;\n&lt;b&gt;Emne:&lt;/b&gt; Re: [archive-cr=\r\nawler] WARCWriter and empty payload&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;p =\r\nclass=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;div&gt;=\r\n\n&lt;p class=3D&quot;MsoNormal&quot;&gt;Hello Nicholas,&lt;br&gt;\n&lt;br&gt;\nDo you have a test case fo=\r\nr that? &lt;br&gt;\n&lt;br&gt;\nThere are a number of things that could be considered a r=\r\necord with empty payload. I tried to reproduce with the h3 WARCWriter using=\r\n this code:&lt;br&gt;\n&lt;br&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ANVLRecord =\r\nheaders =3D new ANVLRecord(1);&lt;br&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=\r\np; headers.addLabelValue(NAMED_FIELD_IP_LABEL, &quot;127.0.0.1&quot;);&lt;br&gt;\n=\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.writeResourceRecord(&lt;a href=3D=\r\n&quot;http://example.org/empty&quot;&gt;&quot;http://example.org/empty&quot;&lt;/a&gt;,&lt;br&gt;\n&n=\r\nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=\r\n;&nbsp;&nbsp; ArchiveUtils.get14DigitDate(), &quot;text/plain&quot;, header=\r\ns,&lt;br&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=\r\nbsp;&nbsp;&nbsp;&nbsp; new ByteArrayInputStream(new byte[0]), 0);&lt;br&gt;\n&lt;br&gt;\n=\r\nFound that it WARCWriter.createRecordHeader() chooses not to write a conten=\r\nt-type header because the content length is 0. WARCReader chokes because it=\r\n expects the content-type header. I don&#39;t know if it&#39;s worth worrying about=\r\n that because it may not ever happen\n in the wild. But in any case it doesn=\r\n&#39;t match your description of the problem.&lt;br&gt;\n&lt;br&gt;\nNoah&lt;br&gt;\n&lt;br&gt;\nOn 08/21/2=\r\n012 09:21 AM, Nicholas Clarke wrote:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;blockquote styl=\r\ne=3D&quot;margin-top:5.0pt;margin-bottom:5.0pt&quot;&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span st=\r\nyle=3D&quot;font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif=\r\n&quot;&quot;&gt;&lt;br&gt;\n&lt;br&gt;\n&lt;br&gt;\n&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;Hello =\r\nall&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D=\r\n&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;When using the H1 WarcWriter to write a re=\r\ncord with empty(=3D0) payload it somehow forgets to write a CRLF pair after=\r\n the WARC header or in the 2 trailing CRLF pairs.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p =\r\nclass=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p cl=\r\nass=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;Is this only a H1 problem?&lt;/span&gt;&lt;o:=\r\np&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;=\r\n&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;And is there a worka=\r\nround short of extending the WARCWriter and making a method for this specia=\r\nl case.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;&=\r\nnbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;PS:=\r\n Trying to read the buggy record with ArchiveReader kills the reader.&lt;/span=\r\n&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;=\r\no:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;-Nicholas&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;=\r\nMsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;font-size:10.5pt;font-family:Conso=\r\nlas&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-U=\r\nS&quot; style=3D&quot;font-size:10.5pt;font-family:Consolas&quot;&gt;------------------------=\r\n------------------------------------------------------&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p=\r\n&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;Nicholas Clarke, Software Dev=\r\neloper&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;De=\r\npartment of Digital Preservation, Royal Library, Copenhagen, Denmark&lt;/span&gt;=\r\n&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;tlf: (&#43;45) =\r\n33 47 48 38&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-U=\r\nS&quot;&gt;email: &lt;a href=3D&quot;mailto:svc@...&quot;&gt;nicl@...&lt;/a&gt;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;=\r\n\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot; style=3D&quot;font-size:10.5pt;font=\r\n-family:Consolas&quot;&gt;---------------------------------------------------------=\r\n---------------------&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span la=\r\nng=3D&quot;EN-US&quot;&gt;Building complex programs one state machine at a time.&lt;/span&gt;&lt;=\r\no:p&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span lang=3D&quot;EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:=\r\np&gt;&lt;/o:p&gt;&lt;/p&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span style=3D&quot;font-size:12.0pt;font-fa=\r\nmily:&quot;Times New Roman&quot;,&quot;serif&quot;&quot;&gt;&lt;br&gt;\n&lt;br&gt;\n&lt;br&gt;\n&lt;o:p&gt;&lt;/o=\r\n:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;div&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span style=3D&quot;font-size:12.0pt=\r\n;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;color:white&quot;&gt;&lt;o:=\r\np&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;/blockquote&gt;\n&lt;p class=3D&quot;MsoNormal&quot;&gt;&lt;span style=\r\n=3D&quot;font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&qu=\r\not;&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\r\n--_000_562E190D92E89148841BDF055D642C841D4399ADEXCHANGE01kbdk_--\r\n\n\r\n--_004_562E190D92E89148841BDF055D642C841D4399ADEXCHANGE01kbdk_\r\nContent-Type: image/jpeg; name=&quot;image001.jpg&quot;\r\nContent-Description: image001.jpg\r\nContent-Disposition: inline; filename=&quot;image001.jpg&quot;; size=332;\n\tcreation-date=&quot;Wed, 22 Aug 2012 12:31:07 GMT&quot;;\n\tmodification-date=&quot;Wed, 22 Aug 2012 12:31:07 GMT&quot;\r\nContent-ID: &lt;image001.jpg@01CD8072.C3DF22A0&gt;\r\n\r\n[ Attachment content not displayed ]\r\n--_004_562E190D92E89148841BDF055D642C841D4399ADEXCHANGE01kbdk_--\r\n\n"}}