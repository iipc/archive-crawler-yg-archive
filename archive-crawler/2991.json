{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"AqJlRtFMls401NZg_1llgyjxSXOF0nsPvTH-Fh9qqso6UYlLajhWauasqrsOiMRfcxMFJPuU6JenJXZgoXimbzxtsKHOGvM","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Re: Heritrix &quot;hangs&quot; and doesn&#39;t finish its job","postDate":"1151615526","msgId":2991,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQ0QTQ0MjI2LjkwMTAxMDhAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGU4MGtjZiszamVqQGVHcm91cHMuY29tPg==","referencesHeader":"PGU4MGtjZiszamVqQGVHcm91cHMuY29tPg=="},"prevInTopic":2989,"nextInTopic":2994,"prevInTime":2990,"nextInTime":2992,"topicId":2822,"numMessagesInTopic":9,"msgSnippet":"Olaf - I can see a potential cause of your problem -- an interaction between the IP-based queueing and retired queues -- but I can t reproduce it. ","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nReceived: (qmail 91225 invoked from network); 29 Jun 2006 21:11:07 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m30.grp.scd.yahoo.com with QMQP; 29 Jun 2006 21:11:07 -0000\r\nReceived: from unknown (HELO mail.archive.org) (207.241.227.188)\n  by mta1.grp.scd.yahoo.com with SMTP; 29 Jun 2006 21:10:59 -0000\r\nReceived: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 0C029141569A3\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Thu, 29 Jun 2006 14:10:58 -0700 (PDT)\r\nReceived: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id 11319-01-19 for &lt;archive-crawler@yahoogroups.com&gt;;\n\tThu, 29 Jun 2006 14:10:57 -0700 (PDT)\r\nReceived: from [192.168.1.203] (unknown [67.170.222.19])\n\tby mail.archive.org (Postfix) with ESMTP id 4830714156993\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Thu, 29 Jun 2006 14:10:57 -0700 (PDT)\r\nMessage-ID: &lt;44A44226.9010108@...&gt;\r\nDate: Thu, 29 Jun 2006 14:12:06 -0700\r\nUser-Agent: Mail/News 1.5 (X11/20060309)\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;e80kcf+3jej@...&gt;\r\nIn-Reply-To: &lt;e80kcf+3jej@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-Virus-Scanned: Debian amavisd-new at archive.org\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] Re: Heritrix &quot;hangs&quot; and doesn&#39;t finish its\n job\r\nX-Yahoo-Group-Post: member; u=137285340; y=TjfqNxFrLB1oTOY8kfH8bAJnLBuYu7YKzLgA4IGkyqSt\r\nX-Yahoo-Profile: gojomo\r\n\r\nOlaf -\n\nI can see a potential cause of your problem -- an interaction between \nthe IP-based queueing and retired queues -- but I can&#39;t reproduce it.\n\nSpecifically, with the IP-based queueing, URIs first go onto a \ndomain-name queue (before IP is known), then get moved to an IP-based \nqueue. It appears possible that this handoff between queues might not \nmaintain the proper queued count in all situations. (Also, that the\n\nHowever, my attempts to reproduce with the URI you provided and similar \nsettings have not yet succeeded. Indeed, I even ran into another problem \nwith IPQueueAssignmentPolicy not working at all, given the difference \nbetween its getClassKey() signature and the superclass signature.\n\nWhat JVM are you using?\n\nCan you forward the contents of the full frontier report for your latest \nmini-reproduction run?\n\n- Gordon @ IA\n\npandae667 wrote:\n&gt; Hi everyone,\n&gt; \n&gt; I tried to find the cause of the problem for a while by now, but I&#39;m\n&gt; still stuck. \n&gt; I added some debug output to heritrix so each time the queuedUriCount\n&gt; gets increased I get an info in the log, same when it is increased.\n&gt; \n&gt; Using the previous example of mine I see the following in my logs:\n&gt; \n&gt; queued count increased by 1:  231\n&gt; queued count decreased by 1:   24 (it have been 4 queues, max total\n&gt; cost of 5 - thus 5 plus DNS query for each?)\n&gt; \n&gt; and in the end, 4 queues are retired, reducing the queued count by: 1,\n&gt; 2, 36, 164\n&gt; \n&gt; So a total of 231 objects were queued, but only 227 were dequeued,\n&gt; resulting in 4 remaining &quot;queued&quot; URIs in no queue that feels responsible.\n&gt; \n&gt; As the number of single decreases seems sane, the single increases\n&gt; seem correct, too (no URI seems to have been enqueued twice) I suspect\n&gt; the problem must be with the WorkQueues. Is there any chance that the\n&gt; getCount() method might return the wrong value?\n&gt; \n&gt; I&#39;d be thankful for any help as I&#39;m desperated by now..\n&gt; \n&gt; Thanks in advance\n&gt;   Olaf Freyer\n&gt; \n&gt; --- In archive-crawler@yahoogroups.com, &quot;pandae667&quot; &lt;aaron667@...&gt; wrote:\n&gt;&gt; Hi everyone,\n&gt;&gt;\n&gt;&gt; its me again. I have managed to reproduce this problem with just one\n&gt;&gt; seed.\n&gt;&gt; The seed in question is:  http://www.chip.de/c1_navseite_12648189.html\n&gt;&gt; The order.xml to trigger the problem can be found at:\n&gt;&gt; http://user.cs.tu-berlin.de/~aaron/order.xml\n&gt;&gt;\n&gt;&gt; With this order.xml it takes about 5 seconds to trigger the problem for\n&gt;&gt; me (100% reproducable).\n&gt;&gt; I&#39;m using an out-of-the-box heritrix-1.8.0 release without any special\n&gt;&gt; tweaks or changes.\n&gt;&gt;\n&gt;&gt; Here is the queue report I get:\n&gt;&gt; -----===== STATS =====-----\n&gt;&gt; Discovered:    492\n&gt;&gt; Queued:        134\n&gt;&gt; Finished:      30\n&gt;&gt; Successfully: 30\n&gt;&gt; Failed:       0\n&gt;&gt; Disregarded:  0\n&gt;&gt;\n&gt;&gt; -----===== QUEUES =====-----\n&gt;&gt; Already included size:     492\n&gt;&gt; pending:     0\n&gt;&gt;\n&gt;&gt; All class queues map size: 5\n&gt;&gt; Active queues: 0\n&gt;&gt; In-process: 0\n&gt;&gt; Ready: 0\n&gt;&gt; Snoozed: 0\n&gt;&gt; Inactive queues: 0\n&gt;&gt; Retired queues: 5\n&gt;&gt; Exhausted queues: 0\n&gt;&gt;\n&gt;&gt; -----===== IN-PROCESS QUEUES =====-----\n&gt;&gt; heritrix_out.log shows once again no sign of an exception.\n&gt;&gt;\n&gt;&gt; Thx for any further help in resolving this problem\n&gt;&gt;    Olaf Freyer\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; --- In archive-crawler@yahoogroups.com, &quot;pandae667&quot; &lt;aaron667@&gt;\n&gt;&gt; wrote:\n&gt;&gt;&gt; Hi everyone,\n&gt;&gt;&gt;\n&gt;&gt;&gt; I&#39;v dug some more through the Heritrix sources to track down the\n&gt;&gt;&gt; problem but haven&#39;t found a solution yet. This problem starts to get\n&gt;&gt;&gt; really annoying as it happens on almost every big crawl I&#39;m running\n&gt;&gt;&gt; (500+ seeds) but rarly on small ones with less seeds.\n&gt;&gt;&gt;\n&gt;&gt;&gt; I haven&#39;t found a cause yet but have some theories what might cause it\n&gt;&gt;&gt; (even though I might be totally wrong).\n&gt;&gt;&gt;\n&gt;&gt;&gt; The most propable theory so far is the following:\n&gt;&gt;&gt; Two ToeThreads working on different URIs from different queues come\n&gt;&gt;&gt; accross the same (so far unseen) URI at more or less &quot;the exact same\n&gt;&gt;&gt; moment&quot;. Both threads come to the conclusion that their URI is new and\n&gt;&gt;&gt; try to enqueue it in the currect queue. While doing this both of them\n&gt;&gt;&gt; increment to queuedUriCount by 1 but the queue itself being smart\n&gt;&gt;&gt; enough only contains one of them.\n&gt;&gt;&gt;\n&gt;&gt;&gt; I&#39;ll increase logging to see if my theory might be true and report\n&gt;&gt;&gt; back later.\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; If anyone has any other idea in the meantime I&#39;ll be happy to hear\n&gt;&gt;&gt; about it.\n&gt;&gt;&gt;\n&gt;&gt;&gt; Thanks alot\n&gt;&gt;&gt;   Olaf Freyer\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; --- In archive-crawler@yahoogroups.com, &quot;pandae667&quot; aaron667@ wrote:\n&gt;&gt;&gt;&gt; Hi everyone here at archive-crawler,\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; I&#39;m experiencing a strange problem with my crawler (heritrix cvs +\n&gt;&gt;&gt;&gt; AddRedirectFromRootServerToScope fix from Gordon). It happened to me\n&gt;&gt;&gt;&gt; twice so far.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; After about 1 hour it has fetched (allmost?) all the documents it is\n&gt;&gt;&gt;&gt; supposed to (about 9000 seeds and a limit of 100 documents per host)\n&gt;&gt;&gt;&gt; and then just &quot;hangs&quot;.\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; The Frontier Report tells me:\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;  -----===== STATS =====-----\n&gt;&gt;&gt;&gt;  Discovered:    1008968\n&gt;&gt;&gt;&gt;  Queued:        24\n&gt;&gt;&gt;&gt;  Finished:      432424\n&gt;&gt;&gt;&gt;   Successfully: 426289\n&gt;&gt;&gt;&gt;   Failed:       1565\n&gt;&gt;&gt;&gt;   Disregarded:  4570\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;  -----===== QUEUES =====-----\n&gt;&gt;&gt;&gt;  Already included size:     1008968\n&gt;&gt;&gt;&gt;                pending:     0\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;  All class queues map size: 12872\n&gt;&gt;&gt;&gt;              Active queues: 0\n&gt;&gt;&gt;&gt;                     In-process: 0\n&gt;&gt;&gt;&gt;                          Ready: 0\n&gt;&gt;&gt;&gt;                        Snoozed: 0\n&gt;&gt;&gt;&gt;            Inactive queues: 0\n&gt;&gt;&gt;&gt;             Retired queues: 2226\n&gt;&gt;&gt;&gt;           Exhausted queues: 10646\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt;  -----===== IN-PROCESS QUEUES =====-----\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; So there are still 24 queued URIs - but no active queue left (last\n&gt;&gt;&gt;&gt; time a queue did anything was about 12 hours ago).\n&gt;&gt;&gt;&gt;\n&gt;&gt;&gt;&gt; Thanks in advance for any ideas\n&gt;&gt;&gt;&gt;   Olaf Freyer\n&gt;&gt;&gt;&gt;\n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt; \n&gt;  \n&gt; Yahoo! Groups Links\n&gt; \n&gt; \n&gt; \n&gt;  \n&gt; \n&gt; \n\n\n"}}