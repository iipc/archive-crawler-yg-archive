{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":278782393,"authorName":"pjack@archive.org","from":"pjack@...","profile":"poetbeware","replyTo":"LIST","senderId":"GMiSc0o4vpQU1uwZb6b0PZLpU4RAy-E0bT4RaGQI6muUEFhxDwN_9AKozYxoA35QClop8JE6s5U","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] embedding 2.0...a bad idea?","postDate":"1202320876","msgId":4968,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQ0NTM0LjcxLjEzMS4yOS4yMDcuMTIwMjMyMDg3Ni5zcXVpcnJlbEBtYWlsLmFyY2hpdmUub3JnPg==","inReplyToHeader":"PDQ3QTlFNzRELjYwMjA3MDNAZW1vcnkuZWR1Pg==","referencesHeader":"PDQ3QTlFNzRELjYwMjA3MDNAZW1vcnkuZWR1Pg=="},"prevInTopic":4967,"nextInTopic":4970,"prevInTime":4967,"nextInTime":4969,"topicId":4966,"numMessagesInTopic":4,"msgSnippet":"... The current event dispatch stuff in CrawlController is quite messy, sorry. We were going to standardize on JMX notifications but ended up just porting","rawEmail":"Return-Path: &lt;pjack@...&gt;\r\nX-Sender: pjack@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 59427 invoked from network); 6 Feb 2008 18:01:17 -0000\r\nX-Received: from unknown (66.218.67.94)\n  by m48.grp.scd.yahoo.com with QMQP; 6 Feb 2008 18:01:17 -0000\r\nX-Received: from unknown (HELO mail.archive.org) (207.241.233.246)\n  by mta15.grp.scd.yahoo.com with SMTP; 6 Feb 2008 18:01:17 -0000\r\nX-Received: from localhost (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 1BD484939E\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed,  6 Feb 2008 10:01:17 -0800 (PST)\r\nX-Received: from mail.archive.org ([127.0.0.1])\n\tby localhost (mail.archive.org [127.0.0.1]) (amavisd-new, port 10024)\n\twith LMTP id leFpMFmblhWL for &lt;archive-crawler@yahoogroups.com&gt;;\n\tWed,  6 Feb 2008 10:01:16 -0800 (PST)\r\nX-Received: from mail.archive.org (localhost [127.0.0.1])\n\tby mail.archive.org (Postfix) with ESMTP id 7E6782994D\n\tfor &lt;archive-crawler@yahoogroups.com&gt;; Wed,  6 Feb 2008 10:01:16 -0800 (PST)\r\nX-Received: from 71.131.29.207\n        (SquirrelMail authenticated user pjack)\n        by mail.archive.org with HTTP;\n        Wed, 6 Feb 2008 10:01:16 -0800 (PST)\r\nMessage-ID: &lt;44534.71.131.29.207.1202320876.squirrel@...&gt;\r\nIn-Reply-To: &lt;47A9E74D.6020703@...&gt;\r\nReferences: &lt;47A9E74D.6020703@...&gt;\r\nDate: Wed, 6 Feb 2008 10:01:16 -0800 (PST)\r\nTo: archive-crawler@yahoogroups.com\r\nUser-Agent: SquirrelMail/1.4.10a\r\nMIME-Version: 1.0\r\nContent-Type: text/plain;charset=iso-8859-1\r\nContent-Transfer-Encoding: 8bit\r\nX-Priority: 3 (Normal)\r\nImportance: Normal\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: pjack@...\r\nSubject: Re: [archive-crawler] embedding 2.0...a bad idea?\r\nX-Yahoo-Group-Post: member; u=278782393; y=4ziqC_SA2NZbPjIVzn-6xYa-CSljQBiIquB8rCuMhMC4Oy1zEQ\r\nX-Yahoo-Profile: poetbeware\r\n\r\n&gt; Hi,\n&gt;\n&gt; I&#39;ve been struggling with 2.0.1 snapshot for the past few days, and I\n&gt; just do not like all the JMX integration.  From the perspective of\n&gt; someone just trying to embed heretrix via good old fashioned API calls,\n&gt; it makes everything extremely confusing.\n&gt;\n&gt; Paul was kind enough to make a change that allowed getting an Engine&#39;s\n&gt; SheetManager via a non-JMX call, but not I&#39;m struggling with adding\n&gt; crawl status listeners.  The previous method (implement the\n&gt; CrawlStatusListener interface) seems intuitive to me.\n\nThe current event dispatch stuff in CrawlController is quite messy, sorry.\n We were going to standardize on JMX notifications but ended up just\nporting CrawlStatusEvents to JMX, and leaving the other events alone. \nI&#39;ve opened HER-1456 for cleaning this up.\n\nHowever, in the meantime, you just have to implement a different\ninterface.  JMX notifications are similar to the 1.x events, but all JMX\nnotifications use the same listener/event class, instead of having a\nseparate listener/event class for each kind of event.\n\nIn 2.x, CrawlControllerImpl implements (via its superclass)\njavax.management.NotificationBroadcaster.  To add a listener for the JMX\nnotifications:\n\n   cc.addNotificationBroadcaster(myListener, null, null);\n\nWhere myListener is an implementation of\njavax.management.NotificationListener.  Eg:\n\n   public class MyNotificationListener implements NotificationListener {\n\n       public void handleNotification(Notification n, Object ignored) {\n           if (n.getType().equals(&quot;FINISHED&quot;)) {\n               System.out.println(&quot;Crawl finished.&quot;);\n           }\n       }\n\n   }\n\nThe CrawlController will emit a notification every time the crawl changes\nstate.  The states are: PREPARED, STARTED, RUNNING, PAUSING, PAUSED,\nSTOPPING, FINISHED.  You can get the phase change via the getType()\nmethod.  See the javax.management javadocs for more details, but the\noverall process isn&#39;t that much different than in 1.x.\n\n\n&gt;  The new method\n&gt; (??? something to do with ListModuleListener and the sheet manager) has\n&gt; stumped me so far, and I&#39;m about ready to give up.  I&#39;ve been through\n&gt; the code, and the closest thing I could find was addFinishedCallback in\n&gt; EngineImpl, but I don&#39;t really understand what it&#39;s doing, and try as I\n&gt; might, I can&#39;t get similar code to work for me.\n\nListModuleListeners are invoked whenever a module is added or removed from\nthe configuration managed by a SheetManager.\n\nThe addFinishedCallback method is an implementation detail of the Engine;\nit&#39;s used to remove all the JMX modules from the MBeanServer after the job\nfinishes.\n\nNeither are really related to what you want to do.\n\n\n&gt; So, am I barking up the wrong tree trying to embed heritrix 2?  I&#39;m sure\n&gt; making embedding hard is not a goal for 2.0, but was easy embedding\n&gt; scratched from the list?\n\nI hope not. :)\n\n-Paul\n\n\n"}}