{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":137285340,"authorName":"Gordon Mohr","from":"Gordon Mohr &lt;gojomo@...&gt;","profile":"gojomo","replyTo":"LIST","senderId":"--8RYBNp9dMh3F-fjaTvcCuDPozISe_Rlno6eQ4IQwVXmJm6tTYFmq1h66VdlL0OA0XTVr3__fmAVV3u11B-QSsVvcLUXnc","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [archive-crawler] Re: General questions and questions about DecideRule","postDate":"1292960886","msgId":6934,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDREMTEwNDc2LjcwNDA1MDVAYXJjaGl2ZS5vcmc+","inReplyToHeader":"PGllcHNmMCtjNjRuQGVHcm91cHMuY29tPg==","referencesHeader":"PGllcHNmMCtjNjRuQGVHcm91cHMuY29tPg=="},"prevInTopic":6928,"nextInTopic":0,"prevInTime":6933,"nextInTime":6935,"topicId":6918,"numMessagesInTopic":4,"msgSnippet":"... Please do! Also take a look at PredicatedDecideRule, if you haven t already. It represents the idea of all rules which turn a boolean true/false test into","rawEmail":"Return-Path: &lt;gojomo@...&gt;\r\nX-Sender: gojomo@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 97072 invoked from network); 21 Dec 2010 19:48:10 -0000\r\nX-Received: from unknown (66.196.94.105)\n  by m13.grp.re1.yahoo.com with QMQP; 21 Dec 2010 19:48:10 -0000\r\nX-Received: from unknown (HELO relay03.pair.com) (209.68.5.17)\n  by mta1.grp.re1.yahoo.com with SMTP; 21 Dec 2010 19:48:10 -0000\r\nX-Received: (qmail 74027 invoked by uid 0); 21 Dec 2010 19:48:07 -0000\r\nX-Received: from 67.188.34.83 (HELO silverbook.local) (67.188.34.83)\n  by relay03.pair.com with SMTP; 21 Dec 2010 19:48:07 -0000\r\nX-pair-Authenticated: 67.188.34.83\r\nMessage-ID: &lt;4D110476.7040505@...&gt;\r\nDate: Tue, 21 Dec 2010 11:48:06 -0800\r\nUser-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.13) Gecko/20101207 Thunderbird/3.1.7\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nCc: dechouxb &lt;dechouxb@...&gt;\r\nReferences: &lt;iepsf0+c64n@...&gt;\r\nIn-Reply-To: &lt;iepsf0+c64n@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nFrom: Gordon Mohr &lt;gojomo@...&gt;\r\nSubject: Re: [archive-crawler] Re: General questions and questions about DecideRule\r\nX-Yahoo-Group-Post: member; u=137285340; y=oLJNG_mPN-MqzDXP_oM-RxS-VA1dTz6TaGFhv61vwB4N\r\nX-Yahoo-Profile: gojomo\r\n\r\nOn 12/21/10 1:36 AM, dechouxb wrote:\n&gt; Thanks for the reply. I was not arguing about the DecideRuleSequence or the three-state logic itself. Of course, this does allow an &#39;expressivity&#39; that would be hard to equal with boolean operators. We agree that we could manage to express the same thing but that would not be more readable.\n&gt;\n&gt; My concern was more about the consumer of such rules. Depending on the consumer, the meaning of NONE/PASS means either ACCEPT or REJECT.\n&gt;\n&gt; I am going to do my experiment and I will keep you/the group informed.\n\nPlease do!\n\nAlso take a look at PredicatedDecideRule, if you haven&#39;t already. It \nrepresents the idea of all rules which turn a boolean true/false test \ninto a specific-decision/NONE result.\n\n- Gordon @ IA\n\n\n\n\n&gt; Regards\n&gt;\n&gt; Bertrand Dechoux\n&gt;\n&gt;\n&gt; --- In archive-crawler@yahoogroups.com, Gordon Mohr&lt;gojomo@...&gt;  wrote:\n&gt;&gt;\n&gt;&gt; On 12/17/10 12:51 AM, dechouxb wrote:\n&gt;&gt;&gt; Hi,\n&gt;&gt;&gt;\n&gt;&gt;&gt; I basically would like to contribute back to H3. But first I have a few\n&gt;&gt;&gt; questions :\n&gt;&gt;\n&gt;&gt; Great! We&#39;ve put some notes about contributing code on the project wiki at:\n&gt;&gt;\n&gt;&gt; https://webarchive.jira.com/wiki/display/Heritrix/Contributing+to+Heritrix\n&gt;&gt;\n&gt;&gt;&gt;      * How does serialization work within H3?\n&gt;&gt;\n&gt;&gt; Objects are primarily serialized to be saved in persistent caches\n&gt;&gt; (summary info for each known host, server, queue) or on-disk queues.\n&gt;&gt;\n&gt;&gt; Up through 3.0.0, Java&#39;s native serialization was used, with a few\n&gt;&gt; classes implementing custom serialization for efficiency. However, in\n&gt;&gt; SVN TRUNK, we&#39;ve moved to the &#39;Kryo&#39; serialization library for speed and\n&gt;&gt; compactness benefits.\n&gt;&gt;\n&gt;&gt; Starting in H3, we avoid use of serialization for saving checkpoint\n&gt;&gt; state, preferring JSON, to make state easier to view and edit before\n&gt;&gt; resumption.\n&gt;&gt;\n&gt;&gt;&gt;      * I believe I saw that job configuration might be serialized, not\n&gt;&gt;&gt;        using the standard java serialization, but a JSON variant. Is\n&gt;&gt;&gt;        there a relation with the HasKeyedProperties interface or is this\n&gt;&gt;&gt;        interface uniquely for sheet-based contextual overriding of\n&gt;&gt;&gt;        properties?\n&gt;&gt;\n&gt;&gt; The configuration is only really stored in the &#39;CXML&#39; files, which are\n&gt;&gt; the same XML format as specified by the Spring Inversion-of-Control\n&gt;&gt; container. Such CXML is only consulted when a crawl job is first &#39;built&#39;\n&gt;&gt; -- it&#39;s never updated by a running job.\n&gt;&gt;\n&gt;&gt; The HasKeyedProperties interface is only used for the sheet-based\n&gt;&gt; overlaying of some settings based on URI context -- for example flipping\n&gt;&gt; a flag, or changing a threshold, for some sites or URI patterns. It&#39;s\n&gt;&gt; not related to any serialization.\n&gt;&gt;\n&gt;&gt;&gt;      * What is the development relationships between version 1, 2 and 3\n&gt;&gt;&gt;        of archive-crawler/Heritrix? I guess bug fixes are spread as much\n&gt;&gt;&gt;        as possible but what about if a minor architectural change was\n&gt;&gt;&gt;        made within H3?\n&gt;&gt;\n&gt;&gt; H1 and H3 are getting active development, though for H1 mostly bug\n&gt;&gt; fixes. H3 is still a bit more suited for expert operators and those more\n&gt;&gt; comfortable seeing the raw Java class names, and occasionally looking\n&gt;&gt; through the Java source code to understand all the options.  H3 is\n&gt;&gt; recommended over H2; no mroe fixes or features are expected for H2.\n&gt;&gt;\n&gt;&gt; H3 has many big changes that won&#39;t be backported to H1; moving to H3 is\n&gt;&gt; the right way to use them.\n&gt;&gt;\n&gt;&gt;&gt;      * Could the design of DecideRule be simplified?\n&gt;&gt;&gt;\n&gt;&gt;&gt; Basically, for code reading/understanding/maintenance, high inheritance\n&gt;&gt;&gt; trees are not that great. The current DecideRule mother class has many\n&gt;&gt;&gt; children and could abstracted with :\n&gt;&gt;&gt;\n&gt;&gt;&gt;      package org.archive.modules.decisions;\n&gt;&gt;&gt;\n&gt;&gt;&gt;      public interface DecideRule implements Serializable {\n&gt;&gt;&gt;\n&gt;&gt;&gt;      boolean accepts(CrawlURI uri);\n&gt;&gt;&gt;\n&gt;&gt;&gt;      }\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; The other real public method (a method which is used outside any\n&gt;&gt;&gt; DecideRule classes) is decisionFor(CrawlURI). But really, I believe the\n&gt;&gt;&gt; tree-state logic does not have to leak out from the DecideRule various\n&gt;&gt;&gt; implementations. The NONE DecideResult has no reason to be used\n&gt;&gt;&gt; consistently because the callers want a boolean decision. That is\n&gt;&gt;&gt; something which slows down the setting up and updating of rules ie &#39;How\n&gt;&gt;&gt; NONE was handled for that particular implementation?&#39; &#39;Does it only keep\n&gt;&gt;&gt; CrawlURI with ACCEPT or does it only ignore CrawlURI with REJECT?&#39; ...*\n&gt;&gt;&gt; All current implementations could use the accepts(CrawlURI uri) method.\n&gt;&gt;&gt; Those which are currently using decisionFor(CrawlURI) could be\n&gt;&gt;&gt; refactored with full backward compatibility using a DecideRuleSequence\n&gt;&gt;&gt; and the right default constant DecideResult without changing their API\n&gt;&gt;&gt; and their behaviour.\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; Actually, the fact that a DecideRule can offer three different decisions\n&gt;&gt; -- ACCEPT, REJECT, or PASS -- is important to its style of\n&gt;&gt; specification, allowing a flat list of rules to cover most common\n&gt;&gt; scoping needs, without multilevel boolean-clause nesting.\n&gt;&gt;\n&gt;&gt; A mere boolean true/false would be insufficient to allow a later (and\n&gt;&gt; thus superceding) rule to simply say, &#39;no opinion&#39;.\n&gt;&gt;\n&gt;&gt; (Additionally, the onlyDecision() optimization allows rules that would\n&gt;&gt; only repeat the already-standing decision to be skipped.)\n&gt;&gt;\n&gt;&gt; As an exercise, you might try to replicate the behavior of the current\n&gt;&gt; default rule set with rules that only answer true/false. I think you&#39;d\n&gt;&gt; find nesting with ANDs/ORs/NOTs to 3+ levels would be necessary. Our\n&gt;&gt; scoping used to work like that, and it became quite confusing to\n&gt;&gt; remember that a filter in one place returning &#39;true&#39; meant &#39;reject&#39; and\n&gt;&gt; in another place &#39;true&#39; means &#39;accept&#39;.\n&gt;&gt;\n&gt;&gt; Thus, it would take a strong demonstration that such a change made\n&gt;&gt; typical configurations easier and more understandable to refactor in\n&gt;&gt; that direction now.\n&gt;&gt;\n&gt;&gt; - Gordon @ IA\n&gt;&gt;\n&gt;&gt;&gt; I am of course volunteering for the task. I only wanted to have your\n&gt;&gt;&gt; thoughts before starting any coding work. I might not understand/know\n&gt;&gt;&gt; all the reasons for the current design. And at the end of the day, I\n&gt;&gt;&gt; will need your agreement for the work to be integrated into the current\n&gt;&gt;&gt; version of H3.\n&gt;&gt;&gt;\n&gt;&gt;&gt; Regards\n&gt;&gt;&gt;\n&gt;&gt;&gt; Bertrand Dechoux\n&gt;&gt;&gt;\n&gt;&gt;&gt; *\n&gt;&gt;&gt; **\n&gt;&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n\n"}}