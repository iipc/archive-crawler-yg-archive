{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":362973207,"authorName":"Juergen Umbrich","from":"Juergen Umbrich &lt;juergen@...&gt;","replyTo":"LIST","senderId":"owlAP-FL3zn7fP-g7VBiR5Jkc4JzjuNd6wCn_Dw_7buZZntZuiY9KBV-7cmokpPef7qUuY0iXoEmFI0x7JMFMqRsEaiG91_9huG7FA","spamInfo":{"isSpam":false,"reason":"12"},"subject":"Re: [archive-crawler] Broad-scope 10M seeds Xmx6G 64-Bit JVM: OOME: GC overhead limit exceeded","postDate":"1226512509","msgId":5571,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQ5MUIxODdELjUwNDA5MDJAdW1icmljaC5uZXQ+","inReplyToHeader":"PDQ5MDU1ODcxLjcwNjA0MDdAYXJjaGl2ZS5vcmc+","referencesHeader":"PDQ5MDA2MEQxLjUwNzA0MDdAdW1icmljaC5uZXQ+IDw0OTAxMUJBQS44MDQwNzA5QGFyY2hpdmUub3JnPiA8NDkwMTlENjcuODA2MDIwMEB1bWJyaWNoLm5ldD4gPDQ5MDU1ODcxLjcwNjA0MDdAYXJjaGl2ZS5vcmc+"},"prevInTopic":5561,"nextInTopic":5577,"prevInTime":5570,"nextInTime":5572,"topicId":5537,"numMessagesInTopic":12,"msgSnippet":"Hi thanks a lot Gordon for all your help! ... Is it because heritrix 2.0.1 (or 2.0.2) is to unstable, or what is your reason? ... yes, thats right, we changed","rawEmail":"Return-Path: &lt;juergen@...&gt;\r\nX-Sender: juergen@...\r\nX-Apparently-To: archive-crawler@yahoogroups.com\r\nX-Received: (qmail 97253 invoked from network); 12 Nov 2008 17:56:31 -0000\r\nX-Received: from unknown (66.218.67.94)\n  by m56.grp.scd.yahoo.com with QMQP; 12 Nov 2008 17:56:31 -0000\r\nX-Received: from unknown (HELO mx2.nuigalway.ie) (140.203.201.101)\n  by mta15.grp.scd.yahoo.com with SMTP; 12 Nov 2008 17:56:31 -0000\r\nX-IronPort-Anti-Spam-Filtered: true\r\nX-IronPort-Anti-Spam-Result: ApoEAPanGkkKhJ0L/2dsb2JhbADQYINX\r\nX-IronPort-AV: E=Sophos;i=&quot;4.33,591,1220223600&quot;; \n   d=&quot;scan&#39;208&quot;;a=&quot;97719081&quot;\r\nX-Received: from exbe1.ac.nuigalway.ie (HELO EVS1.ac.nuigalway.ie) ([10.132.157.11])\n  by mx2.nuigalway.ie with ESMTP; 12 Nov 2008 17:56:30 +0000\r\nX-Received: from EVS1.ac.nuigalway.ie ([10.132.157.14]) by EVS1.ac.nuigalway.ie with Microsoft SMTPSVC(6.0.3790.3959);\n\t Wed, 12 Nov 2008 17:56:30 +0000\r\nX-Received: from [10.2.17.73] ([140.203.154.12]) by EVS1.ac.nuigalway.ie over TLS secured channel with Microsoft SMTPSVC(6.0.3790.3959);\n\t Wed, 12 Nov 2008 17:56:29 +0000\r\nMessage-ID: &lt;491B187D.5040902@...&gt;\r\nDate: Wed, 12 Nov 2008 17:55:09 +0000\r\nUser-Agent: Mozilla-Thunderbird 2.0.0.17 (X11/20081018)\r\nMIME-Version: 1.0\r\nTo: archive-crawler@yahoogroups.com\r\nReferences: &lt;490060D1.5070407@...&gt; &lt;49011BAA.8040709@...&gt; &lt;49019D67.8060200@...&gt; &lt;49055871.7060407@...&gt;\r\nIn-Reply-To: &lt;49055871.7060407@...&gt;\r\nContent-Type: text/plain; charset=UTF-8; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nReturn-Path: juergen@...\r\nX-OriginalArrivalTime: 12 Nov 2008 17:56:29.0824 (UTC) FILETIME=[FD88C000:01C944EF]\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Juergen Umbrich &lt;juergen@...&gt;\r\nSubject: Re: [archive-crawler] Broad-scope 10M seeds Xmx6G 64-Bit JVM: OOME:\n GC overhead limit exceeded\r\nX-Yahoo-Group-Post: member; u=362973207\r\n\r\nHi\n\nthanks a lot Gordon for all your help!\n&gt;&gt; Is it possible to publish one of these optimised configuration files?\n&gt;&gt; We are very interested in performing large crawls.\n&gt;&gt;     \n&gt;\n&gt; They are essentially the default bundled configurations, though with \n&gt; different seed & SURT-prefix configurations.\n&gt;\n&gt; The one most common change we make for crawls expected to go &gt;100 \n&gt; million URIs is to use the BloomUriUniqFilter, with its defaults sizing. \n&gt; The default sizing, IIRC, uses about 500MB to remember discovery of up \n&gt; to 125 million URIs with a 1-in-4-million chance of false positives. \n&gt; Over 125 million inserts, the false positive rate will go up. \n&gt; Commensurate with this change, we usually set the BDB-JE cache memory \n&gt; percent to something like 30% -- otherwise its default 60%, plus the \n&gt; 500MB bloom filter, would leave little other space in our usual 2-3GB \n&gt; heaps. This might not be an issue in your 6GB heap.\n&gt;\n&gt; Note though that we still use Heritrix 1.14.x for our production crawls \n&gt; of all sizes.\n&gt;   \nIs it because heritrix 2.0.1 (or 2.0.2) is to unstable, or what is your \nreason?\n\n&gt; I imagine you&#39;ve also changed the max-hops limit?\n&gt;\n&gt;   \nyes, thats right, we changed it to &quot;2&quot;.\n&gt;&gt; sorry, we deleted the crawl. But I think we can reproduce error and \n&gt;&gt; provide you with the thread reports.\n&gt;&gt;\n&gt;&gt; The _out.log files are available at\n&gt;&gt; http://www.umbrich.net/heritrix_out.log1\n&gt;&gt; http://www.umbrich.net/heritrix_out.log2\n&gt;&gt; http://www.umbrich.net/heritrix_out.log3\n&gt;&gt;     \n&gt;\n&gt; Thanks for these. I note that in each, there appears to be a &#39;seeds \n&gt; report&#39; in progress -- evident either from the error stacks or the \n&gt; RegexpLineIterator warnings.\n&gt;\n&gt; As I mentioned, we haven&#39;t typically run crawls with 10 million seeds. \n&gt; (I think our largest has been closer to 1 million.) It&#39;s also rare for \n&gt; us to request a seeds report on large crawls while they are running. I \n&gt; suspect it&#39;s the building of the seeds report in memory that&#39;s either \n&gt; triggering or contributing to your issue.\n&gt;   \n&gt; Do you need the report, or can you get the necessary info from the logs?\n&gt;   \nNo, we don&#39;t need the seed report. The information in the log files and \nour additional logging is more than enough.\n\n&gt; We don&#39;t want any valid request for a seeds report to crash the crawler, \n&gt; so there&#39;s something for us to fix here. However, the answer might be to \n&gt; cap the size of a seed report viewable by the web UI -- that is, protect \n&gt; by limiting risky functionality.\n&gt;   \n&gt;&gt; Please not that in our seed list are some error lines integrated (the \n&gt;&gt; lines have a RDF-NQuad format)\n&gt;&gt; (Just know i recognise all the warnings from the \n&gt;&gt; org.archive.util.iterator.RegexpLineIterator, and i have in mind that \n&gt;&gt; the regex handling with java can cause serious problems. Could this be \n&gt;&gt; the reason for the GC thing?)\n&gt;&gt;     \n&gt;\n&gt; As noted above, the rescanning of the seeds file to compile the full \n&gt; report is likely related. There&#39;s nothing inherently troubling about \n&gt; Java regex handling, especially in this line-by-line scanning of \n&gt; well-formed input (no deep recursion, even give your error lines). It&#39;s \n&gt; more the size of the report data being assembled at the same time the \n&gt; rest of the crawl is trying to proceed.\n&gt;   \nOK, related to the information above, we run several new benchmark \ncrawls with a seed set of around 1M URIs.\nIn all the different test runs we had no problems.\nWe fetched ~10M page/day and the whole system did not show a unormalities.\nSo, we think that the seed report generation, Gordon mentioned, is the \nproblem for the crashing of heritrix in the previous test runs.\n\nThanks again for the help!\n\nBest juergen\n\n"}}